var _Mathpow=Math.pow,_StringfromCharCode=String.fromCharCode,_Mathmin=Math.min,_Mathfloor=Math.floor,_Mathmax=Math.max,_Mathabs=Math.abs;(function(r){function h(E){if(_[E])return _[E].exports;var w=_[E]={i:E,l:!1,exports:{}};return r[E].call(w.exports,w,w.exports,h),w.l=!0,w.exports}var _={};return h.m=r,h.c=_,h.i=function(E){return E},h.d=function(E,w,S){h.o(E,w)||Object.defineProperty(E,w,{configurable:!1,enumerable:!0,get:S})},h.n=function(E){var w=E&&E.__esModule?function(){return E['default']}:function(){return E};return h.d(w,'a',w),w},h.o=function(E,w){return Object.prototype.hasOwnProperty.call(E,w)},h.p='',h(h.s=74)})([function(r,h,_){r.exports=_(60),r.exports.default=r.exports},function(r,h,_){r.exports=_(59),r.exports.default=r.exports},function(r,h,_){'use strict';var E=_(43);_.d(h,'b',function(){return E.a});var w=_(42);_.d(h,'c',function(){return w.a});var S=_(44);_.d(h,'e',function(){return S.a});var C=_(45);_.d(h,'d',function(){return C.a});var R=_(41);_.d(h,'g',function(){return R.a});var N=_(14);_.d(h,'f',function(){return N.a});var O=_(47);_.d(h,'h',function(){return O.a});var I=_(46);_.d(h,'a',function(){return I.a})},function(r,h,_){'use strict';var E=_(30);_.d(h,'f',function(){return E.a});var w=_(32),S=_(33);_.d(h,'b',function(){return S.a});var C=_(13),R=_(6);_.d(h,'e',function(){return R.a});var N=_(34);_.d(h,'g',function(){return N.a});var O=_(36);_.d(h,'a',function(){return O.a});var I=_(29);_.d(h,'h',function(){return I.a});var M=_(31);_.d(h,'c',function(){return M.a});var A=_(35);_.d(h,'d',function(){return A.a})},function(r,h,_){r.exports=_(62),r.exports.default=r.exports},function(r,h){'use strict';h.e=(O,I,M)=>({type:'MARK_MOVE_DEST',name:O,left:I,right:M});h.f=(O,I,M)=>({type:'MOVE_COLUMN',name:O,left:I,right:M});h.d=(O,I)=>({type:'RESIZE_COLUMN',name:O,size:I});h.c=(O,I)=>({type:'FILTER_COLUMN',name:O,filter:I});h.b=(O)=>({type:'SORT_COLUMN',name:O});h.a=(O)=>({type:'SELECT_ROW',rowIndex:O})},function(r,h,_){'use strict';var E=_(0),w=_.n(E),S=_(1),C=_.n(S),R=_(2);h.a=(N,O)=>(I)=>class extends C.a{constructor(M){super(M),this.state=O(M),this.checkProps='function'==typeof N?N:_.i(R.c)(...N)}componentWillReceiveProps(M){this.checkProps(this.props,M)&&this.setState(O(M))}render(M,A){return w()(I,Object.assign({},M,A))}}},function(r,h,_){'use strict';var E=_(21);_.d(h,'b',function(){return E.a});var w=_(11),S=_(12),C=_(39);_.d(h,'c',function(){return C.a});var R=_(2);_.d(h,'d',function(){return R.a});var N=_(3);_.d(h,'a',function(){return N.a})},function(r,h,_){(function(E){function w(C,R){var N=C[1]||'',O=C[3];if(!O)return N;if(R){var I=S(O),M=O.sources.map(function(A){return'/*# sourceURL='+O.sourceRoot+A+' */'});return[N].concat(M).concat([I]).join('\n')}return[N].join('\n')}function S(C){var R=new E(JSON.stringify(C)).toString('base64');return'/*# '+('sourceMappingURL=data:application/json;charset=utf-8;base64,'+R)+' */'}r.exports=function(C){var R=[];return R.toString=function(){return this.map(function(O){var I=w(O,C);return O[2]?'@media '+O[2]+'{'+I+'}':I}).join('')},R.i=function(N,O){'string'==typeof N&&(N=[[null,N,'']]);for(var I={},M=0,A;M<this.length;M++)A=this[M][0],'number'==typeof A&&(I[A]=!0);for(M=0;M<N.length;M++){var P=N[M];'number'==typeof P[0]&&I[P[0]]||(O&&!P[2]?P[2]=O:O&&(P[2]='('+P[2]+') and ('+O+')'),R.push(P))}},R}}).call(h,_(49).Buffer)},function(r){function _(Y,z){for(var V=0;V<Y.length;V++){var K=Y[V],G=A[K.id];if(G){G.refs++;for(var $=0;$<G.parts.length;$++)G.parts[$](K.parts[$]);for(;$<K.parts.length;$++)G.parts.push(N(K.parts[$],z))}else{for(var F=[],$=0;$<K.parts.length;$++)F.push(N(K.parts[$],z));A[K.id]={id:K.id,refs:1,parts:F}}}}function E(Y){for(var z=[],V={},K=0;K<Y.length;K++){var G=Y[K],$=G[0],F=G[1],X=G[2],q=G[3],J={css:F,media:X,sourceMap:q};V[$]?V[$].parts.push(J):z.push(V[$]={id:$,parts:[J]})}return z}function w(Y,z){var V=U(),K=W[W.length-1];if('top'===Y.insertAt)K?K.nextSibling?V.insertBefore(z,K.nextSibling):V.appendChild(z):V.insertBefore(z,V.firstChild),W.push(z);else if('bottom'===Y.insertAt)V.appendChild(z);else throw new Error('Invalid value for parameter \'insertAt\'. Must be \'top\' or \'bottom\'.')}function S(Y){Y.parentNode.removeChild(Y);var z=W.indexOf(Y);0<=z&&W.splice(z,1)}function C(Y){var z=document.createElement('style');return z.type='text/css',w(Y,z),z}function R(Y){var z=document.createElement('link');return z.rel='stylesheet',w(Y,z),z}function N(Y,z){var V,K,G;if(z.singleton){var $=B++;V=D||(D=C(z)),K=O.bind(null,V,$,!1),G=O.bind(null,V,$,!0)}else Y.sourceMap&&'function'==typeof URL&&'function'==typeof URL.createObjectURL&&'function'==typeof URL.revokeObjectURL&&'function'==typeof Blob&&'function'==typeof btoa?(V=R(z),K=M.bind(null,V),G=function(){S(V),V.href&&URL.revokeObjectURL(V.href)}):(V=C(z),K=I.bind(null,V),G=function(){S(V)});return K(Y),function(X){if(X){if(X.css===Y.css&&X.media===Y.media&&X.sourceMap===Y.sourceMap)return;K(Y=X)}else G()}}function O(Y,z,V,K){var G=V?'':K.css;if(Y.styleSheet)Y.styleSheet.cssText=H(z,G);else{var $=document.createTextNode(G),F=Y.childNodes;F[z]&&Y.removeChild(F[z]),F.length?Y.insertBefore($,F[z]):Y.appendChild($)}}function I(Y,z){var V=z.css,K=z.media;if(K&&Y.setAttribute('media',K),Y.styleSheet)Y.styleSheet.cssText=V;else{for(;Y.firstChild;)Y.removeChild(Y.firstChild);Y.appendChild(document.createTextNode(V))}}function M(Y,z){var V=z.css,K=z.sourceMap;K&&(V+='\n/*# sourceMappingURL=data:application/json;base64,'+btoa(unescape(encodeURIComponent(JSON.stringify(K))))+' */');var G=new Blob([V],{type:'text/css'}),$=Y.href;Y.href=URL.createObjectURL(G),$&&URL.revokeObjectURL($)}var A={},P=function(Y){var z;return function(){return'undefined'==typeof z&&(z=Y.apply(this,arguments)),z}},T=P(function(){return /msie [6-9]\b/.test(self.navigator.userAgent.toLowerCase())}),U=P(function(){return document.head||document.getElementsByTagName('head')[0]}),D=null,B=0,W=[];r.exports=function(Y,z){if('undefined'!=typeof DEBUG&&DEBUG&&'object'!=typeof document)throw new Error('The style-loader cannot be used in a non-browser environment');z=z||{},'undefined'==typeof z.singleton&&(z.singleton=T()),'undefined'==typeof z.insertAt&&(z.insertAt='bottom');var V=E(Y);return _(V,z),function(G){for(var $=[],F=0;F<V.length;F++){var X=V[F],q=A[X.id];q.refs--,$.push(q)}if(G){var J=E(G);_(J,z)}for(var F=0,q;F<$.length;F++)if(q=$[F],0===q.refs){for(var Z=0;Z<q.parts.length;Z++)q.parts[Z]();delete A[q.id]}}};var H=function(){var Y=[];return function(z,V){return Y[z]=V,Y.filter(Boolean).join('\n')}}()},function(r,h,_){'use strict';var E=_(27),w=_(66),S=_.n(w),C=_(28),R=_(67),N=_.n(R),O=_(26),I=_(65),M=_.n(I);h.a=[{href:'minimal',title:'Minimal',component:E.a,code:S.a},{href:'pinned-columns',title:'Pinned columns',component:C.a,code:N.a},{href:'complex',title:'Complex demo',component:O.a,code:M.a}]},function(r,h,_){'use strict';var E=_(0),w=_.n(E),S=_(3),C=_(5);const R='1px solid #d4d4d4',N='1px solid #000',O=(A,P,T,U)=>({position:'relative',height:'inherit',boxSizing:'border-box',padding:'0 8px',borderTop:R,borderBottom:R,borderLeft:U&&R||(A.moving&&A.moving.right===P.name?N:R)||'',borderRight:U&&R||T&&(A.moving&&A.moving.left===P.name?N:R)||'',background:'linear-gradient(to top, #eeeeee, #ffffff)',opacity:U?.8:1}),I=()=>({width:'100%',boxSizing:'border-box',padding:'0 8px',border:0,borderBottom:R,marginBottom:8}),M=({direction:A})=>w()('div',{style:{['asc'===A?'borderBottom':'borderTop']:'4px solid',borderLeft:'4px solid transparent',borderRight:'4px solid transparent'}});h.a=_.i(S.b)({onSortClink:(A)=>A.callback(_.i(C.b)(A.column.name)),onFilterInput:(A,P)=>A.callback(_.i(C.c)(A.column.name,P.target.value))})((A)=>w()('div',{style:O(A.state,A.column,A.last,A.ghost)},w()('div',{style:{display:'flex',alignItems:'center',height:30},onClick:A.onSortClink(A)},A.column.displayName||A.column.name,A.column.sort&&w()(M,{direction:A.column.sort})),A.column.enableFiltering&&w()('input',{style:I(),placeholder:A.column.placeholder,value:A.column.filter,onInput:A.onFilterInput(A)})))},function(r,h,_){'use strict';var E=_(0),w=_.n(E),S=_(3),C=_(5);const R='1px solid #d4d4d4',N=(M,A)=>({display:'flex',height:'inherit',cursor:'default',background:M.selectedIndex===A?'#c9dde1':0==A%2?'#fff':'#f3f3f3'}),O=(M,A)=>({flexShrink:0,display:'flex',alignItems:'center',width:M.width,padding:'0 8px',boxSizing:'border-box',borderLeft:R,borderRight:A?R:''}),I=_.i(S.b)({selectRow:(M)=>M.callback(_.i(C.a)(M.index))})((M)=>w()('div',{style:N(M.state,M.index),onClick:M.selectRow(M)},M.columns.map((A,P)=>w()('div',{style:O(A,P===M.columns.length-1)},w()('div',{style:{overflow:'hidden',whiteSpace:'nowrap',textOverflow:'ellipsis'}},M.datum[A.name])))));h.a=I},function(r,h,_){'use strict';var E=_(0),w=_.n(E);h.a=(S)=>(C)=>(R)=>w()(C,Object.assign({},R,S(R)))},function(r,h){'use strict';h.a=(E,w)=>{if(0>w||0===E.length)return[-1,w];let S=0;return E.reduce((C,{width:R},N)=>{const O=S;return S+=R,O<=w&&w<S?[N,w-O]:S===w?[N,R]:S<w?[N+1,w-S]:C},null)}},function(r,h){'use strict';h.__esModule=!0;var E=h.addLeadingSlash=function(I){return'/'===I.charAt(0)?I:'/'+I},w=h.stripLeadingSlash=function(I){return'/'===I.charAt(0)?I.substr(1):I},S=h.stripPrefix=function(I,M){return 0===I.indexOf(M)?I.substr(M.length):I},C=h.stripTrailingSlash=function(I){return'/'===I.charAt(I.length-1)?I.slice(0,-1):I},R=h.parsePath=function(I){var M=I||'/',A='',P='';M=decodeURI(M);var T=M.indexOf('#');-1!==T&&(P=M.substr(T),M=M.substr(0,T));var U=M.indexOf('?');return-1!==U&&(A=M.substr(U),M=M.substr(0,U)),{pathname:M,search:'?'===A?'':A,hash:'#'===P?'':P}},N=h.createPath=function(I){var M=I.pathname,A=I.search,P=I.hash,T=M||'/';return A&&'?'!==A&&(T+='?'===A.charAt(0)?A:'?'+A),P&&'#'!==P&&(T+='#'===P.charAt(0)?P:'#'+P),encodeURI(T)}},function(r){'use strict';!1,r.exports=function(){}},function(r,h,_){'use strict';var E=_(0),w=_.n(E),S=_(10),C=_(70),R=_.n(C);h.a=(N)=>w()('div',{className:'App__viewport'},w()('div',{className:'App__container'},w()('div',{className:'App__nav'},S.a.map((O)=>w()('a',{key:O.href,className:'App__link',href:`#${O.href}`},O.title))),w()('div',{className:'App__main'},N.children)))},function(r,h,_){'use strict';var E=_(0),w=_.n(E),S=_(25),C=_(71),R=_.n(C);h.a=(N)=>w()('div',{className:'Page__container'},w()('div',{className:'Page__header'},N.title),w()('div',{className:'Page__content'},w()('div',{className:'Page__demo'},w()(N.component,null)),w()('div',{className:'Page__code'},w()(S.a,{value:N.code}))))},function(r,h,_){'use strict';function E(Y){return Y&&Y.__esModule?Y:{default:Y}}h.__esModule=!0;var w=Object.assign||function(Y){for(var z=1,V;z<arguments.length;z++)for(var K in V=arguments[z],V)Object.prototype.hasOwnProperty.call(V,K)&&(Y[K]=V[K]);return Y},S=_(16),C=E(S),R=_(63),N=E(R),O=_(56),I=_(15),M=_(57),A=E(M),P=_(55),T='hashchange',U={hashbang:{encodePath:function(z){return'!'===z.charAt(0)?z:'!/'+(0,I.stripLeadingSlash)(z)},decodePath:function(z){return'!'===z.charAt(0)?z.substr(1):z}},noslash:{encodePath:I.stripLeadingSlash,decodePath:I.addLeadingSlash},slash:{encodePath:I.addLeadingSlash,decodePath:I.addLeadingSlash}},D=function(){var z=window.location.href,V=z.indexOf('#');return-1===V?'':z.substring(V+1)},B=function(z){return window.location.hash=z},W=function(z){var V=window.location.href.indexOf('#');window.location.replace(window.location.href.slice(0,0<=V?V:0)+'#'+z)};h.default=function(){var z=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};(0,N.default)(P.canUseDOM,'Hash history needs a DOM');var V=window.history,K=(0,P.supportsGoWithoutReloadUsingHash)(),G=z.getUserConfirmation,$=G===void 0?P.getConfirmation:G,F=z.hashType,X=F===void 0?'slash':F,q=z.basename?(0,I.stripTrailingSlash)((0,I.addLeadingSlash)(z.basename)):'',J=U[X],Z=J.encodePath,Q=J.decodePath,ee=function(){var Ce=Q(D());return q&&(Ce=(0,I.stripPrefix)(Ce,q)),(0,I.parsePath)(Ce)},te=(0,A.default)(),ne=function(Ce){w(Se,Ce),Se.length=V.length,te.notifyListeners(Se.location,Se.action)},oe=!1,ae=null,ie=function(){var Ce=D(),Re=Z(Ce);if(Ce!==Re)W(Re);else{var Ne=ee(),Oe=Se.location;if(!oe&&(0,O.locationsAreEqual)(Oe,Ne))return;if(ae===(0,I.createPath)(Ne))return;ae=null,se(Ne)}},se=function(Ce){if(oe)oe=!1,ne();else{var Re='POP';te.confirmTransitionTo(Ce,Re,$,function(Ne){Ne?ne({action:Re,location:Ce}):le(Ce)})}},le=function(Ce){var Re=Se.location,Ne=ce.lastIndexOf((0,I.createPath)(Re));-1===Ne&&(Ne=0);var Oe=ce.lastIndexOf((0,I.createPath)(Ce));-1===Oe&&(Oe=0);var Ie=Ne-Oe;Ie&&(oe=!0,ge(Ie))},de=D(),pe=Z(de);de!==pe&&W(pe);var ue=ee(),ce=[(0,I.createPath)(ue)],ge=function(Ce){(0,C.default)(K,'Hash history go(n) causes a full page reload in this browser'),V.go(Ce)},ve=0,_e=function(Ce){ve+=Ce,1===ve?(0,P.addEventListener)(window,T,ie):0===ve&&(0,P.removeEventListener)(window,T,ie)},xe=!1,Se={length:V.length,action:'POP',location:ue,createHref:function(Ce){return'#'+Z(q+(0,I.createPath)(Ce))},push:function(Ce,Re){(0,C.default)(Re===void 0,'Hash history cannot push state; it is ignored');var Ne='PUSH',Oe=(0,O.createLocation)(Ce,void 0,void 0,Se.location);te.confirmTransitionTo(Oe,Ne,$,function(Ie){if(Ie){var Me=(0,I.createPath)(Oe),Ae=Z(q+Me),Pe=D()!==Ae;if(Pe){ae=Me,B(Ae);var Te=ce.lastIndexOf((0,I.createPath)(Se.location)),Ue=ce.slice(0,-1===Te?0:Te+1);Ue.push(Me),ce=Ue,ne({action:Ne,location:Oe})}else(0,C.default)(!1,'Hash history cannot PUSH the same path; a new entry will not be added to the history stack'),ne()}})},replace:function(Ce,Re){(0,C.default)(Re===void 0,'Hash history cannot replace state; it is ignored');var Ne='REPLACE',Oe=(0,O.createLocation)(Ce,void 0,void 0,Se.location);te.confirmTransitionTo(Oe,Ne,$,function(Ie){if(Ie){var Me=(0,I.createPath)(Oe),Ae=Z(q+Me),Pe=D()!==Ae;Pe&&(ae=Me,W(Ae));var Te=ce.indexOf((0,I.createPath)(Se.location));-1!==Te&&(ce[Te]=Me),ne({action:Ne,location:Oe})}})},go:ge,goBack:function(){return ge(-1)},goForward:function(){return ge(1)},block:function(){var Ce=0<arguments.length&&void 0!==arguments[0]&&arguments[0],Re=te.setPrompt(Ce);return xe||(_e(1),xe=!0),function(){return xe&&(xe=!1,_e(-1)),Re()}},listen:function(Ce){var Re=te.appendListener(Ce);return _e(1),function(){_e(-1),Re()}}};return Se}},function(r,h,_){r.exports=_(61),r.exports.default=r.exports},function(r,h,_){'use strict';var E=_(0),w=_.n(E),S=_(1),C=_.n(S),R=_(22),N=_(24),O=_(23),I=_(3),M=_(2),A=_(5);h.a=_.i(M.b)(_.i(I.c)(),_.i(I.d)(),_.i(I.e)(['columns'],({columns:P})=>({tableWidth:P.reduce((T,U)=>T+U.width,0)})),_.i(I.e)(['columnState','callback','columnComponent'],({columnState:P,callback:T,columnComponent:U})=>({columnComponent:(D)=>w()(U,Object.assign({state:P,callback:T},D))})),_.i(I.e)(['rowState','columns','callback','rowComponent'],({rowState:P,columns:T,callback:U,rowComponent:D})=>({rowComponent:(B)=>w()(D,Object.assign({state:P,columns:T,callback:U},B))})))(class extends C.a{constructor(T){super(T),this.state={ghost:!1,ghostX:0},this.onResizing=this.onResizing.bind(this),this.onResize=this.onResize.bind(this),this.onMoving=this.onMoving.bind(this),this.onMove=this.onMove.bind(this)}onResizing(T,U){this.setState({ghost:!0,ghostX:U})}onResize(T,U){this.setState({ghost:!1}),this.props.callback(_.i(A.d)(T,U))}onMoving(T,U,D){(T!==this.movingName||U!==this.movingLeft||D!==this.movingRight)&&(this.movingName=T,this.movingLeft=U,this.movingRight=D,this.props.callback(_.i(A.e)(T,U,D)))}onMove(T,U,D){this.movingName=null,this.movingLeft=null,this.movingRight=null,this.props.callback(_.i(A.f)(T,U,D))}render(T,{ghost:U,ghostX:D}){return w()('div',{style:{position:'relative',width:T.tableWidth,flexShrink:0}},!!T.headerHeight&&w()('div',{style:{position:'sticky',zIndex:1,top:0,height:T.headerHeight}},w()(R.a,{columns:T.columns,component:T.columnComponent,onMove:this.onMove,onMoving:this.onMoving,onResize:this.onResize,onResizing:this.onResizing})),U&&w()(N.a,{x:D}),w()(O.a,{data:T.data,scrollTop:T.scrollTop-T.headerHeight,viewportHeight:T.viewportHeight-T.headerHeight,rowHeight:T.rowHeight,component:T.rowComponent}))}})},function(r,h,_){'use strict';var E=_(0),w=_.n(E),S=_(1),C=_.n(S),R=_(2),N=_(3);const O=3,I=({children:D})=>w()('div',{style:{display:'flex',position:'relative',height:'inherit'}},D),M=({last:D})=>w()('div',{style:{position:'absolute',zIndex:2,top:0,bottom:0,right:D?0:-O,width:D?O:2*O,cursor:'col-resize'}}),A=({column:D,index:B,last:W,component:H})=>w()('div',{style:{position:'relative',width:D.width,height:'inherit'}},w()(H,{column:D,index:B,last:W,ghost:!1}),D.enableResizing&&w()(M,{last:W})),P=({x:D,column:B,index:W,component:H})=>w()('div',{style:{position:'absolute',transform:`translateX(${D}px)`,width:B.width,height:'inherit'}},w()(H,{column:B,index:W,last:!1,ghost:!0})),T=({columns:D,x:B,dx:W,onResizing:H,onMoving:Y})=>{const[z,V]=_.i(R.f)(D,B-W),K=D[z];if(_Mathabs(V)<=O){if(0!==z){const G=D[z-1];G.enableResizing&&H(G.name,B)}}else if(_Mathabs(V-K.width)<=O)K.enableResizing&&H(K.name,B);else if(K.enableMoving){const[G,$]=_.i(R.g)(D,B-V);return Y(K.name,-1===G?null:D[G].name,-1===$?null:D[$].name),{moving:!0,movingPosition:B-V,movingColumn:K,movingIndex:z}}},U=({columns:D,x:B,dx:W,onResize:H,onMove:Y})=>{const[z,V]=_.i(R.f)(D,B-W),K=D[z];if(_Mathabs(V)<=O){if(0!==z){const G=D[z-1];G.enableResizing&&H(G.name,_.i(R.h)(G,G.width+V+W))}}else if(_Mathabs(V-K.width)<=O)K.enableResizing&&H(K.name,_.i(R.h)(K,V+W));else if(K.enableMoving){const[G,$]=_.i(R.g)(D,B-V);return Y(K.name,-1===G?null:D[G].name,-1===$?null:D[$].name),{moving:!1}}};h.a=_.i(N.h)({offset:O,style:{height:'inherit'}})(class extends C.a{componentWillReceiveProps(B){this.props.dragging&&this.props.x!==B.x&&this.setState(T(B)),B.dragging||this.props.dragging===B.dragging||this.setState(U(B))}render({columns:B,component:W},{moving:H,movingColumn:Y,movingIndex:z,movingPosition:V}){return w()(I,null,B.map((K,G)=>w()(A,{key:K.name,column:K,index:G,last:G===B.length-1,component:W})),H&&w()(P,{x:V,column:Y,index:z,component:W}))}})},function(r,h,_){'use strict';var E=_(0),w=_.n(E),S=_(3),C=_(2);const R=({height:O,renderedTop:I,children:M})=>w()('div',{style:{position:'relative',height:O}},w()('div',{style:{position:'absolute',left:0,right:0,top:I}},M)),N=_.i(C.b)(_.i(S.f)(_.i(C.c)('height','component','datum')))(({height:O,datum:I,index:M,component:A})=>w()('div',{style:{height:O}},w()(A,{datum:I,index:M})));h.a=_.i(C.b)(_.i(S.g)((O,I={})=>{const[M,A]=_.i(C.d)({scrollTop:O.scrollTop,viewportHeight:O.viewportHeight,rowHeight:O.rowHeight,rowsCount:O.data.length});return{start:M,end:A,keys:_.i(C.e)(I.keys,M,A)}}),_.i(S.f)(_.i(C.c)('start','end','data','rowHeight','component')))(({data:O,rowHeight:I,component:M,start:A,end:P,keys:T})=>w()(R,{height:O.length*I,renderedTop:A*I},O.slice(A,P+1).map((U,D)=>w()(N,{key:T[A+D],height:I,index:A+D,datum:U,component:M}))))},function(r,h,_){'use strict';var E=_(0),w=_.n(E);h.a=({x:S})=>w()('div',{style:{position:'absolute',zIndex:3,top:0,bottom:0,borderLeft:'1px dotted #000',pointerEvents:'none',transform:`translateX(${S}px)`}})},function(r,h,_){'use strict';var E=_(0),w=_.n(E),S=_(1),C=_.n(S),R=_(53),N=_.n(R),O=_(54),I=_.n(O),M=_(69),A=_.n(M);N.a.registerLanguage('javascript',I.a);class P extends C.a{constructor(T){super(T),this.html=N.a.highlightAuto(T.value).value}componentWillReceiveProps(T){this.props.value!==T.value&&(this.html=N.a.highlightAuto(T.value).value)}render(){return w()('pre',{style:{margin:'0 0 0 15px'}},w()('code',{'class':'hljs',dangerouslySetInnerHTML:{__html:this.html}}))}}h.a=P},function(r,h,_){'use strict';var E=_(0),w=_.n(E),S=_(1),C=_.n(S),R=_(7);const N=_.i(R.a)(R.b),O=Array(1e5).fill(0).map((M,A)=>({col11:`Pinned left ${A}`,col1:A,col2:`Title ${A}`,col21:`Pinned right ${A}`,col3:'Lorem Ipsum is simply dummy text of the printing and typesetting industry.'}));class I extends C.a{constructor(){super(),this.state={gridState:{columns:[{name:'col1',enableSorting:!0},{name:'col11',width:120,pinnedLeft:!0,enableResizing:!0},{name:'col2',minWidth:60,enableMoving:!0,enableFiltering:!0,placeholder:'Search',width:150,enableResizing:!0},{name:'col21',width:120,pinnedRight:!0,enableResizing:!0},{name:'col3',displayName:'Column 3',width:200,maxWidth:300,enableMoving:!0,enableResizing:!0},{name:'4',width:'50%'}],rowState:{selectedIndex:0}},data:O,originalData:O},this.callback=this.callback.bind(this)}callback(M){switch(console.log(M),M.type){case'FILTER_COLUMN':case'SORT_COLUMN':{const A=_.i(R.c)(this.state.gridState,M);this.setState({gridState:A,data:_.i(R.d)(A,this.state.originalData)});break}default:this.setState({gridState:_.i(R.c)(this.state.gridState,M)});}}render({},{gridState:M,data:A}){return w()(N,{viewportWidth:600,viewportHeight:360,headerHeight:60,columnComponent:void 0,rowComponent:void 0,state:M,data:A,callback:this.callback})}}h.a=I},function(r,h,_){'use strict';var E=_(0),w=_.n(E),S=_(1),C=_.n(S),R=_(7);const N=_.i(R.a)(R.b),O={columns:[{name:'col1',width:'20%'},{name:'col2',width:'35%'},{name:'col3',width:'45%'}]},I=Array(1e5).fill(0).map((A,P)=>({col1:P,col2:`Col2 ${P}`,col3:'Lorem Ipsum is simply dummy text of the printing and typesetting industry.'}));class M extends C.a{render(){return w()(N,{viewportWidth:720,viewportHeight:480,state:O,data:I})}}h.a=M},function(r,h,_){'use strict';var E=_(0),w=_.n(E),S=_(7);const C=_.i(S.a)(S.b),R={columns:[{name:'col1',width:'50%'},{name:'col11',width:120,pinnedLeft:!0},{name:'col2',width:'50%'},{name:'col21',width:120,pinnedRight:!0}]},N=Array(1e5).fill(0).map((O,I)=>({col11:`Pinned left ${I}`,col1:I,col2:`Title ${I}`,col21:`Pinned right ${I}`,col3:'Lorem Ipsum is simply dummy text of the printing and typesetting industry.'}));h.a=()=>w()(C,{viewportWidth:600,viewportHeight:360,state:R,data:N})},function(r,h,_){'use strict';var E=_(0),w=_.n(E),S=_(1),C=_.n(S);h.a=({offset:R=3,style:N={}}={})=>(O)=>class extends C.a{constructor(I){super(I),this.state={dragging:!1},this.onMouseDown=this.onMouseDown.bind(this)}onMouseDown(I){const M=I.currentTarget.getBoundingClientRect().left,A=I.clientX-M,P=(U)=>{U.preventDefault();const D=U.clientX-M,B=D-A;(this.state.dragging||_Mathabs(B)>R)&&this.setState({dragging:!0,dx:B,x:D})},T=(U)=>{document.removeEventListener('mousemove',P),document.removeEventListener('mouseup',T),(this.state.dragging||_Mathabs(U.clientX-M-A)>R)&&this.setState({dragging:!1})};document.addEventListener('mousemove',P),document.addEventListener('mouseup',T)}render(I,M){return w()('div',{onMouseDown:this.onMouseDown,style:N},w()(O,Object.assign({},I,M)))}}},function(r,h,_){'use strict';var E=_(0),w=_.n(E),S=_(1),C=_.n(S);h.a=(R)=>(N)=>class extends C.a{shouldComponentUpdate(O){return R(this.props,O)}render(O){return w()(N,O)}}},function(r,h,_){'use strict';var E=_(2),w=_(13),S=_(6),C=_(11),R=_(12);const N={},O=60,I=(M,A)=>{return'string'==typeof M&&'%'===M[M.length-1]?A*+M.slice(0,-1)/100:M};h.a=()=>_.i(E.b)(_.i(w.a)((M)=>({headerHeight:M.headerHeight||0,rowHeight:M.rowHeight||30,columns:M.state.columns,columnState:M.state.columnState||N,rowState:M.state.rowState||N})),_.i(w.a)((M)=>({columnComponent:M.columnComponent||C.a,rowComponent:M.rowComponent||R.a})),_.i(S.a)(_.i(E.c)('columns','viewportWidth'),(M)=>({columns:M.columns.map((A)=>Object.assign({},A,{width:I(A.width,M.viewportWidth)}))})),_.i(S.a)(_.i(E.c)('columns'),(M)=>({columns:M.columns.map((A)=>Object.assign({},A,{minWidth:A.minWidth||O,width:_Mathmax(A.width||0,A.minWidth||O)}))})))},function(r,h,_){'use strict';var E=_(0),w=_.n(E),S=_(1),C=_.n(S)},function(r,h,_){'use strict';var E=_(0),w=_.n(E),S=_(1),C=_.n(S);h.a=(R)=>(N)=>class extends C.a{constructor(O){super(O);const I=Object.keys(R),M={},A=I.reduce((P,T)=>{return P[T]=(...U)=>R[T](M[T],...U),P},{});this.handlers=I.reduce((P,T)=>{return P[T]=(U)=>{return M[T]=U,A[T]},P},{})}render(O){return w()(N,Object.assign({},O,this.handlers))}}},function(r,h,_){'use strict';var E=_(0),w=_.n(E),S=_(1),C=_.n(S);h.a=(R)=>(N)=>class extends C.a{constructor(O){super(O),this.state=R(O)}componentWillReceiveProps(O){this.setState(R(O,this.state))}render(O,I){return w()(N,Object.assign({},O,I))}}},function(r,h,_){'use strict';var E=_(0),w=_.n(E),S=_(2),C=_(6);h.a=()=>(R)=>_.i(S.b)(_.i(C.a)(_.i(S.c)('columns'),(N)=>({leftPinnedColumns:N.columns.filter((O)=>O.pinnedLeft),centerColumns:N.columns.filter((O)=>!O.pinnedLeft&&!O.pinnedRight),rightPinnedColumns:N.columns.filter((O)=>O.pinnedRight)})))((N)=>w()('div',{style:{display:'flex'}},0!==N.leftPinnedColumns.length&&w()('div',{style:{position:'sticky',zIndex:2,left:0}},w()(R,Object.assign({},N,{columns:N.leftPinnedColumns}))),w()(R,Object.assign({},N,{columns:N.centerColumns})),0!==N.rightPinnedColumns.length&&w()('div',{style:{position:'sticky',zIndex:2,right:0}},w()(R,Object.assign({},N,{columns:N.rightPinnedColumns})))))},function(r,h,_){'use strict';var E=_(0),w=_.n(E),S=_(1),C=_.n(S);h.a=(R)=>class extends C.a{constructor(N){super(N),this.state={scrollTop:0,scrollLeft:0,viewportWidth:N.viewportWidth,viewportHeight:N.viewportHeight},this.ref=(O)=>{this.element=O,O&&this.setState({viewportWidth:O.clientWidth,viewportHeight:O.clientHeight})},this.onScroll=(O)=>this.setState({scrollTop:O.target.scrollTop,scrollLeft:O.target.scrollLeft})}componentWillReceiveProps(N){(this.props.viewportWidth!==N.viewportWidth||this.props.viewportHeight!==N.viewportHeight)&&this.element&&this.setState({viewportWidth:this.element.clientWidth,viewportHeight:this.element.clientHeight})}render(N,O){return w()('div',{style:{width:N.viewportWidth,height:N.viewportHeight,overflow:'auto'},onScroll:this.onScroll,ref:this.ref},w()(R,Object.assign({},N,O)))}}},function(r,h){'use strict';h.a=(E={},w)=>{switch(w.type){case'MARK_MOVE_DEST':return Object.assign({},E,{moving:{name:w.name,left:w.left,right:w.right}});case'MOVE_COLUMN':return Object.assign({},E,{moving:null});case'RESIZE_COLUMN':return Object.assign({},E,{resizing:null});default:return E;}}},function(r,h){'use strict';h.a=(E=[],w)=>{switch(w.type){case'MOVE_COLUMN':if(w.left||w.right){const S=w.left?E.findIndex((C)=>C.name===w.left)+1:E.findIndex((C)=>C.name===w.right);return[...E.slice(0,S).filter((C)=>C.name!==w.name),...E.filter((C)=>C.name===w.name),...E.slice(S).filter((C)=>C.name!==w.name)]}return E;case'RESIZE_COLUMN':return E.map((S)=>{return S.name===w.name?Object.assign({},S,{width:w.size}):S});case'FILTER_COLUMN':return E.map((S)=>{return S.name===w.name?Object.assign({},S,{filter:w.filter}):S});case'SORT_COLUMN':return E.map((S)=>{return S.name===w.name?Object.assign({},S,{sort:!S.sort&&'asc'||'asc'===S.sort&&'desc'||'desc'===S.sort&&null}):S.sort?Object.assign({},S,{sort:null}):S});default:return E;}}},function(r,h,_){'use strict';var E=_(38),w=_(37),S=_(40);h.a=(C={},R)=>Object.assign({},C,{columns:_.i(E.a)(C.columns,R),columnState:_.i(w.a)(C.columnState,R),rowState:_.i(S.a)(C.rowState,R)})},function(r,h){'use strict';h.a=(E={},w)=>{switch(w.type){case'SELECT_ROW':return Object.assign({},E,{selectedIndex:w.rowIndex});default:return E;}}},function(r,h,_){'use strict';var E=_(14);h.a=(w,S)=>{if(2>w.length)return[-1,0];const[C,R]=_.i(E.a)(w,S);if(-1===C)return[-1,0];if(C===w.length)return[w.length-1,-1];const N=w[C].width;return R<N/2?[C-1,C]:C===w.length-1?[C,-1]:[C,C+1]}},function(r,h){'use strict';h.a=(...E)=>(w,S)=>E.some((C)=>w[C]!==S[C])},function(r,h){'use strict';h.a=function(...w){return 0===w.length?(S)=>S:1===w.length?w[0]:w.reduce((S,C)=>(...R)=>S(C(...R)))}},function(r,h){'use strict';const E=()=>Object.create(null),w=(N)=>Object.keys(N).reduce((O,I)=>(O[N[I]]=I,O),E()),S=(N)=>{let O=0;return()=>{for(;;){const I=`key_${O}`;if(O+=1,!(I in N))return I}}},C=(N,O,I)=>{const M=E();for(let A=O;A<I+1;A+=1)A in N&&(M[A]=N[A]);return M},R=(N,O,I)=>{const M=E(),A=S(w(N));for(let P=O;P<I+1;P+=1)P in N||(M[P]=A());return M};h.a=(N=E(),O,I)=>{const M=C(N,O,I),A=R(M,O,I);return Object.assign(E(),M,A)}},function(r,h){'use strict';h.a=({scrollTop:E,viewportHeight:w,rowHeight:S,rowsCount:C})=>{if(0>w)return[0,0];const R=Math.ceil(w/S),N=_Mathfloor(_Mathfloor(_Mathmax(0,E)/S)/R),O=_Mathmin(C,(N+2)*R),I=_Mathmax(0,O-2*R);return[I,O]}},function(r,h){'use strict';const E=(S,C)=>C.every((R)=>-1!==S[R.name].toLowerCase().indexOf(R.filter)),w=(S,C,R)=>{return S[R.name]===C[R.name]?0:'asc'===R.sort?S[R.name]<C[R.name]?-1:1:S[R.name]>C[R.name]?-1:1};h.a=(S,C)=>{const R=S.columns.filter((M)=>M.filter),N=S.columns.find((M)=>'asc'===M.sort||'desc'===M.sort),O=R.length?C.filter((M)=>E(M,R)):C,I=N?O.slice().sort((M,A)=>w(M,A,N)):O;return I}},function(r,h){'use strict';h.a=(E,w)=>_Mathmin(_Mathmax(E.minWidth||0,w),E.maxWidth||Infinity)},function(r,h){'use strict';function E(U){var D=U.length;if(0<D%4)throw new Error('Invalid string. Length must be a multiple of 4');return'='===U[D-2]?2:'='===U[D-1]?1:0}function C(U){return O[63&U>>18]+O[63&U>>12]+O[63&U>>6]+O[63&U]}function R(U,D,B){for(var H=[],Y=D,W;Y<B;Y+=3)W=(U[Y]<<16)+(U[Y+1]<<8)+U[Y+2],H.push(C(W));return H.join('')}h.byteLength=function(U){return 3*U.length/4-E(U)},h.toByteArray=function(U){var V=U.length,D,B,W,H,Y,z;Y=E(U),z=new M(3*V/4-Y),W=0<Y?V-4:V;var K=0;for(D=0,B=0;D<W;D+=4,B+=3)H=I[U.charCodeAt(D)]<<18|I[U.charCodeAt(D+1)]<<12|I[U.charCodeAt(D+2)]<<6|I[U.charCodeAt(D+3)],z[K++]=255&H>>16,z[K++]=255&H>>8,z[K++]=255&H;return 2===Y?(H=I[U.charCodeAt(D)]<<2|I[U.charCodeAt(D+1)]>>4,z[K++]=255&H):1===Y&&(H=I[U.charCodeAt(D)]<<10|I[U.charCodeAt(D+1)]<<4|I[U.charCodeAt(D+2)]>>2,z[K++]=255&H>>8,z[K++]=255&H),z},h.fromByteArray=function(U){for(var B=U.length,W=B%3,H='',Y=[],z=16383,V=0,K=B-W,D;V<K;V+=z)Y.push(R(U,V,V+z>K?K:V+z));return 1==W?(D=U[B-1],H+=O[D>>2],H+=O[63&D<<4],H+='=='):2==W&&(D=(U[B-2]<<8)+U[B-1],H+=O[D>>10],H+=O[63&D>>4],H+=O[63&D<<2],H+='='),Y.push(H),Y.join('')};for(var O=[],I=[],M='undefined'==typeof Uint8Array?Array:Uint8Array,A='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',P=0,T=A.length;P<T;++P)O[P]=A[P],I[A.charCodeAt(P)]=P;I['-'.charCodeAt(0)]=62,I['_'.charCodeAt(0)]=63},function(r,h,_){'use strict';(function(E){function S(){return R.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function C(Ce,Re){if(S()<Re)throw new RangeError('Invalid typed array length');return R.TYPED_ARRAY_SUPPORT?(Ce=new Uint8Array(Re),Ce.__proto__=R.prototype):(null===Ce&&(Ce=new R(Re)),Ce.length=Re),Ce}function R(Ce,Re,Ne){if(!R.TYPED_ARRAY_SUPPORT&&!(this instanceof R))return new R(Ce,Re,Ne);if('number'==typeof Ce){if('string'==typeof Re)throw new Error('If encoding is specified then the first argument must be a string');return M(this,Ce)}return N(this,Ce,Re,Ne)}function N(Ce,Re,Ne,Oe){if('number'==typeof Re)throw new TypeError('"value" argument must not be a number');return'undefined'!=typeof ArrayBuffer&&Re instanceof ArrayBuffer?T(Ce,Re,Ne,Oe):'string'==typeof Re?A(Ce,Re,Ne):U(Ce,Re)}function O(Ce){if('number'!=typeof Ce)throw new TypeError('"size" argument must be a number');else if(0>Ce)throw new RangeError('"size" argument must not be negative')}function I(Ce,Re,Ne,Oe){return O(Re),0>=Re?C(Ce,Re):void 0===Ne?C(Ce,Re):'string'==typeof Oe?C(Ce,Re).fill(Ne,Oe):C(Ce,Re).fill(Ne)}function M(Ce,Re){if(O(Re),Ce=C(Ce,0>Re?0:0|D(Re)),!R.TYPED_ARRAY_SUPPORT)for(var Ne=0;Ne<Re;++Ne)Ce[Ne]=0;return Ce}function A(Ce,Re,Ne){if(('string'!=typeof Ne||''===Ne)&&(Ne='utf8'),!R.isEncoding(Ne))throw new TypeError('"encoding" must be a valid string encoding');var Oe=0|W(Re,Ne);Ce=C(Ce,Oe);var Ie=Ce.write(Re,Ne);return Ie!==Oe&&(Ce=Ce.slice(0,Ie)),Ce}function P(Ce,Re){var Ne=0>Re.length?0:0|D(Re.length);Ce=C(Ce,Ne);for(var Oe=0;Oe<Ne;Oe+=1)Ce[Oe]=255&Re[Oe];return Ce}function T(Ce,Re,Ne,Oe){if(Re.byteLength,0>Ne||Re.byteLength<Ne)throw new RangeError('\'offset\' is out of bounds');if(Re.byteLength<Ne+(Oe||0))throw new RangeError('\'length\' is out of bounds');return Re=void 0===Ne&&void 0===Oe?new Uint8Array(Re):void 0===Oe?new Uint8Array(Re,Ne):new Uint8Array(Re,Ne,Oe),R.TYPED_ARRAY_SUPPORT?(Ce=Re,Ce.__proto__=R.prototype):Ce=P(Ce,Re),Ce}function U(Ce,Re){if(R.isBuffer(Re)){var Ne=0|D(Re.length);return(Ce=C(Ce,Ne),0===Ce.length)?Ce:(Re.copy(Ce,0,0,Ne),Ce)}if(Re){if('undefined'!=typeof ArrayBuffer&&Re.buffer instanceof ArrayBuffer||'length'in Re)return'number'!=typeof Re.length||_e(Re.length)?C(Ce,0):P(Ce,Re);if('Buffer'===Re.type&&we(Re.data))return P(Ce,Re.data)}throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')}function D(Ce){if(Ce>=S())throw new RangeError('Attempt to allocate Buffer larger than maximum size: 0x'+S().toString(16)+' bytes');return 0|Ce}function W(Ce,Re){if(R.isBuffer(Ce))return Ce.length;if('undefined'!=typeof ArrayBuffer&&'function'==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(Ce)||Ce instanceof ArrayBuffer))return Ce.byteLength;'string'!=typeof Ce&&(Ce=''+Ce);var Ne=Ce.length;if(0===Ne)return 0;for(var Oe=!1;;)switch(Re){case'ascii':case'latin1':case'binary':return Ne;case'utf8':case'utf-8':case void 0:return me(Ce).length;case'ucs2':case'ucs-2':case'utf16le':case'utf-16le':return 2*Ne;case'hex':return Ne>>>1;case'base64':return be(Ce).length;default:if(Oe)return me(Ce).length;Re=(''+Re).toLowerCase(),Oe=!0;}}function H(Ce,Re,Ne){var Oe=!1;if((void 0===Re||0>Re)&&(Re=0),Re>this.length)return'';if((void 0===Ne||Ne>this.length)&&(Ne=this.length),0>=Ne)return'';if(Ne>>>=0,Re>>>=0,Ne<=Re)return'';for(Ce||(Ce='utf8');;)switch(Ce){case'hex':return ne(this,Re,Ne);case'utf8':case'utf-8':return Z(this,Re,Ne);case'ascii':return ee(this,Re,Ne);case'latin1':case'binary':return te(this,Re,Ne);case'base64':return J(this,Re,Ne);case'ucs2':case'ucs-2':case'utf16le':case'utf-16le':return oe(this,Re,Ne);default:if(Oe)throw new TypeError('Unknown encoding: '+Ce);Ce=(Ce+'').toLowerCase(),Oe=!0;}}function Y(Ce,Re,Ne){var Oe=Ce[Re];Ce[Re]=Ce[Ne],Ce[Ne]=Oe}function z(Ce,Re,Ne,Oe,Ie){if(0===Ce.length)return-1;if('string'==typeof Ne?(Oe=Ne,Ne=0):2147483647<Ne?Ne=2147483647:-2147483648>Ne&&(Ne=-2147483648),Ne=+Ne,isNaN(Ne)&&(Ne=Ie?0:Ce.length-1),0>Ne&&(Ne=Ce.length+Ne),Ne>=Ce.length){if(Ie)return-1;Ne=Ce.length-1}else if(0>Ne)if(Ie)Ne=0;else return-1;if('string'==typeof Re&&(Re=R.from(Re,Oe)),R.isBuffer(Re))return 0===Re.length?-1:V(Ce,Re,Ne,Oe,Ie);if('number'==typeof Re)return Re&=255,R.TYPED_ARRAY_SUPPORT&&'function'==typeof Uint8Array.prototype.indexOf?Ie?Uint8Array.prototype.indexOf.call(Ce,Re,Ne):Uint8Array.prototype.lastIndexOf.call(Ce,Re,Ne):V(Ce,[Re],Ne,Oe,Ie);throw new TypeError('val must be string, number or Buffer')}function V(Ce,Re,Ne,Oe,Ie){function Me(je,We){return 1==Ae?je[We]:je.readUInt16BE(We*Ae)}var Ae=1,Pe=Ce.length,Te=Re.length;if(void 0!==Oe&&(Oe=(Oe+'').toLowerCase(),'ucs2'===Oe||'ucs-2'===Oe||'utf16le'===Oe||'utf-16le'===Oe)){if(2>Ce.length||2>Re.length)return-1;Ae=2,Pe/=2,Te/=2,Ne/=2}var Ue;if(Ie){var Le=-1;for(Ue=Ne;Ue<Pe;Ue++)if(Me(Ce,Ue)!==Me(Re,-1==Le?0:Ue-Le))-1!=Le&&(Ue-=Ue-Le),Le=-1;else if(-1==Le&&(Le=Ue),Ue-Le+1===Te)return Le*Ae}else for(Ne+Te>Pe&&(Ne=Pe-Te),Ue=Ne;0<=Ue;Ue--){for(var De=!0,Be=0;Be<Te;Be++)if(Me(Ce,Ue+Be)!==Me(Re,Be)){De=!1;break}if(De)return Ue}return-1}function K(Ce,Re,Ne,Oe){Ne=+Ne||0;var Ie=Ce.length-Ne;Oe?(Oe=+Oe,Oe>Ie&&(Oe=Ie)):Oe=Ie;var Me=Re.length;if(0!=Me%2)throw new TypeError('Invalid hex string');Oe>Me/2&&(Oe=Me/2);for(var Ae=0,Pe;Ae<Oe;++Ae){if(Pe=parseInt(Re.substr(2*Ae,2),16),isNaN(Pe))return Ae;Ce[Ne+Ae]=Pe}return Ae}function G(Ce,Re,Ne,Oe){return ve(me(Re,Ce.length-Ne),Ce,Ne,Oe)}function $(Ce,Re,Ne,Oe){return ve(ge(Re),Ce,Ne,Oe)}function F(Ce,Re,Ne,Oe){return $(Ce,Re,Ne,Oe)}function X(Ce,Re,Ne,Oe){return ve(be(Re),Ce,Ne,Oe)}function q(Ce,Re,Ne,Oe){return ve(ye(Re,Ce.length-Ne),Ce,Ne,Oe)}function J(Ce,Re,Ne){return 0===Re&&Ne===Ce.length?xe.fromByteArray(Ce):xe.fromByteArray(Ce.slice(Re,Ne))}function Z(Ce,Re,Ne){Ne=_Mathmin(Ce.length,Ne);for(var Oe=[],Ie=Re;Ie<Ne;){var Me=Ce[Ie],Ae=null,Pe=239<Me?4:223<Me?3:191<Me?2:1;if(Ie+Pe<=Ne){var Te,Ue,Le,De;1==Pe?128>Me&&(Ae=Me):2==Pe?(Te=Ce[Ie+1],128==(192&Te)&&(De=(31&Me)<<6|63&Te,127<De&&(Ae=De))):3==Pe?(Te=Ce[Ie+1],Ue=Ce[Ie+2],128==(192&Te)&&128==(192&Ue)&&(De=(15&Me)<<12|(63&Te)<<6|63&Ue,2047<De&&(55296>De||57343<De)&&(Ae=De))):4==Pe?(Te=Ce[Ie+1],Ue=Ce[Ie+2],Le=Ce[Ie+3],128==(192&Te)&&128==(192&Ue)&&128==(192&Le)&&(De=(15&Me)<<18|(63&Te)<<12|(63&Ue)<<6|63&Le,65535<De&&1114112>De&&(Ae=De))):void 0}null===Ae?(Ae=65533,Pe=1):65535<Ae&&(Ae-=65536,Oe.push(55296|1023&Ae>>>10),Ae=56320|1023&Ae),Oe.push(Ae),Ie+=Pe}return Q(Oe)}function Q(Ce){var Re=Ce.length;if(Re<=Se)return _StringfromCharCode.apply(String,Ce);for(var Ne='',Oe=0;Oe<Re;)Ne+=_StringfromCharCode.apply(String,Ce.slice(Oe,Oe+=Se));return Ne}function ee(Ce,Re,Ne){var Oe='';Ne=_Mathmin(Ce.length,Ne);for(var Ie=Re;Ie<Ne;++Ie)Oe+=_StringfromCharCode(127&Ce[Ie]);return Oe}function te(Ce,Re,Ne){var Oe='';Ne=_Mathmin(Ce.length,Ne);for(var Ie=Re;Ie<Ne;++Ie)Oe+=_StringfromCharCode(Ce[Ie]);return Oe}function ne(Ce,Re,Ne){var Oe=Ce.length;(!Re||0>Re)&&(Re=0),(!Ne||0>Ne||Ne>Oe)&&(Ne=Oe);for(var Ie='',Me=Re;Me<Ne;++Me)Ie+=he(Ce[Me]);return Ie}function oe(Ce,Re,Ne){for(var Oe=Ce.slice(Re,Ne),Ie='',Me=0;Me<Oe.length;Me+=2)Ie+=_StringfromCharCode(Oe[Me]+256*Oe[Me+1]);return Ie}function ae(Ce,Re,Ne){if(0!=Ce%1||0>Ce)throw new RangeError('offset is not uint');if(Ce+Re>Ne)throw new RangeError('Trying to access beyond buffer length')}function ie(Ce,Re,Ne,Oe,Ie,Me){if(!R.isBuffer(Ce))throw new TypeError('"buffer" argument must be a Buffer instance');if(Re>Ie||Re<Me)throw new RangeError('"value" argument is out of bounds');if(Ne+Oe>Ce.length)throw new RangeError('Index out of range')}function se(Ce,Re,Ne,Oe){0>Re&&(Re=65535+Re+1);for(var Ie=0,Me=_Mathmin(Ce.length-Ne,2);Ie<Me;++Ie)Ce[Ne+Ie]=(Re&255<<8*(Oe?Ie:1-Ie))>>>8*(Oe?Ie:1-Ie)}function le(Ce,Re,Ne,Oe){0>Re&&(Re=4294967295+Re+1);for(var Ie=0,Me=_Mathmin(Ce.length-Ne,4);Ie<Me;++Ie)Ce[Ne+Ie]=255&Re>>>8*(Oe?Ie:3-Ie)}function de(Ce,Re,Ne,Oe){if(Ne+Oe>Ce.length)throw new RangeError('Index out of range');if(0>Ne)throw new RangeError('Index out of range')}function pe(Ce,Re,Ne,Oe,Ie){return Ie||de(Ce,Re,Ne,4,3.4028234663852886e38,-3.4028234663852886e38),Ee.write(Ce,Re,Ne,Oe,23,4),Ne+4}function ue(Ce,Re,Ne,Oe,Ie){return Ie||de(Ce,Re,Ne,8,1.7976931348623157e308,-1.7976931348623157e308),Ee.write(Ce,Re,Ne,Oe,52,8),Ne+8}function ce(Ce){if(Ce=fe(Ce).replace(ke,''),2>Ce.length)return'';for(;0!=Ce.length%4;)Ce+='=';return Ce}function fe(Ce){return Ce.trim?Ce.trim():Ce.replace(/^\s+|\s+$/g,'')}function he(Ce){return 16>Ce?'0'+Ce.toString(16):Ce.toString(16)}function me(Ce,Re){Re=Re||Infinity;for(var Oe=Ce.length,Ie=null,Me=[],Ae=0,Ne;Ae<Oe;++Ae){if(Ne=Ce.charCodeAt(Ae),55295<Ne&&57344>Ne){if(!Ie){if(56319<Ne){-1<(Re-=3)&&Me.push(239,191,189);continue}else if(Ae+1===Oe){-1<(Re-=3)&&Me.push(239,191,189);continue}Ie=Ne;continue}if(56320>Ne){-1<(Re-=3)&&Me.push(239,191,189),Ie=Ne;continue}Ne=(Ie-55296<<10|Ne-56320)+65536}else Ie&&-1<(Re-=3)&&Me.push(239,191,189);if(Ie=null,128>Ne){if(0>(Re-=1))break;Me.push(Ne)}else if(2048>Ne){if(0>(Re-=2))break;Me.push(192|Ne>>6,128|63&Ne)}else if(65536>Ne){if(0>(Re-=3))break;Me.push(224|Ne>>12,128|63&Ne>>6,128|63&Ne)}else if(1114112>Ne){if(0>(Re-=4))break;Me.push(240|Ne>>18,128|63&Ne>>12,128|63&Ne>>6,128|63&Ne)}else throw new Error('Invalid code point')}return Me}function ge(Ce){for(var Re=[],Ne=0;Ne<Ce.length;++Ne)Re.push(255&Ce.charCodeAt(Ne));return Re}function ye(Ce,Re){for(var Me=[],Ae=0,Ne,Oe,Ie;Ae<Ce.length&&!(0>(Re-=2));++Ae)Ne=Ce.charCodeAt(Ae),Oe=Ne>>8,Ie=Ne%256,Me.push(Ie),Me.push(Oe);return Me}function be(Ce){return xe.toByteArray(ce(Ce))}function ve(Ce,Re,Ne,Oe){for(var Ie=0;Ie<Oe&&!(Ie+Ne>=Re.length||Ie>=Ce.length);++Ie)Re[Ie+Ne]=Ce[Ie];return Ie}function _e(Ce){return Ce!==Ce}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */var xe=_(48),Ee=_(58),we=_(64);h.Buffer=R,h.SlowBuffer=function(Ce){return+Ce!=Ce&&(Ce=0),R.alloc(+Ce)},h.INSPECT_MAX_BYTES=50,R.TYPED_ARRAY_SUPPORT=E.TYPED_ARRAY_SUPPORT===void 0?function(){try{var Ce=new Uint8Array(1);return Ce.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===Ce.foo()&&'function'==typeof Ce.subarray&&0===Ce.subarray(1,1).byteLength}catch(Re){return!1}}():E.TYPED_ARRAY_SUPPORT,h.kMaxLength=S(),R.poolSize=8192,R._augment=function(Ce){return Ce.__proto__=R.prototype,Ce},R.from=function(Ce,Re,Ne){return N(null,Ce,Re,Ne)},R.TYPED_ARRAY_SUPPORT&&(R.prototype.__proto__=Uint8Array.prototype,R.__proto__=Uint8Array,'undefined'!=typeof Symbol&&Symbol.species&&R[Symbol.species]===R&&Object.defineProperty(R,Symbol.species,{value:null,configurable:!0})),R.alloc=function(Ce,Re,Ne){return I(null,Ce,Re,Ne)},R.allocUnsafe=function(Ce){return M(null,Ce)},R.allocUnsafeSlow=function(Ce){return M(null,Ce)},R.isBuffer=function(Re){return!!(null!=Re&&Re._isBuffer)},R.compare=function(Re,Ne){if(!R.isBuffer(Re)||!R.isBuffer(Ne))throw new TypeError('Arguments must be Buffers');if(Re===Ne)return 0;for(var Oe=Re.length,Ie=Ne.length,Me=0,Ae=_Mathmin(Oe,Ie);Me<Ae;++Me)if(Re[Me]!==Ne[Me]){Oe=Re[Me],Ie=Ne[Me];break}return Oe<Ie?-1:Ie<Oe?1:0},R.isEncoding=function(Re){switch((Re+'').toLowerCase()){case'hex':case'utf8':case'utf-8':case'ascii':case'latin1':case'binary':case'base64':case'ucs2':case'ucs-2':case'utf16le':case'utf-16le':return!0;default:return!1;}},R.concat=function(Re,Ne){if(!we(Re))throw new TypeError('"list" argument must be an Array of Buffers');if(0===Re.length)return R.alloc(0);var Oe;if(Ne===void 0)for(Ne=0,Oe=0;Oe<Re.length;++Oe)Ne+=Re[Oe].length;var Ie=R.allocUnsafe(Ne),Me=0;for(Oe=0;Oe<Re.length;++Oe){var Ae=Re[Oe];if(!R.isBuffer(Ae))throw new TypeError('"list" argument must be an Array of Buffers');Ae.copy(Ie,Me),Me+=Ae.length}return Ie},R.byteLength=W,R.prototype._isBuffer=!0,R.prototype.swap16=function(){var Re=this.length;if(0!=Re%2)throw new RangeError('Buffer size must be a multiple of 16-bits');for(var Ne=0;Ne<Re;Ne+=2)Y(this,Ne,Ne+1);return this},R.prototype.swap32=function(){var Re=this.length;if(0!=Re%4)throw new RangeError('Buffer size must be a multiple of 32-bits');for(var Ne=0;Ne<Re;Ne+=4)Y(this,Ne,Ne+3),Y(this,Ne+1,Ne+2);return this},R.prototype.swap64=function(){var Re=this.length;if(0!=Re%8)throw new RangeError('Buffer size must be a multiple of 64-bits');for(var Ne=0;Ne<Re;Ne+=8)Y(this,Ne,Ne+7),Y(this,Ne+1,Ne+6),Y(this,Ne+2,Ne+5),Y(this,Ne+3,Ne+4);return this},R.prototype.toString=function(){var Re=0|this.length;return 0==Re?'':0===arguments.length?Z(this,0,Re):H.apply(this,arguments)},R.prototype.equals=function(Re){if(!R.isBuffer(Re))throw new TypeError('Argument must be a Buffer');return this===Re||0===R.compare(this,Re)},R.prototype.inspect=function(){var Re='',Ne=h.INSPECT_MAX_BYTES;return 0<this.length&&(Re=this.toString('hex',0,Ne).match(/.{2}/g).join(' '),this.length>Ne&&(Re+=' ... ')),'<Buffer '+Re+'>'},R.prototype.compare=function(Re,Ne,Oe,Ie,Me){if(!R.isBuffer(Re))throw new TypeError('Argument must be a Buffer');if(void 0===Ne&&(Ne=0),void 0===Oe&&(Oe=Re?Re.length:0),void 0===Ie&&(Ie=0),void 0===Me&&(Me=this.length),0>Ne||Oe>Re.length||0>Ie||Me>this.length)throw new RangeError('out of range index');if(Ie>=Me&&Ne>=Oe)return 0;if(Ie>=Me)return-1;if(Ne>=Oe)return 1;if(Ne>>>=0,Oe>>>=0,Ie>>>=0,Me>>>=0,this===Re)return 0;for(var Ae=Me-Ie,Pe=Oe-Ne,Te=_Mathmin(Ae,Pe),Ue=this.slice(Ie,Me),Le=Re.slice(Ne,Oe),De=0;De<Te;++De)if(Ue[De]!==Le[De]){Ae=Ue[De],Pe=Le[De];break}return Ae<Pe?-1:Pe<Ae?1:0},R.prototype.includes=function(Re,Ne,Oe){return-1!==this.indexOf(Re,Ne,Oe)},R.prototype.indexOf=function(Re,Ne,Oe){return z(this,Re,Ne,Oe,!0)},R.prototype.lastIndexOf=function(Re,Ne,Oe){return z(this,Re,Ne,Oe,!1)},R.prototype.write=function(Re,Ne,Oe,Ie){if(void 0===Ne)Ie='utf8',Oe=this.length,Ne=0;else if(void 0===Oe&&'string'==typeof Ne)Ie=Ne,Oe=this.length,Ne=0;else if(isFinite(Ne))Ne|=0,isFinite(Oe)?(Oe|=0,void 0===Ie&&(Ie='utf8')):(Ie=Oe,Oe=void 0);else throw new Error('Buffer.write(string, encoding, offset[, length]) is no longer supported');var Me=this.length-Ne;if((void 0===Oe||Oe>Me)&&(Oe=Me),0<Re.length&&(0>Oe||0>Ne)||Ne>this.length)throw new RangeError('Attempt to write outside buffer bounds');Ie||(Ie='utf8');for(var Ae=!1;;)switch(Ie){case'hex':return K(this,Re,Ne,Oe);case'utf8':case'utf-8':return G(this,Re,Ne,Oe);case'ascii':return $(this,Re,Ne,Oe);case'latin1':case'binary':return F(this,Re,Ne,Oe);case'base64':return X(this,Re,Ne,Oe);case'ucs2':case'ucs-2':case'utf16le':case'utf-16le':return q(this,Re,Ne,Oe);default:if(Ae)throw new TypeError('Unknown encoding: '+Ie);Ie=(''+Ie).toLowerCase(),Ae=!0;}},R.prototype.toJSON=function(){return{type:'Buffer',data:Array.prototype.slice.call(this._arr||this,0)}};var Se=4096;R.prototype.slice=function(Re,Ne){var Oe=this.length;Re=~~Re,Ne=Ne===void 0?Oe:~~Ne,0>Re?(Re+=Oe,0>Re&&(Re=0)):Re>Oe&&(Re=Oe),0>Ne?(Ne+=Oe,0>Ne&&(Ne=0)):Ne>Oe&&(Ne=Oe),Ne<Re&&(Ne=Re);var Ie;if(R.TYPED_ARRAY_SUPPORT)Ie=this.subarray(Re,Ne),Ie.__proto__=R.prototype;else{var Me=Ne-Re;Ie=new R(Me,void 0);for(var Ae=0;Ae<Me;++Ae)Ie[Ae]=this[Ae+Re]}return Ie},R.prototype.readUIntLE=function(Re,Ne,Oe){Re|=0,Ne|=0,Oe||ae(Re,Ne,this.length);for(var Ie=this[Re],Me=1,Ae=0;++Ae<Ne&&(Me*=256);)Ie+=this[Re+Ae]*Me;return Ie},R.prototype.readUIntBE=function(Re,Ne,Oe){Re|=0,Ne|=0,Oe||ae(Re,Ne,this.length);for(var Ie=this[Re+--Ne],Me=1;0<Ne&&(Me*=256);)Ie+=this[Re+--Ne]*Me;return Ie},R.prototype.readUInt8=function(Re,Ne){return Ne||ae(Re,1,this.length),this[Re]},R.prototype.readUInt16LE=function(Re,Ne){return Ne||ae(Re,2,this.length),this[Re]|this[Re+1]<<8},R.prototype.readUInt16BE=function(Re,Ne){return Ne||ae(Re,2,this.length),this[Re]<<8|this[Re+1]},R.prototype.readUInt32LE=function(Re,Ne){return Ne||ae(Re,4,this.length),(this[Re]|this[Re+1]<<8|this[Re+2]<<16)+16777216*this[Re+3]},R.prototype.readUInt32BE=function(Re,Ne){return Ne||ae(Re,4,this.length),16777216*this[Re]+(this[Re+1]<<16|this[Re+2]<<8|this[Re+3])},R.prototype.readIntLE=function(Re,Ne,Oe){Re|=0,Ne|=0,Oe||ae(Re,Ne,this.length);for(var Ie=this[Re],Me=1,Ae=0;++Ae<Ne&&(Me*=256);)Ie+=this[Re+Ae]*Me;return Me*=128,Ie>=Me&&(Ie-=_Mathpow(2,8*Ne)),Ie},R.prototype.readIntBE=function(Re,Ne,Oe){Re|=0,Ne|=0,Oe||ae(Re,Ne,this.length);for(var Ie=Ne,Me=1,Ae=this[Re+--Ie];0<Ie&&(Me*=256);)Ae+=this[Re+--Ie]*Me;return Me*=128,Ae>=Me&&(Ae-=_Mathpow(2,8*Ne)),Ae},R.prototype.readInt8=function(Re,Ne){return Ne||ae(Re,1,this.length),128&this[Re]?-1*(255-this[Re]+1):this[Re]},R.prototype.readInt16LE=function(Re,Ne){Ne||ae(Re,2,this.length);var Oe=this[Re]|this[Re+1]<<8;return 32768&Oe?4294901760|Oe:Oe},R.prototype.readInt16BE=function(Re,Ne){Ne||ae(Re,2,this.length);var Oe=this[Re+1]|this[Re]<<8;return 32768&Oe?4294901760|Oe:Oe},R.prototype.readInt32LE=function(Re,Ne){return Ne||ae(Re,4,this.length),this[Re]|this[Re+1]<<8|this[Re+2]<<16|this[Re+3]<<24},R.prototype.readInt32BE=function(Re,Ne){return Ne||ae(Re,4,this.length),this[Re]<<24|this[Re+1]<<16|this[Re+2]<<8|this[Re+3]},R.prototype.readFloatLE=function(Re,Ne){return Ne||ae(Re,4,this.length),Ee.read(this,Re,!0,23,4)},R.prototype.readFloatBE=function(Re,Ne){return Ne||ae(Re,4,this.length),Ee.read(this,Re,!1,23,4)},R.prototype.readDoubleLE=function(Re,Ne){return Ne||ae(Re,8,this.length),Ee.read(this,Re,!0,52,8)},R.prototype.readDoubleBE=function(Re,Ne){return Ne||ae(Re,8,this.length),Ee.read(this,Re,!1,52,8)},R.prototype.writeUIntLE=function(Re,Ne,Oe,Ie){if(Re=+Re,Ne|=0,Oe|=0,!Ie){var Me=_Mathpow(2,8*Oe)-1;ie(this,Re,Ne,Oe,Me,0)}var Ae=1,Pe=0;for(this[Ne]=255&Re;++Pe<Oe&&(Ae*=256);)this[Ne+Pe]=255&Re/Ae;return Ne+Oe},R.prototype.writeUIntBE=function(Re,Ne,Oe,Ie){if(Re=+Re,Ne|=0,Oe|=0,!Ie){var Me=_Mathpow(2,8*Oe)-1;ie(this,Re,Ne,Oe,Me,0)}var Ae=Oe-1,Pe=1;for(this[Ne+Ae]=255&Re;0<=--Ae&&(Pe*=256);)this[Ne+Ae]=255&Re/Pe;return Ne+Oe},R.prototype.writeUInt8=function(Re,Ne,Oe){return Re=+Re,Ne|=0,Oe||ie(this,Re,Ne,1,255,0),R.TYPED_ARRAY_SUPPORT||(Re=_Mathfloor(Re)),this[Ne]=255&Re,Ne+1},R.prototype.writeUInt16LE=function(Re,Ne,Oe){return Re=+Re,Ne|=0,Oe||ie(this,Re,Ne,2,65535,0),R.TYPED_ARRAY_SUPPORT?(this[Ne]=255&Re,this[Ne+1]=Re>>>8):se(this,Re,Ne,!0),Ne+2},R.prototype.writeUInt16BE=function(Re,Ne,Oe){return Re=+Re,Ne|=0,Oe||ie(this,Re,Ne,2,65535,0),R.TYPED_ARRAY_SUPPORT?(this[Ne]=Re>>>8,this[Ne+1]=255&Re):se(this,Re,Ne,!1),Ne+2},R.prototype.writeUInt32LE=function(Re,Ne,Oe){return Re=+Re,Ne|=0,Oe||ie(this,Re,Ne,4,4294967295,0),R.TYPED_ARRAY_SUPPORT?(this[Ne+3]=Re>>>24,this[Ne+2]=Re>>>16,this[Ne+1]=Re>>>8,this[Ne]=255&Re):le(this,Re,Ne,!0),Ne+4},R.prototype.writeUInt32BE=function(Re,Ne,Oe){return Re=+Re,Ne|=0,Oe||ie(this,Re,Ne,4,4294967295,0),R.TYPED_ARRAY_SUPPORT?(this[Ne]=Re>>>24,this[Ne+1]=Re>>>16,this[Ne+2]=Re>>>8,this[Ne+3]=255&Re):le(this,Re,Ne,!1),Ne+4},R.prototype.writeIntLE=function(Re,Ne,Oe,Ie){if(Re=+Re,Ne|=0,!Ie){var Me=_Mathpow(2,8*Oe-1);ie(this,Re,Ne,Oe,Me-1,-Me)}var Ae=0,Pe=1,Te=0;for(this[Ne]=255&Re;++Ae<Oe&&(Pe*=256);)0>Re&&0==Te&&0!==this[Ne+Ae-1]&&(Te=1),this[Ne+Ae]=255&(Re/Pe>>0)-Te;return Ne+Oe},R.prototype.writeIntBE=function(Re,Ne,Oe,Ie){if(Re=+Re,Ne|=0,!Ie){var Me=_Mathpow(2,8*Oe-1);ie(this,Re,Ne,Oe,Me-1,-Me)}var Ae=Oe-1,Pe=1,Te=0;for(this[Ne+Ae]=255&Re;0<=--Ae&&(Pe*=256);)0>Re&&0==Te&&0!==this[Ne+Ae+1]&&(Te=1),this[Ne+Ae]=255&(Re/Pe>>0)-Te;return Ne+Oe},R.prototype.writeInt8=function(Re,Ne,Oe){return Re=+Re,Ne|=0,Oe||ie(this,Re,Ne,1,127,-128),R.TYPED_ARRAY_SUPPORT||(Re=_Mathfloor(Re)),0>Re&&(Re=255+Re+1),this[Ne]=255&Re,Ne+1},R.prototype.writeInt16LE=function(Re,Ne,Oe){return Re=+Re,Ne|=0,Oe||ie(this,Re,Ne,2,32767,-32768),R.TYPED_ARRAY_SUPPORT?(this[Ne]=255&Re,this[Ne+1]=Re>>>8):se(this,Re,Ne,!0),Ne+2},R.prototype.writeInt16BE=function(Re,Ne,Oe){return Re=+Re,Ne|=0,Oe||ie(this,Re,Ne,2,32767,-32768),R.TYPED_ARRAY_SUPPORT?(this[Ne]=Re>>>8,this[Ne+1]=255&Re):se(this,Re,Ne,!1),Ne+2},R.prototype.writeInt32LE=function(Re,Ne,Oe){return Re=+Re,Ne|=0,Oe||ie(this,Re,Ne,4,2147483647,-2147483648),R.TYPED_ARRAY_SUPPORT?(this[Ne]=255&Re,this[Ne+1]=Re>>>8,this[Ne+2]=Re>>>16,this[Ne+3]=Re>>>24):le(this,Re,Ne,!0),Ne+4},R.prototype.writeInt32BE=function(Re,Ne,Oe){return Re=+Re,Ne|=0,Oe||ie(this,Re,Ne,4,2147483647,-2147483648),0>Re&&(Re=4294967295+Re+1),R.TYPED_ARRAY_SUPPORT?(this[Ne]=Re>>>24,this[Ne+1]=Re>>>16,this[Ne+2]=Re>>>8,this[Ne+3]=255&Re):le(this,Re,Ne,!1),Ne+4},R.prototype.writeFloatLE=function(Re,Ne,Oe){return pe(this,Re,Ne,!0,Oe)},R.prototype.writeFloatBE=function(Re,Ne,Oe){return pe(this,Re,Ne,!1,Oe)},R.prototype.writeDoubleLE=function(Re,Ne,Oe){return ue(this,Re,Ne,!0,Oe)},R.prototype.writeDoubleBE=function(Re,Ne,Oe){return ue(this,Re,Ne,!1,Oe)},R.prototype.copy=function(Re,Ne,Oe,Ie){if(Oe||(Oe=0),Ie||0===Ie||(Ie=this.length),Ne>=Re.length&&(Ne=Re.length),Ne||(Ne=0),0<Ie&&Ie<Oe&&(Ie=Oe),Ie===Oe)return 0;if(0===Re.length||0===this.length)return 0;if(0>Ne)throw new RangeError('targetStart out of bounds');if(0>Oe||Oe>=this.length)throw new RangeError('sourceStart out of bounds');if(0>Ie)throw new RangeError('sourceEnd out of bounds');Ie>this.length&&(Ie=this.length),Re.length-Ne<Ie-Oe&&(Ie=Re.length-Ne+Oe);var Me=Ie-Oe,Ae;if(this===Re&&Oe<Ne&&Ne<Ie)for(Ae=Me-1;0<=Ae;--Ae)Re[Ae+Ne]=this[Ae+Oe];else if(1e3>Me||!R.TYPED_ARRAY_SUPPORT)for(Ae=0;Ae<Me;++Ae)Re[Ae+Ne]=this[Ae+Oe];else Uint8Array.prototype.set.call(Re,this.subarray(Oe,Oe+Me),Ne);return Me},R.prototype.fill=function(Re,Ne,Oe,Ie){if('string'==typeof Re){if('string'==typeof Ne?(Ie=Ne,Ne=0,Oe=this.length):'string'==typeof Oe&&(Ie=Oe,Oe=this.length),1===Re.length){var Me=Re.charCodeAt(0);256>Me&&(Re=Me)}if(void 0!==Ie&&'string'!=typeof Ie)throw new TypeError('encoding must be a string');if('string'==typeof Ie&&!R.isEncoding(Ie))throw new TypeError('Unknown encoding: '+Ie)}else'number'==typeof Re&&(Re&=255);if(0>Ne||this.length<Ne||this.length<Oe)throw new RangeError('Out of range index');if(Oe<=Ne)return this;Ne>>>=0,Oe=Oe===void 0?this.length:Oe>>>0,Re||(Re=0);var Ae;if('number'==typeof Re)for(Ae=Ne;Ae<Oe;++Ae)this[Ae]=Re;else{var Pe=R.isBuffer(Re)?Re:me(new R(Re,Ie).toString()),Te=Pe.length;for(Ae=0;Ae<Oe-Ne;++Ae)this[Ae+Ne]=Pe[Ae%Te]}return this};var ke=/[^+\/0-9A-Za-z-_]/g}).call(h,_(73))},function(r,h,_){h=r.exports=_(8)(void 0),h.push([r.i,'.hljs{display:block;overflow-x:auto;padding:.5em;background:#272822;color:#ddd}.hljs-keyword,.hljs-literal,.hljs-name,.hljs-selector-tag,.hljs-strong,.hljs-tag{color:#f92672}.hljs-code{color:#66d9ef}.hljs-class .hljs-title{color:#fff}.hljs-attribute,.hljs-link,.hljs-regexp,.hljs-symbol{color:#bf79db}.hljs-addition,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-emphasis,.hljs-section,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-string,.hljs-subst,.hljs-template-tag,.hljs-template-variable,.hljs-title,.hljs-type,.hljs-variable{color:#a6e22e}.hljs-comment,.hljs-deletion,.hljs-meta,.hljs-quote{color:#75715e}.hljs-doctag,.hljs-keyword,.hljs-literal,.hljs-section,.hljs-selector-id,.hljs-selector-tag,.hljs-title,.hljs-type{font-weight:700}',''])},function(r,h,_){h=r.exports=_(8)(void 0),h.push([r.i,'.App__viewport{position:absolute;top:0;left:0;width:100vw;height:100vh;overflow:auto}.App__container{position:absolute;width:100%;min-height:100vh;display:flex;align-items:stretch;font-family:sans-serif}.App__nav{flex-shrink:0;box-sizing:border-box;width:300px;padding:15px;background:#eee}.App__link{display:block;padding:4px 0;color:#666}.App__link:hover{color:#000}.App__main{flex:1}',''])},function(r,h,_){h=r.exports=_(8)(void 0),h.push([r.i,'.Page__header{padding:15px;background:#ddd;font-size:2em}.Page__content{display:flex;padding:15px}',''])},function(r,h){(function(E){var w='object'==typeof window&&window||'object'==typeof self&&self;E(h)})(function(E){function w(oe){return oe.replace(/[&<>]/gm,function(ae){return ne[ae]})}function S(oe){return oe.nodeName.toLowerCase()}function C(oe,ae){var ie=oe&&oe.exec(ae);return ie&&0===ie.index}function R(oe){return J.test(oe)}function N(oe){var de=oe.className+' ',ae,ie,se,le;if(de+=oe.parentNode?oe.parentNode.className:'',ie=Z.exec(de),ie)return G(ie[1])?ie[1]:'no-highlight';for(de=de.split(/\s+/),ae=0,se=de.length;ae<se;ae++)if(le=de[ae],R(le)||G(le))return le}function O(oe){var ie={},se=Array.prototype.slice.call(arguments,1),ae;for(ae in oe)ie[ae]=oe[ae];return se.forEach(function(le){for(ae in le)ie[ae]=le[ae]}),ie}function I(oe){var ae=[];return function ie(se,le){for(var de=se.firstChild;de;de=de.nextSibling)3===de.nodeType?le+=de.nodeValue.length:1===de.nodeType&&(ae.push({event:'start',offset:le,node:de}),le=ie(de,le),S(de).match(/br|hr|img|input/)||ae.push({event:'stop',offset:le,node:de}));return le}(oe,0),ae}function M(oe,ae,ie){function se(){return oe.length&&ae.length?oe[0].offset===ae[0].offset?'start'===ae[0].event?oe:ae:oe[0].offset<ae[0].offset?oe:ae:oe.length?oe:ae}function le(me){ce+='<'+S(me)+$.map.call(me.attributes,function(ye){return' '+ye.nodeName+'="'+w(ye.value)+'"'}).join('')+'>'}function de(me){ce+='</'+S(me)+'>'}function pe(me){('start'===me.event?le:de)(me.node)}for(var ue=0,ce='',fe=[],he;oe.length||ae.length;)if(he=se(),ce+=w(ie.substring(ue,he[0].offset)),ue=he[0].offset,he===oe){fe.reverse().forEach(de);do pe(he.splice(0,1)[0]),he=se();while(he===oe&&he.length&&he[0].offset===ue);fe.reverse().forEach(le)}else'start'===he[0].event?fe.push(he[0].node):fe.pop(),pe(he.splice(0,1)[0]);return ce+w(ie.substr(ue))}function A(oe){return oe.variants&&!oe.cached_variants&&(oe.cached_variants=oe.variants.map(function(ae){return O(oe,{variants:null},ae)})),oe.cached_variants||oe.endsWithParent&&[O(oe)]||[oe]}function P(oe){function ae(le){return le&&le.source||le}function ie(le,de){return new RegExp(ae(le),'m'+(oe.case_insensitive?'i':'')+(de?'g':''))}function se(le,de){if(!le.compiled){if(le.compiled=!0,le.keywords=le.keywords||le.beginKeywords,le.keywords){var pe={},ue=function(fe,he){oe.case_insensitive&&(he=he.toLowerCase()),he.split(' ').forEach(function(me){var ge=me.split('|');pe[ge[0]]=[fe,ge[1]?+ge[1]:1]})};'string'==typeof le.keywords?ue('keyword',le.keywords):F(le.keywords).forEach(function(fe){ue(fe,le.keywords[fe])}),le.keywords=pe}le.lexemesRe=ie(le.lexemes||/\w+/,!0),de&&(le.beginKeywords&&(le.begin='\\b('+le.beginKeywords.split(' ').join('|')+')\\b'),!le.begin&&(le.begin=/\B|\b/),le.beginRe=ie(le.begin),!le.end&&!le.endsWithParent&&(le.end=/\B|\b/),le.end&&(le.endRe=ie(le.end)),le.terminator_end=ae(le.end)||'',le.endsWithParent&&de.terminator_end&&(le.terminator_end+=(le.end?'|':'')+de.terminator_end)),le.illegal&&(le.illegalRe=ie(le.illegal)),null==le.relevance&&(le.relevance=1),le.contains||(le.contains=[]),le.contains=Array.prototype.concat.apply([],le.contains.map(function(fe){return A('self'===fe?le:fe)})),le.contains.forEach(function(fe){se(fe,le)}),le.starts&&se(le.starts,de);var ce=le.contains.map(function(fe){return fe.beginKeywords?'\\.?('+fe.begin+')\\.?':fe.begin}).concat([le.terminator_end,le.illegal]).map(ae).filter(Boolean);le.terminators=ce.length?ie(ce.join('|'),!0):{exec:function(){return null}}}}se(oe)}function T(oe,ae,ie,se){function le(Ne,Oe){var Ie,Me;for(Ie=0,Me=Oe.contains.length;Ie<Me;Ie++)if(C(Oe.contains[Ie].beginRe,Ne))return Oe.contains[Ie]}function de(Ne,Oe){if(C(Ne.endRe,Oe)){for(;Ne.endsParent&&Ne.parent;)Ne=Ne.parent;return Ne}return Ne.endsWithParent?de(Ne.parent,Oe):void 0}function pe(Ne,Oe){return!ie&&C(Oe.illegalRe,Ne)}function ue(Ne,Oe){var Ie=be.case_insensitive?Oe[0].toLowerCase():Oe[0];return Ne.keywords.hasOwnProperty(Ie)&&Ne.keywords[Ie]}function ce(Ne,Oe,Ie,Me){var Ae=Me?'':te.classPrefix,Pe='<span class="'+Ae,Te=Ie?'':ee;return Pe+=Ne+'">',Pe+Oe+Te}function fe(){var Ne,Oe,Ie,Me;if(!ve.keywords)return w(we);for(Me='',Oe=0,ve.lexemesRe.lastIndex=0,Ie=ve.lexemesRe.exec(we);Ie;)Me+=w(we.substring(Oe,Ie.index)),Ne=ue(ve,Ie),Ne?(Se+=Ne[1],Me+=ce(Ne[0],w(Ie[0]))):Me+=w(Ie[0]),Oe=ve.lexemesRe.lastIndex,Ie=ve.lexemesRe.exec(we);return Me+w(we.substr(Oe))}function he(){var Ne='string'==typeof ve.subLanguage;if(Ne&&!X[ve.subLanguage])return w(we);var Oe=Ne?T(ve.subLanguage,we,!0,_e[ve.subLanguage]):U(we,ve.subLanguage.length?ve.subLanguage:void 0);return 0<ve.relevance&&(Se+=Oe.relevance),Ne&&(_e[ve.subLanguage]=Oe.top),ce(Oe.language,Oe.value,!1,!0)}function me(){xe+=null==ve.subLanguage?fe():he(),we=''}function ge(Ne){xe+=Ne.className?ce(Ne.className,'',!0):'',ve=Object.create(Ne,{parent:{value:ve}})}function ye(Ne,Oe){if(we+=Ne,null==Oe)return me(),0;var Ie=le(Oe,ve);if(Ie)return Ie.skip?we+=Oe:(Ie.excludeBegin&&(we+=Oe),me(),!Ie.returnBegin&&!Ie.excludeBegin&&(we=Oe)),ge(Ie,Oe),Ie.returnBegin?0:Oe.length;var Me=de(ve,Oe);if(Me){var Ae=ve;Ae.skip?we+=Oe:(!(Ae.returnEnd||Ae.excludeEnd)&&(we+=Oe),me(),Ae.excludeEnd&&(we=Oe));do ve.className&&(xe+=ee),ve.skip||(Se+=ve.relevance),ve=ve.parent;while(ve!==Me.parent);return Me.starts&&ge(Me.starts,''),Ae.returnEnd?0:Oe.length}if(pe(Oe,ve))throw new Error('Illegal lexeme "'+Oe+'" for mode "'+(ve.className||'<unnamed>')+'"');return we+=Oe,Oe.length||1}var be=G(oe);if(!be)throw new Error('Unknown language: "'+oe+'"');P(be);var ve=se||be,_e={},xe='',Ee;for(Ee=ve;Ee!==be;Ee=Ee.parent)Ee.className&&(xe=ce(Ee.className,'',!0)+xe);var we='',Se=0;try{for(var Re=0,ke,Ce;ve.terminators.lastIndex=Re,ke=ve.terminators.exec(ae),!!ke;)Ce=ye(ae.substring(Re,ke.index),ke[0]),Re=ke.index+Ce;for(ye(ae.substr(Re)),Ee=ve;Ee.parent;Ee=Ee.parent)Ee.className&&(xe+=ee);return{relevance:Se,value:xe,language:oe,top:ve}}catch(Ne){if(Ne.message&&-1!==Ne.message.indexOf('Illegal'))return{relevance:0,value:w(ae)};throw Ne}}function U(oe,ae){ae=ae||te.languages||F(X);var ie={relevance:0,value:w(oe)},se=ie;return ae.filter(G).forEach(function(le){var de=T(le,oe,!1);de.language=le,de.relevance>se.relevance&&(se=de),de.relevance>ie.relevance&&(se=ie,ie=de)}),se.language&&(ie.second_best=se),ie}function D(oe){return te.tabReplace||te.useBR?oe.replace(Q,function(ae,ie){return te.useBR&&'\n'===ae?'<br>':te.tabReplace?ie.replace(/\t/g,te.tabReplace):''}):oe}function B(oe,ae,ie){var se=ae?q[ae]:ie,le=[oe.trim()];return oe.match(/\bhljs\b/)||le.push('hljs'),-1===oe.indexOf(se)&&le.push(se),le.join(' ').trim()}function W(oe){var pe=N(oe),ae,ie,se,le,de;R(pe)||(te.useBR?(ae=document.createElementNS('http://www.w3.org/1999/xhtml','div'),ae.innerHTML=oe.innerHTML.replace(/\n/g,'').replace(/<br[ \/]*>/g,'\n')):ae=oe,de=ae.textContent,se=pe?T(pe,de,!0):U(de),ie=I(ae),ie.length&&(le=document.createElementNS('http://www.w3.org/1999/xhtml','div'),le.innerHTML=se.value,se.value=M(ie,I(le),de)),se.value=D(se.value),oe.innerHTML=se.value,oe.className=B(oe.className,pe,se.language),oe.result={language:se.language,re:se.relevance},se.second_best&&(oe.second_best={language:se.second_best.language,re:se.second_best.relevance}))}function Y(){if(!Y.called){Y.called=!0;var oe=document.querySelectorAll('pre code');$.forEach.call(oe,W)}}function G(oe){return oe=(oe||'').toLowerCase(),X[oe]||X[q[oe]]}var $=[],F=Object.keys,X={},q={},J=/^(no-?highlight|plain|text)$/i,Z=/\blang(?:uage)?-([\w-]+)\b/i,Q=/((^(<[^>]+>|\t|)+|(?:\n)))/gm,ee='</span>',te={classPrefix:'hljs-',tabReplace:null,useBR:!1,languages:void 0},ne={'&':'&amp;','<':'&lt;','>':'&gt;'};return E.highlight=T,E.highlightAuto=U,E.fixMarkup=D,E.highlightBlock=W,E.configure=function(oe){te=O(te,oe)},E.initHighlighting=Y,E.initHighlightingOnLoad=function(){addEventListener('DOMContentLoaded',Y,!1),addEventListener('load',Y,!1)},E.registerLanguage=function(oe,ae){var ie=X[oe]=ae(E);ie.aliases&&ie.aliases.forEach(function(se){q[se]=oe})},E.listLanguages=function(){return F(X)},E.getLanguage=G,E.inherit=O,E.IDENT_RE='[a-zA-Z]\\w*',E.UNDERSCORE_IDENT_RE='[a-zA-Z_]\\w*',E.NUMBER_RE='\\b\\d+(\\.\\d+)?',E.C_NUMBER_RE='(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)',E.BINARY_NUMBER_RE='\\b(0b[01]+)',E.RE_STARTERS_RE='!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~',E.BACKSLASH_ESCAPE={begin:'\\\\[\\s\\S]',relevance:0},E.APOS_STRING_MODE={className:'string',begin:'\'',end:'\'',illegal:'\\n',contains:[E.BACKSLASH_ESCAPE]},E.QUOTE_STRING_MODE={className:'string',begin:'"',end:'"',illegal:'\\n',contains:[E.BACKSLASH_ESCAPE]},E.PHRASAL_WORDS_MODE={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|like)\b/},E.COMMENT=function(oe,ae,ie){var se=E.inherit({className:'comment',begin:oe,end:ae,contains:[]},ie||{});return se.contains.push(E.PHRASAL_WORDS_MODE),se.contains.push({className:'doctag',begin:'(?:TODO|FIXME|NOTE|BUG|XXX):',relevance:0}),se},E.C_LINE_COMMENT_MODE=E.COMMENT('//','$'),E.C_BLOCK_COMMENT_MODE=E.COMMENT('/\\*','\\*/'),E.HASH_COMMENT_MODE=E.COMMENT('#','$'),E.NUMBER_MODE={className:'number',begin:E.NUMBER_RE,relevance:0},E.C_NUMBER_MODE={className:'number',begin:E.C_NUMBER_RE,relevance:0},E.BINARY_NUMBER_MODE={className:'number',begin:E.BINARY_NUMBER_RE,relevance:0},E.CSS_NUMBER_MODE={className:'number',begin:E.NUMBER_RE+'(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?',relevance:0},E.REGEXP_MODE={className:'regexp',begin:/\//,end:/\/[gimuy]*/,illegal:/\n/,contains:[E.BACKSLASH_ESCAPE,{begin:/\[/,end:/\]/,relevance:0,contains:[E.BACKSLASH_ESCAPE]}]},E.TITLE_MODE={className:'title',begin:E.IDENT_RE,relevance:0},E.UNDERSCORE_TITLE_MODE={className:'title',begin:E.UNDERSCORE_IDENT_RE,relevance:0},E.METHOD_GUARD={begin:'\\.\\s*'+E.UNDERSCORE_IDENT_RE,relevance:0},E})},function(r){r.exports=function(_){var E='[A-Za-z$_][0-9A-Za-z$_]*',w={keyword:'in of if for while finally var new function do return void else break catch instanceof with throw case default try this switch continue typeof delete let yield const export super debugger as async await static import from as',literal:'true false null undefined NaN Infinity',built_in:'eval isFinite isNaN parseFloat parseInt decodeURI decodeURIComponent encodeURI encodeURIComponent escape unescape Object Function Boolean Error EvalError InternalError RangeError ReferenceError StopIteration SyntaxError TypeError URIError Number Math Date String RegExp Array Float32Array Float64Array Int16Array Int32Array Int8Array Uint16Array Uint32Array Uint8Array Uint8ClampedArray ArrayBuffer DataView JSON Intl arguments require module console window document Symbol Set Map WeakSet WeakMap Proxy Reflect Promise'},C={className:'number',variants:[{begin:'\\b(0[bB][01]+)'},{begin:'\\b(0[oO][0-7]+)'},{begin:_.C_NUMBER_RE}],relevance:0},R={className:'subst',begin:'\\$\\{',end:'\\}',keywords:w,contains:[]},N={className:'string',begin:'`',end:'`',contains:[_.BACKSLASH_ESCAPE,R]};R.contains=[_.APOS_STRING_MODE,_.QUOTE_STRING_MODE,N,C,_.REGEXP_MODE];var O=R.contains.concat([_.C_BLOCK_COMMENT_MODE,_.C_LINE_COMMENT_MODE]);return{aliases:['js','jsx'],keywords:w,contains:[{className:'meta',relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},{className:'meta',begin:/^#!/,end:/$/},_.APOS_STRING_MODE,_.QUOTE_STRING_MODE,N,_.C_LINE_COMMENT_MODE,_.C_BLOCK_COMMENT_MODE,C,{begin:/[{,]\s*/,relevance:0,contains:[{begin:E+'\\s*:',returnBegin:!0,relevance:0,contains:[{className:'attr',begin:E,relevance:0}]}]},{begin:'('+_.RE_STARTERS_RE+'|\\b(case|return|throw)\\b)\\s*',keywords:'return throw case',contains:[_.C_LINE_COMMENT_MODE,_.C_BLOCK_COMMENT_MODE,_.REGEXP_MODE,{className:'function',begin:'(\\(.*?\\)|'+E+')\\s*=>',returnBegin:!0,end:'\\s*=>',contains:[{className:'params',variants:[{begin:E},{begin:/\(\s*\)/},{begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:w,contains:O}]}]},{begin:/</,end:/(\/\w+|\w+\/)>/,subLanguage:'xml',contains:[{begin:/<\w+\s*\/>/,skip:!0},{begin:/<\w+/,end:/(\/\w+|\w+\/)>/,skip:!0,contains:[{begin:/<\w+\s*\/>/,skip:!0},'self']}]}],relevance:0},{className:'function',beginKeywords:'function',end:/\{/,excludeEnd:!0,contains:[_.inherit(_.TITLE_MODE,{begin:E}),{className:'params',begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,contains:O}],illegal:/\[|%/},{begin:/\$[(.]/},_.METHOD_GUARD,{className:'class',beginKeywords:'class',end:/[{;=]/,excludeEnd:!0,illegal:/[:"\[\]]/,contains:[{beginKeywords:'extends'},_.UNDERSCORE_TITLE_MODE]},{beginKeywords:'constructor',end:/\{/,excludeEnd:!0}],illegal:/#(?!!)/}}},function(r,h){'use strict';h.__esModule=!0;var E=h.canUseDOM=!!('undefined'!=typeof window&&window.document&&window.document.createElement),w=h.addEventListener=function(A,P,T){return A.addEventListener?A.addEventListener(P,T,!1):A.attachEvent('on'+P,T)},S=h.removeEventListener=function(A,P,T){return A.removeEventListener?A.removeEventListener(P,T,!1):A.detachEvent('on'+P,T)},C=h.getConfirmation=function(A,P){return P(window.confirm(A))},R=h.supportsHistory=function(){var A=window.navigator.userAgent;return(-1!==A.indexOf('Android 2.')||-1!==A.indexOf('Android 4.0'))&&-1!==A.indexOf('Mobile Safari')&&-1===A.indexOf('Chrome')&&-1===A.indexOf('Windows Phone')?!1:window.history&&'pushState'in window.history},N=h.supportsPopStateOnHashChange=function(){return-1===window.navigator.userAgent.indexOf('Trident')},O=h.supportsGoWithoutReloadUsingHash=function(){return-1===window.navigator.userAgent.indexOf('Firefox')},I=h.isExtraneousPopstateEvent=function(A){return A.state===void 0&&-1===navigator.userAgent.indexOf('CriOS')}},function(r,h,_){'use strict';function E(A){return A&&A.__esModule?A:{default:A}}h.__esModule=!0,h.locationsAreEqual=h.createLocation=void 0;var w=Object.assign||function(A){for(var P=1,T;P<arguments.length;P++)for(var U in T=arguments[P],T)Object.prototype.hasOwnProperty.call(T,U)&&(A[U]=T[U]);return A},S=_(68),C=E(S),R=_(72),N=E(R),O=_(15),I=h.createLocation=function(P,T,U,D){var B;return'string'==typeof P?(B=(0,O.parsePath)(P),B.state=T):(B=w({},P),void 0===B.pathname&&(B.pathname=''),B.search?'?'!==B.search.charAt(0)&&(B.search='?'+B.search):B.search='',B.hash?'#'!==B.hash.charAt(0)&&(B.hash='#'+B.hash):B.hash='',void 0!==T&&void 0===B.state&&(B.state=T)),B.key=U,D&&(B.pathname?'/'!==B.pathname.charAt(0)&&(B.pathname=(0,C.default)(B.pathname,D.pathname)):B.pathname=D.pathname),B},M=h.locationsAreEqual=function(P,T){return P.pathname===T.pathname&&P.search===T.search&&P.hash===T.hash&&P.key===T.key&&(0,N.default)(P.state,T.state)}},function(r,h,_){'use strict';h.__esModule=!0;var w=_(16),S=function(R){return R&&R.__esModule?R:{default:R}}(w);h.default=function(){var N=null,M=[];return{setPrompt:function(U){return(0,S.default)(null==N,'A history supports only one prompt at a time'),N=U,function(){N===U&&(N=null)}},confirmTransitionTo:function(U,D,B,W){if(null!=N){var H='function'==typeof N?N(U,D):N;'string'==typeof H?'function'==typeof B?B(H,W):((0,S.default)(!1,'A history needs a getUserConfirmation function in order to use a prompt message'),W(!0)):W(!1!==H)}else W(!0)},appendListener:function(U){var D=!0,B=function(){D&&U.apply(void 0,arguments)};return M.push(B),function(){D=!1,M=M.filter(function(W){return W!==B})}},notifyListeners:function(){for(var U=arguments.length,D=Array(U),B=0;B<U;B++)D[B]=arguments[B];M.forEach(function(W){return W.apply(void 0,D)})}}}},function(r,h){h.read=function(_,E,w,S,C){var R,N,O=8*C-S-1,I=(1<<O)-1,M=I>>1,A=-7,P=w?C-1:0,T=w?-1:1,U=_[E+P];for(P+=T,R=U&(1<<-A)-1,U>>=-A,A+=O;0<A;R=256*R+_[E+P],P+=T,A-=8);for(N=R&(1<<-A)-1,R>>=-A,A+=S;0<A;N=256*N+_[E+P],P+=T,A-=8);if(0===R)R=1-M;else{if(R===I)return N?NaN:(U?-1:1)*Infinity;N+=_Mathpow(2,S),R-=M}return(U?-1:1)*N*_Mathpow(2,R-S)},h.write=function(_,E,w,S,C,R){var N,O,I,M=8*R-C-1,A=(1<<M)-1,P=A>>1,T=23===C?5.960464477539063e-8-6.617444900424222e-24:0,U=S?0:R-1,D=S?1:-1,B=0>E||0===E&&0>1/E?1:0;for(E=_Mathabs(E),isNaN(E)||E===Infinity?(O=isNaN(E)?1:0,N=A):(N=_Mathfloor(Math.log(E)/Math.LN2),1>E*(I=_Mathpow(2,-N))&&(N--,I*=2),E+=1<=N+P?T/I:T*_Mathpow(2,1-P),2<=E*I&&(N++,I/=2),N+P>=A?(O=0,N=A):1<=N+P?(O=(E*I-1)*_Mathpow(2,C),N+=P):(O=E*_Mathpow(2,P-1)*_Mathpow(2,C),N=0));8<=C;_[w+U]=255&O,U+=D,O/=256,C-=8);for(N=N<<C|O,M+=C;0<M;_[w+U]=255&N,U+=D,N/=256,M-=8);_[w+U-D]|=128*B}},function(r,h,_){(function(E,w){r.exports=w(_(4))})(this,function(E){'use strict';function w($){var F=typeof $;return'string'==F||'number'==F}function S($){return I($)||N($)}function C($){return N($)||!1===$||O($)||I($)}function R($){return'function'==typeof $}function N($){return null===$}function O($){return!0===$}function I($){return void 0===$}function M($){throw $||($=W),new Error('Inferno Error: '+$)}function A($,F){if(28&$.flags){var X=$.parentVNode;X&&(X.dom=F,A(X,F))}}function P(){return E.createVNode(4096)}function T($){return E.createVNode(1,null,null,$)}function U($,F,X){var q=K.get($);q||(q=[],K.set($,q),Promise.resolve().then(function(){K.delete($),B($,F,function(){for(var J=0;J<q.length;J++)q[J]()})})),X&&q.push(X)}function D($,F,X,q){for(var J in R(F)&&(F=F($.state,$.props,$.context)),F)$._pendingState[J]=F[J];!$._pendingSetState&&H?q||$._blockRender?($._pendingSetState=!0,B($,!1,X)):U($,!1,X):($.state=Object.assign({},$.state,$._pendingState),$._pendingState={})}function B($,F,X){if((!$._deferSetState||F)&&!$._blockRender&&!$._unmounted){$._pendingSetState=!1;var q=$._pendingState,J=$.state,Z=Object.assign({},J,q),Q=$.props,ee=$.context;$._pendingState={};var te=$._updateComponent(J,Z,Q,Q,ee,F,!0),ne=!0;C(te)?te=P():te===E.NO_OP?(te=$._lastInput,ne=!1):w(te)?te=T(te):Y(te)&&(!1,M());var oe=$._lastInput,ae=$._vNode,ie=oe.dom&&oe.dom.parentNode||(oe.dom=ae.dom);if($._lastInput=te,ne){var se=$._lifecycle;se?se.listeners=[]:se=new z,$._lifecycle=se;var le=$.getChildContext();le=S(le)?Object.assign({},ee,$._childContext):Object.assign({},ee,$._childContext,le),$._patch(oe,te,ie,se,le,$._isSVG,!1),se.trigger(),$.componentDidUpdate(Q,J),E.options.afterUpdate&&E.options.afterUpdate(ae)}var de=ae.dom=te.dom,pe=$._componentToDOMNodeMap;pe&&pe.set($,te.dom),A(ae,de),S(X)||X()}else S(X)||X()}var W='a runtime error occured! Use Inferno in development environment to find the error.',H='undefined'!=typeof window&&window.document,Y=Array.isArray,z=function(){this.listeners=[],this.fastUnmount=!0};z.prototype.addListener=function(F){this.listeners.push(F)},z.prototype.trigger=function(){for(var F=this,X=0;X<this.listeners.length;X++)F.listeners[X]()};var K=new Map,G=function(F,X){this.state={},this.refs={},this._blockRender=!1,this._ignoreSetState=!1,this._blockSetState=!1,this._deferSetState=!1,this._pendingSetState=!1,this._pendingState={},this._lastInput=null,this._vNode=null,this._unmounted=!0,this._lifecycle=null,this._childContext=null,this._patch=null,this._isSVG=!1,this._componentToDOMNodeMap=null,this.props=F||E.EMPTY_OBJ,this.context=X||{}};return G.prototype.render=function(){},G.prototype.forceUpdate=function(F){this._unmounted||H&&B(this,!0,F)},G.prototype.setState=function(F,X){this._unmounted||(this._blockSetState?(!1,M()):!this._ignoreSetState&&D(this,F,X,!1))},G.prototype.setStateSync=function(F){this._unmounted||(this._blockSetState?(!1,M()):!this._ignoreSetState&&D(this,F,null,!0))},G.prototype.componentWillMount=function(){},G.prototype.componentDidUpdate=function(){},G.prototype.shouldComponentUpdate=function(){return!0},G.prototype.componentWillReceiveProps=function(){},G.prototype.componentWillUpdate=function(){},G.prototype.getChildContext=function(){},G.prototype._updateComponent=function(F,X,q,J,Z,Q,ee){if(!0===this._unmounted&&(!1,M()),q!==J||J===E.EMPTY_OBJ||F!==X||Q){(q!==J||J===E.EMPTY_OBJ)&&(!ee&&(this._blockRender=!0,this.componentWillReceiveProps(J,Z),this._blockRender=!1),this._pendingSetState&&(X=Object.assign({},X,this._pendingState),this._pendingSetState=!1,this._pendingState={}));var te=this.shouldComponentUpdate(J,X,Z);if(!1!==te||Q){this._blockSetState=!0,this.componentWillUpdate(J,X,Z),this._blockSetState=!1,this.props=J;var ne=this.state=X;this.context=Z,E.options.beforeRender&&E.options.beforeRender(this);var oe=this.render(J,ne,Z);return E.options.afterRender&&E.options.afterRender(this),oe}}return E.NO_OP},G})},function(r,h,_){(function(E,w){r.exports=w(_(4))})(this,function(E){'use strict';function w(U){return!M(U.prototype)&&!M(U.prototype.render)}function S(U){return M(U)||O(U)}function C(U){return O(U)||!1===U||I(U)||M(U)}function R(U){return'o'===U[0]&&'n'===U[1]&&3<U.length}function N(U){return'string'==typeof U}function O(U){return null===U}function I(U){return!0===U}function M(U){return U===void 0}function A(U){return'object'==typeof U}var T={onComponentWillMount:!0,onComponentDidMount:!0,onComponentWillUnmount:!0,onComponentShouldUpdate:!0,onComponentWillUpdate:!0,onComponentDidUpdate:!0};return function(U,D){for(var B=[],W=arguments.length-2;0<W--;)B[W]=arguments[W+2];if(C(U)||A(U))throw new Error('Inferno Error: createElement() name parameter cannot be undefined, null, false or true, It must be a string, class or function.');var H=B,Y=null,z=null,V=null,K=0;if(1===B.length?H=B[0]:0===B.length&&(H=void 0),N(U)){switch(K=2,U){case'svg':K=128;break;case'input':K=512;break;case'textarea':K=1024;break;case'select':K=2048;break;default:}if(!S(D))for(var G=Object.keys(D),$=0,F;$<G.length;$++)F=G[$],'key'===F?(z=D.key,delete D.key):'children'===F&&M(H)?H=D.children:'ref'===F?Y=D.ref:R(F)&&(!V&&(V={}),V[F]=D[F],delete D[F])}else if(K=w(U)?4:8,M(H)||(!D&&(D={}),D.children=H,H=null),!S(D))for(var X=Object.keys(D),q=0,J;q<X.length;q++)J=X[q],T[J]?(!Y&&(Y={}),Y[J]=D[J]):'key'===J&&(z=D.key,delete D.key);return E.createVNode(K,U,D,H,V,z,Y)}})},function(r,h,_){(function(E,w){r.exports=w(_(4),_(1),_(0))})(this,function(E,w,S){'use strict';function C(Oe,Ie){var Me=Ie.router,Ae=Oe.activeClassName,Pe=Oe.activeStyle,Te=Oe.className,Ue=Oe.onClick,Le=Oe.to,De={href:Le};return Te&&(De.className=Te),Me.location.pathname===Le&&(Ae&&(De.className=(Te?Te+' ':'')+Ae),Pe&&(De.style=Object.assign({},Oe.style,Pe))),De.onclick=function(je){0!==je.button||je.ctrlKey||je.altKey||je.metaKey||je.shiftKey||(je.preventDefault(),'function'==typeof Ue&&Ue(je),Me.push(Le,je.target.textContent))},E.createVNode(2,'a',De,Oe.children)}function N(Oe){return ue(Oe)?Oe:Oe?[Oe]:Oe}function O(Oe){return'string'==typeof Oe}function I(Oe){return'string'==typeof Oe?decodeURIComponent(Oe):Oe}function M(Oe){return!Oe||!(ue(Oe)?Oe:Object.keys(Oe)).length}function A(Oe){var Ie=[];return z(Oe,Ie),Ie}function P(Oe){return O(Oe)?Oe:Oe.pathname+Oe.search}function T(Oe){if(''===Oe)return{};for(var Ie=Object.create(null),Me=Oe.split('&'),Ae=0;Ae<Me.length;Ae++){var Pe=Me[Ae],Te=Pe.split('=').map(W),Ue=Te[0],Le=Te[1];Ie[Ue]?(Ie[Ue]=ue(Ie[Ue])?Ie[Ue]:[Ie[Ue]],Ie[Ue].push(Le)):Ie[Ue]=Le}return Ie}function U(Oe,Ie){return 0===Oe.indexOf(Ie)?Oe.substr(Ie.length):Oe}function D(Oe,Ie){var Me={};for(var Ae in Oe)0>Ie.indexOf(Ae)&&(Me[Ae]=Oe[Ae]);return Me}function B(Oe,Ie){var Me=Oe.props||ce,Ae=Ie.props||ce,Pe=Y(Ae.path)-Y(Me.path);return Pe||(Ae.path&&Me.path?Ae.path.length-Me.path.length:0)}function W(Oe,Ie){return decodeURIComponent(0|Ie?Oe:Oe.replace('[]',''))}function H(Oe){return Oe.replace(/(^\/+|\/+$)/g,'')}function Y(Oe){return void 0===Oe&&(Oe=''),(H(Oe).match(/\/+/g)||'').length}function z(Oe,Ie){for(var Me=0,Ae;Me<Oe.length;Me++)Ae=Oe[Me],ue(Ae)?z(Ae,Ie):Ie.push(Ae)}function K(Oe,Ie){for(var Me=[],Ae=0,Pe=0,Te='',Ue=Ie&&Ie.delimiter||'/',Le;null!=(Le=we.exec(Oe));){var De=Le[0],Be=Le[1],je=Le.index;if(Te+=Oe.slice(Pe,je),Pe=je+De.length,Be){Te+=Be[1];continue}var We=Oe[Pe],He=Le[2],Ye=Le[3],ze=Le[4],Ve=Le[5],Ke=Le[6],Ge=Le[7];Te&&(Me.push(Te),Te='');var qe=Le[2]||Ue,Je=ze||Ve;Me.push({name:Ye||Ae++,prefix:He||'',delimiter:qe,optional:'?'===Ke||'*'===Ke,repeat:'+'===Ke||'*'===Ke,partial:null!=He&&null!=We&&We!==He,asterisk:!!Ge,pattern:Je?J(Je):Ge?'.*':'[^'+q(qe)+']+?'})}return Pe<Oe.length&&(Te+=Oe.substr(Pe)),Te&&Me.push(Te),Me}function $(Oe){return encodeURI(Oe).replace(/[\/?#]/g,function(Ie){return'%'+Ie.charCodeAt(0).toString(16).toUpperCase()})}function F(Oe){return encodeURI(Oe).replace(/[?#]/g,function(Ie){return'%'+Ie.charCodeAt(0).toString(16).toUpperCase()})}function X(Oe){for(var Ie=Array(Oe.length),Me=0;Me<Oe.length;Me++)'object'==typeof Oe[Me]&&(Ie[Me]=new RegExp('^(?:'+Oe[Me].pattern+')$'));return function(Ae,Pe){for(var Te='',Ue=Ae||{},Le=Pe||{},De=Le.pretty?$:encodeURIComponent,Be=0,je;Be<Oe.length;Be++){if(je=Oe[Be],'string'==typeof je){Te+=je;continue}var We=Ue[je.name],He;if(null==We)if(je.optional){je.partial&&(Te+=je.prefix);continue}else throw new TypeError('Expected "'+je.name+'" to be defined');if(ye(We)){if(!je.repeat)throw new TypeError('Expected "'+je.name+'" to not repeat, but received `'+JSON.stringify(We)+'`');if(0===We.length)if(je.optional)continue;else throw new TypeError('Expected "'+je.name+'" to not be empty');for(var Ye=0;Ye<We.length;Ye++){if(He=De(We[Ye]),!Ie[Be].test(He))throw new TypeError('Expected all "'+je.name+'" to match "'+je.pattern+'", but received `'+JSON.stringify(He)+'`');Te+=(0===Ye?je.prefix:je.delimiter)+He}continue}if(He=je.asterisk?F(We):De(We),!Ie[Be].test(He))throw new TypeError('Expected "'+je.name+'" to match "'+je.pattern+'", but received "'+He+'"');Te+=je.prefix+He}return Te}}function q(Oe){return Oe.replace(/([.+*?=^!:${}()[\]|\/\\])/g,'\\$1')}function J(Oe){return Oe.replace(/([=!:$\/()])/g,'\\$1')}function Z(Oe,Ie){return Oe.keys=Ie,Oe}function Q(Oe){return Oe.sensitive?'':'i'}function ee(Oe,Ie){var Me=Oe.source.match(/\((?!\?)/g);if(Me)for(var Ae=0;Ae<Me.length;Ae++)Ie.push({name:Ae,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return Z(Oe,Ie)}function te(Oe,Ie,Me){for(var Ae=[],Pe=0;Pe<Oe.length;Pe++)Ae.push(ae(Oe[Pe],Ie,Me).source);var Te=new RegExp('(?:'+Ae.join('|')+')',Q(Me));return Z(Te,Ie)}function ne(Oe,Ie,Me){return oe(K(Oe,Me),Ie,Me)}function oe(Oe,Ie,Me){ye(Ie)||(Me=Ie||Me,Ie=[]),Me=Me||{};for(var Ae=Me.strict,Pe=!1!==Me.end,Te='',Ue=0,Le;Ue<Oe.length;Ue++)if(Le=Oe[Ue],'string'==typeof Le)Te+=q(Le);else{var De=q(Le.prefix),Be='(?:'+Le.pattern+')';Ie.push(Le),Le.repeat&&(Be+='(?:'+De+Be+')*'),Be=Le.optional?Le.partial?De+'('+Be+')?':'(?:'+De+'('+Be+'))?':De+'('+Be+')',Te+=Be}var je=q(Me.delimiter||'/'),We=Te.slice(-je.length)===je;return Ae||(Te=(We?Te.slice(0,-je.length):Te)+'(?:'+je+'(?=$))?'),Te+=Pe?'$':Ae&&We?'':'(?='+je+'|$)',Z(new RegExp('^'+Te,Q(Me)),Ie)}function ae(Oe,Ie,Me){return ye(Ie)||(Me=Ie||Me,Ie=[]),Me=Me||{},Oe instanceof RegExp?ee(Oe,Ie):ye(Oe)?te(Oe,Ie,Me):ne(Oe,Ie,Me)}function ie(Oe,Ie){var Me=P(Ie),Ae=se(N(Oe),Me,'/');return Ae}function se(Oe,Ie,Me,Ae){void 0===Ie&&(Ie='/'),void 0===Me&&(Me='/'),void 0===Ae&&(Ae=!1);var Pe=ue(Oe)?A(Oe):N(Oe),Te=Ie.split('?'),Ue=Te[0];void 0===Ue&&(Ue='/');var Le=Te[1];void 0===Le&&(Le='');var De=T(Le);Pe.sort(B);for(var Be=0;Be<Pe.length;Be++){var je=Pe[Be],We=je.props.from||je.props.path||'/',He=Me+U(We,Me).replace(/\/\//g,'/'),Ye=!je.props||M(je.props.children),ze=le(Ye,He,Ue);if(ze){var Ve=je.props.children;if(je.props.from&&(Ae=je.props.to),Ve){var Ke=se(Ve,Ie,He,Ae);if(Ke){if(Ke.redirect)return{location:He,redirect:Ke.redirect};Ve=Ke.matched,Object.assign(De,Ve.props.params)}else Ve=null}var Ge=pe.cloneVNode(je,{params:Object.assign(De,ze.params),children:Ve});return{location:He,redirect:Ae,matched:Ge}}}}function le(Oe,Ie,Me){var Ae=Ie+'|'+Oe,Pe=ke.get(Ae);if(!Pe){var Te=[];Pe={pattern:Se(Ie,Te,{end:Oe}),keys:Te},ke.set(Ae,Pe)}var Ue=Pe.pattern.exec(Me);if(!Ue)return null;for(var Le=Ue[0],De=Object.create(null),Be=1;Be<Ue.length;Be+=1)De[Pe.keys[Be-1].name]=I(Ue[Be]);return{path:''===Le?'/':Le,params:De}}function de(Oe){if(!Oe)throw new TypeError('Inferno: Error "inferno-router" requires a history prop passed');return{push:Oe.push,replace:Oe.replace,listen:Oe.listen,isActive:function(Me){return le(!0,Me,this.url)},get location(){return'blank'===Oe.location.pathname?{pathname:'/',search:''}:Oe.location},get url(){return this.location.pathname+this.location.search}}}var pe='default'in E?E['default']:E;w='default'in w?w['default']:w,S='default'in S?S['default']:S;var ue=Array.isArray,ce=Object.create(null),fe=function(Oe){function Ie(Me,Ae){var Pe=this;Oe.call(this,Me,Ae),this._onComponentResolved=function(Te,Ue){Pe.setState({asyncComponent:Ue})},this.state={asyncComponent:null}}return Oe&&(Ie.__proto__=Oe),Ie.prototype=Object.create(Oe&&Oe.prototype),Ie.prototype.constructor=Ie,Ie.prototype.componentWillMount=function(){var Ae=this,Pe=this.props,Te=Pe.onEnter,Ue=this.context,Le=Ue.router;Te&&Promise.resolve().then(function(){Te({props:Ae.props,router:Le})});var De=this.props,Be=De.getComponent;Be&&Promise.resolve().then(function(){Be({props:Ae.props,router:Le},Ae._onComponentResolved)})},Ie.prototype.onLeave=function(Ae){void 0===Ae&&(Ae=!1);var Pe=this.props,Me=Pe.onLeave,Te=this.context,Ue=Te.router;Me&&Ae&&Me({props:this.props,router:Ue})},Ie.prototype.componentWillUnmount=function(){this.onLeave(!0)},Ie.prototype.componentWillReceiveProps=function(Ae){this.onLeave(this.props.path!==Ae.path)},Ie.prototype.render=function(Ae){var Pe=Ae.component,Te=Ae.children,Ue=D(Ae,['component','children','path']),Le=this.state,De=Le.asyncComponent,Be=Pe||De;return Be?S(Be,Ue,Te):null},Ie}(w),he=function(Oe){function Ie(Me,Ae){Oe.call(this,Me,Ae),Me.path='/'}return Oe&&(Ie.__proto__=Oe),Ie.prototype=Object.create(Oe&&Oe.prototype),Ie.prototype.constructor=Ie,Ie}(fe),me=function(Oe){function Ie(Me,Ae){Oe.call(this,Me,Ae),Me.to||(Me.to='/')}return Oe&&(Ie.__proto__=Oe),Ie.prototype=Object.create(Oe&&Oe.prototype),Ie.prototype.constructor=Ie,Ie}(fe),ge=Array.isArray||function(Oe){return'[object Array]'==Object.prototype.toString.call(Oe)},ye=ge,be=ae,we=new RegExp(['(\\\\.)','([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))'].join('|'),'g');be.parse=K,be.compile=function(Oe,Ie){return X(K(Oe,Ie))},be.tokensToFunction=X,be.tokensToRegExp=oe;var Se=function(Oe,Ie){return Ie={exports:{}},Oe(Ie,Ie.exports),Ie.exports}(function(Oe){var Ie=be;Oe.exports=Ie,Oe.exports.parse=Ie.parse,Oe.exports.compile=Ie.compile,Oe.exports.tokensToFunction=Ie.tokensToFunction,Oe.exports.tokensToRegExp=Ie.tokensToRegExp,Oe.exports['default']=Oe.exports}),ke=new Map,Ce=function(Oe){function Ie(Me,Ae){Oe.call(this,Me,Ae)}return Oe&&(Ie.__proto__=Oe),Ie.prototype=Object.create(Oe&&Oe.prototype),Ie.prototype.constructor=Ie,Ie.prototype.getChildContext=function(){return{router:this.props.router||{location:{pathname:this.props.location}}}},Ie.prototype.render=function(Ae){return Ae.matched},Ie}(w),Re=function(Oe){function Ie(Me,Ae){Oe.call(this,Me,Ae),this.router=de(Me.history),this.state={url:Me.url||this.router.url}}return Oe&&(Ie.__proto__=Oe),Ie.prototype=Object.create(Oe&&Oe.prototype),Ie.prototype.constructor=Ie,Ie.prototype.componentWillMount=function(){var Ae=this;this.router&&(this.unlisten=this.router.listen(function(){Ae.routeTo(Ae.router.url)}))},Ie.prototype.componentWillReceiveProps=function(Ae){this.setState({url:Ae.url})},Ie.prototype.componentWillUnmount=function(){this.unlisten&&this.unlisten()},Ie.prototype.routeTo=function(Ae){this.setState({url:Ae})},Ie.prototype.render=function(Ae){var Pe=this,Te=ie(Ae.children,this.state.url);return Te.redirect?(setTimeout(function(){Pe.router.replace(Te.redirect)},0),null):E.createVNode(4,Ce,{location:this.state.url,router:this.router,matched:Te.matched})},Ie}(w);return{Route:fe,IndexRoute:he,Redirect:me,IndexRedirect:me,Router:Re,RouterContext:Ce,Link:C,IndexLink:function(Oe){return Oe.to='/',E.createVNode(8,C,Oe)},match:ie}})},function(r,h){(function(E,w){w(h)})(this,function(E){'use strict';function w(vn){return!T(vn.prototype)&&!T(vn.prototype.render)}function S(vn){var _n=typeof vn;return'string'==_n||'number'==_n}function C(vn){return T(vn)||A(vn)}function R(vn){return A(vn)||!1===vn||P(vn)||T(vn)}function N(vn){return'function'==typeof vn}function O(vn){return'o'===vn[0]&&'n'===vn[1]&&3<vn.length}function I(vn){return'string'==typeof vn}function M(vn){return'number'==typeof vn}function A(vn){return null===vn}function P(vn){return!0===vn}function T(vn){return vn===void 0}function U(vn){return'object'==typeof vn}function D(vn){throw vn||(vn=Yt),new Error('Inferno Error: '+vn)}function W(vn,_n){return _n.key=vn,_n}function H(vn,_n){return M(vn)&&(vn='.'+vn),A(_n.key)||'.'===_n.key[0]?W(vn,_n):_n}function Y(vn,_n){return _n.key=vn+_n.key,_n}function z(vn,_n,xn,En){for(;xn<vn.length;xn++){var wn=vn[xn],Sn=En+'.'+xn;R(wn)||(Vt(wn)?z(wn,_n,0,Sn):(S(wn)?wn=Q(wn):(ee(wn)&&wn.dom||wn.key&&'.'===wn.key[0])&&(wn=J(wn)),wn=A(wn.key)||'.'===wn.key[0]?W(Sn,wn):Y(En,wn),_n.push(wn)))}}function V(vn){var _n;vn.$?vn=vn.slice():vn.$=!0;for(var xn=0,En;xn<vn.length;xn++){if(En=vn[xn],R(En)||Vt(En)){var wn=(_n||vn).slice(0,xn);return z(vn,wn,xn,''),wn}S(En)?(_n||(_n=vn.slice(0,xn)),_n.push(H(xn,Q(En)))):ee(En)&&En.dom||A(En.key)&&!(64&En.flags)?(_n||(_n=vn.slice(0,xn)),_n.push(H(xn,J(En)))):_n&&_n.push(H(xn,J(En)))}return _n||vn}function K(vn){if(Vt(vn))return V(vn);return ee(vn)&&vn.dom?J(vn):vn}function G(vn,_n,xn){28&vn.flags||!C(xn)||C(_n.children)||(vn.children=_n.children),_n.ref&&(vn.ref=_n.ref,delete _n.ref),_n.events&&(vn.events=_n.events),C(_n.key)||(vn.key=_n.key,delete _n.key)}function $(vn,_n){for(var xn in vn)T(_n[xn])&&(_n[xn]=vn[xn])}function F(vn,_n){_n.flags='svg'===vn?128:'input'===vn?512:'select'===vn?2048:'textarea'===vn?1024:'media'===vn?256:2}function X(vn){var _n=vn.props,xn=!A(_n),En=vn.type,wn=vn.children;I(En)&&28&vn.flags&&(F(En,vn),xn&&_n.children&&(vn.children=_n.children,wn=_n.children)),xn&&G(vn,_n,wn),R(wn)||(vn.children=K(wn)),xn&&!R(_n.children)&&(_n.children=K(_n.children))}function q(vn,_n,xn,En,wn,Sn,kn,Cn){16&vn&&(vn=w(_n)?4:8);var Rn={children:T(En)?null:En,dom:null,events:wn||null,flags:vn,key:T(Sn)?null:Sn,props:xn||null,ref:kn||null,type:_n};return Cn||X(Rn),Gt.createVNode&&Gt.createVNode(Rn),Rn}function J(vn,_n){for(var xn=[],En=arguments.length-2;0<En--;)xn[En]=arguments[En+2];var wn=xn;0<xn.length&&!A(xn[0])&&(!_n&&(_n={}),1===xn.length&&(wn=xn[0]),T(_n.children)?_n.children=wn:Vt(wn)?Vt(_n.children)?_n.children=_n.children.concat(wn):_n.children=[_n.children].concat(wn):Vt(_n.children)?_n.children.push(wn):(_n.children=[_n.children],_n.children.push(wn))),wn=null;var Sn;if(Vt(vn)){for(var kn=[],Cn=0;Cn<vn.length;Cn++)kn.push(J(vn[Cn]));Sn=kn}else{var Rn=vn.flags,Nn=vn.events||_n&&_n.events||null,On=C(vn.key)?_n?_n.key:null:vn.key,In=vn.ref||(_n?_n.ref:null);if(28&Rn){Sn=q(Rn,vn.type,Object.assign({},vn.props,_n),null,Nn,On,In,!0);var Mn=Sn.props;if(Mn){var An=Mn.children;if(An)if(Vt(An))for(var Pn=0,Tn;Pn<An.length;Pn++)Tn=An[Pn],!R(Tn)&&ee(Tn)&&(Mn.children[Pn]=J(Tn));else ee(An)&&(Mn.children=J(An))}Sn.children=null}else 3970&Rn?(wn=_n&&_n.children||vn.children,Sn=q(Rn,vn.type,Object.assign({},vn.props,_n),wn,Nn,On,In,!wn)):1&Rn&&(Sn=Q(vn.children))}return Sn}function Z(){return q(4096)}function Q(vn){return q(1,null,null,vn,null,null,null,!0)}function ee(vn){return!!vn.flags}function te(vn,_n,xn){vn.split(',').forEach(function(En){return _n[En]=xn})}function ne(vn,_n,xn){return _n+'-'+xn.toLowerCase()}function oe(vn,_n,xn,En){var wn=sn.get(vn);if(xn){if(!wn){wn={items:new Map,count:0,docEvent:null};var Sn=se(vn,wn);wn.docEvent=Sn,sn.set(vn,wn)}_n||(wn.count++,rn&&'onClick'===vn&&de(En)),wn.items.set(En,xn)}else wn&&wn.items.has(En)&&(wn.count--,wn.items.delete(En),0===wn.count&&(document.removeEventListener(ie(vn),wn.docEvent),sn.delete(vn)))}function ae(vn,_n,xn,En,wn){var Sn=xn.get(_n);if(!(Sn&&(En--,wn.dom=_n,Sn.event?Sn.event(Sn.data,vn):Sn(vn),wn.stopPropagation))&&0<En){var kn=_n.parentNode;(kn||kn===document.body)&&ae(vn,kn,xn,En,wn)}}function ie(vn){return vn.substr(2).toLowerCase()}function se(vn,_n){var xn=function(En){var wn={stopPropagation:!1,dom:document};Object.defineProperty(En,'currentTarget',{configurable:!0,get:function(){return wn.dom}}),En.stopPropagation=function(){wn.stopPropagation=!0};var Sn=_n.count;0<Sn&&ae(En,En.target,_n.items,Sn,wn)};return document.addEventListener(ie(vn),xn),xn}function le(){}function de(vn){vn.onclick=le}function pe(vn,_n,xn,En){var wn=vn.type,Sn=vn.key,kn=dn.get(wn);if(!T(kn)){var Cn=null===Sn?kn.nonKeyed:kn.keyed.get(Sn);if(!T(Cn)){var Rn=Cn.pop();if(!T(Rn))return ot(Rn,vn,null,_n,xn,En,!0),vn.dom}}return null}function ue(vn){var _n=vn.type,xn=vn.key,En=dn.get(_n);if(T(En)&&(En={nonKeyed:[],keyed:new Map},dn.set(_n,En)),A(xn))En.nonKeyed.push(vn);else{var wn=En.keyed.get(xn);T(wn)&&(wn=[],En.keyed.set(xn,wn)),wn.push(vn)}}function ce(vn,_n,xn,En){var wn=vn.type,Sn=vn.key,kn=ln.get(wn);if(!T(kn)){var Cn=null===Sn?kn.nonKeyed:kn.keyed.get(Sn);if(!T(Cn)){var Rn=Cn.pop();if(!T(Rn)){var Nn=vn.flags,On=it(Rn,vn,null,_n,xn,En,4&Nn,!0);if(!On)return vn.dom}}}return null}function fe(vn){var _n=vn.type,xn=vn.key,En=vn.ref,wn=En&&(En.onComponentWillMount||En.onComponentWillUnmount||En.onComponentDidMount||En.onComponentWillUpdate||En.onComponentDidUpdate);if(!wn){var Sn=ln.get(_n);if(T(Sn)&&(Sn={nonKeyed:[],keyed:new Map},ln.set(_n,Sn)),A(xn))Sn.nonKeyed.push(vn);else{var kn=Sn.keyed.get(xn);T(kn)&&(kn=[],Sn.keyed.set(xn,kn)),kn.push(vn)}}}function he(vn,_n,xn,En,wn){var Sn=vn.flags;28&Sn?ge(vn,_n,xn,En,wn):3970&Sn?ye(vn,_n,xn,En,wn):Sn&4097&&me(vn,_n)}function me(vn,_n){_n&&Me(_n,vn.dom)}function ge(vn,_n,xn,En,wn){var Sn=vn.children,kn=vn.flags,Cn=4&kn,Rn=vn.ref,Nn=vn.dom;if(!pn.has(vn)||wn||_n){if(pn.set(vn),!wn)if(!Cn)C(Rn)||C(Rn.onComponentWillUnmount)||Rn.onComponentWillUnmount(Nn),xn.fastUnmount||he(Sn,null,xn,!1,wn);else if(!Sn._unmounted){Sn._ignoreSetState=!0,Gt.beforeUnmount&&Gt.beforeUnmount(vn),Sn.componentWillUnmount&&Sn.componentWillUnmount(),Rn&&!wn&&Rn(null),Sn._unmounted=!0,Gt.findDOMNodeEnabled&&hn.delete(Sn);var On=Sn._lifecycle;On.fastUnmount||he(Sn._lastInput,null,On,!1,wn)}if(_n){var In=Sn._lastInput;C(In)&&(In=Sn),Me(_n,Nn)}Gt.recyclingEnabled&&!Cn&&(_n||En)&&fe(vn)}}function ye(vn,_n,xn,En,wn){var Sn=vn.dom,kn=vn.ref,Cn=vn.events;if(!pn.has(vn)||wn||_n){if(pn.set(vn),!xn.fastUnmount){kn&&!wn&&ve(kn);var Rn=vn.children;C(Rn)||be(Rn,xn,wn)}if(!A(Cn))for(var Nn in Cn)ht(Nn,Cn[Nn],null,Sn),Cn[Nn]=null;_n&&Me(_n,Sn),Gt.recyclingEnabled&&(_n||En)&&ue(vn)}}function be(vn,_n,xn){if(Vt(vn))for(var En=0,wn;En<vn.length;En++)wn=vn[En],!R(wn)&&U(wn)&&he(wn,null,_n,!1,xn);else U(vn)&&he(vn,null,_n,!1,xn)}function ve(vn){if(N(vn))vn(null);else{if(R(vn))return;!1,D()}}function _e(vn,_n,xn,En,wn){T(En)&&(En={});var Sn=new _n(xn,En);Sn.context=En,Sn.props===Kt&&(Sn.props=xn),Sn._patch=tt,Gt.findDOMNodeEnabled&&(Sn._componentToDOMNodeMap=hn),Sn._unmounted=!1,Sn._pendingSetState=!0,Sn._isSVG=wn,N(Sn.componentWillMount)&&Sn.componentWillMount();var kn=Sn.getChildContext();Sn._childContext=C(kn)?En:Object.assign({},En,kn),Gt.beforeRender&&Gt.beforeRender(Sn);var Cn=Sn.render(xn,Sn.state,En);return Gt.afterRender&&Gt.afterRender(Sn),Vt(Cn)?(!1,D()):R(Cn)?Cn=Z():S(Cn)?Cn=Q(Cn):(Cn.dom&&(Cn=J(Cn)),28&Cn.flags&&(Cn.parentVNode=vn)),Sn._pendingSetState=!1,Sn._lastInput=Cn,Sn}function xe(vn,_n,xn,En,wn,Sn,kn){Ee(xn,yt(_n,null,En,wn,Sn),vn,En,kn)}function Ee(vn,_n,xn,En,wn){var Sn=!1;28&xn.flags&&(he(xn,null,En,!1,wn),xn=xn.children._lastInput||xn.children,Sn=!0),Ie(vn,_n,xn.dom),he(xn,null,En,!1,wn)}function we(vn,_n,xn,En){var wn=_n(xn,En);return Vt(wn)?(!1,D()):R(wn)?wn=Z():S(wn)?wn=Q(wn):(wn.dom&&(wn=J(wn)),28&wn.flags&&(wn.parentVNode=vn)),wn}function Se(vn,_n){''===_n?vn.appendChild(document.createTextNode('')):vn.textContent=_n}function ke(vn,_n){vn.firstChild.nodeValue=_n}function Ce(vn,_n){vn.appendChild(_n)}function Re(vn,_n,xn){C(xn)?Ce(vn,_n):vn.insertBefore(_n,xn)}function Ne(vn,_n){return!0===_n?document.createElementNS(Xt,vn):document.createElement(vn)}function Oe(vn,_n,xn,En,wn,Sn,kn){he(vn,null,En,!1,kn);var Cn=yt(_n,null,En,wn,Sn);_n.dom=Cn,Ie(xn,Cn,vn.dom)}function Ie(vn,_n,xn){vn||(vn=xn.parentNode),vn.replaceChild(_n,xn)}function Me(vn,_n){vn.removeChild(_n)}function Ae(vn,_n,xn,En){vn.textContent='',(!xn.fastUnmount||xn.fastUnmount&&Gt.recyclingEnabled&&!En)&&Pe(null,_n,xn,En)}function Pe(vn,_n,xn,En){for(var wn=0,Sn;wn<_n.length;wn++)Sn=_n[wn],R(Sn)||he(Sn,vn,xn,!0,En)}function Te(vn,_n){return _n.length&&!C(_n[0])&&!C(_n[0].key)&&vn.length&&!C(vn[0])&&!C(vn[0].key)}function Ue(vn){return'checkbox'===vn||'radio'===vn}function Le(vn){var _n=Ue(vn.type);return _n?!C(vn.checked):!C(vn.value)}function De(vn){var _n=this.vNode,xn=_n.events||Kt,En=_n.dom;if(xn.onInput){var wn=xn.onInput;wn.event?wn.event(wn.data,vn):wn(vn)}else xn.oninput&&xn.oninput(vn);Ye(this.vNode,En)}function Be(vn){var _n=this.vNode,xn=_n.events||Kt,En=xn.onChange;En.event?En.event(En.data,vn):En(vn)}function je(vn){var _n=this.vNode,xn=_n.events||Kt,En=_n.dom;if(xn.onClick){var wn=xn.onClick;wn.event?wn.event(wn.data,vn):wn(vn)}else xn.onclick&&xn.onclick(vn);Ye(this.vNode,En)}function We(vn){var _n=document.querySelectorAll('input[type="radio"][name="'+vn+'"]');[].forEach.call(_n,function(xn){var En=un.get(xn);if(En){var wn=En.vNode.props;wn&&(xn.checked=En.vNode.props.checked)}})}function He(vn,_n){var xn=vn.props||Kt;if(Ye(vn,_n),Le(xn)){var En=un.get(_n);return En||(En={vNode:vn},Ue(xn.type)?(_n.onclick=je.bind(En),_n.onclick.wrapped=!0):(_n.oninput=De.bind(En),_n.oninput.wrapped=!0),xn.onChange&&(_n.onchange=Be.bind(En),_n.onchange.wrapped=!0),un.set(_n,En)),En.vNode=vn,!0}return!1}function Ye(vn,_n){var xn=vn.props||Kt,En=xn.type,wn=xn.value,Sn=xn.checked,kn=xn.multiple;En&&En!==_n.type&&(_n.type=En),kn&&kn!==_n.multiple&&(_n.multiple=kn),Ue(En)?(!C(wn)&&(_n.value=wn),_n.checked=Sn,'radio'===En&&xn.name&&We(xn.name)):C(wn)||_n.value===wn?!C(Sn)&&(_n.checked=Sn):_n.value=wn}function ze(vn){return!C(vn.value)}function Ve(vn,_n){var xn=vn.type;if('optgroup'===xn){var En=vn.children;if(Vt(En))for(var wn=0;wn<En.length;wn++)Ke(En[wn],_n);else ee(En)&&Ke(En,_n)}else Ke(vn,_n)}function Ke(vn,_n){var xn=vn.props||Kt,En=vn.dom;En.value=xn.value,En.selected=Vt(_n)&&-1!==_n.indexOf(xn.value)||xn.value===_n||xn.selected||!1}function Ge(vn){var _n=this.vNode,xn=_n.events||Kt,En=_n.dom;if(xn.onChange){var wn=xn.onChange;wn.event?wn.event(wn.data,vn):wn(vn)}else xn.onchange&&xn.onchange(vn);Fe(this.vNode,En)}function $e(vn,_n){var xn=vn.props||Kt;if(Fe(vn,_n),ze(xn)){var En=un.get(_n);return En||(En={vNode:vn},_n.onchange=Ge.bind(En),_n.onchange.wrapped=!0,un.set(_n,En)),En.vNode=vn,!0}return!1}function Fe(vn,_n){var xn=vn.props||Kt;xn.multiple!==_n.multiple&&(_n.multiple=xn.multiple);var En=vn.children;if(!R(En)){var wn=xn.value;if(Vt(En))for(var Sn=0;Sn<En.length;Sn++)Ve(En[Sn],wn);else ee(En)&&Ve(En,wn)}}function Xe(vn){return!C(vn.value)}function qe(vn){var _n=this.vNode,xn=_n.events||Kt,En=xn.onChange;En.event?En.event(En.data,vn):En(vn)}function Je(vn){var _n=this.vNode,xn=_n.events||Kt,En=_n.dom;if(xn.onInput){var wn=xn.onInput;wn.event?wn.event(wn.data,vn):wn(vn)}else xn.oninput&&xn.oninput(vn);Qe(this.vNode,En)}function Ze(vn,_n){var xn=vn.props||Kt;Qe(vn,_n);var En=un.get(_n);return!!Xe(xn)&&(En||(En={vNode:vn},_n.oninput=Je.bind(En),_n.oninput.wrapped=!0,xn.onChange&&(_n.onchange=qe.bind(En),_n.onchange.wrapped=!0),un.set(_n,En)),En.vNode=vn,!0)}function Qe(vn,_n){var xn=vn.props||Kt,En=xn.value,wn=_n.value;wn!==En&&(C(En)?''!==wn&&(_n.value=''):_n.value=En)}function et(vn,_n,xn){return 512&vn?He(_n,xn):2048&vn?$e(_n,xn):!!(1024&vn)&&Ze(_n,xn)}function tt(vn,_n,xn,En,wn,Sn,kn){if(vn!==_n){var Cn=vn.flags,Rn=_n.flags;28&Rn?28&Cn?it(vn,_n,xn,En,wn,Sn,4&Rn,kn):Ee(xn,Et(_n,null,En,wn,Sn,4&Rn),vn,En,kn):3970&Rn?3970&Cn?ot(vn,_n,xn,En,wn,Sn,kn):Ee(xn,_t(_n,null,En,wn,Sn),vn,En,kn):1&Rn?1&Cn?st(vn,_n):Ee(xn,bt(_n,null),vn,En,kn):4096&Rn?4096&Cn?lt(vn,_n):Ee(xn,vt(_n,null),vn,En,kn):xe(vn,_n,xn,En,wn,Sn,kn)}}function nt(vn,_n,xn,En){ee(vn)?he(vn,_n,xn,!0,En):Vt(vn)?Ae(_n,vn,xn,En):_n.textContent=''}function ot(vn,_n,xn,En,wn,Sn,kn){var Cn=_n.type,Rn=vn.type;if(Rn!==Cn)Oe(vn,_n,xn,En,wn,Sn,kn);else{var Nn=vn.dom,On=vn.props,In=_n.props,Mn=vn.children,An=_n.children,Pn=vn.flags,Tn=_n.flags,Un=vn.ref,Ln=_n.ref,Dn=vn.events,Bn=_n.events;_n.dom=Nn,(Sn||128&Tn)&&(Sn=!0),Mn!==An&&at(Pn,Tn,Mn,An,Nn,En,wn,Sn,kn);var jn=!1;if(2&Tn||(jn=et(Tn,_n,Nn)),On!==In){var Wn=On||Kt,Hn=In||Kt;if(Hn!==Kt)for(var Yn in Hn){var zn=Hn[Yn],Vn=Wn[Yn];C(zn)?gt(Yn,zn,Nn):ct(Yn,Vn,zn,Nn,Sn,jn)}if(Wn!==Kt)for(var Kn in Wn)C(Hn[Kn])&&gt(Kn,Wn[Kn],Nn)}Dn!==Bn&&ft(Dn,Bn,Nn),Ln&&(Un!==Ln||kn)&&kt(Nn,Ln,En)}}function at(vn,_n,xn,En,wn,Sn,kn,Cn,Rn){var Nn=!1,On=!1;64&_n?Nn=!0:32&vn&&32&_n?(On=!0,Nn=!0):R(En)?nt(xn,wn,Sn,Rn):R(xn)?S(En)?Se(wn,En):Vt(En)?xt(En,wn,Sn,kn,Cn):yt(En,wn,Sn,kn,Cn):S(En)?S(xn)?ke(wn,En):(nt(xn,wn,Sn,Rn),Se(wn,En)):Vt(En)?Vt(xn)?(Nn=!0,Te(xn,En)&&(On=!0)):(nt(xn,wn,Sn,Rn),xt(En,wn,Sn,kn,Cn)):Vt(xn)?(Ae(wn,xn,Sn,Rn),yt(En,wn,Sn,kn,Cn)):ee(En)&&(ee(xn)?tt(xn,En,wn,Sn,kn,Cn,Rn):(nt(xn,wn,Sn,Rn),yt(En,wn,Sn,kn,Cn))),Nn&&(On?pt(xn,En,wn,Sn,kn,Cn,Rn):dt(xn,En,wn,Sn,kn,Cn,Rn))}function it(vn,_n,xn,En,wn,Sn,kn,Cn){var Rn=vn.type,Nn=_n.type,On=_n.props||Kt,In=vn.key,Mn=_n.key,An=Nn.defaultProps;if(T(An)||($(An,On),_n.props=On),Rn!==Nn){if(kn)Oe(vn,_n,xn,En,wn,Sn,Cn);else{var Pn=vn.children._lastInput||vn.children,Tn=we(_n,Nn,On,wn);he(vn,null,En,!1,Cn),tt(Pn,Tn,xn,En,wn,Sn,Cn);var Un=_n.dom=Tn.dom;_n.children=Tn,St(_n.ref,Un,En)}}else if(kn){if(In!==Mn)return Oe(vn,_n,xn,En,wn,Sn,Cn),!1;var Ln=vn.children;if(Ln._unmounted){if(A(xn))return!0;Ie(xn,Et(_n,null,En,wn,Sn,4&_n.flags),vn.dom)}else{var Dn=Ln.state,Bn=Ln.state,jn=Ln.props,Wn=Ln.getChildContext();_n.children=Ln,Ln._isSVG=Sn,Wn=C(Wn)?wn:Object.assign({},wn,Wn);var Hn=Ln._lastInput,Yn=Ln._updateComponent(Dn,Bn,jn,On,wn,!1,!1),zn=!0;if(Ln._childContext=Wn,R(Yn)?Yn=Z():Yn===Ht?(Yn=Hn,zn=!1):S(Yn)?Yn=Q(Yn):Vt(Yn)?(!1,D()):U(Yn)&&Yn.dom&&(Yn=J(Yn)),28&Yn.flags?Yn.parentVNode=_n:28&Hn.flags&&(Hn.parentVNode=_n),Ln._lastInput=Yn,Ln._vNode=_n,zn){var Vn=En.fastUnmount,Kn=Ln._lifecycle;En.fastUnmount=Kn.fastUnmount,tt(Hn,Yn,xn,En,Wn,Sn,Cn),Kn.fastUnmount=En.fastUnmount,En.fastUnmount=Vn,Ln.componentDidUpdate(jn,Dn),Gt.afterUpdate&&Gt.afterUpdate(_n),Gt.findDOMNodeEnabled&&hn.set(Ln,Yn.dom)}_n.dom=Yn.dom}}else{var Gn=!0,$n=vn.props,Fn=_n.ref,Xn=!C(Fn),qn=vn.children,Jn=qn;_n.dom=vn.dom,_n.children=qn,In===Mn?Xn&&!C(Fn.onComponentShouldUpdate)&&(Gn=Fn.onComponentShouldUpdate($n,On)):Gn=!0,!1!==Gn&&(Xn&&!C(Fn.onComponentWillUpdate)&&Fn.onComponentWillUpdate($n,On),Jn=Nn(On,wn),R(Jn)?Jn=Z():S(Jn)&&Jn!==Ht?Jn=Q(Jn):Vt(Jn)?(!1,D()):U(Jn)&&Jn.dom&&(Jn=J(Jn)),Jn!==Ht&&(tt(qn,Jn,xn,En,wn,Sn,Cn),_n.children=Jn,Xn&&!C(Fn.onComponentDidUpdate)&&Fn.onComponentDidUpdate($n,On),_n.dom=Jn.dom)),28&Jn.flags?Jn.parentVNode=_n:28&qn.flags&&(qn.parentVNode=_n)}return!1}function st(vn,_n){var xn=_n.children,En=vn.dom;_n.dom=En,vn.children!==xn&&(En.nodeValue=xn)}function lt(vn,_n){_n.dom=vn.dom}function dt(vn,_n,xn,En,wn,Sn,kn){for(var Cn=vn.length,Rn=_n.length,Nn=Cn>Rn?Rn:Cn,On=0,In;On<Nn;On++)In=_n[On],In.dom&&(In=_n[On]=J(In)),tt(vn[On],In,xn,En,wn,Sn,kn);if(Cn<Rn)for(On=Nn;On<Rn;On++){var Mn=_n[On];Mn.dom&&(Mn=_n[On]=J(Mn)),Ce(xn,yt(Mn,null,En,wn,Sn))}else if(0===Rn)Ae(xn,vn,En,kn);else if(Cn>Rn)for(On=Nn;On<Cn;On++)he(vn[On],xn,En,!1,kn)}function pt(vn,_n,xn,En,wn,Sn,kn){var Cn=vn.length,Rn=_n.length,Nn=Cn-1,On=Rn-1,In=0,Mn=0,An,Pn,Tn,Un,Ln,Dn,Bn;if(0===Cn)return void(0!==Rn&&xt(_n,xn,En,wn,Sn));if(0===Rn)return void Ae(xn,vn,En,kn);var jn=vn[In],Wn=_n[Mn],Hn=vn[Nn],Yn=_n[On];Wn.dom&&(_n[Mn]=Wn=J(Wn)),Yn.dom&&(_n[On]=Yn=J(Yn));outer:for(;;){for(;jn.key===Wn.key;){if(tt(jn,Wn,xn,En,wn,Sn,kn),In++,Mn++,In>Nn||Mn>On)break outer;jn=vn[In],Wn=_n[Mn],Wn.dom&&(_n[Mn]=Wn=J(Wn))}for(;Hn.key===Yn.key;){if(tt(Hn,Yn,xn,En,wn,Sn,kn),Nn--,On--,In>Nn||Mn>On)break outer;Hn=vn[Nn],Yn=_n[On],Yn.dom&&(_n[On]=Yn=J(Yn))}if(Hn.key===Wn.key){tt(Hn,Wn,xn,En,wn,Sn,kn),Re(xn,Wn.dom,jn.dom),Nn--,Mn++,Hn=vn[Nn],Wn=_n[Mn],Wn.dom&&(_n[Mn]=Wn=J(Wn));continue}if(jn.key===Yn.key){tt(jn,Yn,xn,En,wn,Sn,kn),Dn=On+1,Ln=Dn<_n.length?_n[Dn].dom:null,Re(xn,Yn.dom,Ln),In++,On--,jn=vn[In],Yn=_n[On],Yn.dom&&(_n[On]=Yn=J(Yn));continue}break}if(In>Nn){if(Mn<=On)for(Dn=On+1,Ln=Dn<_n.length?_n[Dn].dom:null;Mn<=On;)Bn=_n[Mn],Bn.dom&&(_n[Mn]=Bn=J(Bn)),Mn++,Re(xn,yt(Bn,null,En,wn,Sn),Ln);}else if(Mn>On)for(;In<=Nn;)he(vn[In++],xn,En,!1,kn);else{Cn=Nn-In+1,Rn=On-Mn+1;var zn=vn,Vn=Array(Rn);for(An=0;An<Rn;An++)Vn[An]=-1;var Kn=!1,Gn=0,$n=0;if(4>=Rn||16>=Cn*Rn){for(An=In;An<=Nn;An++)if(Tn=vn[An],$n<Rn)for(Pn=Mn;Pn<=On;Pn++)if(Un=_n[Pn],Tn.key===Un.key){Vn[Pn-Mn]=An,Gn>Pn?Kn=!0:Gn=Pn,Un.dom&&(_n[Pn]=Un=J(Un)),tt(Tn,Un,xn,En,wn,Sn,kn),$n++,zn[An]=null;break}}else{var Fn=new Map;for(An=Mn;An<=On;An++)Bn=_n[An],Fn.set(Bn.key,An);for(An=In;An<=Nn;An++)Tn=vn[An],$n<Rn&&(Pn=Fn.get(Tn.key),!T(Pn)&&(Un=_n[Pn],Vn[Pn-Mn]=An,Gn>Pn?Kn=!0:Gn=Pn,Un.dom&&(_n[Pn]=Un=J(Un)),tt(Tn,Un,xn,En,wn,Sn,kn),$n++,zn[An]=null))}if(Cn===vn.length&&0==$n)for(Ae(xn,vn,En,kn);Mn<Rn;)Bn=_n[Mn],Bn.dom&&(_n[Mn]=Bn=J(Bn)),Mn++,Re(xn,yt(Bn,null,En,wn,Sn),null);else{for(An=Cn-$n;0<An;)Tn=zn[In++],A(Tn)||(he(Tn,xn,En,!0,kn),An--);if(Kn){var Xn=ut(Vn);for(Pn=Xn.length-1,An=Rn-1;0<=An;An--)-1===Vn[An]?(Gn=An+Mn,Bn=_n[Gn],Bn.dom&&(_n[Gn]=Bn=J(Bn)),Dn=Gn+1,Ln=Dn<_n.length?_n[Dn].dom:null,Re(xn,yt(Bn,xn,En,wn,Sn),Ln)):0>Pn||An!==Xn[Pn]?(Gn=An+Mn,Bn=_n[Gn],Dn=Gn+1,Ln=Dn<_n.length?_n[Dn].dom:null,Re(xn,Bn.dom,Ln)):Pn--}else if($n!==Rn)for(An=Rn-1;0<=An;An--)-1===Vn[An]&&(Gn=An+Mn,Bn=_n[Gn],Bn.dom&&(_n[Gn]=Bn=J(Bn)),Dn=Gn+1,Ln=Dn<_n.length?_n[Dn].dom:null,Re(xn,yt(Bn,null,En,wn,Sn),Ln))}}}function ut(vn){var _n=vn.slice(0),xn=[0],En,wn,Sn,kn,Cn;for(En=0;En<vn.length;En++)if(-1!==vn[En]){if(wn=xn[xn.length-1],vn[wn]<vn[En]){_n[En]=wn,xn.push(En);continue}for(Sn=0,kn=xn.length-1;Sn<kn;)Cn=0|(Sn+kn)/2,vn[xn[Cn]]<vn[En]?Sn=Cn+1:kn=Cn;vn[En]<vn[xn[Sn]]&&(0<Sn&&(_n[En]=xn[Sn-1]),xn[Sn]=En)}for(Sn=xn.length,kn=xn[Sn-1];0<Sn--;)xn[Sn]=kn,kn=_n[kn];return xn}function ct(vn,_n,xn,En,wn,Sn){if(!(en[vn]||Sn&&'value'===vn))if(Jt[vn])En[vn]=!!xn;else if(qt[vn]){var kn=C(xn)?'':xn;En[vn]!==kn&&(En[vn]=kn)}else if(_n!==xn)if(O(vn))ht(vn,_n,xn,En);else if(C(xn))En.removeAttribute(vn);else if('className'===vn)wn?En.setAttribute('class',xn):En.className=xn;else if('style'===vn)mt(_n,xn,En);else if('dangerouslySetInnerHTML'===vn){var Cn=_n&&_n.__html,Rn=xn&&xn.__html;Cn===Rn||C(Rn)||(En.innerHTML=Rn)}else{var Nn;tn[vn]?Nn=tn[vn]:wn&&vn.match(nn)?(Nn=vn.replace(/([a-z])([A-Z]|1)/g,ne),tn[vn]=Nn):Nn=vn;var On=Zt[vn];On?En.setAttributeNS(On,Nn,xn):En.setAttribute(Nn,xn)}}function ft(vn,_n,xn){if(vn=vn||Kt,_n=_n||Kt,_n!==Kt)for(var En in _n)ht(En,vn[En],_n[En],xn);if(vn!==Kt)for(var wn in vn)C(_n[wn])&&ht(wn,vn[wn],null,xn)}function ht(vn,_n,xn,En){if(_n!==xn){var wn=vn.toLowerCase(),Sn=En[wn];if(Sn&&Sn.wrapped)return;if(on[vn])oe(vn,_n,xn,En);else if(_n!==xn)if(!N(xn)&&!C(xn)){var kn=xn.event;kn&&N(kn)?(!En._data&&(En[wn]=function(Cn){kn(Cn.currentTarget._data,Cn)}),En._data=xn.data):(!1,D())}else En[wn]=xn}}function mt(vn,_n,xn){if(I(_n))return void(xn.style.cssText=_n);for(var En in _n){var wn=_n[En];xn.style[En]=M(wn)&&!Qt[En]?wn+'px':wn}if(!C(vn))for(var Sn in vn)C(_n[Sn])&&(xn.style[Sn]='')}function gt(vn,_n,xn){'className'===vn?xn.removeAttribute('class'):'value'===vn?xn.value='':'style'===vn?xn.removeAttribute('style'):O(vn)?oe(name,_n,null,xn):xn.removeAttribute(vn)}function yt(vn,_n,xn,En,wn){var Sn=vn.flags;if(3970&Sn)return _t(vn,_n,xn,En,wn);return 28&Sn?Et(vn,_n,xn,En,wn,4&Sn):4096&Sn?vt(vn,_n):1&Sn?bt(vn,_n):void(!1,D())}function bt(vn,_n){var xn=document.createTextNode(vn.children);return vn.dom=xn,_n&&Ce(_n,xn),xn}function vt(vn,_n){var xn=document.createTextNode('');return vn.dom=xn,_n&&Ce(_n,xn),xn}function _t(vn,_n,xn,En,wn){if(Gt.recyclingEnabled){var Sn=pe(vn,xn,En,wn);if(!A(Sn))return A(_n)||Ce(_n,Sn),Sn}var kn=vn.type,Cn=vn.flags;(wn||128&Cn)&&(wn=!0);var Rn=Ne(kn,wn),Nn=vn.children,On=vn.props,In=vn.events,Mn=vn.ref;vn.dom=Rn,A(Nn)||(S(Nn)?Se(Rn,Nn):Vt(Nn)?xt(Nn,Rn,xn,En,wn):ee(Nn)&&yt(Nn,Rn,xn,En,wn));var An=!1;if(2&Cn||(An=et(Cn,vn,Rn)),!A(On))for(var Pn in On)ct(Pn,null,On[Pn],Rn,wn,An);if(!A(In))for(var Tn in In)ht(Tn,null,In[Tn],Rn);return A(Mn)||kt(Rn,Mn,xn),A(_n)||Ce(_n,Rn),Rn}function xt(vn,_n,xn,En,wn){for(var Sn=0,kn;Sn<vn.length;Sn++)kn=vn[Sn],R(kn)||(kn.dom&&(vn[Sn]=kn=J(kn)),yt(vn[Sn],_n,xn,En,wn))}function Et(vn,_n,xn,En,wn,Sn){if(Gt.recyclingEnabled){var kn=ce(vn,xn,En,wn);if(!A(kn))return A(_n)||Ce(_n,kn),kn}var Cn=vn.type,Rn=vn.props||Kt,Nn=Cn.defaultProps,On=vn.ref,In;if(T(Nn)||($(Nn,Rn),vn.props=Rn),Sn){var Mn=_e(vn,Cn,Rn,En,wn),An=Mn._lastInput,Pn=xn.fastUnmount;xn.fastUnmount=!0,Mn._vNode=vn,vn.dom=In=yt(An,null,xn,Mn._childContext,wn);var Tn=Mn._lifecycle=new an;Tn.fastUnmount=T(Mn.componentWillUnmount)&&xn.fastUnmount,xn.fastUnmount=Pn&&Tn.fastUnmount,A(_n)||Ce(_n,In),wt(vn,On,Mn,xn),Gt.findDOMNodeEnabled&&hn.set(Mn,In),vn.children=Mn}else{var Un=we(vn,Cn,Rn,En);vn.dom=In=yt(Un,null,xn,En,wn),vn.children=Un,St(On,In,xn),A(_n)||Ce(_n,In)}return In}function wt(vn,_n,xn,En){_n&&(N(_n)?_n(xn):(!1,D()));var wn=xn.componentDidMount,Sn=Gt.afterMount;T(wn)&&A(Sn)||En.addListener(function(){Sn&&Sn(vn),wn&&xn.componentDidMount()})}function St(vn,_n,xn){vn&&(!C(vn.onComponentWillMount)&&vn.onComponentWillMount(),!C(vn.onComponentDidMount)&&xn.addListener(function(){return vn.onComponentDidMount(_n)}),!C(vn.onComponentWillUnmount)&&(xn.fastUnmount=!1))}function kt(vn,_n,xn){if(N(_n))xn.fastUnmount=!1,xn.addListener(function(){return _n(vn)});else{if(R(_n))return;!1,D()}}function Ct(vn){for(var _n=vn.firstChild;_n;)if(!(8===_n.nodeType))_n=_n.nextSibling;else if('!'===_n.data){var xn=document.createTextNode('');vn.replaceChild(xn,_n),_n=_n.nextSibling}else{var En=_n.previousSibling;vn.removeChild(_n),_n=En||vn.firstChild}}function Rt(vn,_n,xn,En,wn,Sn){var kn=vn.type,Cn=vn.props||Kt,Rn=vn.ref;if(vn.dom=_n,Sn){var Nn=_n.namespaceURI===Xt,On=kn.defaultProps;T(On)||($(On,Cn),vn.props=Cn);var In=_e(vn,kn,Cn,En,Nn),Mn=xn.fastUnmount,An=In._lastInput;xn.fastUnmount=!0,In._vComponent=vn,In._vNode=vn,At(An,_n,xn,In._childContext,Nn);var Pn=In._lifecycle=new an;Pn.fastUnmount=T(In.componentWillUnmount)&&xn.fastUnmount,xn.fastUnmount=Mn&&Pn.fastUnmount,wt(vn,Rn,In,xn),Gt.findDOMNodeEnabled&&hn.set(In,_n),vn.children=In}else{var Tn=we(vn,kn,Cn,En);At(Tn,_n,xn,En,wn),vn.children=Tn,vn.dom=Tn.dom,St(Rn,_n,xn)}return _n}function Nt(vn,_n,xn,En,wn){var Sn=vn.type,kn=vn.children,Cn=vn.props,Rn=vn.events,Nn=vn.flags,On=vn.ref;if((wn||128&Nn)&&(wn=!0),1!==_n.nodeType||_n.tagName.toLowerCase()!==Sn){var In=_t(vn,null,xn,En,wn);return vn.dom=In,Ie(_n.parentNode,In,_n),In}vn.dom=_n,kn&&Ot(kn,_n,xn,En,wn);var Mn=!1;if(2&Nn||(Mn=et(Nn,vn,_n)),Cn)for(var An in Cn)ct(An,null,Cn[An],_n,wn,Mn);if(Rn)for(var Pn in Rn)ht(Pn,null,Rn[Pn],_n);return On&&kt(_n,On,xn),_n}function Ot(vn,_n,xn,En,wn){Ct(_n);var Sn=_n.firstChild;if(Vt(vn))for(var kn=0,Cn;kn<vn.length;kn++)Cn=vn[kn],!A(Cn)&&U(Cn)&&(Sn?(Sn=At(Cn,Sn,xn,En,wn),Sn=Sn.nextSibling):yt(Cn,_n,xn,En,wn));else S(vn)?(Sn&&3===Sn.nodeType?Sn.nodeValue!==vn&&(Sn.nodeValue=vn):vn&&(_n.textContent=vn),Sn=Sn.nextSibling):U(vn)&&(At(vn,Sn,xn,En,wn),Sn=Sn.nextSibling);for(;Sn;){var Rn=Sn.nextSibling;_n.removeChild(Sn),Sn=Rn}}function It(vn,_n){if(3!==_n.nodeType){var xn=bt(vn,null);return vn.dom=xn,Ie(_n.parentNode,xn,_n),xn}var En=vn.children;return _n.nodeValue!==En&&(_n.nodeValue=En),vn.dom=_n,_n}function Mt(vn,_n){return vn.dom=_n,_n}function At(vn,_n,xn,En,wn){var Sn=vn.flags;if(28&Sn)return Rt(vn,_n,xn,En,wn,4&Sn);return 3970&Sn?Nt(vn,_n,xn,En,wn):1&Sn?It(vn,_n):4096&Sn?Mt(vn,_n):void(!1,D())}function Pt(vn,_n,xn){var En=_n&&_n.firstChild;if(En){for(At(vn,En,xn,{},!1),En=_n.firstChild;En=En.nextSibling;)_n.removeChild(En);return!0}return!1}function Tt(vn){Gt.findDOMNodeEnabled||(!1,D());var _n=vn&&vn.nodeType?vn:null;return hn.get(vn)||_n}function Ut(vn){for(var _n=0,xn;_n<cn.length;_n++)if(xn=cn[_n],xn.dom===vn)return xn;return null}function Lt(vn,_n,xn){var En={dom:vn,input:_n,lifecycle:xn};return cn.push(En),En}function Dt(vn){for(var _n=0;_n<cn.length;_n++)if(cn[_n]===vn)return void cn.splice(_n,1)}function Bt(vn,_n){if(mn===_n&&(!1,D()),vn!==Ht){var xn=Ut(_n);if(A(xn)){var En=new an;R(vn)||(vn.dom&&(vn=J(vn)),!Pt(vn,_n,En)&&yt(vn,_n,En,{},!1),xn=Lt(_n,vn,En),En.trigger())}else{var wn=xn.lifecycle;wn.listeners=[],C(vn)?(he(xn.input,_n,wn,!1,!1),Dt(xn)):(vn.dom&&(vn=J(vn)),tt(xn.input,vn,_n,wn,{},!1,!1)),wn.trigger(),xn.input=vn}if(xn){var Sn=xn.input;if(Sn&&28&Sn.flags)return Sn.children}}}function jt(vn){var _n=vn||null;return function(En,wn){_n||(_n=En),Bt(wn,_n)}}function Wt(vn,_n){return{data:vn,event:_n}}var Ht='$NO_OP',Yt='a runtime error occured! Use Inferno in development environment to find the error.',zt='undefined'!=typeof window&&window.document,Vt=Array.isArray,Kt={},Gt={recyclingEnabled:!0,findDOMNodeEnabled:!1,roots:null,createVNode:null,beforeRender:null,afterRender:null,afterMount:null,afterUpdate:null,beforeUnmount:null},Xt='http://www.w3.org/2000/svg',qt={},Jt={},Zt={},Qt={},en={},tn={httpEquiv:'http-equiv',acceptCharset:'accept-charset'},nn=/^(accentH|arabicF|capH|font[FSVW]|glyph[NO]|horiz[AO]|panose1|renderingI|strikethrough[PT]|underline[PT]|v[AHIM]|vert[AO]|xH|alignmentB|baselineS|clip[PR]|color[IPR]|dominantB|enableB|fill[OR]|flood[COF]|imageR|letterS|lightingC|marker[EMS]|pointerE|shapeR|stop[CO]|stroke[DLMOW]|text[ADR]|unicodeB|wordS|writingM).*/,on={};te('xlink:href,xlink:arcrole,xlink:actuate,xlink:role,xlink:titlef,xlink:type',Zt,'http://www.w3.org/1999/xlink'),te('xml:base,xml:lang,xml:space',Zt,'http://www.w3.org/XML/1998/namespace'),te('volume,defaultValue,defaultChecked',qt,!0),te('children,childrenType,ref,key,selected,checked,multiple',en,!0),te('onClick,onMouseDown,onMouseUp,onMouseMove,onSubmit,onDblClick,onKeyDown,onKeyUp,onKeyPress',on,!0),te('muted,scoped,loop,open,checked,default,capture,disabled,readOnly,required,autoplay,controls,seamless,reversed,allowfullscreen,novalidate,hidden',Jt,!0),te('animationIterationCount,borderImageOutset,borderImageSlice,borderImageWidth,boxFlex,boxFlexGroup,boxOrdinalGroup,columnCount,flex,flexGrow,flexPositive,flexShrink,flexNegative,flexOrder,gridRow,gridColumn,fontWeight,lineClamp,lineHeight,opacity,order,orphans,tabSize,widows,zIndex,zoom,fillOpacity,floodOpacity,stopOpacity,strokeDasharray,strokeDashoffset,strokeMiterlimit,strokeOpacity,strokeWidth,',Qt,!0);var an=function(){this.listeners=[],this.fastUnmount=!0};an.prototype.addListener=function(_n){this.listeners.push(_n)},an.prototype.trigger=function(){for(var _n=this,xn=0;xn<this.listeners.length;xn++)_n.listeners[xn]()};var rn=zt&&!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform),sn=new Map,ln=new Map,dn=new Map,pn=new WeakMap,un=new Map,cn=[],hn=new Map;Gt.roots=cn,!1;var mn=zt?document.body:null;var yn='1.2.2';E['default']={linkEvent:Wt,createVNode:q,cloneVNode:J,NO_OP:Ht,EMPTY_OBJ:Kt,render:Bt,findDOMNode:Tt,createRenderer:jt,options:Gt,version:yn},E.linkEvent=Wt,E.createVNode=q,E.cloneVNode=J,E.NO_OP=Ht,E.EMPTY_OBJ=Kt,E.render=Bt,E.findDOMNode=Tt,E.createRenderer=jt,E.options=Gt,E.version=yn,Object.defineProperty(E,'__esModule',{value:!0})})},function(r){'use strict';r.exports=function(w,S,C,R,N,O,I,M){if(!w){var A;if(void 0===S)A=new Error('Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.');else{var P=[C,R,N,O,I,M],T=0;A=new Error(S.replace(/%s/g,function(){return P[T++]})),A.name='Invariant Violation'}throw A.framesToPop=1,A}}},function(r){var _={}.toString;r.exports=Array.isArray||function(E){return'[object Array]'==_.call(E)}},function(r){r.exports='import createElement from \'inferno-create-element\';\nimport Component from \'inferno-component\';\nimport { Grid, reducer, selectGridData, withScrollProps } from \'../../index.js\';\n\nconst TrackedGrid = withScrollProps(Grid);\n\nconst data = Array(100000).fill(0).map((item, i) => ({\n    col11: `Pinned left ${i}`,\n    col1: i,\n    col2: `Title ${i}`,\n    col21: `Pinned right ${i}`,\n    col3: \'Lorem Ipsum is simply dummy text of the printing and typesetting industry.\'\n}));\n\nexport default class Viewport extends Component {\n    constructor() {\n        super();\n\n        this.state = {\n            gridState: {\n                columns: [{\n                    name: \'col1\',\n                    enableSorting: true\n                }, {\n                    name: \'col11\',\n                    width: 120,\n                    pinnedLeft: true,\n                    enableResizing: true\n                }, {\n                    name: \'col2\',\n                    minWidth: 60,\n                    enableMoving: true,\n                    enableFiltering: true,\n                    placeholder: \'Search\',\n                    width: 150,\n                    enableResizing: true\n                }, {\n                    name: \'col21\',\n                    width: 120,\n                    pinnedRight: true,\n                    enableResizing: true\n                }, {\n                    name: \'col3\',\n                    displayName: \'Column 3\',\n                    width: 200,\n                    maxWidth: 300,\n                    enableMoving: true,\n                    enableResizing: true\n                }, {\n                    name: \'4\',\n                    width: \'50%\'\n                }],\n                rowState: {\n                    selectedIndex: 0\n                }\n            },\n            data,\n            originalData: data\n        };\n\n        this.callback = this.callback.bind(this);\n    }\n\n    callback(action) {\n        console.log(action);\n        switch (action.type) {\n            case \'FILTER_COLUMN\':\n            case \'SORT_COLUMN\':\n                {\n                    const gridState = reducer(this.state.gridState, action);\n                    this.setState({\n                        gridState,\n                        data: selectGridData(gridState, this.state.originalData)\n                    });\n                    break;\n                }\n\n            default:\n                this.setState({\n                    gridState: reducer(this.state.gridState, action)\n                });\n                break;\n        }\n    }\n\n    render({}, { gridState, data }) {\n        return createElement(TrackedGrid, {\n            viewportWidth: 600,\n            viewportHeight: 360,\n            headerHeight: 60,\n            columnComponent: undefined,\n            rowComponent: undefined,\n            state: gridState,\n            data: data,\n            callback: this.callback\n        });\n    }\n}'},function(r){r.exports='import createElement from \'inferno-create-element\';\nimport Component from \'inferno-component\';\nimport { withScrollProps, Grid } from \'../../index.js\';\n\nconst TrackedGrid = withScrollProps(Grid);\n\nconst gridState = {\n    columns: [{\n        name: \'col1\',\n        width: \'20%\'\n    }, {\n        name: \'col2\',\n        width: \'35%\'\n    }, {\n        name: \'col3\',\n        width: \'45%\'\n    }]\n};\n\nconst data = Array(100000).fill(0).map((item, i) => ({\n    col1: i,\n    col2: `Col2 ${i}`,\n    col3: \'Lorem Ipsum is simply dummy text of the printing and typesetting industry.\'\n}));\n\nexport default class Minimal extends Component {\n    render() {\n        return createElement(TrackedGrid, {\n            viewportWidth: 720,\n            viewportHeight: 480,\n            state: gridState,\n            data: data });\n    }\n}'},function(r){r.exports='import createElement from \'inferno-create-element\';\nimport { withScrollProps, Grid } from \'../../index.js\';\n\nconst TrackedGrid = withScrollProps(Grid);\n\nconst gridState = {\n    columns: [{\n        name: \'col1\',\n        width: \'50%\'\n    }, {\n        name: \'col11\',\n        width: 120,\n        pinnedLeft: true\n    }, {\n        name: \'col2\',\n        width: \'50%\'\n    }, {\n        name: \'col21\',\n        width: 120,\n        pinnedRight: true\n    }]\n};\n\nconst data = Array(100000).fill(0).map((item, i) => ({\n    col11: `Pinned left ${i}`,\n    col1: i,\n    col2: `Title ${i}`,\n    col21: `Pinned right ${i}`,\n    col3: \'Lorem Ipsum is simply dummy text of the printing and typesetting industry.\'\n}));\n\nexport default (() => createElement(TrackedGrid, {\n    viewportWidth: 600,\n    viewportHeight: 360,\n    state: gridState,\n    data: data }));'},function(r){'use strict';var E=function(R){return'/'===R.charAt(0)},w=function(R,N){for(var O=N,I=O+1,M=R.length;I<M;O+=1,I+=1)R[O]=R[I];R.pop()};r.exports=function(R){var N=1>=arguments.length||void 0===arguments[1]?'':arguments[1],O=R&&R.split('/')||[],I=N&&N.split('/')||[],M=R&&E(R),A=N&&E(N),P=M||A;if(R&&E(R)?I=O:O.length&&(I.pop(),I=I.concat(O)),!I.length)return'/';var T;if(I.length){var U=I[I.length-1];T='.'===U||'..'===U||''===U}else T=!1;for(var D=0,B=I.length,W;0<=B;B--)W=I[B],'.'===W?w(I,B):'..'===W?(w(I,B),D++):D&&(w(I,B),D--);if(!P)for(;D--;D)I.unshift('..');!P||''===I[0]||I[0]&&E(I[0])||I.unshift('');var H=I.join('/');return T&&'/'!==H.substr(-1)&&(H+='/'),H}},function(r,h,_){var E=_(50);'string'==typeof E&&(E=[[r.i,E,'']]);_(9)(E,{});E.locals&&(r.exports=E.locals),!1},function(r,h,_){var E=_(51);'string'==typeof E&&(E=[[r.i,E,'']]);_(9)(E,{});E.locals&&(r.exports=E.locals),!1},function(r,h,_){var E=_(52);'string'==typeof E&&(E=[[r.i,E,'']]);_(9)(E,{});E.locals&&(r.exports=E.locals),!1},function(r,h){'use strict';h.__esModule=!0;var E='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(S){return typeof S}:function(S){return S&&'function'==typeof Symbol&&S.constructor===Symbol&&S!==Symbol.prototype?'symbol':typeof S};h.default=function S(C,R){if(C===R)return!0;if(null==C||null==R)return!1;if(Array.isArray(C))return Array.isArray(R)&&C.length===R.length&&C.every(function(T,U){return S(T,R[U])});var N='undefined'==typeof C?'undefined':E(C),O='undefined'==typeof R?'undefined':E(R);if(N!==O)return!1;if('object'===N){var I=C.valueOf(),M=R.valueOf();if(I!==C||M!==R)return S(I,M);var A=Object.keys(C),P=Object.keys(R);return A.length===P.length&&A.every(function(T){return S(C[T],R[T])})}return!1}},function(r){var _=function(){return this}();try{_=_||Function('return this')()||(1,eval)('this')}catch(E){'object'==typeof window&&(_=window)}r.exports=_},function(r,h,_){'use strict';Object.defineProperty(h,'__esModule',{value:!0});var E=_(4),w=_.n(E),S=_(0),C=_.n(S),R=_(20),N=_.n(R),O=_(19),I=_.n(O),M=_(17),A=_(18),P=_(10);const T=P.a.map((U)=>Object.assign({},U,{component:()=>C()(A.a,U)}));w.a.render(C()(R.Router,{history:I()()},C()(R.Route,{component:M.a},T.map((U)=>C()(R.Route,{key:U.href,path:U.href,component:U.component})))),document.body.appendChild(document.createElement('div')))}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvdXRpbHMvZ2V0VmlzaWJsZVJvd3MuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2hvYy93aXRoRGVmYXVsdHMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0hlYWRlci5qcyIsIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgOWEwMmE3OWUzYzRmNjVhZDE0ZGUiLCJ3ZWJwYWNrOi8vLy4vfi9pbmZlcm5vLWNyZWF0ZS1lbGVtZW50L2luZmVybm8tY3JlYXRlLWVsZW1lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vfi9pbmZlcm5vLWNvbXBvbmVudC9pbmZlcm5vLWNvbXBvbmVudC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbHMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2hvYy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9+L2luZmVybm8vaW5mZXJuby5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvYWN0aW9uQ3JlYXRvcnMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2hvYy93aXRoUHJvcHNPbkNoYW5nZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vfi9jc3MtbG9hZGVyL2xpYi9jc3MtYmFzZS5qcyIsIndlYnBhY2s6Ly8vLi9+L3N0eWxlLWxvYWRlci9hZGRTdHlsZXMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2V4YW1wbGVzL25hdi5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvRGVmYXVsdENvbHVtbi5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvRGVmYXVsdFJvdy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaG9jL3dpdGhQcm9wcy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbHMvZmluZENvbHVtbi5qcyIsIndlYnBhY2s6Ly8vLi9+L2hpc3RvcnkvUGF0aFV0aWxzLmpzIiwid2VicGFjazovLy8uL34vd2FybmluZy9icm93c2VyLmpzIiwid2VicGFjazovLy8uL3NyYy9leGFtcGxlcy9BcHAuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2V4YW1wbGVzL1BhZ2UuanMiLCJ3ZWJwYWNrOi8vLy4vfi9oaXN0b3J5L2NyZWF0ZUhhc2hIaXN0b3J5LmpzIiwid2VicGFjazovLy8uL34vaW5mZXJuby1yb3V0ZXIvaW5mZXJuby1yb3V0ZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0dyaWQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0xpc3QuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1Jlc2l6ZUdob3N0LmpzIiwid2VicGFjazovLy8uL3NyYy9leGFtcGxlcy9Db2RlLmpzIiwid2VicGFjazovLy8uL3NyYy9leGFtcGxlcy9kZW1vcy9HcmlkRGVtby5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZXhhbXBsZXMvZGVtb3MvTWluaW1hbC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZXhhbXBsZXMvZGVtb3MvUGlubmVkQ29sdW1ucy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaG9jL2RyYWdnYWJsZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaG9jL3Nob3VsZFVwZGF0ZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaG9jL3dpdGhIYW5kbGVycy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaG9jL3dpdGhMaW5rZWRIYW5kbGVycy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaG9jL3dpdGhNaWRkbGVTdGF0ZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaG9jL3dpdGhQaW5uZWRDb2x1bW5zLmpzIiwid2VicGFjazovLy8uL3NyYy9ob2Mvd2l0aFNjcm9sbFByb3BzLmpzIiwid2VicGFjazovLy8uL3NyYy9yZWR1Y2Vycy9jb2x1bW5TdGF0ZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcmVkdWNlcnMvY29sdW1ucy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcmVkdWNlcnMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3JlZHVjZXJzL3Jvd1N0YXRlLmpzIiwid2VicGFjazovLy8uL3NyYy91dGlscy9iaXNlY3RDb2x1bW5zLmpzIiwid2VicGFjazovLy8uL3NyYy91dGlscy9jaGVja1Byb3BzLmpzIiwid2VicGFjazovLy8uL3NyYy91dGlscy9jb21wb3NlLmpzIiwid2VicGFjazovLy8uL3NyYy91dGlscy9nZXRLZXlzQnlJbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbHMvc2VsZWN0R3JpZERhdGEuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWxzL3RyaW1Db2x1bW5XaWR0aC5qcyIsIndlYnBhY2s6Ly8vLi9+L2Jhc2U2NC1qcy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9+L2J1ZmZlci9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9+L2hpZ2hsaWdodC5qcy9zdHlsZXMvbW9ub2thaS5jc3MiLCJ3ZWJwYWNrOi8vLy4vc3JjL2V4YW1wbGVzL0FwcC5jc3MiLCJ3ZWJwYWNrOi8vLy4vc3JjL2V4YW1wbGVzL1BhZ2UuY3NzIiwid2VicGFjazovLy8uL34vaGlnaGxpZ2h0LmpzL2xpYi9oaWdobGlnaHQuanMiLCJ3ZWJwYWNrOi8vLy4vfi9oaWdobGlnaHQuanMvbGliL2xhbmd1YWdlcy9qYXZhc2NyaXB0LmpzIiwid2VicGFjazovLy8uL34vaGlzdG9yeS9ET01VdGlscy5qcyIsIndlYnBhY2s6Ly8vLi9+L2hpc3RvcnkvTG9jYXRpb25VdGlscy5qcyIsIndlYnBhY2s6Ly8vLi9+L2hpc3RvcnkvY3JlYXRlVHJhbnNpdGlvbk1hbmFnZXIuanMiLCJ3ZWJwYWNrOi8vLy4vfi9pZWVlNzU0L2luZGV4LmpzIiwid2VicGFjazovLy8uL34vaW5mZXJuby9kaXN0L2luZmVybm8tY29tcG9uZW50Lm5vZGUuanMiLCJ3ZWJwYWNrOi8vLy4vfi9pbmZlcm5vL2Rpc3QvaW5mZXJuby1jcmVhdGUtZWxlbWVudC5ub2RlLmpzIiwid2VicGFjazovLy8uL34vaW5mZXJuby9kaXN0L2luZmVybm8tcm91dGVyLm5vZGUuanMiLCJ3ZWJwYWNrOi8vLy4vfi9pbmZlcm5vL2Rpc3QvaW5mZXJuby5ub2RlLmpzIiwid2VicGFjazovLy8uL34vaW52YXJpYW50L2Jyb3dzZXIuanMiLCJ3ZWJwYWNrOi8vLy4vfi9pc2FycmF5L2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9leGFtcGxlcy9kZW1vcy9HcmlkRGVtby5qcz9mZDcyIiwid2VicGFjazovLy8uL3NyYy9leGFtcGxlcy9kZW1vcy9NaW5pbWFsLmpzPzYyMGMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2V4YW1wbGVzL2RlbW9zL1Bpbm5lZENvbHVtbnMuanM/MzNhYyIsIndlYnBhY2s6Ly8vLi9+L3Jlc29sdmUtcGF0aG5hbWUvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vfi9oaWdobGlnaHQuanMvc3R5bGVzL21vbm9rYWkuY3NzP2QyYjciLCJ3ZWJwYWNrOi8vLy4vc3JjL2V4YW1wbGVzL0FwcC5jc3M/MDJiZCIsIndlYnBhY2s6Ly8vLi9zcmMvZXhhbXBsZXMvUGFnZS5jc3M/ODUzMyIsIndlYnBhY2s6Ly8vLi9+L3ZhbHVlLWVxdWFsL2luZGV4LmpzIiwid2VicGFjazovLy8od2VicGFjaykvYnVpbGRpbi9nbG9iYWwuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2V4YW1wbGVzL2luZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJ1RUFNZ0IsS0FBSyxlQURhLEtBQUssZUMrQnBCLEtBQUssYUNNaEIsS0FBSyxnQkN6Q2IsY0FNQSxNQUNBLGVBR0EsbUJBQ0EsR0FDQSxFQUNBLEtBSUEsbURBR0EsS0FHQSxPQUNBLE9BSUEsSUF6QkEsaUJBNEJBLE1BR0EsaUJBQTJDLE9BQWMsRUFHekQscUJBQ0EsT0FDQSw4QkFDQSxDQUNBLGdCQUNBLGtCQUdBLEdBR0EsaUJBQ0EsWUFDQSxxQkFBMkIsVUFBMEIsVUFDckQsWUFBaUMsT0FBZSxFQUNoRCxtQkFDQSxHQUNBLENBR0EsbUJBQXNELCtDQUErRCxFQUdySCxNQUdBLGdDQ2hFQSxnQkFDQSxvQix5QkNEQSxnQkFDQSxvQixtWkNLQSwwWENOQSxtQ0FXQSxvQkNYQSxnQkFDQSxvQix1QkNEYSxhQU9BLElBUDRCLFVBQ3JDLE1BQ0EsaUJBQ0EsT0FDQSxPQUpnRCxVQWN2QyxJQVAwQixVQUNuQyxNQUNBLGNBQ0EsT0FDQSxPQUo4QyxVQWFyQyxJQU5zQixRQUMvQixNQUNBLGdCQUNBLE9BSHlDLFNBWWhDLElBTnNCLFFBQy9CLE1BQ0EsZ0JBQ0EsT0FIMkMsV0FXbEMsSUFMYSxNQUN0QixNQUNBLGNBRitCLGFBS1YsTUFDckIsTUFDQSxhQUZrQyxtRkMzQnRDLE9BQXNCLE9BQWEsS0FBaUIsYUFBYyxHQUFkLENBQ2hELENBQVksY0FDUixPQUNBLFFBQUssTUFBUSxFQUNiLFFBQUssV0FBNkIsVUFBaEIsUUFBTyxHQUFzQixFQUFPLFNBQVcsR0FDcEUsRUFFRCxDQUEwQiw0QkFDdEIsQ0FBSSxLQUFLLFdBQVcsS0FBSyxNQUNyQixTQUFLLFNBQVMsRUFFckIsR0FFRCxDQUFjLFdBQ1YsT0FBTyxLQUFDLG1CQUFrQixFQUM3QixHQWZ1RSxvT0NBNUUsbUJDSkEsYUFJQSxDQTZDQSxlQUNBLGFBQ0EsT0FDQSxPQUNBLFFBR0EsUUFDQSxTQUNBLDhCQUNBLHVDQUNBLEtBRUEsd0NBQ0EsS0FFQSxnQkFDQSxLQUVBLENBQ0EsYUFDQSx5Q0FDQSx3QkFBbUUsK0RBRW5FLEdBQ0EsTUFyRUEscUJBQ0EsSUFHQSxrQ0FDQSw0QkFDQSxXQUNBLFlBQ0Esa0JBQW1DLE1BRW5DLElBRUEsQ0FBRyxRQUNILEdBR0EsbUJBQ0EsQ0FDQSxnQ0FDQSxhQUNBLFFBQWdCLFdBQWlCLE9BQ2pDLGNBQ0EsR0FDQSx1QkFFQSxhQUFZLE1BQW9CLFdBQ2hDLFNBS0EsOEJBQ0EsWUFDQSxRQUNLLEVBQ0wsOEJBRUEsWUFFQSxHQUNBLENBQ0EsRUFDQSxzQ0M1Q0EsQ0EwREEsZUFDQSxXQUFlLE1BQW1CLFdBQ2xDLFNBQ0EsU0FDQSxTQUNBLEdBQ0EsaUJBQWlCLFlBQTJCLE9BQzVDLHVCQUVBLElBQVEsZUFBdUIsT0FDL0IsOEJBRUEsR0FBRyxLQUNILFFBQ0EsUUFBaUIsWUFBdUIsT0FDeEMsd0JBRUEsYUFBMkIscUJBQzNCLEVBQ0EsQ0FDQSxFQUVBLGFBQ0EsUUFDQSxNQUNBLE9BQWUsTUFBaUIsV0FDaEMsU0FDQSxPQUNBLE9BQ0EsT0FDQSxPQUNBLE1BQWMsd0JBQ2QsS0FDQSxtQkFHQSxnQkFIZ0MsWUFFaEMsSUFFQSxPQUNBLEdBRUEsZUFDQSxPQUNBLGlCQUNBLE1BQ0EsbUJBQ0EsSUFFQSwrQkFFQSwyQkFFQSxzQkFMRyxtQkFNRCxXQUNGLG9DQUVBLHdCQUVBLDRFQUVBLGFBQ0EsMEJBQ0EsbUJBQ0EsR0FDQSxpQkFFQSxHQUVBLGFBQ0EsOEJBQ0EsdUJBQ0EsZUFDQSxHQUNBLEVBRUEsYUFDQSw4QkFDQSxxQkFDQSxpQkFDQSxHQUNBLEVBRUEsZUFDQSxTQUVBLGlCQUNBLE9BQ0EsY0FDQSxvQkFDQSxzQkFDQSxLQUFFLFFBQ0YsV0FDQSx3QkFDQSx3Q0FDQSx3Q0FDQSx5QkFDQSw2QkFDQSxpQkFDQSxlQUNBLEdBQ0EsS0FDQSw0QkFDQSxLQUVBLFFBQ0EsaUJBQ0EsZUFDQSxHQUNBLEVBR0EsWUFFQSxjQUNBLE1BQ0Esc0RBQ0EsVUFDQSxXQUNBLEVBQ0EsS0FFQSxJQUNBLEVBV0EsbUJBQ0EsY0FFQSxTQUNBLG9DQUNFLE9BQ0YsK0JBQ0EsT0FDQSxpQ0FDQSxNQUNBLDBCQUVBLGtCQUVBLEVBQ0EsRUFFQSxlQUNBLFNBQ0EsUUFFQSxTQUNBLDBCQUdBLEtBQ0EsZ0NBQ0UsTUFDRixRQUNBLDRCQUVBLGtEQUNBLEdBQ0EsRUFFQSxlQUNBLFNBQ0EsUUFFQSxVQUVBLE9BQXVELDZHQUd2RCwwQkFBNkIsTUFFN0IsaUJBRUEsZ0NBRUEsR0FDQSx1QkFDQSxHQWpQQSxHQUNBLG1CQUNBLElBQ0Esb0JBQ0EsOENBQ0EsWUFDQSxDQUNBLENBQ0EsZ0JBQ0EscURBQ0EsY0FDQSxpQkFDQSw2REFDQSxFQUNBLEtBQ0EsT0FDQSxPQUVBLHVCQUNBLCtCQUNBLGlEQUdBLGtFQUdBLG9EQUdBLGlEQUVBLGtCQUNBLGNBRUEsY0FDQSxRQUNBLFFBQWdCLE1BQW1CLFdBQ25DLFNBQ0EsU0FDQSxNQUNBLGNBQ0EsRUFDQSxNQUNBLFNBQ0EsT0FDQSxFQUNBLFdBQWdCLFFBQXNCLE9BQ3RDLFdBQ0EsY0FDQSxXQUFrQixZQUEyQixPQUM3QyxZQUNBLGdCQUNBLEdBRUEsQ0FDQSxHQTZIQSxnQkFDQSxJQUVBLDBCQUNBLGFBQ0EseUJBQ0EsS0FDQSxDQUFDLDhHQzFMRCxPQUVlLENBRVAsTUFDQSxnQkFDQSxvQkFDQSxTQUFNLEtBR04sTUFDQSx1QkFDQSwyQkFDQSxTQUFNLEtBR04sTUFDQSxnQkFDQSx5QkFDQSxTQUFNLG1FQ3RCZCxHQUVBLEtBQU0sR0FDTixvQkFBTSxFQUVOLGlCQUFNLEVBQXVDLFlBQ3pDLFVBQ0Esa0JBQ0Esb0JBQ0EscUJBQ0Esa0JBQ0EsZUFDQSxhQUFZLEdBQVMsSUFDYixFQUFNLFFBQVUsRUFBTSxPQUFPLFFBQVUsRUFBTyxLQUFPLEVBQWUsSUFHNUUsZUFBYSxHQUFTLEdBQ2YsSUFBUyxFQUFNLFFBQVUsRUFBTSxPQUFPLE9BQVMsRUFBTyxLQUFPLEVBQWUsSUFFbkYsY0FDQSxvREFBUyxFQUFRLEdBR3JCLElBQU0sRUFBZ0IsS0FDbEIsT0FDQSxpQkFDQSxxQkFDQSxlQUNBLGVBQ0EsZUFHSixJQUFNLEVBQVEsQ0FBQyxDQUFFLGVBQ2IsV0FBSyxNQUNELEVBQWUsS0FBZCxLQUFzQixlQUFpQixhQUN4Qyx1QkFDQSxvQ0FLUiwrQkFBZSxTQUNYLGFBQWEsS0FBUyxFQUFNLFNBQVMsU0FBVyxFQUFNLE9BQ3RELHFCQUF1QixPQUFVLEVBQU0sU0FBUyxTQUFhLEVBQU0sT0FBTyxLQUFNLEVBQU0sT0FBTyxVQUM5RixLQUNDLFdBQUssTUFBTyxFQUFlLEVBQU0sTUFBTyxFQUFNLE9BQVEsRUFBTSxLQUFNLEVBQzlELG1CQUFLLE1BQU8sQ0FBRSxRQUFTLE9BQVEsV0FBWSxTQUFVLE9BQVEsSUFBTyxRQUFTLEVBQU0sWUFDOUUsTUFBTSxPQUFPLGFBQWUsRUFBTSxPQUNsQyxPQUFNLE9BQU8sTUFDVixJQUFDLEdBQU0sVUFBVyxFQUFNLE9BRy9CLFVBQU0sT0FBTyxpQkFDVixhQUFPLE1BQ0gsZ0JBQWEsRUFBTSxPQUNuQixrQkFBTyxFQUFNLE9BQ2IsZUFBUyxFQUFNLGNBQWMsb0VDeEQ3QyxHQUVBLEtBQU0sR0FFTixvQkFBTSxFQUFzQixRQUN4QixTQUNBLGNBQ0EsaUJBQ0EscUJBQVksRUFBTSxnQkFBa0IsRUFBUSxVQUEwQixDQUFkLElBQVEsRUFBVSxPQUc5RSxZQUFNLEVBQTBCLFFBQzVCLFlBQ0EsVUFDQSxrQkFDQSxlQUFPLEVBQ1AsY0FDQSxrQkFDQSx3QkFDQSxjQUFhLEVBQU8sRUFHeEIsS0FBTSxFQUFhLFNBQ2YsV0FBVyxLQUFTLEVBQU0sU0FBUyxTQUFVLEVBQU0sVUFDcEQsS0FDQyxXQUFLLE1BQU8sRUFBWSxFQUFNLE1BQU8sRUFBTSxPQUFRLFFBQVMsRUFBTSxVQUM3RCxNQUFNLFFBQVEsSUFBVyxPQUN0QixXQUFLLE1BQU8sRUFBZSxFQUFNLElBQWdCLEVBQU0sUUFBUSxPQUMzRCxlQUFLLE1BQU8sQ0FBRSxTQUFVLFNBQVUsV0FBWSxTQUFVLGFBQ25ELGVBQU0sTUFBTSxFQU9qQyxlQUFlLGlEQ3BDZixPQUFlLEtBQVksS0FBaUIsS0FBUyxJQUFDLG1CQUFrQixFQUFXLEVBQVMsb0JDRjVGLGlCQUF5QixPQUNyQixJQUFRLENBQUosSUFDQSxDQURTLEtBQVEsYUFDVixDQUFDLENBQUMsRUFFYixNQUFJLEdBQ0osUUFBTyxHQUFRLE9BQVEsR0FBSyxDQUFXLGFBQ25DLE1BQU0sR0FDTixZQUNBLEVBQUksR0FBUSxHQUFLLEVBQ2IsRUFBTyxDQUFDLEVBQU8sRUFFbkIsR0FBSSxJQUNBLEVBQU8sQ0FBQyxFQUVaLEdBQUksRUFDQSxFQUFPLENBQUMsRUFBUSxFQUFHLEVBRXZCLEdBQ0gsQ0FiTSxFQWNWLEtBbkJELGlCQ0FBLGFBRUEsZ0JBQ0EsbUNBQ0EsK0JBQ0EsQ0FFQSxtQ0FDQSxxQ0FDQSxDQUVBLCtCQUNBLDRDQUNBLENBRUEsb0NBQ0EsZ0RBQ0EsQ0FFQSwyQkFDQSxVQUNBLE1BQ0EsS0FFQSxlQUNBLG1CQUNBLE1BQ0EsbUJBQ0EsZ0JBR0Esb0JBQ0EsWUFDQSxtQkFDQSxnQkFHQSxJQUNBLFVBQ0Esb0JBQ0Esa0JBRUEsRUFFQSw0QkFDQSxTQUNBLGFBQ0EsV0FHQSxVQUVBLG1EQUVBLDJDQUVBLGFBQ0EsRSxlQ3ZDQSxnQkF5Q0EscUJBRkEsMEVDckRBLE9BQWUsS0FDWCxXQUFLLFVBQ0QsNEJBQUssVUFDRCw2QkFBSyxVQUNBLGdCQUFJLElBQUksS0FDTCxTQUFHLElBQUssRUFBSyxLQUFNLFVBQVUsWUFBbUIsU0FBRyxFQUFVLElBQ3hELE1BSWIsb0JBQUssVUFDQSxlQUFNLG9GQ1h2QixPQUFlLEtBQ1gsV0FBSyxVQUNELDhCQUFLLFVBQTBCLGtCQUMvQixrQkFBSyxVQUNELDRCQUFLLFVBQ0Qsa0JBQUMsRUFBTSxVQUVYLGtCQUFLLFVBQ0Qsa0JBQUMsS0FBSyxNQUFPLEVBQU0sMkJDWm5DLGFBd0JBLGFBQXNDLDBCQUF1QyxTQUFnQixFQUU3RixDQXhCQSxnQkFFQSxnQ0FBbUQsV0FBZ0IsZ0JBQXNCLE9BQU8sNkJBQTJCLEdBQTBCLHlDQUF5RCxZQUFpQyxVQUFlLEVBRTlQLE1BRUEsUUFFQSxPQUVBLFFBRUEsT0FFQSxRQUVBLFFBRUEsUUFFQSxhQU1BLGVBQ0EsVUFDQSx1QkFDQSx3REFDQSxFQUNBLHdCQUNBLHFDQUNBLENBRUEsV0FDQSxjQUNBLCtCQUVBLHVCQUNBLGNBQ0EsNkJBSUEsOEJBR0EsdUJBQ0EsaUJBQ0EsbUNBQ0EsRUFFQSxlQUNBLDZCQUNBLENBRUEsZUFDQSxvQ0FFQSx3RUFDQSxFQUVBLEVBZ1FBLEUsa0JBL1BBLDJEQUVBLGdDQUVBLHlDQUNBLGVBRUEsd0NBQ0EsbURBQ0EsTUFDQSw4QkFFQSwyRUFFQSxPQUNBLE9BQ0EsZUFHQSx3QkFDQSxVQUVBLHdDQUVBLG9CQUNBLEdBRUEsVUFFQSwwQkFDQSxNQUVBLGdCQUVBLHlDQUNBLE9BRUEsRUFDQSxTQUVBLGtCQUNBLFFBQ0EsU0FFQSxZQUVBLEtBQ0ssUUFDTCxRQUNBLFdBRUEsZ0RBRUEsb0NBRUEsVUFFQSxRQUNBLEdBQ0EsQ0FFQSxpQkFDQSxJQUNBLEdBQ0EsTUFDSyxTQUNMLFFBRUEsaURBQ0EsQ0FDQSxNQUFvQixvQkFFcEIsUUFFQSxHQUNBLEVBQ0EsQ0FFQSxpQkFDQSxXQU1BLDRDQUVBLGtCQUVBLDBDQUVBLGtCQUVBLGFBRUEsR0FDQSxLQUNBLFNBRUEsSUFHQSxLQUNBLFNBRUEsZUFFQSxXQUNBLDBCQUlBLG9CQXFFQSxpQkFFQSxxRUFDQSxHQUVBLEtBVUEsaUJBQ0EsS0FFQSxHQUNBLHVDQUNLLElBQ0wsMkNBRUEsR0FFQSxFQUVBLFNBK0JBLFVBQ0EsY0FDQSxlQUNBLEdBQ0EsdUJBbElBLGdDQUNBLElBRUEsRUFnSUEsb0JBL0hBLDJCQUVBLHdEQUNBLG1EQUVBLHFEQUNBLElBRUEsNEJBQ0EsV0FDQSxhQUVBLFNBSUEsSUFDQSxLQUVBLDhDQUNBLHNDQUVBLFdBQ0EsT0FFQSxNQUFrQixvQkFDbEIsSUFDQSxzQkFFQSw4RkFFQSxLQUNBLEVBRUEsRUE4RkEsdUJBN0ZBLDJCQUVBLDJEQUNBLHNEQUVBLHFEQUNBLElBRUEsNEJBQ0EsV0FDQSxhQUVBLEdBSUEsUUFDQSxLQUdBLDJDQUVBLDRCQUVBLE9BQWdCLG9CQUNoQixLQUNBLEVBRUEsS0FrRUEsR0FDQSxpQkE1REEsWUFDQSxFQUVBLEVBMERBLG9CQXpEQSxXQUNBLEVBRUEsRUF1REEsZ0JBeENBLDZEQUVBLG1CQUVBLFVBQ0EsU0FDQSxHQUdBLGlCQUNBLE9BQ0EsTUFDQSxVQUdBLElBQ0EsSUFDQSxDQUVBLEVBd0JBLG1CQXZCQSwwQkFDQSxjQUVBLGFBQ0EsS0FDQSxHQUNBLElBQ0EsQ0FFQSxTQWVBLHNCQy9UQSxnQkFDQSxvQixvSEMwQ0EsT0FBZSxTQUNYLFdBQ0EsV0FDQSxJQUNLLGlCQUNELENBQUMsQ0FBRSxjQUNDLFlBQVksRUFBUSxPQUFhLE9BQVMsRUFBTSxFQUFLLE1BQU8sTUFHcEUsSUFDZ0Msa0RBQzVCLENBQUMsQ0FBRSxjQUFhLFdBQTJCLHNCQUN2QyxpQkFBaUIsS0FBUyxJQUFDLGlCQUFPLE1BQU8sRUFBYSxTQUFVLEdBQWMsT0FHdEYsSUFDd0Msc0RBQ3BDLENBQUMsQ0FBRSxXQUFVLFVBQVUsV0FBd0IsbUJBQzNDLGNBQWMsS0FBUyxJQUFDLGlCQUFJLE1BQU8sRUFBVSxRQUFTLEVBQVMsU0FBVSxHQUFjLFFBRzNGLGFBQW9CLEdBQTFCLENBQ0UsQ0FBWSxjQUNSLE9BQ0EsUUFBSyxNQUNELENBQ0EsZ0JBRUosUUFBSyxXQUFhLEtBQUssV0FBVyxLQUNsQyxXQUFLLFNBQVcsS0FBSyxTQUFTLEtBQzlCLFdBQUssU0FBVyxLQUFLLFNBQVMsS0FDOUIsV0FBSyxPQUFTLEtBQUssT0FBTyxLQUM3QixLQUVELENBQWlCLGVBQ2IsTUFBSyxTQUNELENBQ0EsU0FFUCxVQUVELENBQWUsYUFDWCxNQUFLLFNBQ0QsQ0FFSixnQkFBSyxNQUFNLFNBQVMsU0FBYSxFQUNwQyxHQUVELENBQXFCLGVBQ2pCLEVBQUksSUFBUyxLQUFLLFlBQWMsSUFBUyxLQUFLLFlBQWMsSUFBVSxLQUNsRSxvQkFBSyxXQUNMLE9BQUssV0FDTCxPQUFLLFlBQ0wsT0FBSyxNQUFNLFNBQVMsU0FBYSxFQUFNLEVBRTlDLElBRUQsQ0FBbUIsYUFDZixNQUFLLFdBQ0wsVUFBSyxXQUNMLFVBQUssWUFDTCxVQUFLLE1BQU0sU0FBUyxTQUFXLEVBQU0sRUFDeEMsR0FFRCxDQUFPLFNBQU8sQ0FBRSxRQUFPLFVBQ25CLE9BQ0ksWUFBSyxNQUFPLENBQUUsU0FBVSxXQUFZLE1BQU8sRUFBTSxXQUFZLFdBQ3hELE1BQVEsRUFBTSxjQUNYLFdBQUssTUFBTyxDQUFFLFNBQVUsU0FBVSxPQUFRLEVBQUcsSUFBSyxFQUFHLE9BQVEsRUFDekQsbUJBQUMsSUFDRyxTQUFTLEVBQ1Qsa0JBQVcsRUFDWCx1QkFBUSxLQUNSLGdCQUFVLEtBQ1Ysa0JBQVUsS0FDVixvQkFBWSxLQUd2QixpQkFBUyxJQUFDLEtBQVksRUFDdkIsUUFBQyxJQUNHLE1BQU0sRUFDTixlQUFXLEVBQU0sVUFBWSxFQUM3Qiw0QkFBZ0IsRUFBTSxlQUFpQixFQUN2Qyx1QkFBVyxFQUNYLG9CQUFXLEVBRzFCLGVBbEVpQyxpRnZCN0R0QyxHQUVBLEtBQU0sR0FFTixFQUFNLEVBQVksQ0FBQyxDQUFFLGNBQ2pCLFdBQUssTUFBTyxDQUFFLFFBQVMsT0FBUSxTQUFVLFdBQVksT0FDaEQsWUFJVCxHQUFNLEVBQVUsQ0FBQyxDQUFFLFVBQ2YsV0FBSyxNQUNELFVBQ0Esa0JBQ0EsTUFDQSxTQUNBLFFBQU8sRUFBTyxFQUFJLENBQ2xCLFFBQU8sRUFBTyxFQUNkLENBRDJCLFVBTW5DLGdCQUFNLEVBQWdCLENBQUMsQ0FBRSxTQUFRLFFBQU8sT0FBaUIsZUFDckQsV0FBSyxNQUFPLENBQUUsU0FBVSxXQUFZLE1BQU8sRUFBTyxNQUFPLE9BQ3JELGdCQUFDLEdBQU8sT0FBUSxFQUFRLE1BQU8sRUFBTyxLQUFNLEVBQzNDLGFBQU8sZ0JBQWtCLElBQUMsR0FBUSxLQUkzQyxLQUFNLEVBQWMsQ0FBQyxDQUFFLElBQUcsU0FBUSxRQUFrQixlQUNoRCxXQUFLLE1BQU8sQ0FBRSxTQUFVLFdBQXdCLHdCQUFlLENBQW5ELE1BQXlELE1BQU8sRUFBTyxNQUFPLE9BQ3RGLGdCQUFDLEdBQU8sT0FBUSxFQUFRLE1BQU8sRUFBYSxRQUlwRCxZQUFNLEVBQVcsQ0FBQyxDQUFFLFVBQVMsSUFBRyxLQUFJLGFBQVksY0FDNUMsTUFBbUIsTUFBVSxTQUFXLEVBQVMsRUFDakQsR0FBTSxFQUFjLEVBQ3BCLGVBQWEsSUFHVCxNQUFtQixDQUFmLEtBQ0EsTUFBTSxHQUFhLEVBQVEsRUFDM0IsR0FBSSxFQUNBLGtCQUFXLEVBQVcsS0FFN0IsRUFDSixNQUFNLElBQVMsU0FBSSxFQUFTLEVBQVksUUFFckMsRUFBSSxFQUNBLGtCQUFXLEVBQVksS0FFOUIsT0FBTSxJQUFJLEVBQVksYUFFbkIsTUFBa0IsTUFBYyxTQUFjLEVBQVMsRUFDdkQsWUFDSSxFQUFZLEtBQ0UsQ0FBQyxDQUFmLEtBQW1CLEtBQU8sRUFBUSxHQUFXLEtBQzlCLENBQUMsQ0FBaEIsS0FBb0IsS0FBTyxFQUFRLEdBRXZDLE1BQ0ksQ0FDQSx5QkFBZ0IsRUFDaEIsZUFDQSxjQUVQLEVBQ0osQ0FFRCxFQUFNLEVBQVUsQ0FBQyxDQUFFLFVBQVMsSUFBRyxLQUFJLFdBQVUsWUFDekMsTUFBbUIsTUFBVSxTQUFXLEVBQVMsRUFDakQsR0FBTSxFQUFjLEVBQ3BCLE1BQVMsU0FBSSxJQUdULE1BQW1CLENBQWYsS0FDQSxNQUFNLEdBQWEsRUFBUSxFQUMzQixHQUFJLEVBQ0Esa0JBQVMsRUFBVyxLQUFNLFNBQWdCLEVBQVksRUFBVyxNQUFRLEVBRWhGLEdBQ0osTUFBTSxJQUFTLFNBQUksRUFBUyxFQUFZLFFBRXJDLEVBQUksRUFDQSxrQkFBUyxFQUFZLEtBQU0sU0FBZ0IsRUFBYSxFQUUvRCxRQUFNLElBQUksRUFBWSxhQUVuQixNQUFrQixNQUFjLFNBQWMsRUFBUyxFQUN2RCxZQUNJLEVBQVksS0FDRSxDQUFDLENBQWYsS0FBbUIsS0FBTyxFQUFRLEdBQVcsS0FDOUIsQ0FBQyxDQUFoQixLQUFvQixLQUFPLEVBQVEsR0FFdkMsTUFDSSxDQUVQLFVBQ0osQ0FFRCxNQUFlLFNBQ1gsUUFDQSxRQUFPLENBQUUsT0FBUSxhQUNaLGFBQWUsR0FBckIsQ0FDQyxDQUEwQiw0QkFDdEIsQ0FBSSxLQUFLLE1BQU0sVUFBWSxLQUFLLE1BQU0sSUFBTSxFQUN4QyxRQUFLLFNBQVMsRUFFbEIsSUFBSyxFQUFVLFFBQVgsRUFBdUIsS0FBSyxNQUFNLFdBQWEsRUFDL0MsZUFBSyxTQUFTLEVBRXJCLEdBRUQsUUFBTyxDQUFFLFVBQVMsYUFBYSxDQUFFLFNBQVEsZUFBYyxjQUFhLGtCQUNoRSxPQUNLLEtBQUQsRUFDSyxPQUFRLElBQWEsT0FDbEIsSUFBQyxFQUNHLEtBQUssRUFDTCxZQUNBLFFBQ0EsT0FBTSxJQUFVLEVBQVEsT0FDeEIsWUFHUCxRQUNHLElBQUMsRUFDRyxHQUNBLFNBQ0EsUUFDQSxZQUtuQixJQWhDNkIsaUV3QnpHbEMsR0FFQSxLQUFNLEdBQVksQ0FBQyxDQUFFLFNBQVEsY0FBYSxjQUN0QyxXQUFLLE1BQU8sQ0FBRSxTQUFVLFdBQ3BCLHNCQUFLLE1BQU8sQ0FBRSxTQUFVLFdBQVksS0FBTSxFQUFHLE1BQU8sRUFBRyxJQUNsRCxJQUtiLElBQU0sRUFBYSxTQUNmLFNBQWEsU0FBVyxTQUFVLFlBQWEsV0FDakQsQ0FBQyxDQUFFLFNBQVEsUUFBTyxRQUFrQixlQUNsQyxXQUFLLE1BQU8sQ0FDUixlQUFDLEdBQUksTUFBTyxFQUFPLE1BSTNCLFVBQWUsU0FDWCxTQUFpQixHQUFlLE9BQzVCLE1BQWMsTUFBTyxTQUNqQixXQUFXLEVBQ1gseUJBQWdCLEVBQ2hCLHlCQUFXLEVBQ1gsb0JBQVcsRUFBTSxLQUVyQixlQUNJLENBQ0EsUUFDQSxXQUFNLFNBQWUsRUFBTSxLQUFNLEVBRXhDLEdBWkQsR0FhQSxTQUFhLFNBQVcsUUFBUyxNQUFPLE9BQVEsWUFBYSxlQUMvRCxDQUFDLENBQUUsT0FBTSxZQUFXLFlBQVcsUUFBTyxNQUFLLFVBQ3hDLElBQUQsR0FBVyxPQUFRLEVBQUssT0FBUyxFQUFXLFlBQWEsRUFDcEQsS0FBSyxNQUFNLEVBQU8sRUFBTSxHQUFHLElBQVksT0FDcEMsSUFBQyxFQUNHLEtBQUssRUFBSyxFQUNWLFVBQ0EsUUFBTyxFQUNQLFFBQ0EsWUFBVyxzREN6QzNCLE9BQWUsQ0FBQyxDQUFFLE9BQ2QsV0FBSyxNQUNELFVBQ0Esa0JBQ0EsTUFDQSxTQUNBLGFBQ0EsZ0NBQ0EsT0FBWSx3QkFBZSxDQVBuQiwySENDaEIsR0FFQSxJQUFLLGlCQUFpQixhQUFjLEVBQXBDLEdBRXFCLGVBQWEsR0FBbkIsQ0FDWCxDQUFZLGNBQ1IsT0FDQSxRQUFLLEtBQU8sSUFBSyxjQUFjLEVBQU0sT0FDeEMsS0FFRCxDQUEwQiw0QkFDdEIsQ0FBSSxLQUFLLE1BQU0sUUFBVSxFQUNyQixhQUFLLEtBQU8sSUFBSyxjQUFjLEVBQVUsT0FFaEQsTUFFRCxTQUNJLE9BQ0ksWUFBSyxNQUFPLENBQUUsT0FDViwyQkFBTSxRQUFNLE9BQU8sd0JBQXlCLENBQUUsT0FBUSxLQUdqRSxRQWxCdUMsOEVDTjVDLEdBRUEsS0FBTSxHQUFjLFNBRXBCLEtBQU0sRUFBYSxXQUFRLEtBQUssR0FBRyxJQUFXLFFBQzFDLENBQVEscUJBQWdCLENBQ3hCLFFBQ0EsRUFBTyxjQUFVLENBQ2pCLEdBQVEsc0JBQWlCLENBQ3pCLFFBQU0sZ0ZBR1csZUFBaUIsR0FBdkIsQ0FDWCxjQUNJLENBRUEsYUFBSyxNQUNELFdBQ0ksU0FBUyxDQUVELE1BQ0EsT0FBZSxrQkFHZixNQUNBLGNBQ0EsSUFDQSxjQUFnQixtQkFHaEIsTUFDQSxnQkFDQSxHQUNBLGdCQUNBLCtCQUNBLGVBQ0EsSUFBZ0IsbUJBR2hCLE1BQ0EsY0FDQSxJQUNBLGVBQWdCLG1CQUdoQixNQUNBLG1CQUNBLGlCQUNBLGFBQ0EsSUFDQSxnQkFBZ0IsbUJBR2hCLE1BQ0EsVUFHUixpQkFDSSxlQUdSLElBQ0Esb0JBR0osUUFBSyxTQUFXLEtBQUssU0FBUyxLQUNqQyxLQUVELENBQVMsV0FDTCxnQkFBUSxJQUNSLEdBQVEsRUFDSixVQUNBLG9CQUFvQixjQUNoQixNQUFNLEdBQVksU0FBUSxLQUFLLE1BQU0sVUFDckMsUUFBSyxTQUNELENBQ0EsaUJBQU0sU0FBZSxFQUFXLEtBQUssTUFFekMsZ0JBQ0gsS0FFRCxDQUNJLGFBQUssU0FDRCxXQUFXLFNBQVEsS0FBSyxNQUFNLFVBSTdDLE1BRUQsUUFBTyxHQUFJLENBQUUsWUFBVyxRQUNwQixPQUNJLEtBQUMsRUFDRyxlQUNBLG1CQUNBLGlCQUNBLEdBQ0EsdUJBQ0EsMEJBQ0EsT0FDQSxXQUFVLEtBR3JCLFVBMUYyQyw4RUNaaEQsR0FFQSxLQUFNLEdBQWMsU0FFcEIsS0FBTSxFQUNGLFNBQVMsQ0FFRCxNQUNBLGFBQU8sT0FHUCxNQUNBLGFBQU8sT0FHUCxNQUNBLGFBS1osU0FBTSxFQUFhLFdBQVEsS0FBSyxHQUFHLElBQVcsUUFDMUMsTUFDQSxFQUFPLGFBQVMsQ0FDaEIsUUFBTSxnRkFHVyxlQUFnQixHQUF0QixDQUNYLFNBQ0ksT0FDSSxLQUFDLEVBQ0csZUFDQSxtQkFDQSxVQUNBLE9BRVgsR0FUMEMsOERDNUIvQyxHQUVBLEtBQU0sR0FBYyxTQUVwQixLQUFNLEVBQ0YsU0FBUyxDQUVELE1BQ0EsYUFBTyxPQUdQLE1BQ0EsY0FDQSxJQUFZLGVBR1osTUFDQSxhQUFPLE9BR1AsTUFDQSxjQUNBLElBS1osa0JBQU0sRUFBYSxXQUFRLEtBQUssR0FBRyxJQUFXLFFBQzFDLENBQVEscUJBQWdCLENBQ3hCLFFBQ0EsRUFBTyxjQUFVLENBQ2pCLEdBQVEsc0JBQWlCLENBQ3pCLFFBR0osb0ZBQWUsSUFDWCxJQUFDLEVBQ0csZUFDQSxtQkFDQSxVQUNBLE9BQU0sbUVDdENkLE9BQWUsQ0FBQyxDQUFFLFNBQVMsRUFBa0IsaUJBQU8sS0FBaUIsYUFBYyxHQUFkLENBQ2pFLENBQVksY0FDUixPQUNBLFFBQUssTUFDRCxDQUVKLGtCQUFLLFlBQWMsS0FBSyxZQUFZLEtBQ3ZDLEtBRUQsQ0FBWSxjQUNSLE1BQU0sR0FBVSxFQUFVLGNBQWMsd0JBQ3hDLEtBQU0sRUFBUyxFQUFVLFFBQ3pCLEVBQU0sRUFBYyxLQUNoQixHQUNBLHNCQUFNLEdBQUksRUFBRSxRQUNaLEVBQU0sRUFBSyxFQUNYLEdBQUksS0FBSyxNQUFNLFVBQWlCLFNBQUksR0FDaEMsU0FBSyxTQUNELENBQ0EsWUFDQSxLQUdYLEtBQ0QsRUFBTSxFQUFZLEtBQ2QsVUFBUyxvQkFBb0IsWUFDN0IsWUFBUyxvQkFBb0IsVUFDN0IsSUFBSSxLQUFLLE1BQU0sVUFBaUIsU0FBSSxFQUFFLFFBQVUsRUFBVSxHQUN0RCxTQUFLLFNBQ0QsQ0FHWCxhQUNELFdBQVMsaUJBQWlCLFlBQzFCLFlBQVMsaUJBQWlCLFVBQzdCLEVBRUQsQ0FBYyxXQUNWLE9BQ0ksWUFBSyxZQUFhLEtBQUssWUFBYSxNQUNoQyxPQUFDLG1CQUFrQixFQUc5QixJQTNDd0Ysa0VDQTdGLE9BQWUsS0FBUSxLQUFpQixhQUFjLEdBQWQsQ0FDcEMsQ0FBc0Isd0JBQ2xCLE9BQU8sR0FBSyxLQUFLLE1BQ3BCLEVBRUQsQ0FBTyxTQUNILE9BQU8sS0FBQyxFQUNYLEVBUDJELHVFaENDaEUsSUFFQSxLQUNBLE1BQU0sRUFFTixHQUFNLEVBQXFCLE9BQ3ZCLE9BQXFCLFFBQWpCLFFBQU8sSUFDUCxHQUQ2QixLQUFNLEVBQU0sT0FBUyxHQUMzQixHQUFPLEVBQU0sTUFBTSxFQUFHLENBQUMsR0FFbEQsSUFDSCxDQUVELE1BQWUsSUFBTSxTQUNqQixTQUFVLE1BQ04sY0FBYyxFQUFNLGNBQ3BCLFlBQVcsRUFBTSxXQUNqQixXQUFTLEVBQU0sTUFDZixvQkFBYSxFQUFNLE1BQU0sYUFDekIsV0FBVSxFQUFNLE1BQU0sVUFBWSxLQUV0QyxTQUFVLE1BQ04saUJBQWlCLEVBQU0saUJBQ3ZCLGlCQUFjLEVBQU0sY0FBZ0IsT0FFeEMsU0FBa0IsU0FBVyxVQUFXLGlCQUFrQixNQUN0RCxTQUFTLEVBQU0sUUFBUSxJQUFJLEtBQVUsT0FBYyxVQUFJLEVBQ25ELE9BQU8sRUFBVyxFQUFPLE1BQU8sRUFBTSxxQkFHOUMsU0FBa0IsU0FBVyxXQUFZLE1BQ3JDLFNBQVMsRUFBTSxRQUFRLElBQUksS0FBVSxPQUFjLFVBQUksRUFDbkQsVUFBVSxFQUFPLFVBQ2pCLGlCQUFnQixFQUFPLE9BQVMsRUFBRyxFQUFPLFVBQVkseUVpQ3RCN0Qsa0VDWEwsT0FBZSxLQUFZLEtBQWlCLGFBQWMsR0FBZCxDQUN4QyxDQUFZLGNBQ1IsT0FDQSxRQUFNLEdBQWUsT0FBTyxLQUM1QixHQUNBLEtBQU0sRUFBZ0IsRUFBYSxPQUFhLE9BQzVDLFVBQUksR0FBTyxDQUFJLE9BQVMsRUFBUyxHQUFLLEVBQWMsR0FBTSxHQUMxRCxHQUNILENBQ0QsV0FBSyxTQUFXLEVBQWEsT0FBYSxPQUN0QyxVQUFJLEdBQU8sS0FDUCxVQUFjLEdBQ2QsRUFBTyxFQUNWLEVBQ0QsRUFDSCxDQUNKLEtBRUQsQ0FBTyxTQUNILE9BQU8sS0FBQyxtQkFBa0IsRUFBVyxLQUN4QyxVQXBCK0Qsa0VDQXBFLE9BQWUsS0FBVyxLQUFpQixhQUFjLEdBQWQsQ0FDdkMsQ0FBWSxjQUNSLE9BQ0EsUUFBSyxNQUFRLEVBQ2hCLEVBRUQsQ0FBMEIsNEJBQ3RCLE1BQUssU0FBUyxFQUFRLEVBQVcsS0FDcEMsT0FFRCxDQUFjLFdBQ1YsT0FBTyxLQUFDLG1CQUFrQixFQUM3QixHQVo4RCxnRUNDbkUsT0FBZSxJQUFNLEtBQWlCLFNBQ2xDLFNBQWtCLFNBQVcsV0FBWSxNQUNyQyxtQkFBbUIsRUFBTSxRQUFRLE9BQU8sS0FBVSxFQUNsRCwwQkFBZSxFQUFNLFFBQVEsT0FBTyxLQUFVLENBQUMsRUFBTyxZQUFjLENBQUMsRUFDckUsZ0NBQW9CLEVBQU0sUUFBUSxPQUFPLEtBQVUsRUFBTyxpQkFFaEUsS0FDRSxXQUFLLE1BQU8sQ0FBRSxRQUNULFNBQW1DLE1BQTdCLGtCQUFrQixRQUNyQixXQUFLLE1BQU8sQ0FBRSxTQUFVLFNBQVUsT0FBUSxFQUFHLEtBQ3pDLFFBQUMsbUJBQWtCLEdBQU8sUUFBUyxFQUczQywwQkFBQyxtQkFBa0IsR0FBTyxRQUFTLEVBQ2xDLGlCQUFvQyxNQUE5QixtQkFBbUIsUUFDdEIsV0FBSyxNQUFPLENBQUUsU0FBVSxTQUFVLE9BQVEsRUFBRyxNQUN6QyxRQUFDLG1CQUFrQixHQUFPLFFBQVMsRUFBTSx3RkNqQnpELE9BQWUsS0FBaUIsYUFBYyxHQUFkLENBQzVCLENBQVksY0FDUixPQUNBLFFBQUssTUFDRCxXQUNBLGFBQ0EsZ0JBQWUsRUFDZiw2QkFBZ0IsRUFFcEIscUJBQUssSUFBTSxLQUNQLE1BQUssUUFDTCxFQUNJLFFBQUssU0FDRCxlQUFlLEVBQ2YsMkJBQWdCLEVBRzNCLGNBQ0QsT0FBSyxTQUFXLEtBQUssS0FBSyxTQUN0QixXQUFXLEVBQUUsT0FDYixxQkFBWSxFQUFFLE9BRXJCLFlBRUQsQ0FBMEIsNEJBQ3RCLEVBQUksS0FBSyxNQUFNLGdCQUFrQixFQUFVLGVBQ3ZDLEtBQUssTUFBTSxpQkFBbUIsRUFFOUIsaUJBQUksS0FDQSxjQUFLLFNBQ0QsZUFBZSxLQUFLLFFBQ3BCLDJCQUFnQixLQUFLLFFBSXBDLGNBRUQsQ0FBYyxXQUNWLE9BQ0ksWUFBSyxNQUFPLENBQUUsTUFBTyxFQUFNLGNBQWUsT0FBUSxFQUFNLGVBQWdCLFNBQ3BFLGlCQUFVLEtBQ1YsYUFBSyxLQUNMLFNBQUMsbUJBQWtCLEVBRzlCLElBN0NtRCxrQkNIeEQsaUJBQWUsQ0FBYSxTQUN4QixRQUFRLEVBQ0osVUFDSSx1QkFBTyxRQUFjLFVBQUksRUFDckIsUUFDSSxNQUFNLEVBQ04sVUFBTSxFQUNOLFdBQU8sRUFJbkIsYUFDSSxvQkFBTyxRQUFjLFVBQUksRUFDckIsUUFHUixXQUNJLHNCQUFPLFFBQWMsVUFBSSxFQUNyQixVQUdSLE9BQ0ksY0FFWCxJQXhCRCxpQkNBQSxpQkFBZSxDQUFhLFNBQ3hCLFFBQVEsRUFDSixVQUNJLGlCQUFJLEVBQU8sTUFBUSxFQUFPLE1BQ3RCLE1BQU0sR0FDQSxFQUFPLEtBQ1AsRUFBTSxVQUFVLEtBQVEsRUFBSyxPQUFTLEVBQU8sTUFBUSxFQUNyRCxFQUFNLFVBQVUsS0FBUSxFQUFLLE9BQVMsRUFDNUMsYUFBTyxDQUNILEdBQUcsRUFBTSxNQUFNLEVBQUcsR0FBTyxPQUFPLEtBQVEsRUFBSyxPQUFTLEVBQU8sTUFDN0QsR0FBRyxFQUFNLE9BQU8sS0FBUSxFQUFLLE9BQVMsRUFBTyxNQUM3QyxHQUFHLEVBQU0sTUFBTSxHQUFPLE9BQU8sS0FBUSxFQUFLLE9BQVMsRUFFMUQsTUFDRCxPQUVKLE9BQ0ksc0JBQU8sR0FBTSxJQUFJLEtBQ2IsT0FBSSxHQUFLLE9BQVMsRUFDZCxLQUFPLE9BQWMsVUFBSSxFQUNyQixPQUFPLEVBR2YsT0FDSCxDQUVMLE9BQ0ksc0JBQU8sR0FBTSxJQUFJLEtBQ2IsT0FBSSxHQUFLLE9BQVMsRUFDZCxLQUFPLE9BQWMsVUFBSSxFQUNyQixRQUFRLEVBR2hCLFNBQ0gsQ0FFTCxPQUNJLG9CQUFPLEdBQU0sSUFBSSxLQUNiLE9BQUksR0FBSyxPQUFTLEVBQ2QsS0FBTyxPQUFjLFVBQUksRUFDckIsTUFBTSxDQUFDLEVBQUssTUFBUSxPQUF1QixLQUFkLEtBQUssTUFBa0IsUUFBd0IsTUFBZCxLQUFLLE1BRzNFLE9BQUksRUFDQSxLQUFPLE9BQWMsVUFBSSxFQUNyQixNQUdSLE9BQ0gsQ0FFTCxHQUNJLGNBRVgsSUF0REQsd0RDSUEsUUFBZSxDQUFhLFNBQVcsT0FBYyxVQUFJLEVBQ3JELFNBQVMsU0FBZSxFQUFNLFFBQzlCLGVBQWEsU0FBbUIsRUFBTSxZQUN0QyxZQUFVLFNBQWdCLEVBQU0sU0FBVSxvQkNQOUMsaUJBQWUsQ0FBYSxTQUN4QixRQUFRLEVBQ0osVUFDSSxtQkFBTyxRQUFjLFVBQUksRUFDckIsZUFBZSxFQUd2QixXQUNJLGNBRVgsSUFWRCx3Q0NFQSxRQUF5QixPQUNyQixJQUNJLENBREEsR0FBUSxPQUdaLGtCQUFvQixNQUFrQixTQUFXLEVBQ2pELE1BQW9CLENBQ2hCLENBREEsS0FHSixnQkFBSSxJQUFnQixFQUNoQixhQUFPLENBQUMsRUFBUSxPQUFTLEVBQUcsQ0FFaEMsUUFBTSxHQUFRLEVBQVEsR0FDdEIsWUFBSSxHQUFpQixFQUNqQixFQUFPLENBQUMsRUFBYyxFQUNuQixHQUFJLElBQWdCLEVBQVEsT0FDL0IsRUFBTyxDQUFDLEVBQWEsQ0FFckIsR0FBTyxDQUFDLEVBQWEsRUFFNUIsRUFuQkQsaUJDRkEsaUJBQWUsQ0FBSSxPQUFpQixPQUNoQyxFQUFLLEtBQUssS0FBTyxFQUFNLEtBQVMsRUFBVSxvQ0NEdEIsU0FBVyxLQUMvQixPQUNJLEVBREEsS0FBTSxPQUNDLEtBR1gsRUFDSSxDQURBLEtBQU0sT0FDQyxFQUdYLEdBQU8sRUFBTSxPQUFXLE9BQU0sQ0FBSSxPQUFTLEVBQUUsRUFBRSxHQUNsRCxJLDhCQ1ZELEtBQU0sR0FBUSxJQUFNLE9BQU8sT0FFM0IsTUFBTSxFQUFTLEtBQU8sT0FBTyxLQUFLLEdBQUssT0FBYSxRQUFTLEVBQUksRUFBSSxJQUFRLEVBQUssR0FFbEYsS0FBTSxFQUEwQixLQUM1QixJQUFJLEdBQ0osUUFBTyxJQUNJLFFBQ0gsTUFBYSxVQUFrQixDQUMvQixTQUNBLEVBQUksRUFBRSxJQUNGLFVBRVAsRUFDSixDQUNKLENBRUQsRUFBTSxFQUFxQyxTQUN2QyxNQUFNLEdBQ04sUUFBSyxHQUFJLEdBQUksRUFBTyxFQUFJLEVBQU0sRUFBRyxHQUM3QixFQUFJLElBQ0EsT0FBSyxHQUFLLEVBR2xCLFVBQ0gsRUFFRCxFQUFNLEVBQWlDLFNBQ25DLE1BQU0sR0FDTixJQUFNLEVBQWMsRUFBdUIsRUFDM0MsUUFBSyxHQUFJLEdBQUksRUFBTyxFQUFJLEVBQU0sRUFBRyxHQUN6QixFQUFFLElBQ0YsT0FBSyxHQUdiLFdBQ0gsRUFFRCxNQUFlLENBQUMsRUFBMkIsVUFDdkMsTUFBTSxHQUFZLEVBQWlCLEVBQVUsRUFDN0MsR0FBTSxFQUFZLEVBQWEsRUFBVyxFQUMxQyxTQUFPLFFBQU8sT0FBTyxJQUFTLEVBQ2pDLEVBSkQsaUI5Q3RDQSxpQkFBZSxDQUFDLENBQUUsWUFBVyxpQkFBZ0IsWUFBVyxlQUNwRCxJQUNJLENBREEsR0FHSixpQkFBTSxHQUFjLEtBQUssS0FBSyxFQUM5QixHQUFNLEVBQWtCLHNCQUFzQixTQUFJLEVBQUcsR0FBYSxHQUNsRSxHQUFNLFdBQWUsRUFBVyxDQUFDLEVBQWEsR0FFOUMsR0FBTSxFQUFhLFNBQUksRUFBRyxFQUMxQixDQURnQyxVQUN6QixDQUFDLEVBQ1gsRUFWRCw4QitDQUEsS0FBTSxHQUEyQixPQUM3QixFQUFRLE1BQU0sS0FBb0UsQ0FFdEYsQ0FGNEIsS0FBSSxFQUFPLE1BQU0sY0FBYyxRQUFRLEVBQU8sU0FFcEUsRUFBMkIsU0FDN0IsT0FBSSxHQUFFLEVBQU8sUUFBVSxFQUFFLEVBQ3JCLE1BRUosRUFDSSxLQURBLEtBQU8sS0FDQSxFQUFFLEVBQU8sTUFBUSxFQUFFLEVBQU8sTUFBUSxDQUFDLEVBRTlDLEVBQU8sRUFBRSxFQUFPLE1BQVEsRUFBRSxFQUFPLE1BQVEsQ0FBQyxFQUM3QyxDQUVELE1BQTJCLE9BQ3ZCLE1BQU0sR0FBa0IsRUFBVSxRQUFRLE9BQU8sS0FBVSxFQUMzRCxRQUFNLEVBQWUsRUFBVSxRQUFRLEtBQUssS0FBMEIsS0FBaEIsS0FBTyxNQUM3RCxNQUQrRSxLQUFPLE1BQ2hGLEVBQ0EsRUFBZ0IsT0FDaEIsRUFBSyxPQUFPLEtBQVMsRUFBbUIsRUFBTyxJQUVyRCxFQUFNLEVBQ0EsRUFDQSxFQUFTLFFBQVEsS0FBUyxPQUFNLEVBQWtCLEVBQUcsRUFBRyxJQUU5RCxRQUNILEVBWkQsaUJDYkEsaUJBQXdCLE9BQWUsU0FBUyxTQUFJLEVBQU8sVUFBWSxFQUFHLEdBQVEsRUFBTyxVQUFZLHlCQ0FyRyxhQW1CQSxhQUNBLFNBQ0EsVUFDQSxzQkFRQSxzRkFDQSxFQXNDQSxhQUNBLDZDQUNBLE1BRUEsaUJBQ0EsUUFFQSxRQUFxQixFQURyQixJQUM4QixLQUM5QiwrQkFDQSxZQUVBLGtCQUNBLElBL0VBLGFBK0JBLFdBRUEsdUJBQ0EsSUFqQ0EsY0FtQ0EsV0FDQSxTQUVBLGlCQURBLE1BR0EsaUJBR0EsYUFFQSxRQUVBLFlBQW9CLElBQU8sVUFDM0IsNkZBQ0EsV0FDQSxpQkFDQSxnQkFHQSxZQUNBLHNEQUNBLFNBQ0csT0FDSCwrRUFDQSxTQUNBLGdCQUdBLE9BQ0EsR0EvREEsRUFFQSxjQTZFQSxXQUNBLGFBRUEsV0FDQSxJQUNBLEdBQ0EsT0FHQSxjQUEwQyxFQVAxQyxJQU9vRCxLQUNwRCx5QkFJQSxVQUNBLGFBQ0EsV0FDQSxRQUNBLFlBQ0csTUFDSCx5QkFDQSxXQUNBLFNBQ0EsY0FDQSxZQUdBLFlBRUEsVUFDQSxLQXRHQSxPQUpBLE1BQ0Esc0NBRUEsOEZBQ2tDLFNBQVMsRUFDM0MsV0FDQSxzQkFDQSxFQUVBLHdCQUNBLHlDQ2pCQSwwQkErREEsWUFDQSxVQUNBLG9CQUNBLFdBQ0EsV0FFQSxpQkFDQSxRQUNBLHdCQUVBLHVDQUVBLHVDQUNBLG1CQUdBLFlBQ0EscUJBRUEsZUFHQSxJQUNBLEVBVUEsQ0FFQSxvQkFDQSw2Q0FDQSx1QkFJQSwyQkFDQSxJQUNBLDZCQUNBLE9BR0EsbUZBQ0EsR0FDQSxxQkFDQSxJQVVBLHVCQUNBLElBQ0Esd0NBR0EsNkZBQ0Esd0JBR0EsSUFDQSw0QkFHQSxTQUNBLEdBU0EsQ0FrQkEsY0FDQSxJQUNBLHdDQUNHLDRDQUNILDBCQUVBLHdDQUVBLHVCQUNBLFVBQ0EsSUFDQSxXQUVBLElBSUEsaUJBS0EsSUFKQSxxQ0FDQSxrQkFFQSxHQU1BLENBS0EsaUJBQ0EsTUFDQSxtQkFDQSxZQUNBLCtCQUFtQixLQUFVLEdBQzdCLFlBR0EsUUFDQSxHQUlBLENBV0Esb0JBQ0EsMEJBQ0EsY0FHQSxzQkFDQSx3QkFHQSxxREFDQSxtQkFFQSx1QkFFQSxnQkFJQSxtQkFHQSxLQUNBLEdBRUEsaUJBQ0Esc0JBQ0EsdUJBQ0EsZUFBaUIsS0FBWSxPQUM3QixTQUVBLGlCQUNBLElBRUEsdUJBQ0EsT0FFQSwrQkFDQSx3QkFHQSx3REFDQSx3QkFHQSxzREFDQSwyQkFDRyxJQUNILDhCQUVBLHlCQUdBLE1BRUEsd0JBQ0Esa0JBR0EsbUJBRUEsSUFDQSxHQUVBLGlCQUNBLG1CQUNBLFFBQ0EsOEJBRUEsSUFDQSxlQUdBLG1CQUNBLElBQ0EsR0FFQSxPQUNBLElBQ0EsNkVBQ0EsNENBQ0EsYUFFQSxRQUdBLGlDQUNBLHFCQUVBLEtBRUEscUJBQ0Esc0ZBRUEsY0FHQSxRQUNBLHlCQUNBLDJFQUVBLGdCQUNBLE1BcUZBLGlCQUNBLGVBQ0EsY0FFQSwyQ0FDQSw2RUFDQSx3QkFFQSxXQUNBLDRCQUdBLGNBQ0EsdUJBR0EsR0FFQSxPQURBLGdCQUVBLFFBQ0EsWUFDQSxhQUNBLGVBQ0EsUUFDQSxXQUNBLFFBQ0EsMEJBQ0EsV0FDQSxXQUNBLFlBQ0EsY0FDQSxpQkFDQSxVQUNBLGtCQUNBLE1BQ0EsdUJBQ0EsT0FDQSw0QkFDQSxrQkFDQSxjQUdBLFFBR0Esb0JBQ0EsSUFTQSx3QkFDQSxXQUlBLFdBQ0EsYUFHQSw0QkFDQSxrQkFHQSxRQUNBLFlBSUEsWUFDQSxRQUVBLE1BQ0EsU0FHQSxlQUdBLGlCQUNBLFFBQ0Esd0JBRUEsUUFDQSxXQUNBLHlCQUVBLFFBQ0EsMEJBRUEsUUFDQSxhQUNBLDJCQUVBLFFBQ0EsMEJBRUEsUUFDQSxXQUNBLFlBQ0EsY0FDQSw2QkFFQSxJQUNBLHVEQUNBLGVBQ0EsY0FHQSxPQUdBLENBR0Esb0JBQ0EsV0FDQSxjQUNBLFdBQ0EsR0FrSUEsMEJBRUEseUJBR0EsS0FDQSx3QkFDQSxNQUNHLEdBQ0gsaUJBQ0csWUFDSCxvQkFFQSxnQkFDQSxTQUVBLHdCQUlBLHVCQUNBLGtCQUNBLGNBQ0EsZUFDQSxDQUFHLFNBQ0gsY0FDQSxjQUlBLEtBQ0EsbUNBSUEsZ0JBRUEsVUFDQSxnQkFFQSxnQkFDRyxPQUNILCtCQUNBLE1BQ0EscUJBQ0EsZ0RBQ0EsMkNBRUEsZ0RBR0Esb0JBR0Esd0JBQ0Esd0NBRUEsMEJBQ0EsbUJBbUJBLE9BQ0EsVUFFQSx1QkFFQSxHQUVBLFFBekJBLFFBQ0EsYUFFQSxVQUNBLHlCQUNBLDJCQUNBLCtDQUNBLGlCQUNBLG1CQUVBLEtBQ0EsTUFDQSxNQUNBLE1BQ0EsQ0FHQSxJQVNBLFVBQ0EsU0FDQSxTQUF3QixNQUFlLEdBQ3ZDLHNDQUNBLG9CQUlBLFFBR0Esc0JBTkEsMkJBRUEsRUFLQSwyQkFDQSxPQUF3QixHQUFRLFdBQ2hDLFFBQ0EsVUFBcUIsS0FBZSxHQUNwQyxpQ0FDQSxDQUNBLE1BQ0EsS0FFQSxhQUNBLEdBR0EsUUFDQSxFQWNBLHVCQUNBLFNBQ0EsbUJBQ0EsR0FDQSxRQUdBLE1BQ0EsUUFLQSxRQVBBLGFBUUEsc0NBRUEsNEJBQ0EsVUFFQSxjQUFpQixRQUFZLFFBQzdCLGtDQUNBLG9CQUNBLGNBQ0EsRUFDQSxPQUNBLElBRUEsdUJBQ0EscUNBQ0EsSUFFQSx1QkFDQSx3QkFDQSxJQUVBLHVCQUNBLG1CQUNBLElBRUEsdUJBQ0Esd0JBQ0EsSUFFQSx1QkFDQSxxQ0FDQSxJQWlGQSxvQkFDQSx3QkFDQSx3QkFFQSxpQ0FFQSxLQUVBLG9CQUNBLHVCQUNBLFdBRUEsVUFDQSxVQUNBLFdBQ0EsT0FDQSxlQUNBLFNBQ0EsU0FDQSxFQUVBLGVBQ0EsY0FFQSxHQUVBLEdBREEsR0FFQSxZQUdBLElBQ0EsZ0JBQ0EsR0FDQSw4QkFDQSxNQUNBLFlBSUEsTUFDQSxnQkFDQSxZQUNBLGtCQUNBLDBDQUNBLDBCQUNBLGVBSUEsTUFDQSxnQkFDQSxZQUNBLFlBQ0EsaUNBQ0Esc0RBQ0EsZ0JBQ0EsZ0JBSUEsWUFFQSxDQUdBLGNBQ0EsU0FDSyxHQUVMLGVBQ0EsY0FDQSw2QkFHQSxpQkFDQSxRQUNBLEVBRUEsVUFDQSxHQUlBLENBR0EsY0FDQSxXQUNBLGNBQ0EsMkNBSUEsZUFDQSxNQUNBLEtBQ0EsNEJBQ0EsTUFDQSx1QkFHQSxXQUNBLElBRUEscUJBQ0EsUUFDQSx5QkFFQSxlQUFxQixNQUFTLEdBQzlCLDZCQUVBLGtCQUNBLElBRUEscUJBQ0EsUUFDQSx5QkFFQSxlQUFxQixNQUFTLEdBQzlCLGdDQUVBLFdBQ0EsSUFFQSxxQkFDQSxXQUVBLHdCQUNBLDJCQUVBLGVBQ0EsTUFBcUIsTUFBUyxHQUM5QixlQUVBLFdBQ0EsSUFFQSxxQkFDQSx3QkFDQSxPQUNBLE1BQWlCLFFBQWtCLFdBQ25DLGlDQUVBLG9CQUNBLElBeUNBLHFCQUNBLHVDQUNBLHVEQUNBLHlDQThKQSw4QkFDQSx3Q0FDQSxvRkFDQSw2RUFDQSxzQkFpREEsd0JBQ0Esb0JBQ0EseUNBQXVELE1BQU8sR0FDOUQsbUNBQ0EsT0FFQSxlQTRCQSx3QkFDQSx5QkFDQSx5Q0FBdUQsTUFBTyxHQUM5RCxlQUVBLHdCQWlKQSx3QkFDQSx5Q0FDQSxtREFDQSxzQkFFQSwyQkFDQSxPQUNBLHlDQUVBLGdEQUNBLE1BQ0EsRUFVQSwyQkFDQSxPQUNBLDBDQUVBLGlEQUNBLE1BQ0EsRUErSEEsZUFFQSx5QkFFQSxzQkFFQSxRQUNBLG9CQUVBLFVBQ0EsSUFFQSxlQUNBLG1CQUNBLCtCQUNBLElBRUEsZUFDQSw4QkFDQSxnQkFDQSxJQUVBLGtCQUNBLFFBQ0EsdUJBRUEsVUFDQSxLQUVBLFNBQWlCLEVBSmpCLE1BSTZCLFFBQzdCLHFCQUdBLHVCQUVBLFFBRUEsYUFFQSw2QkFDQSxLQUNBLFFBQVMsbUJBRVQsNkJBQ0EsS0FDQSxRQUdBLElBRUEsR0FDQSxRQUdBLGFBQ0EsNkJBQ0EsUUFDQSxHQUNBLFFBR0EsNEJBQ0EsS0FBSyxLQUVMLGlDQUdBLFdBR0EsWUFDQSxjQUNBLGNBQ0EsR0FBSyxpQkFDTCxjQUNBLFNBQ0EsS0FDQSxVQUVBLFVBQUssa0JBQ0wsY0FDQSxTQUNBLEtBQ0EsV0FDQSxhQUVBLFVBQUssb0JBQ0wsY0FDQSxTQUNBLEtBQ0EsV0FDQSxjQUNBLGFBRUEsVUFDQSxzQkFFQSxxQkFFQSxPQUNBLElBRUEsZUFDQSxRQUNBLFVBQWlCLFFBQWdCLE9BRWpDLGFBRUEsNkJBQ0EsSUFFQSxrQkFDQSxRQUVBLFVBQWlCLFFBRGpCLFNBQ2lDLFVBR2pDLFdBRkEsc0JBR0EsV0FDQSxRQUNBLFlBQ0EsWUFHQSxVQUNBLElBRUEsZUFDQSwwQkFDQSxLQUVBLHdCQUNBLFlBQWlCLEtBQVksK0JBRTdCLFFBREEsa0JBR0EsVUFDQSxJQUVBLGVBQ0EsYUFDQSxHQXB2REE7Ozs7O0dBRUEsU0FDQSxTQUNBLGFBRUEsV0FDQSxhQW9UQSxZQUNBLFlBQ0EsUUFFQSxZQUNBLEtBeFRBLG9CQXlCQSxHQUNBLHdCQUNBLDZCQVFBLFVBQ0EsSUFDQSx1QkFDQSx3QkFBcUIsNkNBQW1ELFVBQ3hFLEdBQ0EsZUFDQSxnQ0FDQSwrQkFBRyxVQUNILENBQ0EsUUFDQSxFQWJBLEtBSkEsb0JBS0EsaUJBa0VBLFdBRUEsS0FDQSx1QkFDQSx1QkFDQSxVQUNBLElBMEJBLHlCQUNBLHFCQUNBLEdBRUEsSUFDQSx1REFDQSxzQkFDQSw4Q0FDQSw2QkFFQSwwQ0FDQSxPQUNBLEtBR0EsbUJBOEJBLDBCQUNBLHFCQUNBLEtBZ0JBLDBCQUNBLGVBQ0EsR0FHQSxFQUNBLDhCQUNBLGVBQ0EsS0FnSEEsdUJBQ0EsdUJBQ0EsWUFFQSx5QkFDQSxpQ0FDQSx3QkFHQSw4Q0FFQSxpQkFDQSxhQUVBLDJCQUF1QyxPQUFTLEdBQ2hELHdCQUNBLE9BQ0EsVUFDQSxJQUNBLEtBR0EsZUFDQSxRQUNBLEVBQ0EsR0FFQSx5QkFDQSxnQkFDQSxtQkFDQSxVQUNBLFdBQ0EsWUFDQSxZQUNBLGFBQ0EsYUFDQSxhQUNBLFdBQ0EsWUFDQSxjQUNBLFdBQ0EsU0FDQSxRQUVBLFlBRUEsd0JBQ0EsUUFDQSx3QkFHQSxrREFDQSw2QkFHQSxNQUNBLE9BQ0EsbUJBQ0EsS0FBZSxRQUFpQixPQUNoQyxnQkFJQSw0QkFDQSxPQUNBLFNBQWEsUUFBaUIsWUFDOUIsV0FDQSxtQkFDQSx3QkFFQSwwREFDQSxXQUNBLE1BQ0EsT0FDQSxLQTZDQSxlQTBFQSx5QkFRQSw2QkFDQSxhQUNBLFVBQ0EsNkJBRUEsd0RBQWlCLEtBQVMsT0FDMUIsZUFFQSxTQUNBLE9BRUEsNkJBQ0EsYUFDQSxVQUNBLDZCQUVBLHdEQUFpQixLQUFTLE9BQzFCLGVBQ0Esa0JBRUEsU0FDQSxPQUVBLDZCQUNBLGFBQ0EsVUFDQSw2QkFFQSx3REFBaUIsS0FBUyxPQUMxQixlQUNBLGtCQUNBLGtCQUNBLGtCQUVBLFNBQ0EsT0FFQSwrQkFDQSxRQUNBLDJCQUNBLGlDQUNBLGlCQUNBLFlBRUEsK0JBQ0Esd0NBQ0EsMkNBQ0EsSUFDQSx3QkFFQSw4QkFDQSxRQUNBLFFBQ0Esd0JBQ0Esb0RBQWtELGNBQ2xELDBCQUVBLHdCQUNBLEtBRUEsNENBQ0EsZ0JBQ0Esd0JBR0EsZ0NBQ0EsaUJBRUEsR0FDQSw4QkFFQSxHQUNBLGlCQUVBLEdBQ0Esc0JBR0EsMENBQ0EsNEJBR0EscUNBQ0EsU0FFQSxVQUNBLFVBRUEsU0FDQSxTQUdBLFlBQ0EsUUFDQSxRQUNBLFFBRUEsa0JBRUEsaUJBQ0EsU0FDQSxrQkFFQSxxQkFDQSxtQkFFQSxPQUFpQixLQUFTLEdBQzFCLHdCQUNBLE9BQ0EsVUFDQSxJQUNBLEtBR0EsZUFDQSxRQUNBLEVBQ0EsQ0FVQSxFQWtIQSx1Q0FDQSxRQUNBLDRCQUVBLHNDQUNBLHFCQUNBLFFBRUEsMENBQ0EscUJBQ0EsUUFpREEsdUNBRUEsSUFDQSxlQUNBLGVBQ0EsVUFFRyx1QkFDSCx1QkFDQSxXQUNBLFVBRUcsbUJBQ0gsUUFDQSxXQUNBLFNBQ0EsbUJBRUEsYUFDQSxHQUlBLHlCQUNBLE9BSUEsOEZBQ0EsZ0NBRUEsdUNBQ0EsNEJBR0Esa0RBRUEsUUFFQSxPQURBLGdCQUVBLFFBQ0EsMEJBRUEsUUFDQSxXQUNBLDRCQUVBLFFBQ0EsNEJBRUEsUUFDQSxhQUNBLDZCQUVBLFFBRUEsNkJBRUEsUUFDQSxXQUNBLFlBQ0EsY0FDQSwrQkFFQSxJQUNBLHVEQUNBLGVBQ0EsY0FHQSxTQUVBLDZCQUNBLE9BQ0EsTUFDQSx5REFFQSxLQXNGQSxZQThEQSxpQ0FDQSxhQUNBLFlBQ0EsdUJBRUEsR0FDQSxVQUNBLGFBQ0csT0FDSCxRQUdBLElBQ0EsVUFDQSxhQUNHLE9BQ0gsUUFHQSxlQUVBLE9BQ0EsU0FDQSx3Q0FDQSxtQkFDRyxjQUNILFdBQ0EsWUFDQSxzQkFBbUIsS0FBYyxHQUNqQyxvQkFFQSxHQUVBLE9BQ0EsR0FJQSxFQU1BLHlDQUNBLEtBQ0EsTUFDQSxvQkFFQSx3QkFDQSxPQUNBLEtBQ0EsZ0JBQ0Esc0JBR0EsU0FDQSxLQUVBLHlDQUNBLEtBQ0EsTUFDQSxFQUNBLGtCQUdBLDJCQUNBLFNBQ0EsYUFDQSx3QkFHQSxTQUNBLEtBRUEscUNBQ0EseUJBQ0EsYUFDQSxLQUVBLHdDQUNBLHlCQUNBLDZCQUNBLEdBRUEsd0NBQ0EseUJBQ0EsNEJBQ0EsSUFFQSx3Q0FDQSx5QkFFQSxjQUNBLGdCQUNBLGNBQ0EsSUFDQSxxQkFFQSx3Q0FDQSx5QkFFQSxRQUNBLCtCQUNBLGVBQ0EsVUFDQSxLQUVBLHdDQUNBLEtBQ0EsTUFDQSxvQkFFQSx3QkFDQSxPQUNBLEtBQ0EsZ0JBQ0Esc0JBRUEsY0FFQSw4QkFFQSxLQUNBLElBRUEsd0NBQ0EsS0FDQSxNQUNBLG9CQUVBLG1CQUNBLE1BQ0EsYUFDQSxpQkFDQSx3QkFFQSxjQUVBLDhCQUVBLEtBQ0EsSUFFQSxvQ0FDQSx5QkFDQSxzQkFFQSx3QkFEQSxLQUdBLHVDQUNBLGtCQUNBLG9DQUNBLGdDQUNBLElBRUEsdUNBQ0Esa0JBQ0Esb0NBQ0EsZ0NBQ0EsSUFFQSx1Q0FDQSx5QkFFQSxhQUNBLGdCQUNBLGNBQ0EsZUFDQSxJQUVBLHVDQUNBLHlCQUVBLGtCQUNBLGVBQ0EsZUFDQSxVQUNBLElBRUEsdUNBQ0EseUJBQ0EsOEJBQ0EsSUFFQSx1Q0FDQSx5QkFDQSw4QkFDQSxJQUVBLHdDQUNBLHlCQUNBLDhCQUNBLElBRUEsd0NBQ0EseUJBQ0EsOEJBQ0EsSUFRQSw2Q0FDQSxRQUNBLE9BQ0EsTUFDQSxNQUNBLHlCQUNBLHNCQUNBLEVBRUEsUUFDQSxLQUNBLGVBQ0EscUJBQ0Esa0JBR0Esb0JBQ0EsSUFFQSw2Q0FDQSxRQUNBLE9BQ0EsTUFDQSxNQUNBLHlCQUNBLHNCQUNBLEVBRUEsV0FDQSxLQUNBLGtCQUNBLHFCQUNBLGtCQUdBLG9CQUNBLElBRUEseUNBQ0EsWUFDQSxPQUNBLDBCQUNBLHlDQUNBLGNBQ0EsVUFDQSxHQVVBLDRDQUNBLFlBQ0EsT0FDQSw0QkFDQSxLQUNBLDhCQUNBLHVCQUVBLGNBRUEsVUFDQSxHQUVBLDRDQUNBLFlBQ0EsT0FDQSw0QkFDQSxLQUNBLG1DQUNBLGFBRUEsbUJBRUEsVUFDQSxHQVNBLDRDQUNBLFlBQ0EsT0FDQSxpQ0FDQSxLQUNBLHFDQUNBLG1CQUNBLG1CQUNBLFdBRUEsbUJBRUEsVUFDQSxHQUVBLDRDQUNBLFlBQ0EsT0FDQSxpQ0FDQSxLQUNBLG1DQUNBLG1CQUNBLG1CQUNBLGFBRUEsbUJBRUEsVUFDQSxHQUVBLDRDQUNBLFFBQ0EsT0FDQSxNQUNBLHdCQUVBLDBCQUNBLEdBRUEsUUFDQSxLQUNBLEtBQ0EsZUFDQSxxQkFDQSxtQkFDQSx1QkFFQSxlQUdBLDRCQUNBLElBRUEsNENBQ0EsUUFDQSxPQUNBLE1BQ0Esd0JBRUEsMEJBQ0EsR0FFQSxXQUNBLEtBQ0EsS0FDQSxrQkFDQSxxQkFDQSxtQkFDQSx1QkFFQSxlQUdBLDRCQUNBLElBRUEsd0NBQ0EsWUFDQSxPQUNBLDJCQUNBLDJDQUNBLHNCQUNBLFlBQ0EsVUFDQSxHQUVBLDJDQUNBLFlBQ0EsT0FDQSw2QkFDQSxTQUNBLDhCQUNBLHVCQUVBLGNBRUEsVUFDQSxHQUVBLDJDQUNBLFlBQ0EsT0FDQSw2QkFDQSxTQUNBLG1DQUNBLGFBRUEsbUJBRUEsVUFDQSxHQUVBLDJDQUNBLFlBQ0EsT0FDQSxrQ0FDQSxjQUNBLDhCQUNBLHVCQUNBLGtCQUNBLG1CQUVBLGVBRUEsVUFDQSxHQUVBLDJDQUNBLFlBQ0EsT0FDQSxrQ0FDQSxvQ0FDQSxLQUNBLG1DQUNBLG1CQUNBLG1CQUNBLGFBRUEsbUJBRUEsVUFDQSxHQWVBLDJDQUNBLHlCQUNBLEtBRUEsMkNBQ0EseUJBQ0EsS0FVQSw0Q0FDQSx5QkFDQSxLQUVBLDRDQUNBLHlCQUNBLEdBRUEsRUFDQSxzQ0FDQSxZQUNBLHdCQUNBLDhCQUNBLGdCQUNBLG9CQUdBLGtCQUNBLDJDQUdBLE1BQ0EsMEJBRUEsMkVBQ0EsMERBR0Esb0RBQ0Esd0JBQ0EscUJBR0EsY0FDQSxHQUVBLDJCQUVBLGFBQXFCLEVBQVEsTUFDN0IsdUJBRUcsdUJBRUgsMkJBQWUsS0FBUyxHQUN4Qix1QkFHQSxrQ0FDQSxLQUNBLHVCQUNBLElBSUEsVUFDQSxHQUtBLEVBQ0Esc0NBRUEsd0JBQ0EsSUFDQSx3QkFDQSxNQUNBLFVBQ0ssUUFDTCx5QkFDQSxXQUVBLHNCQUNBLHNCQUNBLEdBQ0EsWUFFQSxHQUNBLGlCQUNBLHdDQUVBLG1FQUNBLDZDQUVBLEdBQUcsS0FDSCwwQkFJQSwwQ0FDQSx3QkFHQSw2QkFDQSxTQUdBLFlBQ0Esa0NBRUEsVUFFQSxNQUNBLE9BQ0EsMkJBQW1CLE1BQVMsR0FDNUIsY0FFRyxPQUNILG1CQUNBLElBQ0EsbUJBQ0Esa0JBQ0EsY0FBZSxRQUFpQixHQUNoQyx1QkFFQSxHQUVBLE9BQ0EsS0FHQSxFQUVBLDZEQzdtREEsY0FJQSxXQUNBLFlBQXl3QixrdkJBRXp3QixzQkNQQSxjQUlBLFdBQ0EsWUFBNFoscVlBRTVaLHNCQ1BBLGNBSUEsV0FDQSxZQUE0SCxxR0FFNUgsbUJDRkEsYUFHQSxnQ0FDQSwrQkFLQSxPQWNBLEVBQUMsY0FFRCxlQWlDQSx5Q0FDQSxXQUNBLEdBQ0EsRUFFQSxlQUNBLG9CQUNBLGFBRUEsa0JBQ0Esb0JBQ0EsZUFDQSxZQUVBLGVBQ0EsZUFDQSxHQUVBLGVBQ0EscUJBR0EsYUFGQSxnREFLQSxhQUNBLElBQ0EseUJBR0EsK0JBRUEsa0JBQXdDLFVBQVksR0FDcEQsY0FFQSxhQUNBLFVBR0EsR0FFQSxlQUNBLElBRUEsK0NBRUEsR0FIQSxZQUlBLGNBQ0Esa0NBQ0EsVUFDQSxjQUNBLEdBQ0EsR0FDQSxFQUlBLGVBQ0EsSUFDQSxnQ0FDQSxlQUF1QyxXQUFPLFNBQzlDLFlBQ0EsaUNBQ0EsT0FDQSwwQkFDQSxPQUNBLGVBQ0EsUUFFQSxjQUlBLGdCQUNBLDRCQUNBLE9BQ0EsY0FDQSxRQUtBLFlBQ0EsR0FBSyxLQUNMLEdBQ0EsRUFFQSxxQkFDQSxjQUtBLHNCQUNBLDRCQUdBLGdDQW1CQSxnQ0FEQSxnQkFuQkEsRUFzQkEsZ0JBQ0EscURBQTRCLDBDQUM1QixZQUNBLEdBRUEsZ0JBQ0EsZ0JBQ0EsR0FFQSxnQkFDQSwrQkFDQSxLQUVBLFlBMUNBLEtBQ0EsR0FFQSx1QkF3Q0EsY0FDQSxpQ0FDQSxrQkFDQSxlQU9BLHNCQUNBLElBQ0EscUJBQ0EsT0FDUyw4Q0FDVCx5QkFDQSxHQUNBLEtBQ0Esb0NBRUEsU0FFQSx3QkFHQSwwQkFDQSxJQUlBLGVBQ0EseUJBQ0EsaUVBQ0EsY0FBOEIsU0FBZSxNQUM3QyxHQUVBLHFEQUNBLEdBRUEsZUFFQSxnQkFDQSx1QkFDQSxFQUVBLG1CQUNBLFdBQ0EsV0FDQSw2Q0FFQSxJQUVBLG1CQUNBLFFBRUEsZ0JBRUEsd0NBQ0EsMEJBQ0EsSUFFQSx5QkFDQSxJQUNBLHlCQUVBLGlEQUNBLGlCQUNBLGdDQUNBLEVBQ0EsRUFFQSxFQUNBLDZDQUVBLDZDQUNBLG1CQUNBLElBRUEsZUFDQSxFQUNBLDZCQUVBLFVBQ0EsUUFDQSxzRUFFQSxZQUNBLGlCQUNBLDBCQUNBLG9CQUNBLHdCQUNBLFlBQ0EscUJBQ0Esb0NBQ0EseUJBQ0EsdURBRUEsb0JBQ0EsNkJBQ0EsVUFDQSxrQ0FDQSxNQUNBLGNBRUEscUZBQ0EseUJBQ0EsR0FDQSxxQ0FBeUMsU0FFekMsTUFDQSxxQkFHQSxPQUNBLGdDQUNBLHFEQUNBLEtBQ0EsZ0NBQ0EsY0FDQSxXQUNBLHVEQUFxRixnQkFBdUIsV0FDNUcsR0FFQSxJQUNBLEdBV0Esd0JBRUEsbUJBQ0EsUUFFQSwyQkFBZ0QsVUFBWSxHQUM1RCxrQ0FDQSx1QkFHQSxHQUVBLG1CQUNBLG1CQUNBLHdCQUNBLGNBRUEsYUFDQSxHQUNBLFdBQ0EsNEJBRUEsVUFFQSxtQkFDQSwyQkFDQSxHQUVBLG1CQUNBLG1EQUNBLHNEQUNBLEdBRUEseUJBQ0EsaUJBQ0EsK0JBQ0EsWUFFQSxpQkFFQSxXQUNBLEVBRUEsY0FDQSxjQUVBLFVBQ0Esa0JBRUEsV0FDQSxNQUNBLHlCQUNBLHVCQUVBLElBQ0EsNkJBQ0EsaUJBQ0EsSUFDQSxXQUNBLHFCQUVBLGVBRUEsb0JBQ0EsK0JBRUEsMEJBQ0EsSUFFQSxjQUNBLFFBQ0EsNkNBQ0Esc0JBR0EsV0FDQSxnQ0FDQSw0Q0FNQSwwQkFDQSx5QkFFQSxXQUNBLDJCQUVBLHVCQUNBLFlBRUEsY0FDQSwwQkFDQSxhQUNBLEVBRUEsZ0JBQ0EseUNBQ0Esd0JBQWlDLFFBQVMsTUFDMUMsS0FFQSxtQkFFQSxRQUVBLEdBQ0EsZUFDQSxNQUdBLGVBQ0EsT0FDQSxhQUNBLFNBRUEsT0FDQSxtQkFFQSxJQUNBLDBCQUNBLGtCQUdBLFdBQ0Esd0JBR0Esb0JBQ0EsVUFDQSxRQUNBLE1BQ0EsU0FFQSx1QkFDQSxrQkFFQSxJQUNBLFFBQ0EsZ0JBR0EsS0FDQSxNQUNBLGdCQUVBLE9BQ0EsY0FFQSxpQkFDUyxxQkFDVCxrQkFDQSxxQkFFQSxzQkFDQSxNQUVBLFVBQ0EscUZBT0EsZ0JBQ0EsY0FDQSxDQUVBLFVBQ0EsUUFDQSw0Q0FHQSxPQUNBLGVBQ0EsR0FDQSxZQUNBLFVBQXNCLFFBQXNCLFNBQzVDLFVBQ0Esc0NBR0EsV0FDQSxNQUNBLEtBQ0EsWUFFQSxpQ0FDQSwwQkFDQSxNQUVBLHVDQUNBLGdCQUVBLG9CQUNBLFFBQXdCLE1BQWdCLGFBQ3hDLFVBQ0EsZ0JBR0EsVUFDQSxXQUNBLFNBQ0EsWUFDQSxPQUVBLEdBQUssVUFDTCxpQkFDQSx3Q0FDQSxXQUNBLFVBR0EsVUFFQSxHQUNBLENBYUEsa0JBQ0Esd0JBQ0EsVUFDQSxXQUNBLFVBRUEsUUFDQSwyQ0FDQSxhQUNBLG1CQUNBLG1CQUNBLGVBRUEsb0JBQ0EsZUFDQSxNQUVBLEdBQ0EsTUFDQSwwQkFFQSxJQUNBLEVBU0EsZUFDQSwwQkFDQSxrQ0FFQSxrQkFDQSxVQUNXLFVBQ1gsK0JBRUEsWUFDQSxFQUNBLEdBUkEsRUFVQSxxQkFDQSxpQkFDQSxVQUVBLHdCQUNBLHFCQUdBLFNBQ0EsNEJBR0EsaUJBQ0EsTUFNQSxlQUNBLFVBR0EsZ0JBRkEsS0FLQSxTQUNBLGtFQUNBLHlFQUVBLFVBRUEsU0FDQSxnQ0FFQSxTQUNBLE9BQ0Esb0VBQ0EsdUJBQ0EsMEJBRUEsbUJBRUEsdUJBQ0Esd0NBQ0Esb0JBQ0EsYUFDQSxlQUVBLGNBQ0EsNkJBQ0EseUJBQ0EsMkJBR0EsWUFLQSxhQVFBLE9BRUEsVUFFQSwyQ0FDQSw4QkFDQSxHQUtBLGVBaUJBLG9CQUNBLHlCQUNBLElBSUEsSUFucUJBLGVBR0EsS0FDQSxLQUdBLE9BQ0Esa0NBQ0EsZ0NBRUEsa0NBSUEsYUFDQSxhQUNBLG1CQUNBLEtBQ0EsU0FJQSxrQkFRQSwwREFxb0JBLGtCQUNBLGNBQ0EsbUJBQ0EsSUFDQSxzQkE5Q0EsU0FDQSxHQUtBLHFCQXlDQSxJQUNBLGlDQTdCQSxxQ0FDQSw4QkFDQSxLQUVBLElBMEJBLGdDQXpCQSxpQkFDQSxNQUNBLHlDQUE0QyxRQUU1QyxFQUVBLElBb0JBLHdCQW5CQSxVQUNBLEVBRUEsZ0JBaUJBLFlBR0EsYUFDQSxxQ0FDQSw0QkFDQSxrQ0FDQSw0RkFDQSxnQ0FHQSxrS0FDQSxnQ0FFQSxzQkFDQSxXQUNBLHdCQUNBLGFBQ0Esa0JBRUEsdUNBQ0EsV0FDQSx1QkFDQSxZQUNBLGtCQUVBLHdDQUNBLE9BRUEsZ0tBQ0EsVUFDQSxRQUNBLFdBQ0EsdUJBQ0EsR0FFQSxhQUVBLGtDQUNBLHFDQUNBLFdBQ0EsZUFDQSx5Q0FFQSxJQUNBLEVBQ0EsdUNBQ0EsNkNBQ0EsMENBQ0EsbUJBQ0EsV0FDQSxpQkFDQSxvQkFFQSxtQkFDQSxXQUNBLGlCQUNBLHNCQUVBLHdCQUNBLFdBQ0EsaUJBQ0EsMkJBRUEscUJBQ0EsV0FDQSxpQkFTQSxzSEFFQSxpQkFDQSxXQUNBLHdCQUNBLHFCQUNBLGNBQ0EsR0FDQSxpQkFDQSxnQkFDQSxlQUNBLGNBSUEsa0NBQ0EsV0FDQSxnQkFDQSxtQkFFQSwyQkFDQSxXQUNBLGdCQUNBLDhCQUVBLGtCQUVBLG1CQUNBLDhCQUdBLEdBQ0EsQ0FBQyxnQkN2ekJELHFCQUNBLE9BQ0EsNkJBQ0EsQ0FPQSwyT0FDQSxRQUNBLHlDQVdBLHNoQkFDQSxXQUNBLGtCQUNBLENBQU8sT0FDUCxtQkFBTyxPQUNQLG9CQUFPLFNBRVAsd0JBRUEsS0FDQSxXQUNBLGNBQWtCLGFBQ2xCLGVBQ0EsRUFFQSxlQUNBLFdBQ0EsdUJBQ0EsYUFDQSxHQUNBLGlCQUdBLGVBQ0EsR0FDQSxtQkFDQSxrQkFDQSxFQUNBLElBRUEscUNBQ0EsR0FDQSx1QkFHQSw0QkFDQSxDQUNBLDhCQUNBLFdBQ0EsQ0FDQSxXQUNBLGlCQUNBLFNBRUEsZ0NBQ0EsV0FDQSx1QkFFQSxPQUNBLG1CQUNBLGtCQUNBLElBQ0Esc0JBQ0EscUJBQ0EsRUFDQSxPQUFrQixvQkFDbEIsV0FDQSxDQUNBLGlCQUNBLHlCQUNBLGFBQXdCLG1DQUl4QixPQUNBLDRCQUNBLDJDQUNBLDZCQUNBLEdBQ0Esc0JBQ0EsdUJBQ0EsWUFDQSxXQUNBLDJDQUNBLG1CQUNBLGtCQUNBLENBQ0EsV0FDQSxrQkFDQSxDQUNBLE9BRUEsR0FDQSxPQUVBLFdBQ0EsZ0JBQ0EscUJBQ0EsdUJBQ0EsV0FNQSxPQUNBLGVBQ0EsNkJBQ0EsZUFDQSxFQUFlLG1CQUNmLFNBQ0EsbUNBQ0EsaUJBQ0EsRUFBbUIsbUJBQ25CLFNBTUEsc0JBRUEsR0FDQSxXQUNBLHdDQUEyQyxLQUMzQyx1QkFDQSx5QkFBeUMsTUFDekMsSUFDQSxXQUNBLHdCQUNBLEtBQ0EsZ0JBQ0EsdUJBR0EsWUFFQSxRQUNBLE9BRUEsWUFDQSxhQUNBLFdBQ0Esa0NBQXlDLFFBQ3pDLHNCQUNBLG9CQUNBLEVBQVcsY0FDWCxhQUdBLHdCQUNBLGlDQUE4QyxLQUc5Qyx3QkFFQSxTLGlCQ3pLQSxhQUVBLGdCQUNBLGtGQUVBLG1EQUNBLDJFQUNBLEVBRUEseUNBQ0EsaUZBQ0EsRUFFQSxtQ0FDQSx5QkFDQSxHQVNBLGdDQUNBLHdCQUVBLDJJQUVBLHVFQUNBLE9BTUEsNkNBQ0EsUUFDQSxpREFLQSxpREFDQSxRQUNBLGlEQU9BLDJDQUNBLDJCQUNBLHdDLG1CQ3REQSxhQWlCQSxhQUFzQywwQkFBdUMsU0FBZ0IsRUFFN0YsQ0FqQkEsZ0JBQ0EsNENBRUEsZ0NBQW1ELFdBQWdCLGdCQUFzQixPQUFPLDZCQUEyQixHQUEwQix5Q0FBeUQsWUFBaUMsVUFBZSxFQUU5UCxNQUVBLFFBRUEsT0FFQSxRQUVBLCtDQUtBLElBQ0EsU0FFQSxzQ0FDQSxXQUdBLE1BQTBCLEtBRTFCLG9DQUVBLE1BQ0EsaURBRUEsaUJBR0EsS0FDQSwyQ0FFQSxhQUdBLDBDQUdBLFVBRUEsRUFFQSxNQUNBLFNBRUEsbUVBSUEsd0JBTEssVUFNTCxDQUVBLHFDQUNBLDhHQUNBLE0sbUJDOURBLGFBRUEsZ0JBRUEsUUFFQSxNQUVBLFdBQXNDLDBCQUF1QyxTQUFnQixFQUU3RixLQTBFQSxFLGtCQXpFQSxPQUVBLEtBb0NBLFdBNEJBLENBQ0EscUJBaEVBLDZCQUVBLGtEQUVBLFlBQ0EsV0FDQSxLQUNBLENBRUEsRUF3REEscUNBcERBLFlBQ0EsbUNBRUEsRUFDQSxtQkFDQSx5QkFFQSxxQkFFQSxtRkFJQSxTQUVBLE9BQ0EsS0FFQSxNQUVBLEVBaUNBLDBCQTlCQSxJQUVBLGtCQUNBLG1CQUNBLFVBRUEsZ0JBRUEsYUFDQSxDQUNBLDJCQUNBLFlBQ0EsQ0FDQSxFQUNBLENBRUEsRUFnQkEsMEJBZkEseUNBQW1FLElBQWEsRUFDaEYsbUJBR0Esd0JBQ0EsdUJBQ0EsRUFDQSxFQUVBLG1CQzVFQSwwQkFDQSxPQUNBLFVBQ0EsV0FDQSxPQUNBLEtBQ0EsVUFDQSxTQUNBLFFBRUEsR0FLUSxPQUhSLGNBQ0EsT0FDQSxLQUNBLEVBQW1CLDJCQUVuQixHQUdRLGdCQUZSLE9BQ0EsS0FDQSxFQUFtQiwyQkFFbkIsTUFDQSxVQUNHLGNBQ0gsd0JBRUEsdUJBQ0EsTUFFQSxnQ0FDQSxJQUVBLDZCQUNBLFNBQ0EsVUFDQSxXQUNBLE9BQ0Esc0RBQ0EsVUFDQSxTQUNBLHdCQUVBLEVBaUNRLGVBL0JSLGlCQUNBLHVCQUNBLElBRUEsa0NBQ0EsS0FDQSx5QkFDQSxPQUVBLE1BQ0EsU0FFQSxpQkFFQSxHQUNBLFNBQ0EsT0FHQSxRQUNBLEtBQ0EsSUFDSyxHQUNMLDZCQUNBLE1BRUEsbUNBQ0EsS0FJQSxJQUFtQixpQ0FFbkIsR0FFUSxXQURSLEtBQ0EsRUFBa0IsZ0NBRWxCLGFBQ0EsdUJDOUVBLGVBQ0EsZUFHQSxHQUFDLG1CQUE0QixjQVM3QixhQUNBLGFBQ0Esc0JBQ0EsWUFDQSxhQUNBLGdCQUNBLEdBQ0EsYUFDQSw4QkFDQSxHQUNBLGFBQ0EsT0FDQSxxQkFJQSxhQUNBLE9BQ0EsVUFDQSxhQUNBLE9BQ0EsT0FDQSxhQUNBLE9BQ0EsWUFFQSxhQUNBLE1BQ0EsT0FFQSwrQkFDQSxFQUVBLENBc0JBLGVBQ0EsZUFDQSxTQUNBLFlBQ0EsVUFDQSxNQUVBLEdBQ0EsQ0FDQSxDQUNBLFlBQ0Esc0JBQ0EsTUFDQSxhQUNBLGtDQUNBLEdBQ0EsaUJBRUEsYUFDQSxHQUNBLElBQ0EsYUFDQSxvQ0FDQSxVQUNBLG1CQUNBLFdBQStCLE1BQWtCLE9BQ2pELE1BRUEsSUFDQSxFQUVBLElBQ0EsVUFFQSxHQUNBLG1CQUNBLGdCQUNBLDJCQUVBLFVBQ0EsdUJBRUEsd0JBQ0EsT0FDQSxnQkFDQSwyQkFHQSxXQUlBLG1CQUEwQyxvQkFDMUMsaUJBRUEsa0JBQ0EsaUJBQ0EsMkRBQ0EsR0FDQSw0QkFDQSxrQkFDQSxlQUF3QyxZQUN4QyxPQUNBLFdBQ0EsVUFDQSxzREFDQSxNQUNBLFFBQ0EsT0FFQSxXQUNBLFlBQ0EsV0FFQSxTQUNBLFNBRUEsTUFJQSxTQUVBLGNBQ0EsZ0JBQ0EsZ0RBQ0EscUJBQ0EsTUFDQSxVQUNBLFdBQ0EsTUFLQSxtQkFGQSxnQkFHQSxZQUNBLHVCQUNBLFdBRytDLGVBRS9DLHNCQUwrQyw2QkFHL0MsOEJBR0EsY0FDQSxpQ0FDQSxnREFDQSxHQUNBLGtCQUNBLFNBQ0EsdUNBQ0EsVUFDQSxNQUNBLElBRUEsR0FDQSxRQUNBLElBRUEsR0FDQSxDQXRMQSxNQUNBLDBIQUlBLHFDQW9DQSxNQUNBLGtCQUNBLGdCQUNBLG1DQUNBLHFCQUNBLElBQ0EsOEJBQ0EsV0FFQSxPQUFtQixtQkFBMkIsT0FDOUMsZ0JBRUEsSUFLQSxFQUNBLFNBRUEsb0JBMEhBLE1BQ0EsY0FDQSxhQUNBLHFCQUNBLHdCQUNBLHVCQUNBLHVCQUNBLHlCQUNBLGlDQUNBLGlCQUNBLFVBQ0EsOEJBQ0Esd0JBQ0EsaUJBQ0EsVUFDQSxzQ0FFQSxxQkFFQSx1QkFDQSxPQTJGQSxNQTFGQSw4QkFDQSxHQUNBLG1DQUNBLE1BR0EseUJBQ0EsSUFDQSxrQ0FDQSxNQUdBLGtCQUNBLG1CQVVBLFdBVEEsMEJBT0EsUUFHQSxvQ0FDQSxNQUdBLGtCQUNBLG1CQVVBLFdBVEEsMEJBT0EsV0FHQSx5Q0FDQSxHQUNBLHlDQUNBLEdBQ0EsNENBQ0EsQ0FDQSxVQUNBLGdEQUNBLEdBQ0EsMENBQ0EsR0FDQSxzQ0FDQSxHQUNBLHFEQUNBLGNBSUEsZ0JBRUEsc0NBQ0EsZUFDQSxjQUNBLFVBQ0EsaURBQ0EsUUFFQSxzQkFDQSw0QkFBNEMsaUJBQzVDLG9CQUNBLHlCQUdBLHlEQUNBLGlCQUNBLE1BQ0EsK0NBQ0EsUUFDQSw2QkFDQSxvQkFDQSxlQUNBLGlEQUNBLDhCQUNBLHVEQUNBLE1BQ0EsRUFDQSxDQUNBLFVBQ0EsT0FJQSxDQUFDLG1CQzlTRCxlQUNBLGVBR0EsR0FBQyxtQkFBNEIsQ0FHN0IsYUFFQSxhQUNBLHVDQUNBLFFBRUEsYUFDQSxnQkFDQSxHQUNBLGFBQ0EsOEJBQ0EsR0FFQSxhQUNBLCtCQUNBLFdBQ0EsYUFDQSxPQUNBLG1CQUVBLGFBQ0EsT0FDQSxVQUNBLGFBQ0EsT0FDQSxPQUNBLGFBQ0EsT0FDQSxZQUNBLGFBQ0EsT0FDQSxtQkFFQSxNQUNBLENBQ0Esd0JBQ0EsdUJBQ0EsMEJBQ0EsMkJBQ0EseUJBQ0EseUJBcUdBLE1BcEdBLGNBQ0EsaUNBQ0EsMEJBRUEsY0FDQSxtQkFFQSx5SUFDQSxJQUNBLE9BQ0EsT0FDQSxPQUVBLEtBQ0EsaUJBRUEsR0FDQSxlQUdBLGVBQ0EsVUFDQSxFQUNBLE9BQ0EsUUFDQSxJQUNBLFVBQ0EsVUFDQSxJQUNBLFVBQ0EsYUFDQSxLQUNBLFVBQ0EsV0FDQSxLQUNBLE1BTUEsZUFDQSx5QkFDQSxLQUEyQixRQUFxQixPQUNoRCxRQUNBLEdBQ0EsZUFDQSxhQUVBLHVCQUNBLE9BRUEsU0FDQSxjQUVBLE1BQ0EsTUFDQSxJQUVBLGFBQ0EsWUFJQSxHQUVBLGtCQUNBLElBQ0EsTUFDQSxJQUVBLGlCQUNBLElBRUEsU0FLQSx5QkFDQSxLQUE2QixRQUF5QixPQUN0RCxRQUNBLEtBQ0EsS0FDQSxJQUVBLGFBRUEsSUFDQSxnQkFDQSxhQUtBLHNDQUNBLEdBSUMsbUJDcEpELGVBQ0EseUJBR0EsR0FBQyx1QkFBb0QsY0FNckQsaUJBQ0EsV0FFQSxhQUNBLHNCQUNBLGtCQUNBLGdCQUNBLGNBQ0EsTUFDQSxNQUVBLFVBQ0EsbUJBRUEsMkJBQ0EsS0FDQSxpQ0FFQSxJQUNBLHFCQUE4QyxtQkFHOUMsNkJBQ0Esc0RBR0EsY0FDQSxpQkFDQSwwQkFFQSx5QkFDQSxhQUNBLDRCQUNBLFVBT0EsY0FDQSwwQkFDQSxFQUVBLENBUUEsY0FDQSxPQUNBLG1CQUVBLENBQ0EsY0FDQSw4Q0FDQSxPQUNBLGNBQ0EseUNBQ0EsT0FDQSxjQUNBLElBQ0EsbUJBQ0EsSUFDQSxHQUNBLGNBQ0EsZ0NBQ0EsTUFNQSxDQUNBLGNBQ0EsSUFDQSxRQUdBLGtDQUNBLGtCQUNBLFFBQW1CLFFBQXNCLFlBQ3pDLFdBQ0EseUJBQ0EsU0FDQSxTQUNBLE1BQ0Esa0NBQ0EsaUJBR0EsWUFFQSxFQUNBLE9BQ0EsR0FNQSxDQUNBLGlCQUNBLE9BQ0EsaUNBRUEsUUFDQSxFQU9BLENBQ0EsaUJBQ0EsSUFDQSxvQkFDQSxJQUNBLDZCQUdBLFdBQ0EsR0FNQSxDQUNBLGlCQUNBLGtCQUNBLGdCQUNBLHNCQUNBLGlFQUNBLEVBR0EsQ0FDQSxpQkFDQSxtREFDQSxLQUNBLGNBQ0Esa0NBQ0EsSUFDQSxjQUNBLHlCQUVBLDhCQUNBLE9BQ0EsaUJBQ0EsWUFBbUIsV0FBcUIsT0FDeEMsV0FDQSxPQUNBLFNBR0EsWUFHQSxHQUVBLENBK0lBLGlCQUNBLFFBQ0EsVUFDQSxLQUNBLEtBQ0Esd0JBQ0EsSUFFQSwyQkFDQSxXQUNBLFNBQ0EsU0FDQSx5QkFDQSxhQUdBLFVBQ0EsUUFDQSxHQUNBLFFBRUEsV0FDQSxVQUNBLFNBQ0EsU0FDQSxTQUNBLFNBQ0EsU0FHQSxHQUNBLGFBQ0EsT0FHQSxrQkFJQSxVQUVBLFdBQ0EsVUFDQSxnQkFDQSxhQUNBLEdBQ0EsbUJBUkEsU0FTQSxpQkFWQSxTQVdBLGlDQVpBLGNBYUEsdUNBRUEsT0FHQSxjQUNBLHVCQUlBLEtBQ0EsWUFHQSxJQUNBLEVBUUEsQ0FXQSxjQUNBLG9EQUNBLHlDQUNBLGFBQ0EsRUFPQSxDQUNBLGNBQ0Esa0RBQ0EseUNBQ0EsYUFDQSxFQUlBLENBQ0EsY0FFQSxxQkFHQSxXQUFpQixRQUFtQixPQUNwQyxLQUNBLGtFQUlBLDZCQUNBLFlBQ0EsTUFDQSxVQUNBLHNCQUVBLHNCQUFtQixXQUFtQixZQUN0QyxVQUVBLHdCQUNBLEtBRUEsR0FDQSxRQUVBLGNBQ0EsTUFFQSxNQUNBLHdCQUVBLElBQ0EsaUJBR0EsUUFDQSxRQUNBLCtDQUlBLDZCQUNBLFFBQ0EscUdBR0EsUUFDQSxvQkFDQSxTQUVBLHVEQUlBLGdDQUF1QixRQUFrQixZQUN6QyxhQUVBLGtCQUNBLGtIQUdBLHlDQUNBLEVBRUEsQ0FDQSxRQUVBLDRCQUVBLGlCQUNBLDhGQUdBLG1CQUNBLEVBRUEsT0FDQSxHQUNBLENBT0EsQ0FDQSxjQUNBLG1CQUFtQyw2QkFDbkMsT0FPQSxDQUNBLGNBQ0EsbUNBQ0EsT0FRQSxDQUNBLGlCQUNBLGdCQUNBLEdBQ0EsRUFPQSxDQUNBLGNBQ0Esd0JBQ0EsR0FRQSxDQUNBLGtCQUVBLHdCQUVBLGdCQUNBLGNBQW1CLFFBQW1CLE9BQ3RDLGFBQ0EsTUFDQSxVQUNBLGVBQ0EsS0FDQSxZQUNBLFVBQ0EsV0FDQSxvQkFLQSxtQkFDQSxHQVNBLENBQ0EscUJBQ0EsUUFFQSxVQUFpQixRQUFpQixPQUNsQyw4QkFHQSxtREFFQSxpQkFDQSxHQVNBLENBQ0EscUJBQ0EsdUJBQ0EsR0FTQSxDQUNBLHFCQUNBLElBQ0EsTUFBaUMsT0FDakMsR0FHQSxVQUVBLHFCQUNBLGtCQUNBLE9BR0EsTUFBaUIsV0FBbUIsT0FDcEMsY0FFQSxJQUNBLDBCQUNLLFFBQ0wsYUFDQSw0QkFFQSxZQUVBLE9BQ0EseUJBR0EsWUFDQSxZQUNBLGtCQUtBLHFCQUhBLGdCQU1BLFFBQ0EsRUFHQSx3QkFDQSwrQkFNQSxTQUNBLGlEQUdBLGVBQ0EsR0FJQSx1QkFHQSxpQ0FDQSxHQWFBLENBQ0EscUJBQ0EsV0FDQSxNQUFpQyxPQUNqQyxHQUdBLFVBRUEsb0JBQ0EsV0FBa0QsR0FHbEQsT0FDQSxJQUEyQyxHQUE4QixNQUd6RSxJQUEwQyxHQUE4QixNQUN4RSxJQTRCQSxrQkFDQSxVQUNBLG1CQUNBLFdBQ0EsR0FTQSxDQUNBLHdCQUNBLGtCQUNBLHNCQUNBLG1CQUVBLDZCQUNBLGdCQUNBLFdBQTZCLG9CQUM3QixlQUF3QixvQkFDeEIsYUFDQSxZQUNBLGNBQW1CLFFBQW1CLFlBQ3RDLFdBQ0EscUNBQ0EsbUNBQ0EsOEJBQ0Esc0JBQ0EsVUFDQSxpQkFDQSxxQkFDQSxtQkFFQSxPQUNBLG9CQUNBLFVBQ0EsT0FDQSxlQUNBLFVBQ0EsZUFHQSxnQkFDQSxrQ0FDQSxPQUVBLFNBRUEsSUFDQSx5QkFDQSw0QkFDQSxpQkFFQSxXQUNBLFVBQ0EsWUFDQSxXQUVBLEdBQ0EsQ0FDQSxDQU9BLENBQ0EscUJBQ0EsZUFDQSxhQUNBLFdBQ0EsSUFDQSxVQUFrQixrQkFBb0MsS0FBVyxVQUNqRSxjQUNBLEdBQ0Esd0JBQ0EsUUFDQSxTQUVBLG9CQUNBLG9CQUNBLFNBQW1CLFFBQWMsV0FDakMsOEJBRUEsV0FDQSxrQkFDQSxVQUVBLEdBRUEsQ0E2QkEsZUFDQSxLQUNBLHVCQUVBLHdFQUNBLFNBQ0EsZ0JBQ0Esa0JBQ0EsNEJBQ0Esc0JBQ0EsSUFDQSxnQkFDQSxzQ0FDQSxVQUNBLFdBRUEsZUFDQSxXQUNBLDZDQUNBLE1BRUEsRUFDQSxDQTEyQkEsb0NBQ0EsK0JBQ0EsK0JBK0NBLDJEQXlIQSxtQkFDQSxRQUVBLHFCQUNBLDZDQUNBLGFBQ0EsZ0JBRUEsSUFDQSxhQUNBLGdCQUVBLEtBRUEsMEJBQ0Esc0NBQ0Esb0NBQ0EsNkNBQ0EsUUFFQSxhQUNBLFlBQ0EsZ0JBQ0EsY0FDQSxPQUNBLHFDQUNBLElBQXlCLHVCQUN6QixJQUVBLGVBQ0EsWUFDQSxhQUNBLHFDQUNBLElBQThCLHVCQUFzQyxPQUNwRSxxQkFFQSxFQUNBLG1DQUNBLGVBRUEsbUJBQ0EsWUFDQSxnQkFDQSxjQUNBLFdBQ0EsT0FBcUIseUJBRXJCLElBQ0EsOENBQ0EsTUFDQSxXQUNBLHFEQUNBLG1DQUNBLEtBQ0Esa0NBQ0EsV0FDQSxnQkFDQSxjQUNBLDRDQUNBLFlBQ0Esc0JBQ0EsU0FDQSxZQUdBLElBREEsSUFHQSxFQUNBLEVBQUMsRUFFRCxrQkFDQSxtQkFDQSxpQkFDQSxZQUNBLEdBRUEsMEJBQ0Esc0NBQ0Esb0NBRUEsR0FDQSxFQUFDLEVBRUQsbUJBQ0EsbUJBQ0EsaUJBQ0EsT0FDQSxXQUVBLElBRUEsMEJBQ0Esc0NBQ0Esb0NBRUEsR0FDQSxFQUFDLG9DQU9ELE9BQ0Esb0RBRUEsS0FLQSxNQUNBLGlCQXFCQSwrSEFRQSxLQXdZQSxTQW5hQSxFQW9hQSxXQS9UQSxlQUNBLGVBQ0EsSUFPQSxFQXVUQSxvQkFwYUEsRUFxYUEsa0JBOVpBLEdBZ2FBLE9BeGJBLGVBQ0EsV0FBa0IsQ0FBYyxpQ0FDaEMsT0FFQSxlQXFiQSxPQUlBLEdBQ0EsY0FDQSwwQkFDQSw4QkFDQSxnREFDQSw0Q0FDQSx5QkFDQSxPQUVBLFNBTUEsb0JBZ0dBLG1CQUNBLGlCQU1BLEdBRUEsMEJBQ0Esc0NBQ0Esb0NBQ0EsMENBQ0EsT0FDQSwyQkFDQSxVQUNBLHFCQUlBLFdBQ0Esa0NBQ0EsV0FDQSxPQUVBLEVBQ0EsRUFBQyxvQkF5QkQsbUJBQ0EsaUJBQ0Esc0JBQ0Esb0JBQ0EseUJBRUEsSUFFQSwwQkFDQSxzQ0FDQSxvQ0FDQSw2Q0FDQSxRQUVBLFVBQ0Esb0RBQ0Esc0JBQ0EsSUFFQSxHQUNBLHFEQUNBLGVBQ0EsUUFFQSxLQUNBLDhDQUNBLE1BQ0EsZUFFQSxVQUNBLG1DQUNBLGVBQXVCLEtBQ3ZCLElBQ0Esa0NBQ0EsUUFFQSxrQ0FDQSxlQUNBLCtCQUNBLHNCQUNBLFNBQWEsRUFDYixHQUVBLHlCQUNBLHFCQUNBLGdCQUNBLGtCQUVBLFNBRUEsRUFDQSxFQUFDLEVBRUQsR0FjQSxNQWJBLE9BQ0EsY0FDQSxZQUNBLGlCQUNBLFVBQ0EsaUJBQ0EsUUFDQSxFQUNBLFVBbDRCQSxZQUNBLGNBQ0Esc0JBQ0EsV0FnNEJBLEdBSUMsaUJDcDdCRCxlQUNBLEdBR0EsRUFBQyxtQkFBNEIsY0FTN0IsY0FDQSx5Q0FDQSxRQUNBLGNBQ0EsY0FDQSx3QkFDQSxhQUNBLGNBQ0EsaUJBQ0EsSUFDQSxjQUNBLGlDQUNBLElBQ0EsY0FDQSxPQUNBLHNCQUNBLGNBQ0EsaUNBQ0EsWUFDQSxjQUNBLE9BQ0Esb0JBQ0EsY0FDQSxPQUNBLG9CQUNBLGNBQ0EsT0FDQSxXQUNBLGNBQ0EsT0FDQSxRQUNBLGNBQ0EsT0FDQSxhQUNBLGNBQ0EsT0FDQSxvQkFDQSxjQUNBLE1BQ0EsU0FFQSxnQ0FDQSxHQUlBLENBRUEsaUJBQ0EsZUFDQSxHQUNBLEdBQ0EsaUJBQ0EsVUFDQSxhQUVBLGVBQ0EscUJBRUEsSUFDQSxHQUNBLGlCQUNBLHFCQUNBLElBQ0EsR0FDQSx1QkFDQSxDQUFVLFdBQXNCLFlBQ2hDLFdBQ0EsY0FDQSxLQUNBLFNBQ0EsY0FHQSxPQUNBLFNBRUEsNkJBQ0Esd0JBRUEsbUJBQ0EscUJBR0EsU0FFQSxZQUdBLEtBQ0EsRUFDQSxjQUNBLElBS0EsSUFDQSxXQUdBLFFBR0EsbUJBQW1CLFdBQWtCLFlBQ3JDLFVBQ0Esa0JBQ0EseUJBQ0Esc0JBQ0EsSUFDQSxFQUNBLEdBQ0EsS0FDQSxtQkFFQSxvQkFFQSxvQ0FDQSxjQUNBLG1CQUVBLG9CQUVBLE9BQ0EsbUJBRUEsS0FDQSxZQUNBLEdBQ0EsY0FDQSxPQUNBLGFBRUEsc0JBQ0EsTUFFQSxJQUNBLEdBQ0Esb0JBQ0EsMkJBQ0EsMkJBRUEsYUFDQSxnQkFDQSxjQUVBLFFBQ0Esc0JBRUEsYUFDQSxpQkFDQSxjQUVBLEtBQ0EsaUJBQ0EsY0FDQSxTQUNBLGlCQUdBLEtBQ0EsaUJBQ0EsVUFDQSxXQUVBLElBQ0EsYUFFQSxJQUNBLGNBRUEsS0FDQSxnQkFFQSxLQUNBLGFBR0EsSUFFQSxFQUNBLGNBQ0EsV0FDQSxZQUNBLFVBQ0EsV0FFQSxnQkFDQSxtQkFDQSxXQUNBLDBCQUNBLGVBR0EsV0FDQSxZQUVBLE1BQ0Esb0JBRUEsZUFDQSw2QkFtQkEsVUFFQSxDQVlBLG1DQUNBLENBQ0EsbUJBRUEsVUFDQSxxQkFDQSxPQUNBLGdCQUNBLFdBQ0Esa0JBQ0EsYUFDQSxhQUNBLFVBRUEsVUFDQSxPQUVBLE9BQ0EsNEJBRUEsSUFDQSxHQUNBLGlCQUNBLG1DQUNBLDhCQUVBLFVBQ0Esc0JBQ0EsT0FDQSxLQUVBLE9BQ0Esc0JBRUEsU0FDQSxzQkFHQSxNQUNBLFVBQ0EseUNBR0EscUNBSUEsVUFDQSwyQkFHQSxxQkFDQSwyQkFLQSxTQUNBLFFBQ0EsY0FDQSxRQUNBLFVBQXVCLFFBQXlCLE9BQ2hELGtCQUVBLFNBQ0EsRUFDQSxLQUNBLFdBQ0EsbUNBQ0EsNEJBQ0Esa0NBQ0EsZUFDQSx3QkFBNkUsa0NBQzdFLGlCQUNBLFlBQ0EsV0FHQSxZQUNBLFNBQ0EsZUFBeUMsV0FBMEIsT0FDbkUsV0FDQSxlQUNBLHdCQUlBLGFBQ0Esb0JBR0EsSUFDQSxhQUNBLElBQ0EsS0FDQSxpQ0FDQSxnQ0FBNkUsb0NBRTdFLEtBQ0EsZUFFQSxVQUNBLE9BQ0EsSUFDQSxZQUNBLFVBQ0EsTUFDQSxjQUNBLG1DQUNBLFNBQ0EsZUFDQSxZQUNBLE1BRUEscUJBRUEsbUNBQTRDLGVBQTBCLEVBQ3RFLEVBQ0EsQ0FhQSxxQkFDQSxrQkFDQSxhQUNBLENBMEJBLHdCQUNBLGVBQ0EsVUFDQSxRQUNBLElBQThCLGdDQUM5QixtQkFDQSxnQkFDQSxhQUNBLEdBQ0EsQ0FDQSxRQUNBLFlBQ0EsbUJBR0EscUJBQ0EsR0FDQSxLQUNBLGtCQUNBLFNBQ0Esd0JBQ0EsSUFDQSxzREFDQSxvQkFJQSxNQUNBLDJCQUNBLGVBQ0EsU0FDQSxLQUVBLFlBQ0EsTUFDQSx1QkFHQSxPQUVBLE9BSUEsd0JBQ0EsV0FDQSw4QkFDQSxzQkFFQSxHQUNBLEVBQ0EsZUFDQSxxQkFDQSxjQUNBLGtCQUNBLG9CQUNBLFFBQ0EsQ0FDQSx1QkFJQSxtREFDQSxDQUNBLDhCQUNBLFdBQ0EsR0FFQSxpQ0FDQSxJQUNBLGtCQUNBLFlBQ0EsTUFDQSxrQ0FFQSxHQUNBLDBDQUNBLElBQ0EsR0FDQSxhQUFvQixFQUNwQixlQVVBLFlBQ0EsRUFFQSxDQUVBLHdCQUNBLFdBQ0EsV0FDQSxjQUNBLGNBQ0EsMkNBQ0EsY0FDQSxXQUNBLFlBQ0EsK0JBQ0EsVUFFQSxHQUNBLENBQ0EsT0FDQSxNQUNBLGVBQ0EsV0FDQSxXQUNBLGNBQ0EsU0FDQSxTQUNBLENBQ0EscUJBRUEsZ0JBRUEsT0FDQSxxQkFFQSxRQUNBLHFCQUNBLE1BQ0EsTUFDQSxzQkFFQSxhQUNBLEdBQ0EsRUFDQSx3QkFDQSxXQUNBLFdBQ0EsY0FDQSxjQUNBLDJDQUNBLGNBQ0EsV0FDQSxnQkFDQSxXQUNBLGdDQUNBLGFBQ0EsYUFFQSxHQUNBLENBQ0EsQ0FDQSxPQUNBLE1BQ0EsZUFDQSxXQUNBLFdBQ0EsVUFDQSxlQUNBLHlCQUNBLDJCQUNBLHdCQUNBLDBCQUNBLDBCQUdBLGtCQUNBLFNBQ0EsU0FDQSxDQUNBLHFCQUVBLGdCQUVBLE9BQ0EscUJBRUEsUUFDQSxxQkFDQSxNQUNBLE1BQ0Esc0JBRUEsYUFDQSxHQUNBLEdBRUEsMkJBQ0EsV0FDQSxNQUNBLHFCQUVBLElBQ0EsdUJBRUEsSUFDQSxlQUVBLElBQ0Esa0JBQ0EsQ0FDQSxhQUVBLElBQ0EsQ0FDQSwyQkFDQSxXQUNBLGVBQ0EsU0FDQSxXQUNBLFVBQ0Esd0JBR0EsY0FDQSxLQUNBLE9BQ0EsS0FpQkEsVUFDQSxtREFHQSxPQUNBLDhCQUlBLDJCQXpCQSxJQUNBLHNEQUNBLGdDQUNBLDRCQUNBLE9BRUEsU0FDQSwrQ0FDQSxjQUNBLGNBQ0EseUNBRUEsR0FHQSxPQVdBLFdBQ0EsYUFDQSxTQUVBLFVBQ0EsR0FDQSxnQ0FDQSxRQUVBLEtBQ0EsMkJBQ0EsV0FDQSxVQUNBLFVBQ0EsMkJBR0EsY0FDQSxvQkFDQSxNQUNBLE9BRUEsY0FDQSxXQUNBLGNBRUEsR0FDQSxPQUNBLGlCQUVBLHNCQUNBLFdBR0EsS0FDQSxVQUVBLDhCQUNBLFFBRUEsS0FDQSxxQkFDQSxPQUNBLGVBQXVCLFdBQXFCLE9BQzVDLFdBQ0EsY0FDQSxzQkFJQSxXQUNBLHNCQUVBLElBQ0EsZUFDQSxNQUNBLE9BRUEsVUFDQSxNQUNBLElBS0EsVUFDQSxHQUNBLEVBRUEsMkJBQ0EsR0FDQSxNQUVBLHdCQUNBLGVBQ0EsY0FDQSxjQUVBLGNBQ0EsTUFDQSwrQ0FFQSxPQUNBLGlCQUNBLDhCQUNBLFFBQ0Esd0JBRUEsK0JBQ0EscUNBQ0EsSUFLQSxVQUxpRCxhQUdqRCxxQ0FHQSxpQ0FDQSwwQ0FDQSxPQUlBLFFBRUEsT0FDQSxPQUVBLE1BQ0EsU0FHQSxRQUNBLFdBRUEsS0FLQSw2QkFHQSxRQUNBLGtDQUNBLEdBQ0EsR0FDQSxpQ0FDQSxrQ0FDQSxJQUNBLDJCQUNBLElBRUEsT0FHQSwrQkFDQSxrQ0FDQSxTQUVBLG1CQUNBLHNCQUNBLElBQ0Esd0JBQ0EsY0FDQSxjQUlBLFFBRUEsT0FDQSxPQUVBLE1BQ0EsU0FHQSxRQUNBLFdBRUEsS0FLQSw2QkFHQSxLQUNBLEdBQ0Esa0JBQ0EsQ0FDQSwrQ0FLQSxvQkFGQSxHQUdBLGtCQUNBLHlCQUNBLEdBQ0Esa0JBQ0EsZ0JBQ0EsSUFDQSxxQkFDQSxHQUNBLFVBR0EsdUJBRUEsSUFDQSxrQkFDQSxPQUNBLG9DQUdBLDJCQUVBLElBQ0EsaUNBQ0Esa0JBQ0EsNEJBQ0EsV0FDQSxlQUNBLEtBQ0EscUJBQ0EsQ0FDQSxXQUVBLCtCQUNBLElBQ0Esa0JBQ0EsZ0JBQ0EsSUFDQSx3QkFDQSxnQkFDQSwyREFDQSxtQkFFQSxJQUNBLHdCQUNBLFlBQW1CLFdBQXFCLE9BQ3hDLFdBQ0EsTUFDQSxvQkFHQSxJQUNBLGtCQUNBLHVDQUNBLHFDQUNBLEtBRUEsZUFDQSx3QkFDQSxhQUNBLGVBQ0EsY0FDQSxxQ0FDQSxPQUNBLGVBQ0EsYUFDQSxvQkFDQSxTQUNBLGtCQUNBLFdBQ0EsV0FDQSx1QkFHQSxPQUVBLEdBQ0EsU0FDQSxvQkFJQSxrQkFDQSxJQUNBLGVBQ0EsYUFDQSxvQkFDQSxTQUNBLFlBQ0EsdUJBR0EsT0FFQSxJQUNBLGVBQ0EsYUFDQSxvQkFDQSxTQUNBLGtCQUNBLFdBQ0EsV0FDQSx1QkFHQSxPQUVBLEdBQ0EsU0FDQSxvQkFJQSxrQkFDQSxJQUNBLGVBQ0Esa0VBQ0EscUNBQ0EsZUFDQSxVQUNBLGlCQUNBLE1BQ0EsK0JBRUEsUUFDQSxDQUNBLEdBQ0Esa0JBQ0Esa0JBQ0EsWUFDQSxXQUNBLGVBQ0EsSUFvQkEsTUFuQkEsU0FDQSxPQUVBLFVBQ0EsMEJBQ0EsZUFHQSxnQ0FDQSxlQUVBLGVBQ0EsK0JBQ0EsZ0JBRUEsc0JBRUEsY0FDQSxLQUVBLENBQ0EsU0FDQSxrQkFDQSxrQkFDQSxTQUNBLFdBQ0EsWUFDQSxjQUNBLHFCQUNBLGVBRUEsZ0JBQ0EsdUJBRUEsT0FDQSxRQUNBLGVBRUEsZUFDQSxvQkFDQSxZQUlBLHlCQUNBLE1BR0EsaUJBR0EsYUFKQSxHQU1BLGVBQ0EsYUFDQSxPQUNBLGtCQUNBLFdBQ0Esd0JBQ0EsV0FDQSxlQUNBLGVBQTJCLFFBQXFCLE9BQ2hELGVBR0EsWUFDQSxXQUVBLEdBRUEsWUFFQSxJQUNBLGtCQUNBLGtCQUNBLFNBRUEsZ0JBQ0EsU0FJQSx1REFIQSxPQUtBLGFBQ0EsZUFDQSxhQUNBLG9CQUNBLFNBQ0EsbUJBQ0EsV0FDQSxZQUNBLHVCQUdBLE9BRUEsR0FDQSxTQUNBLHNCQUlBLGtCQUNBLElBQ0Esa0JBQ0Esa0JBQ0EsWUFDQSxXQUNBLGVBQ0EsSUFVQSxNQVRBLFNBQ0EsT0FFQSx3QkFDQSxnQkFDQSxxQkFFQSxjQUNBLEtBRUEsQ0FDQSxTQUNBLGtCQUNBLGtCQUNBLG9CQUNBLDBCQUVBLG9CQUNBLG1CQUNBLFdBQ0EsWUFDQSxlQUEyQixRQUFxQixPQUNoRCxlQUdBLFlBQ0EsV0FFQSxHQUNBLEVBRUEsZUFDQSxhQUNBLE9BQ0EsZUFDQSxhQUNBLG9CQUNBLFNBQ0EsWUFDQSx1QkFHQSxPQUVBLElBQ0EsZUFDQSxhQUNBLG9CQUNBLFNBQ0Esa0JBQ0EsV0FDQSxXQUNBLHVCQUdBLE9BRUEsR0FDQSxTQUNBLG9CQUlBLGtCQUNBLElBQ0Esa0JBQ0Esa0JBQ0EsU0FDQSxrQkFDQSxlQUNBLE1BQ0EsUUFDQSxPQUVBLHVCQUNBLGVBQ0EsY0FDQSwrQkFDQSxnQkFFQSxzQkFFQSxjQUlBLE9BQ0Esa0JBQ0Esa0JBQ0EsU0FDQSxZQUNBLFdBQ0EsT0FDQSxJQUdBLG1CQUdBLGFBSkEsR0FNQSxDQUNBLHFCQUNBLE9BQ0EsY0FFQSxJQUNBLGNBRUEsT0FDQSxnQkFHQSxJQUVBLGlDQUNBLFlBQ0EsV0FDQSxZQUNBLE1BQ0EsTUFDQSxnQ0FHQSwwQ0FHQSxJQUNBLFFBQ0EsNkJBR0EscUNBR0EsSUFDQSxLQUNBLFdBR0EsNEJBR0EsSUFDQSxRQUNBLGNBR0EsNEJBS0EseUJBRUEsR0FDQSxFQUNBLHdCQUNBLElBQ0EsbUJBRUEsT0FDQSxnQkFHQSxtQkFFQSxHQUNBLGlDQUNBLFdBQ0EsV0FDQSxhQUNBLHdCQUVBLFFBQ0EsV0FDQSxVQUNBLFlBQ0EsWUFDQSxlQUNBLGVBQ0EsWUFDQSxZQUNBLFVBQ0EsVUFDQSxhQUNBLGNBQ0EsUUFDQSxVQUVBLFlBQ0EsK0JBRUEsT0FDQSxVQUNBLG1CQUdBLGFBQ0EsWUFDQSxVQUNBLFdBQ0Esb0JBRUEsV0FDQSxVQUNBLE1BQ0EsYUFHQSxzQkFFQSxHQUVBLFNBQ0EsZ0JBRUEsU0FDQSxtQkFJQSxHQUVBLE1BQ0EsYUFFQSxJQUNBLGNBQ0EsY0FHQSxHQUNBLEVBQ0EsdUNBQ0EsSUFDQSxPQUNBLE1BQ0EsTUFFQSxhQUNBLE9BQ0EsTUFFQSxTQUNBLGdCQUVBLE1BQ0EsTUFDQSxVQUdBLE9BQ0EsbUJBR0EsbUJBSUEsTUFDQSxNQUNBLFVBR0EsaUJBQ0EsVUFHQSxRQUNBLE9BQ0EsS0FDQSxZQUNBLE1BSUEscUJBQ0EsbUJBR0EsUUFDQSxpQkFDQSxtQkFFQSxRQUNBLFNBQ0EseUJBR0EsaUJBQ0EsbUJBR0EsTUFDQSxLQUNBLHdCQUdBLHlCQUdBLEtBQ0Esb0NBQ0EsV0FDQSxXQUNBLGtCQUNBLFNBQ0EsVUFDQSxVQUNBLGtCQUNBLFdBQ0EsYUFFQSxTQUNBLE9BQ0Esd0JBRUEsUUFDQSxtQ0FDQSx3QkFDQSxxQkFDQSx5QkFDQSxxQkFDQSxnQkFDQSxnQkFDQSxHQUdBLGFBQ0EsU0FDQSxHQUdBLDRCQUZBLGlCQUdBLDBCQUNBLE1BQ0EsSUFFQSxrREFDQSxJQUNBLEtBQ0EsV0FDQSxZQUNBLFlBQ0EsWUFDQSw4QkFDQSxhQUNBLFFBQ0EsSUFLQSxVQUxtRCxhQUduRCxjQUdBLDhDQUNBLFVBQ0EsMEJBQ0EsS0FDQSxPQUVBLFNBQ0EsT0FDQSxHQUVBLFNBQ0EsU0FFQSxPQUlBLFFBRUEsZUFDQSxXQUVBLEtBQ0EsMkJBRUEsR0FDQSw2QkFFQSxrQkFDQSxhQUNBLE1BQ0EsV0FDQSxrQkFDQSw2QkFDQSxpQ0FDQSxzQkFDQSwyQkFDQSw0QkFDQSxtQ0FDQSx3Q0FDQSxJQUNBLFdBQ0EsR0FDQSxDQUNBLEtBQ0EsSUFDQSxhQUNBLFlBQ0EsVUFDQSxVQUNBLFlBQ0EsYUFDQSxnQkFDQSxRQUNBLGFBSUEsNERBR0EsS0FKQSxNQUtBLG9CQUNBLG9EQUVBLGFBQ0EsTUFDQSxPQUVBLGdCQUNBLFFBRUEsT0FJQSxRQUVBLGVBQ0EsV0FFQSxVQUNBLDBCQUNBLGdCQUNBLGFBQ0Esa0RBRUEsY0FHQSxNQUNBLDJCQUVBLEdBQ0EsNkJBRUEsR0FFQSxDQUNBLFNBQ0Esa0JBQ0EsV0FDQSxlQUNBLFdBQ0EsaUJBQ0Esa0JBRUEsSUFDQSxrQkFDQSxXQUNBLElBQ0EsaUNBQ0EsQ0FJVSxjQUhWLGFBQ0EsbUJBQ0EsTUFDQSxRQUE0QixHQUM1QixXQUNBLE9BQ0Esa0JBRUEsOEJBRUEsVUFDQSxVQUE4QixNQUF3QixRQUN0RCxXQUNBLE9BQ0Esa0JBRUEsNEJBQ0EsSUFFQSxTQUNBLG1CQUVBLGVBQ0EsVUFBOEIsTUFBd0IsR0FDdEQsd0JBR0EsSUFDQSxpQ0FDQSxXQUNBLGFBQ0EsYUFDQSxRQUNBLEtBQ0EsS0FDQSxFQUNBLEdBQ0EsR0FDQSxHQUNBLEdBQ0EsR0FDQSxHQUNBLE1BQ0EsT0FLQSxZQUpBLHVCQUVBLFFBR0EsT0FHQSx3QkFGQSxjQUdBLFVBQ0EsVUFDQSxVQUNBLE9BQ0Esa0JBRUEsUUFDQSxrQkFJQSxrQkFFQSx1QkFDQSx5QkFDQSxJQUNBLEtBQ0EsZUFDQSxRQUVBLGFBQ0EsVUFDQSxPQUNBLGtCQUVBLElBRUEsdUJBQ0EseUJBQ0EsSUFDQSxLQUNBLGVBQ0EsUUFFQSxhQUNBLFVBQ0EsT0FDQSxrQkFFQSxJQUVBLG9CQUNBLHNCQUNBLG9CQUNBLEtBQ0EsS0FDQSxXQUNBLFVBQ0EsT0FDQSxrQkFFQSxLQUNBLFFBRUEsb0JBQ0Esc0JBQ0EsVUFDQSw2QkFDQSxrQkFDQSxJQUNBLEtBQ0EsV0FDQSxVQUNBLE9BQ0Esa0JBRUEsS0FDQSxRQUNBLENBQ0EsS0FDQSxPQUNBLFdBQ0EsYUFDQSw2QkFDQSxTQUNBLFVBQ0EsT0FDQSxrQkFFQSxLQUNBLGdDQUlBLGdCQUNBLFlBQ0EseUJBR0EsUUFDQSxVQUNBLFdBQ0EsU0FDQSxZQUVBLFdBQW1CLEtBQWEsR0FDaEMsYUFFQSxLQUNBLFVBQ0EsS0FDQSxZQUNBLGtCQUE0QixPQUFXLEdBQ3ZDLGNBQ0EsT0FDQSxVQUFvQyxPQUFXLEdBQy9DLGNBQ0Esb0JBQ0EsV0FDQSxNQUNBLEdBR0EsU0FFQSxNQUNBLGtCQUVBLDBCQUNBLElBQ0EsWUFDQSxLQUNBLEtBS0EsTUFDQSxXQUNBLFlBQTRCLE9BQVcsR0FDdkMsV0FDQSxrQkFFQSxXQUE0QixPQUFXLEdBQ3ZDLFdBQ0EsT0FDQSxrQkFDQSxRQUNBLFlBQ0EsY0FDQSxNQUNBLEdBR0EsU0FFQSxNQUNBLGtCQUVBLDBCQUNBLElBQ0EsWUFJQSxNQUNBLG9CQUNBLHNCQUNBLE9BQ0EsVUFDQSxPQUNBLGtCQUVBLEtBQ0EsZ0NBR0EsVUFDQSxXQUNBLEdBQ0EsWUFDQSxRQUNBLHFCQUNBLElBR0EsWUFDQSxXQUNBLHFCQUNBLFFBQXFDLEVBQVEsTUFDN0MsTUFDQSxrQkFDQSxTQUNBLE9BQ0Esa0JBRUEsV0FDQSw2QkFDQSw4QkFHQSxtQkFDQSxXQUNBLFNBQ0EsVUFDQSw2QkFDQSxrQkFHQSxLQUlBLElBQ0EsY0FDQSxhQUFxQyxFQUFRLE1BQzdDLE1BQ0EsbUJBQ0EsU0FDQSxPQUNBLGtCQUVBLFdBQ0EsNkJBQ0EsZ0NBSUEsSUFDQSxDQUNBLENBQ0EsQ0FDQSxlQUNBLGlCQUNBLEdBQ0EsT0FDQSxHQUNBLEdBQ0EsR0FDQSxHQUNBLFVBQWUsUUFBYyxPQUM3QixTQUdBLCtCQUNBLGlCQUNBLFFBQ0EsV0FDQSxJQUNBLFFBQ0EsUUFDQSxlQUNBLEtBQ0EsT0FDQSwwQkFDQSxVQUdBLEtBR0EsZ0JBQ0EsT0FDQSxvQkFFQSxXQUdBLGNBQ0EsZ0JBQ0EsR0FDQSxlQUNBLFNBRUEsVUFDQSxJQUNBLDhCQUNBLGtCQUdBLG9CQUNBLGFBRUEsa0JBQ0EsaUJBQ0EsWUFDQSxZQUVBLEdBQ0EsY0FDQSxRQUNBLGdCQUVBLGNBQ0EsdUJBRUEsWUFDQSxpQkFDQSwyQkFHQSxpQkFHQSxXQUNBLHNCQUVBLDJDQUNBLGVBQ0EsaUJBQ0EsWUFDQSxNQUNBLG1CQUdBLEdBQ0EsS0FDQSxJQUNBLE9BQ0EsVUFFQSxpQkFDQSx1Q0FDQSxXQUdBLE9BRUEsYUFDQSxJQUNBLDJCQUdBLHVCQUVBLEdBRUEsRUFDQSxxQkFDQSxXQUNBLFVBQ0EsUUFDQSxnQkFFQSx3QkFHQSxZQUNBLGdCQUVBLFNBQ0Esd0JBSUEsSUFDQSx3QkFDQSxZQUNBLFdBQ0Esb0JBRUEsY0FDQSxRQUVBLGFBQ0EsZ0JBR0EsaUJBQ0EscUJBQ0EsV0FDQSxZQUNBLFNBQ0EsMkJBQ0EsMkJBQ0EsR0FFQSxlQU1BLFVBRUEsSUFFQSxhQUlBLEVBQ0EsQ0FFQSxDQUNBLHFCQUNBLE1BQ0EsSUFHQSw2QkFGQSxxQkFJQSxXQUNBLDRCQUNBLE9BR0EsS0FFQSxFQUNBLE9BQ0EsaUJBQ0EsU0FDQSxvQkFJQSxJQUNBLHFCQUNBLENBQ0Esb0NBRUEsU0FDQSxzQkFFQSxHQUNBLGdDQUVBLFdBQ0Esb0JBR0EsdUJBRUEsSUFFQSwyQkFDQSxXQUNBLFNBQ0EsOEJBRUEsVUFDQSx5QkFFQSxNQUNBLGNBRUEsSUFDQSxXQVdBLFlBRUEsS0FDQSxrQkFDQSxtQ0FDQSx3QkFDQSxHQUNBLFVBRUEsSUFDQSxHQUNBLGtCQUNBLGdDQUNBLGtCQUNBLEdBQ0EsVUFFQSxJQUNBLEdBQ0EsMkJBQ0Esd0JBQ0Esb0JBQ0EsVUFDQSxhQUNBLFdBRUEsSUFFQSxFQUNBLFdBQ0EsV0FDQSxXQUNBLFVBRUEsb0JBQ0EsVUFDQSxlQUNBLFlBQ0EsYUFDQSxXQUNBLEtBQ0EsUUFDQSxVQUVBLE9BQ0EsbUJBRUEsT0FDQSxvQkFHQSxRQUNBLFVBQ0EsbUJBRUEsUUFDQSxpQkFFQSw0QkFHQSxVQUNBLGlCQUVBLHNCQUdBLGFBQ0EsY0FFQSxNQUNBLFdBRUEsSUFDQSxHQUNBLDJCQUNBLFlBQW1CLFdBQXFCLE9BQ3hDLFdBRUEsTUFDQSxTQUNBLGtCQUVBLHdCQUdBLEtBQ0EsOEJBQ0Esd0JBQ0Esb0JBQ0EsVUFDQSxhQUNBLFdBRUEsSUFFQSxFQUNBLFdBQ0Esa0JBQ0EsU0FDQSxtQkFDQSxJQUNBLFFBQ0EsV0FDQSxhQUVBLE9BQ0EsdUJBRUEsVUFDQSxpQkFHQSxlQUNBLHlCQUNBLDRDQUVBLDRCQUVBLGtEQUVBLGtDQUNBLGNBQ0EsV0FFQSxnQkFDQSxxQ0FDQSxnQkFDQSxFQUNBLEtBQ0Esb0JBQ0EsK0JBQ0EsZ0JBQ0EsWUFDQSxNQUNBLFdBRUEsR0FDQSxPQUNBLElBQ0Esd0JBQ0EsQ0FDQSxPQUNBLE9BY0EsUUFHQSxnQkFDQSx3QkFDQSxvQkFDQSw4QkFDQSxRQUNBLFdBQ0EsbUJBRUEsR0FDQSxxQkFDQSxDQUNBLFdBQ0EsMEJBRUEsNkJBQ0EsK0NBQStDLCtCQUFxQyxHQUVwRixTQUNBLDZCQUdBLGlCQUNBLHFCQUNBLE1BQ0EsT0FDQSx3Q0FBMkMsV0FBbUIsR0FFOUQsT0FDQSxNQUNBLElBS0EsVUFDQSxHQUNBLEVBRUEsZUFDQSxlQUNBLFdBQ0EsU0FDQSx1QkFlQSxrQ0FkQSxnQ0FDQSx1QkFDQSxVQUNBLFdBQ0EsS0FDQSxXQUNBLCtCQUNBLGNBQ0EsVUFHQSxFQUlBLDhCQUNBLFdBQ0Esa0JBQ0EsU0FDQSxjQUNBLE1BQ0EsMEJBQ0EsU0FDQSxlQUNBLFdBQ0EsYUFFQSwwQkFFQSxVQUNBLGtCQUdBLGNBQ0EsOEJBQ0EsYUFDQSxnQ0FFQSw0QkFFQSxrREFFQSxrQ0FDQSx3QkFDQSxxQ0FDQSxnQkFDQSxFQUNBLEtBQ0Esb0JBQ0EsbUJBQ0EsZ0JBQ0EsYUFDQSxhQUNBLEdBQ0EsT0FDQSxJQUNBLDJCQUNBLFdBQ0EsV0FDQSxlQUNBLFlBQ0EsYUFDQSxZQUNBLFlBQ0EsVUFFQSxzREFJQSx5QkFDQSxrQkFDQSx1QkFDQSxJQUNBLEVBQ0EsUUFDQSxHQUNBLG1CQUVBLE9BQ0EsVUFDQSxtQkFFQSxLQUNBLGdCQUNBLDRCQUdBLE9BQ0EsZ0JBQ0Esc0JBR0EsVUFDQSxjQUVBLElBQ0EsR0FDQSwyQkFDQSxJQUNBLGNBQ0EsaUJBQ0EsZUFBdUIsV0FBcUIsT0FDNUMsV0FDQSxjQUNBLE1BQ0Esc0JBQ0EsVUFHQSw0QkFLQSxZQUNBLFNBQ0EsK0JBQ0Esa0JBR0EsSUFDQSxvQkFFQSxVQUVBLGVBQ0EscUJBQ0EsVUFHQSxzQkFDQSxXQUNBLDJCQUNBLE9BQ0EsRUFDQSxFQUNBLGtCQUNBLG9CQUNBLGNBQ0Esb0JBQ0EsdUJBQ0EsSUFDQSxFQUNBLFdBQ0EsK0JBQ0Esa0JBRUEsV0FDQSxHQUNBLEdBQ0Esa0JBQ0EsZUFDQSxHQUNBLEdBQ0EsMkJBQ0EsV0FDQSxTQUNBLCtCQUVBLFlBQ0Esd0JBRUEsSUFDQSxXQUVBLElBQ0EsY0FNQSxZQUVBLEtBQ0EscUJBQ0EsZUFDQSxpQkFDQSxjQUNBLGdCQUVBLGlCQUNBLDRCQUVBLElBQ0EsUUFDQSxDQUNBLFFBS0EsQ0FHQSxlQUNBLElBSUEsd0JBRUEsK0JBQ0Esd0JBQ0EsR0FDQSxlQUNBLFlBQW1CLFdBQWtCLE9BQ3JDLGNBQ0EsYUFDQSxTQUdBLFVBQ0EsTUFDQSxxQkFDQSxRQUNBLEtBQ0EsU0FDQSxhQUVBLG1CQUNBLElBQ0EsR0FDQSxlQUNBLFlBQW1CLFFBQWtCLE9BQ3JDLGlCQUNBLEdBSUEseUJBSEEsRUFRQSxDQUVBLGtCQUNBLFNBSUEsUUFFQSxVQUdBLGNBQ0EsYUFDQSxXQUNBLE1BQ0EsU0FDQSxXQUVBLGVBQ0EsY0FFQSxzQkFDQSxPQUVBLFVBQ0EsS0FDQSxXQUNBLGFBQ0EsZUFDQSxvQkFDQSxhQUdBLFNBQ0EsV0FFQSx1QkFFQSxpQkFDQSxtQkFDQSxFQUNBLE9BQ0EsV0FDQSxhQUNBLHNCQUVBLFFBQ0EsR0FDQSxlQUNBLFlBQ0EsMkJBQ0EsQ0FDQSxRQUVBLFVBQ0EsR0FDQSxFQUVBLGtCQUNBLE9BQVksZUFDWixHQWVBLENBdC9FQSxPQUNBLFlBQ0EsMkhBSUEsbUNBZ09BLENBQ0Esb0JBQ0EsNEJBQ0EsaUJBQ0Esa0JBQ0EsaUJBQ0EsZ0JBQ0EsaUJBQ0EsbUJBQ0EsU0EySEEsNkJBQ0EsTUFDQSxNQUNBLE1BQ0EsTUFDQSxTQUNBLFdBQ0EsMkJBRUEsMFZBS0Esa0ZBaEJBLGdDQWlCQSxvQ0FoQkEsd0NBaUJBLCtDQUNBLG9FQUNBLHVHQUNBLDRKQUNBLDRaQUVBLGlCQUNBLE1BQ0Esa0JBQ0EsZ0JBQ0EscUNBQ0EscUJBQ0EsS0FDQSwrQkFDQSxZQUVBLFFBQW1CLG9CQUEyQixPQUM5QyxrQkFFQSxPQUVBLG1FQUNBLDJCQStGQSwwQ0FpNURBLGlCQUNBLGVBMENBLG9DQThFQSxRQW9CQSxhQW5CQSxXQUVBLGVBR0EsYUFHQSxRQUNBLGFBR0EsVUFDQSxlQUNBLGtCQUNBLFdBQ0EsV0FDQSxJQUdBLGVBQ0EsZ0JBQ0EsZUFDQSxXQUNBLGVBQ0EsWUFDQSxpQkFDQSxvQkFDQSxhQUNBLGFBRUEscUNBQThDLENBRTlDLFVBQUMsZ0JDaGhGRCxhQTRCQSxtQ0FyQkEsT0FDQSxJQUNBLE1BQ0EsZ0JBSUssNElBQ0wsa0JBQ0EsS0FDQSxPQUNBLGlDQUEwQyxVQUF5QixJQUVuRSxXQUNBLHFCQUVBLHFCQUNBLEVBQ0EsQ0FDQSxnQkNoREEsTUFBaUIsWUFFakIsb0NBQ0EsT0FDQSwwQ0NKQSxVQUFpOUYsNitGQ0FqOUYsVUFBODFCLGczQkNBOTFCLFVBQTQzQiw0NEJDQTUzQixhQUVBLGlCQUNBLE9BQ0EsaUJBR0EsaUJBQ0EsdUJBQWlELFNBQU8sVUFDeEQsU0FDQSxHQUFHLEVBQ0gsS0FHQSxFQXVEQSxFLG1CQXREQSwrREFFQSxnQkFDQSxzQkFFQSxnQkFDQSxVQUNBLFFBRUEsVUFFQSxLQUNHLElBRUgsV0FDQSxpQkFHQSxvQkFFQSxPQUNBLGVBQ0Esa0JBQ0Esd0JBQ0EsTUFDQSxLQUdBLGdCQUNBLE1BQWdDLFNBQVEsS0FDeEMsUUFFQSxHQUNBLFlBQ0ssR0FDTCxjQUNBLEdBQ0ssS0FDTCxRQUNBLEdBSUEsV0FBeUIsS0FBTSxJQUMvQixZQUNHLDhDQUVILGlCQUVBLHVDQUVBLEtBQ0EsbUJDakVBLENBQ0EsUUFDQSxtQ0FFQSxXQUNBLDZCQWFBLDJCQ2xCQSxDQUNBLFFBQ0EsbUNBRUEsV0FDQSw2QkFhQSwyQkNsQkEsQ0FDQSxRQUNBLG1DQUVBLFdBQ0EsNkJBYUEsMEJDcEJBLGFBRUEsZ0JBRUEsNkVBQW9HLGNBQW1CLEVBQUUsYUFBbUIsa0dBQThILEVBRTFRLEVBcUNBLEUsdUJBcENBLFVBRUEsNkJBRUEsMEJBQ0EseUNBRUEsNkJBQ0EsY0FDQSxHQUdBLDZDQUNBLHlDQUVBLFlBRUEseUJBQ0EsU0FDQSxjQUVBLHFDQUVBLHFCQUNBLGlCQUVBLHVCQUVBLDJCQUNBLGlCQUNBLEdBQ0EsRUFFQSxDQUNBLHVCQ3pDQSxHQUdBLGFBQ0EsT0FDQSxLQUFDLElBRUQsR0FFQSwwQ0FDQSxPQUFDLFNBRUQsQ0FDQSw0QkFDQSxPQUk0QyxDQUU1QyxxTENkQSxJQUVBLEtBQU0sR0FBWSxJQUFJLElBQUksS0FBUSxPQUFjLFVBQUksRUFDaEQsV0FBVyxJQUFNLElBQUMsSUFBUyxNQUcvQixJQUFRLE9BQ0gsSUFBRCxVQUFRLFFBQ0osT0FBQyxJQUFELFNBQU8sVUFDRixPQUFVLElBQUksS0FDWCxJQUFDLFNBQU0sSUFBSyxFQUFLLEtBQU0sS0FBTSxFQUFLLEtBQU0sVUFBVyxFQUFLLGVBSXBFLFNBQVMsS0FBSyxZQUFZLFNBQVMsY0FBYyIsImZpbGUiOiJleGFtcGxlcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0ICh7IHNjcm9sbFRvcCwgdmlld3BvcnRIZWlnaHQsIHJvd0hlaWdodCwgcm93c0NvdW50IH0pID0+IHtcclxuICAgIGlmICh2aWV3cG9ydEhlaWdodCA8IDApIHtcclxuICAgICAgICByZXR1cm4gWzAsIDBdO1xyXG4gICAgfVxyXG4gICAgY29uc3QgY2x1c3RlclNpemUgPSBNYXRoLmNlaWwodmlld3BvcnRIZWlnaHQgLyByb3dIZWlnaHQpO1xyXG4gICAgY29uc3QgdG9wQ2x1c3RlciA9IE1hdGguZmxvb3IoTWF0aC5mbG9vcihNYXRoLm1heCgwLCBzY3JvbGxUb3ApIC8gcm93SGVpZ2h0KSAvIGNsdXN0ZXJTaXplKTtcclxuICAgIGNvbnN0IGVuZCA9IE1hdGgubWluKHJvd3NDb3VudCwgKHRvcENsdXN0ZXIgKyAyKSAqIGNsdXN0ZXJTaXplKTtcclxuICAgIC8vIGNvdW50IG9mIHZpc2libGUgcm93cyBpcyBhbHdheXMgdGhlIHNhbWUgdGhlbiBmb2N1cyBuZXZlciBiZSBsb3N0XHJcbiAgICBjb25zdCBzdGFydCA9IE1hdGgubWF4KDAsIGVuZCAtIGNsdXN0ZXJTaXplICogMik7XHJcbiAgICByZXR1cm4gW3N0YXJ0LCBlbmRdO1xyXG59O1xyXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvdXRpbHMvZ2V0VmlzaWJsZVJvd3MuanMiLCJpbXBvcnQgeyBjb21wb3NlLCBjaGVja1Byb3BzIH0gZnJvbSAnLi4vdXRpbHMvaW5kZXguanMnO1xyXG5pbXBvcnQgd2l0aFByb3BzIGZyb20gJy4vd2l0aFByb3BzLmpzJztcclxuaW1wb3J0IHdpdGhQcm9wc09uQ2hhbmdlIGZyb20gJy4vd2l0aFByb3BzT25DaGFuZ2UuanMnO1xyXG5pbXBvcnQgRGVmYXVsdENvbHVtbiBmcm9tICcuLi9EZWZhdWx0Q29sdW1uLmpzJztcclxuaW1wb3J0IERlZmF1bHRSb3cgZnJvbSAnLi4vRGVmYXVsdFJvdy5qcyc7XHJcblxyXG5jb25zdCBkZWZhdWx0U3RhdGUgPSB7fTtcclxuY29uc3QgZGVmYXVsdE1pbldpZHRoID0gNjA7XHJcblxyXG5jb25zdCBwYXJzZVdpZHRoID0gKHdpZHRoLCB2aWV3cG9ydFdpZHRoKSA9PiB7XHJcbiAgICBpZiAodHlwZW9mIHdpZHRoID09PSAnc3RyaW5nJyAmJiB3aWR0aFt3aWR0aC5sZW5ndGggLSAxXSA9PT0gJyUnKSB7XHJcbiAgICAgICAgcmV0dXJuIHZpZXdwb3J0V2lkdGggKiBOdW1iZXIod2lkdGguc2xpY2UoMCwgLTEpKSAvIDEwMDtcclxuICAgIH1cclxuICAgIHJldHVybiB3aWR0aDtcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0ICgpID0+IGNvbXBvc2UoXHJcbiAgICB3aXRoUHJvcHMocHJvcHMgPT4gKHtcclxuICAgICAgICBoZWFkZXJIZWlnaHQ6IHByb3BzLmhlYWRlckhlaWdodCB8fCAwLFxyXG4gICAgICAgIHJvd0hlaWdodDogcHJvcHMucm93SGVpZ2h0IHx8IDMwLFxyXG4gICAgICAgIGNvbHVtbnM6IHByb3BzLnN0YXRlLmNvbHVtbnMsXHJcbiAgICAgICAgY29sdW1uU3RhdGU6IHByb3BzLnN0YXRlLmNvbHVtblN0YXRlIHx8IGRlZmF1bHRTdGF0ZSxcclxuICAgICAgICByb3dTdGF0ZTogcHJvcHMuc3RhdGUucm93U3RhdGUgfHwgZGVmYXVsdFN0YXRlXHJcbiAgICB9KSksXHJcbiAgICB3aXRoUHJvcHMocHJvcHMgPT4gKHtcclxuICAgICAgICBjb2x1bW5Db21wb25lbnQ6IHByb3BzLmNvbHVtbkNvbXBvbmVudCB8fCBEZWZhdWx0Q29sdW1uLFxyXG4gICAgICAgIHJvd0NvbXBvbmVudDogcHJvcHMucm93Q29tcG9uZW50IHx8IERlZmF1bHRSb3dcclxuICAgIH0pKSxcclxuICAgIHdpdGhQcm9wc09uQ2hhbmdlKGNoZWNrUHJvcHMoJ2NvbHVtbnMnLCAndmlld3BvcnRXaWR0aCcpLCBwcm9wcyA9PiAoe1xyXG4gICAgICAgIGNvbHVtbnM6IHByb3BzLmNvbHVtbnMubWFwKGNvbHVtbiA9PiBPYmplY3QuYXNzaWduKHt9LCBjb2x1bW4sIHtcclxuICAgICAgICAgICAgd2lkdGg6IHBhcnNlV2lkdGgoY29sdW1uLndpZHRoLCBwcm9wcy52aWV3cG9ydFdpZHRoKVxyXG4gICAgICAgIH0pKVxyXG4gICAgfSkpLFxyXG4gICAgd2l0aFByb3BzT25DaGFuZ2UoY2hlY2tQcm9wcygnY29sdW1ucycpLCBwcm9wcyA9PiAoe1xyXG4gICAgICAgIGNvbHVtbnM6IHByb3BzLmNvbHVtbnMubWFwKGNvbHVtbiA9PiBPYmplY3QuYXNzaWduKHt9LCBjb2x1bW4sIHtcclxuICAgICAgICAgICAgbWluV2lkdGg6IGNvbHVtbi5taW5XaWR0aCB8fCBkZWZhdWx0TWluV2lkdGgsXHJcbiAgICAgICAgICAgIHdpZHRoOiBNYXRoLm1heChjb2x1bW4ud2lkdGggfHwgMCwgY29sdW1uLm1pbldpZHRoIHx8IGRlZmF1bHRNaW5XaWR0aClcclxuICAgICAgICB9KSlcclxuICAgIH0pKVxyXG4pO1xyXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvaG9jL3dpdGhEZWZhdWx0cy5qcyIsImltcG9ydCBjcmVhdGVFbGVtZW50IGZyb20gJ2luZmVybm8tY3JlYXRlLWVsZW1lbnQnO1xyXG5pbXBvcnQgQ29tcG9uZW50IGZyb20gJ2luZmVybm8tY29tcG9uZW50JztcclxuaW1wb3J0IHsgYmlzZWN0Q29sdW1ucywgZmluZENvbHVtbiwgdHJpbUNvbHVtbldpZHRoIH0gZnJvbSAnLi91dGlscy9pbmRleC5qcyc7XHJcbmltcG9ydCB7IGRyYWdnYWJsZSB9IGZyb20gJy4vaG9jL2luZGV4LmpzJztcclxuXHJcbmNvbnN0IGRyYWdPZmZzZXQgPSAzO1xyXG5cclxuY29uc3QgQ29udGFpbmVyID0gKHsgY2hpbGRyZW4gfSkgPT4gKFxyXG4gICAgPGRpdiBzdHlsZT17eyBkaXNwbGF5OiAnZmxleCcsIHBvc2l0aW9uOiAncmVsYXRpdmUnLCBoZWlnaHQ6ICdpbmhlcml0JyB9fT5cclxuICAgICAgICB7Y2hpbGRyZW59XHJcbiAgICA8L2Rpdj5cclxuKTtcclxuXHJcbmNvbnN0IFJlc2l6ZXIgPSAoeyBsYXN0IH0pID0+IChcclxuICAgIDxkaXYgc3R5bGU9e3tcclxuICAgICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcclxuICAgICAgICB6SW5kZXg6IDIsXHJcbiAgICAgICAgdG9wOiAwLFxyXG4gICAgICAgIGJvdHRvbTogMCxcclxuICAgICAgICByaWdodDogbGFzdCA/IDAgOiAtZHJhZ09mZnNldCxcclxuICAgICAgICB3aWR0aDogbGFzdCA/IGRyYWdPZmZzZXQgOiBkcmFnT2Zmc2V0ICogMixcclxuICAgICAgICBjdXJzb3I6ICdjb2wtcmVzaXplJ1xyXG4gICAgfX0+XHJcbiAgICA8L2Rpdj5cclxuKTtcclxuXHJcbmNvbnN0IENvbHVtbldyYXBwZXIgPSAoeyBjb2x1bW4sIGluZGV4LCBsYXN0LCBjb21wb25lbnQ6IENvbHVtbiB9KSA9PiAoXHJcbiAgICA8ZGl2IHN0eWxlPXt7IHBvc2l0aW9uOiAncmVsYXRpdmUnLCB3aWR0aDogY29sdW1uLndpZHRoLCBoZWlnaHQ6ICdpbmhlcml0JyB9fT5cclxuICAgICAgICA8Q29sdW1uIGNvbHVtbj17Y29sdW1ufSBpbmRleD17aW5kZXh9IGxhc3Q9e2xhc3R9IGdob3N0PXtmYWxzZX0gLz5cclxuICAgICAgICB7Y29sdW1uLmVuYWJsZVJlc2l6aW5nICYmIDxSZXNpemVyIGxhc3Q9e2xhc3R9IC8+fVxyXG4gICAgPC9kaXY+XHJcbik7XHJcblxyXG5jb25zdCBDb2x1bW5HaG9zdCA9ICh7IHgsIGNvbHVtbiwgaW5kZXgsIGNvbXBvbmVudDogQ29sdW1uIH0pID0+IChcclxuICAgIDxkaXYgc3R5bGU9e3sgcG9zaXRpb246ICdhYnNvbHV0ZScsIHRyYW5zZm9ybTogYHRyYW5zbGF0ZVgoJHt4fXB4KWAsIHdpZHRoOiBjb2x1bW4ud2lkdGgsIGhlaWdodDogJ2luaGVyaXQnIH19PlxyXG4gICAgICAgIDxDb2x1bW4gY29sdW1uPXtjb2x1bW59IGluZGV4PXtpbmRleH0gbGFzdD17ZmFsc2V9IGdob3N0PXt0cnVlfSAvPlxyXG4gICAgPC9kaXY+XHJcbik7XHJcblxyXG5jb25zdCBkcmFnTW92ZSA9ICh7IGNvbHVtbnMsIHgsIGR4LCBvblJlc2l6aW5nLCBvbk1vdmluZyB9KSA9PiB7XHJcbiAgICBjb25zdCBbc3RhcnRJbmRleCwgc3RhcnRYXSA9IGZpbmRDb2x1bW4oY29sdW1ucywgeCAtIGR4KTtcclxuICAgIGNvbnN0IHN0YXJ0Q29sdW1uID0gY29sdW1uc1tzdGFydEluZGV4XTtcclxuICAgIGlmIChNYXRoLmFicyhzdGFydFgpIDw9IGRyYWdPZmZzZXQpIHtcclxuICAgICAgICAvLyByZXNpemUgcHJldmlvdXNcclxuICAgICAgICAvLyBza2lwIGZpcnN0IHRvIG5vdCBjb25mbGljdCB3aXRoIHBpbm5lZCB0YWJsZXMgd2l0aCBtb3ZpbmdcclxuICAgICAgICBpZiAoc3RhcnRJbmRleCAhPT0gMCkge1xyXG4gICAgICAgICAgICBjb25zdCBwcmV2Q29sdW1uID0gY29sdW1uc1tzdGFydEluZGV4IC0gMV07XHJcbiAgICAgICAgICAgIGlmIChwcmV2Q29sdW1uLmVuYWJsZVJlc2l6aW5nKSB7XHJcbiAgICAgICAgICAgICAgICBvblJlc2l6aW5nKHByZXZDb2x1bW4ubmFtZSwgeCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKE1hdGguYWJzKHN0YXJ0WCAtIHN0YXJ0Q29sdW1uLndpZHRoKSA8PSBkcmFnT2Zmc2V0KSB7XHJcbiAgICAgICAgLy8gcmVzaXplIGN1cnJlbnRcclxuICAgICAgICBpZiAoc3RhcnRDb2x1bW4uZW5hYmxlUmVzaXppbmcpIHtcclxuICAgICAgICAgICAgb25SZXNpemluZyhzdGFydENvbHVtbi5uYW1lLCB4KTtcclxuICAgICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKHN0YXJ0Q29sdW1uLmVuYWJsZU1vdmluZykge1xyXG4gICAgICAgIC8vIG1vdmUgY3VycmVudFxyXG4gICAgICAgIGNvbnN0IFtsZWZ0SW5kZXgsIHJpZ2h0SW5kZXhdID0gYmlzZWN0Q29sdW1ucyhjb2x1bW5zLCB4IC0gc3RhcnRYKTtcclxuICAgICAgICBvbk1vdmluZyhcclxuICAgICAgICAgICAgc3RhcnRDb2x1bW4ubmFtZSxcclxuICAgICAgICAgICAgbGVmdEluZGV4ID09PSAtMSA/IG51bGwgOiBjb2x1bW5zW2xlZnRJbmRleF0ubmFtZSxcclxuICAgICAgICAgICAgcmlnaHRJbmRleCA9PT0gLTEgPyBudWxsIDogY29sdW1uc1tyaWdodEluZGV4XS5uYW1lXHJcbiAgICAgICAgKTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBtb3Zpbmc6IHRydWUsXHJcbiAgICAgICAgICAgIG1vdmluZ1Bvc2l0aW9uOiB4IC0gc3RhcnRYLFxyXG4gICAgICAgICAgICBtb3ZpbmdDb2x1bW46IHN0YXJ0Q29sdW1uLFxyXG4gICAgICAgICAgICBtb3ZpbmdJbmRleDogc3RhcnRJbmRleFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbn07XHJcblxyXG5jb25zdCBkcmFnRW5kID0gKHsgY29sdW1ucywgeCwgZHgsIG9uUmVzaXplLCBvbk1vdmUgfSkgPT4ge1xyXG4gICAgY29uc3QgW3N0YXJ0SW5kZXgsIHN0YXJ0WF0gPSBmaW5kQ29sdW1uKGNvbHVtbnMsIHggLSBkeCk7XHJcbiAgICBjb25zdCBzdGFydENvbHVtbiA9IGNvbHVtbnNbc3RhcnRJbmRleF07XHJcbiAgICBpZiAoTWF0aC5hYnMoc3RhcnRYKSA8PSBkcmFnT2Zmc2V0KSB7XHJcbiAgICAgICAgLy8gcmVzaXplIHByZXZpb3VzXHJcbiAgICAgICAgLy8gc2tpcCBmaXJzdCB0byBub3QgY29uZmxpY3Qgd2l0aCBwaW5uZWQgdGFibGVzIHdpdGggbW92aW5nXHJcbiAgICAgICAgaWYgKHN0YXJ0SW5kZXggIT09IDApIHtcclxuICAgICAgICAgICAgY29uc3QgcHJldkNvbHVtbiA9IGNvbHVtbnNbc3RhcnRJbmRleCAtIDFdO1xyXG4gICAgICAgICAgICBpZiAocHJldkNvbHVtbi5lbmFibGVSZXNpemluZykge1xyXG4gICAgICAgICAgICAgICAgb25SZXNpemUocHJldkNvbHVtbi5uYW1lLCB0cmltQ29sdW1uV2lkdGgocHJldkNvbHVtbiwgcHJldkNvbHVtbi53aWR0aCArIHN0YXJ0WCArIGR4KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKE1hdGguYWJzKHN0YXJ0WCAtIHN0YXJ0Q29sdW1uLndpZHRoKSA8PSBkcmFnT2Zmc2V0KSB7XHJcbiAgICAgICAgLy8gcmVzaXplIGN1cnJlbnRcclxuICAgICAgICBpZiAoc3RhcnRDb2x1bW4uZW5hYmxlUmVzaXppbmcpIHtcclxuICAgICAgICAgICAgb25SZXNpemUoc3RhcnRDb2x1bW4ubmFtZSwgdHJpbUNvbHVtbldpZHRoKHN0YXJ0Q29sdW1uLCBzdGFydFggKyBkeCkpO1xyXG4gICAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAoc3RhcnRDb2x1bW4uZW5hYmxlTW92aW5nKSB7XHJcbiAgICAgICAgLy8gbW92ZSBjdXJyZW50XHJcbiAgICAgICAgY29uc3QgW2xlZnRJbmRleCwgcmlnaHRJbmRleF0gPSBiaXNlY3RDb2x1bW5zKGNvbHVtbnMsIHggLSBzdGFydFgpO1xyXG4gICAgICAgIG9uTW92ZShcclxuICAgICAgICAgICAgc3RhcnRDb2x1bW4ubmFtZSxcclxuICAgICAgICAgICAgbGVmdEluZGV4ID09PSAtMSA/IG51bGwgOiBjb2x1bW5zW2xlZnRJbmRleF0ubmFtZSxcclxuICAgICAgICAgICAgcmlnaHRJbmRleCA9PT0gLTEgPyBudWxsIDogY29sdW1uc1tyaWdodEluZGV4XS5uYW1lXHJcbiAgICAgICAgKTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBtb3Zpbmc6IGZhbHNlXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGRyYWdnYWJsZSh7XHJcbiAgICBvZmZzZXQ6IGRyYWdPZmZzZXQsXHJcbiAgICBzdHlsZTogeyBoZWlnaHQ6ICdpbmhlcml0J31cclxufSkoY2xhc3MgSGVhZGVyIGV4dGVuZHMgQ29tcG9uZW50IHtcclxuICAgIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzKSB7XHJcbiAgICAgICAgaWYgKHRoaXMucHJvcHMuZHJhZ2dpbmcgJiYgdGhpcy5wcm9wcy54ICE9PSBuZXh0UHJvcHMueCkge1xyXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKGRyYWdNb3ZlKG5leHRQcm9wcykpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIW5leHRQcm9wcy5kcmFnZ2luZyAmJiB0aGlzLnByb3BzLmRyYWdnaW5nICE9PSBuZXh0UHJvcHMuZHJhZ2dpbmcpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZShkcmFnRW5kKG5leHRQcm9wcykpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZW5kZXIoeyBjb2x1bW5zLCBjb21wb25lbnQgfSwgeyBtb3ZpbmcsIG1vdmluZ0NvbHVtbiwgbW92aW5nSW5kZXgsIG1vdmluZ1Bvc2l0aW9uIH0pIHtcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8Q29udGFpbmVyPlxyXG4gICAgICAgICAgICAgICAge2NvbHVtbnMubWFwKChjb2x1bW4sIGluZGV4KSA9PlxyXG4gICAgICAgICAgICAgICAgICAgIDxDb2x1bW5XcmFwcGVyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleT17Y29sdW1uLm5hbWV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbj17Y29sdW1ufVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbmRleD17aW5kZXh9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3Q9e2luZGV4ID09PSBjb2x1bW5zLmxlbmd0aCAtIDF9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudD17Y29tcG9uZW50fVxyXG4gICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAge21vdmluZyAmJlxyXG4gICAgICAgICAgICAgICAgICAgIDxDb2x1bW5HaG9zdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB4PXttb3ZpbmdQb3NpdGlvbn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uPXttb3ZpbmdDb2x1bW59XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4PXttb3ZpbmdJbmRleH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PXtjb21wb25lbnR9XHJcbiAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgPC9Db250YWluZXI+XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufSk7XHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9IZWFkZXIuanMiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcblxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gaWRlbnRpdHkgZnVuY3Rpb24gZm9yIGNhbGxpbmcgaGFybW9ueSBpbXBvcnRzIHdpdGggdGhlIGNvcnJlY3QgY29udGV4dFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5pID0gZnVuY3Rpb24odmFsdWUpIHsgcmV0dXJuIHZhbHVlOyB9O1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbiBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbiBcdFx0XHR9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSA3NCk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd2VicGFjay9ib290c3RyYXAgOWEwMmE3OWUzYzRmNjVhZDE0ZGUiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJ2luZmVybm8vZGlzdC9pbmZlcm5vLWNyZWF0ZS1lbGVtZW50Lm5vZGUnKTtcbm1vZHVsZS5leHBvcnRzLmRlZmF1bHQgPSBtb2R1bGUuZXhwb3J0cztcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vaW5mZXJuby1jcmVhdGUtZWxlbWVudC9pbmZlcm5vLWNyZWF0ZS1lbGVtZW50LmpzXG4vLyBtb2R1bGUgaWQgPSAwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnaW5mZXJuby9kaXN0L2luZmVybm8tY29tcG9uZW50Lm5vZGUnKTtcbm1vZHVsZS5leHBvcnRzLmRlZmF1bHQgPSBtb2R1bGUuZXhwb3J0cztcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vaW5mZXJuby1jb21wb25lbnQvaW5mZXJuby1jb21wb25lbnQuanNcbi8vIG1vZHVsZSBpZCA9IDFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiZXhwb3J0IHsgZGVmYXVsdCBhcyBjb21wb3NlIH0gZnJvbSAnLi9jb21wb3NlLmpzJztcclxuZXhwb3J0IHsgZGVmYXVsdCBhcyBjaGVja1Byb3BzIH0gZnJvbSAnLi9jaGVja1Byb3BzLmpzJztcclxuZXhwb3J0IHsgZGVmYXVsdCBhcyBnZXRLZXlzQnlJbmRleCB9IGZyb20gJy4vZ2V0S2V5c0J5SW5kZXguanMnO1xyXG5leHBvcnQgeyBkZWZhdWx0IGFzIGdldFZpc2libGVSb3dzIH0gZnJvbSAnLi9nZXRWaXNpYmxlUm93cy5qcyc7XHJcbmV4cG9ydCB7IGRlZmF1bHQgYXMgYmlzZWN0Q29sdW1ucyB9IGZyb20gJy4vYmlzZWN0Q29sdW1ucy5qcyc7XHJcbmV4cG9ydCB7IGRlZmF1bHQgYXMgZmluZENvbHVtbiB9IGZyb20gJy4vZmluZENvbHVtbi5qcyc7XHJcbmV4cG9ydCB7IGRlZmF1bHQgYXMgdHJpbUNvbHVtbldpZHRoIH0gZnJvbSAnLi90cmltQ29sdW1uV2lkdGguanMnO1xyXG5leHBvcnQgeyBkZWZhdWx0IGFzIHNlbGVjdEdyaWREYXRhIH0gZnJvbSAnLi9zZWxlY3RHcmlkRGF0YS5qcyc7XHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy91dGlscy9pbmRleC5qcyIsIi8vIGNvbXBvc2VcclxuZXhwb3J0IHsgZGVmYXVsdCBhcyBzaG91bGRVcGRhdGUgfSBmcm9tICcuL3Nob3VsZFVwZGF0ZS5qcyc7XHJcbmV4cG9ydCB7IGRlZmF1bHQgYXMgd2l0aEhhbmRsZXJzIH0gZnJvbSAnLi93aXRoSGFuZGxlcnMuanMnO1xyXG5leHBvcnQgeyBkZWZhdWx0IGFzIHdpdGhMaW5rZWRIYW5kbGVycyB9IGZyb20gJy4vd2l0aExpbmtlZEhhbmRsZXJzLmpzJztcclxuZXhwb3J0IHsgZGVmYXVsdCBhcyB3aXRoUHJvcHMgfSBmcm9tICcuL3dpdGhQcm9wcy5qcyc7XHJcbmV4cG9ydCB7IGRlZmF1bHQgYXMgd2l0aFByb3BzT25DaGFuZ2UgfSBmcm9tICcuL3dpdGhQcm9wc09uQ2hhbmdlLmpzJztcclxuZXhwb3J0IHsgZGVmYXVsdCBhcyB3aXRoTWlkZGxlU3RhdGUgfSBmcm9tICcuL3dpdGhNaWRkbGVTdGF0ZS5qcyc7XHJcblxyXG4vLyBiZWhhdmlvclxyXG5leHBvcnQgeyBkZWZhdWx0IGFzIHdpdGhTY3JvbGxQcm9wcyB9IGZyb20gJy4vd2l0aFNjcm9sbFByb3BzLmpzJztcclxuZXhwb3J0IHsgZGVmYXVsdCBhcyBkcmFnZ2FibGUgfSBmcm9tICcuL2RyYWdnYWJsZS5qcyc7XHJcbmV4cG9ydCB7IGRlZmF1bHQgYXMgd2l0aERlZmF1bHRzIH0gZnJvbSAnLi93aXRoRGVmYXVsdHMuanMnO1xyXG5leHBvcnQgeyBkZWZhdWx0IGFzIHdpdGhQaW5uZWRDb2x1bW5zIH0gZnJvbSAnLi93aXRoUGlubmVkQ29sdW1ucy5qcyc7XHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9ob2MvaW5kZXguanMiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vZGlzdC9pbmZlcm5vLm5vZGUnKTtcbm1vZHVsZS5leHBvcnRzLmRlZmF1bHQgPSBtb2R1bGUuZXhwb3J0cztcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vaW5mZXJuby9pbmZlcm5vLmpzXG4vLyBtb2R1bGUgaWQgPSA0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImV4cG9ydCBjb25zdCBtYXJrTW92ZURlc3QgPSAobmFtZSwgbGVmdCwgcmlnaHQpID0+ICh7XHJcbiAgICB0eXBlOiAnTUFSS19NT1ZFX0RFU1QnLFxyXG4gICAgbmFtZSxcclxuICAgIGxlZnQsXHJcbiAgICByaWdodFxyXG59KTtcclxuXHJcbmV4cG9ydCBjb25zdCBtb3ZlQ29sdW1uID0gKG5hbWUsIGxlZnQsIHJpZ2h0KSA9PiAoe1xyXG4gICAgdHlwZTogJ01PVkVfQ09MVU1OJyxcclxuICAgIG5hbWUsXHJcbiAgICBsZWZ0LFxyXG4gICAgcmlnaHRcclxufSk7XHJcblxyXG5leHBvcnQgY29uc3QgcmVzaXplQ29sdW1uID0gKG5hbWUsIHNpemUpID0+ICh7XHJcbiAgICB0eXBlOiAnUkVTSVpFX0NPTFVNTicsXHJcbiAgICBuYW1lLFxyXG4gICAgc2l6ZVxyXG59KTtcclxuXHJcbmV4cG9ydCBjb25zdCBmaWx0ZXJDb2x1bW4gPSAobmFtZSwgZmlsdGVyKSA9PiAoe1xyXG4gICAgdHlwZTogJ0ZJTFRFUl9DT0xVTU4nLFxyXG4gICAgbmFtZSxcclxuICAgIGZpbHRlclxyXG59KTtcclxuXHJcbmV4cG9ydCBjb25zdCBzb3J0Q29sdW1uID0gbmFtZSA9PiAoe1xyXG4gICAgdHlwZTogJ1NPUlRfQ09MVU1OJyxcclxuICAgIG5hbWVcclxufSk7XHJcblxyXG5leHBvcnQgY29uc3Qgc2VsZWN0Um93ID0gcm93SW5kZXggPT4gKHtcclxuICAgIHR5cGU6ICdTRUxFQ1RfUk9XJyxcclxuICAgIHJvd0luZGV4XHJcbn0pO1xyXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvYWN0aW9uQ3JlYXRvcnMuanMiLCJpbXBvcnQgY3JlYXRlRWxlbWVudCBmcm9tICdpbmZlcm5vLWNyZWF0ZS1lbGVtZW50JztcclxuaW1wb3J0IENvbXBvbmVudCBmcm9tICdpbmZlcm5vLWNvbXBvbmVudCc7XHJcbmltcG9ydCB7IGNoZWNrUHJvcHMgfSBmcm9tICcuLi91dGlscy9pbmRleC5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCAodGVzdCwgbWFwUHJvcHMpID0+IEJhc2VDb21wb25lbnQgPT4gY2xhc3MgZXh0ZW5kcyBDb21wb25lbnQge1xyXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcclxuICAgICAgICBzdXBlcihwcm9wcyk7XHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IG1hcFByb3BzKHByb3BzKTtcclxuICAgICAgICB0aGlzLmNoZWNrUHJvcHMgPSB0eXBlb2YgdGVzdCA9PT0gJ2Z1bmN0aW9uJyA/IHRlc3QgOiBjaGVja1Byb3BzKC4uLnRlc3QpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY2hlY2tQcm9wcyh0aGlzLnByb3BzLCBuZXh0UHJvcHMpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUobWFwUHJvcHMobmV4dFByb3BzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcihwcm9wcywgc3RhdGUpIHtcclxuICAgICAgICByZXR1cm4gPEJhc2VDb21wb25lbnQgey4uLnByb3BzfSB7Li4uc3RhdGV9IC8+O1xyXG4gICAgfVxyXG59O1xyXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvaG9jL3dpdGhQcm9wc09uQ2hhbmdlLmpzIiwiZXhwb3J0IHsgZGVmYXVsdCBhcyBHcmlkIH0gZnJvbSAnLi9HcmlkLmpzJztcclxuZXhwb3J0IHsgZGVmYXVsdCBhcyBEZWZhdWx0Q29sdW1uIH0gZnJvbSAnLi9EZWZhdWx0Q29sdW1uLmpzJztcclxuZXhwb3J0IHsgZGVmYXVsdCBhcyBEZWZhdWx0Um93IH0gZnJvbSAnLi9EZWZhdWx0Um93LmpzJztcclxuZXhwb3J0IHsgZGVmYXVsdCBhcyByZWR1Y2VyIH0gZnJvbSAnLi9yZWR1Y2Vycy9pbmRleC5qcyc7XHJcbmV4cG9ydCB7IHNlbGVjdEdyaWREYXRhIH0gZnJvbSAnLi91dGlscy9pbmRleC5qcyc7XHJcbmV4cG9ydCB7IHdpdGhTY3JvbGxQcm9wcywgd2l0aExpbmtlZEhhbmRsZXJzIH0gZnJvbSAnLi9ob2MvaW5kZXguanMnO1xyXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvaW5kZXguanMiLCIvKlxuXHRNSVQgTGljZW5zZSBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocFxuXHRBdXRob3IgVG9iaWFzIEtvcHBlcnMgQHNva3JhXG4qL1xuLy8gY3NzIGJhc2UgY29kZSwgaW5qZWN0ZWQgYnkgdGhlIGNzcy1sb2FkZXJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24odXNlU291cmNlTWFwKSB7XG5cdHZhciBsaXN0ID0gW107XG5cblx0Ly8gcmV0dXJuIHRoZSBsaXN0IG9mIG1vZHVsZXMgYXMgY3NzIHN0cmluZ1xuXHRsaXN0LnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcoKSB7XG5cdFx0cmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uIChpdGVtKSB7XG5cdFx0XHR2YXIgY29udGVudCA9IGNzc1dpdGhNYXBwaW5nVG9TdHJpbmcoaXRlbSwgdXNlU291cmNlTWFwKTtcblx0XHRcdGlmKGl0ZW1bMl0pIHtcblx0XHRcdFx0cmV0dXJuIFwiQG1lZGlhIFwiICsgaXRlbVsyXSArIFwie1wiICsgY29udGVudCArIFwifVwiO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0dXJuIGNvbnRlbnQ7XG5cdFx0XHR9XG5cdFx0fSkuam9pbihcIlwiKTtcblx0fTtcblxuXHQvLyBpbXBvcnQgYSBsaXN0IG9mIG1vZHVsZXMgaW50byB0aGUgbGlzdFxuXHRsaXN0LmkgPSBmdW5jdGlvbihtb2R1bGVzLCBtZWRpYVF1ZXJ5KSB7XG5cdFx0aWYodHlwZW9mIG1vZHVsZXMgPT09IFwic3RyaW5nXCIpXG5cdFx0XHRtb2R1bGVzID0gW1tudWxsLCBtb2R1bGVzLCBcIlwiXV07XG5cdFx0dmFyIGFscmVhZHlJbXBvcnRlZE1vZHVsZXMgPSB7fTtcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIGlkID0gdGhpc1tpXVswXTtcblx0XHRcdGlmKHR5cGVvZiBpZCA9PT0gXCJudW1iZXJcIilcblx0XHRcdFx0YWxyZWFkeUltcG9ydGVkTW9kdWxlc1tpZF0gPSB0cnVlO1xuXHRcdH1cblx0XHRmb3IoaSA9IDA7IGkgPCBtb2R1bGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR2YXIgaXRlbSA9IG1vZHVsZXNbaV07XG5cdFx0XHQvLyBza2lwIGFscmVhZHkgaW1wb3J0ZWQgbW9kdWxlXG5cdFx0XHQvLyB0aGlzIGltcGxlbWVudGF0aW9uIGlzIG5vdCAxMDAlIHBlcmZlY3QgZm9yIHdlaXJkIG1lZGlhIHF1ZXJ5IGNvbWJpbmF0aW9uc1xuXHRcdFx0Ly8gIHdoZW4gYSBtb2R1bGUgaXMgaW1wb3J0ZWQgbXVsdGlwbGUgdGltZXMgd2l0aCBkaWZmZXJlbnQgbWVkaWEgcXVlcmllcy5cblx0XHRcdC8vICBJIGhvcGUgdGhpcyB3aWxsIG5ldmVyIG9jY3VyIChIZXkgdGhpcyB3YXkgd2UgaGF2ZSBzbWFsbGVyIGJ1bmRsZXMpXG5cdFx0XHRpZih0eXBlb2YgaXRlbVswXSAhPT0gXCJudW1iZXJcIiB8fCAhYWxyZWFkeUltcG9ydGVkTW9kdWxlc1tpdGVtWzBdXSkge1xuXHRcdFx0XHRpZihtZWRpYVF1ZXJ5ICYmICFpdGVtWzJdKSB7XG5cdFx0XHRcdFx0aXRlbVsyXSA9IG1lZGlhUXVlcnk7XG5cdFx0XHRcdH0gZWxzZSBpZihtZWRpYVF1ZXJ5KSB7XG5cdFx0XHRcdFx0aXRlbVsyXSA9IFwiKFwiICsgaXRlbVsyXSArIFwiKSBhbmQgKFwiICsgbWVkaWFRdWVyeSArIFwiKVwiO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGxpc3QucHVzaChpdGVtKTtcblx0XHRcdH1cblx0XHR9XG5cdH07XG5cdHJldHVybiBsaXN0O1xufTtcblxuZnVuY3Rpb24gY3NzV2l0aE1hcHBpbmdUb1N0cmluZyhpdGVtLCB1c2VTb3VyY2VNYXApIHtcblx0dmFyIGNvbnRlbnQgPSBpdGVtWzFdIHx8ICcnO1xuXHR2YXIgY3NzTWFwcGluZyA9IGl0ZW1bM107XG5cdGlmICghY3NzTWFwcGluZykge1xuXHRcdHJldHVybiBjb250ZW50O1xuXHR9XG5cblx0aWYgKHVzZVNvdXJjZU1hcCkge1xuXHRcdHZhciBzb3VyY2VNYXBwaW5nID0gdG9Db21tZW50KGNzc01hcHBpbmcpO1xuXHRcdHZhciBzb3VyY2VVUkxzID0gY3NzTWFwcGluZy5zb3VyY2VzLm1hcChmdW5jdGlvbiAoc291cmNlKSB7XG5cdFx0XHRyZXR1cm4gJy8qIyBzb3VyY2VVUkw9JyArIGNzc01hcHBpbmcuc291cmNlUm9vdCArIHNvdXJjZSArICcgKi8nXG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gW2NvbnRlbnRdLmNvbmNhdChzb3VyY2VVUkxzKS5jb25jYXQoW3NvdXJjZU1hcHBpbmddKS5qb2luKCdcXG4nKTtcblx0fVxuXG5cdHJldHVybiBbY29udGVudF0uam9pbignXFxuJyk7XG59XG5cbi8vIEFkYXB0ZWQgZnJvbSBjb252ZXJ0LXNvdXJjZS1tYXAgKE1JVClcbmZ1bmN0aW9uIHRvQ29tbWVudChzb3VyY2VNYXApIHtcbiAgdmFyIGJhc2U2NCA9IG5ldyBCdWZmZXIoSlNPTi5zdHJpbmdpZnkoc291cmNlTWFwKSkudG9TdHJpbmcoJ2Jhc2U2NCcpO1xuICB2YXIgZGF0YSA9ICdzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtjaGFyc2V0PXV0Zi04O2Jhc2U2NCwnICsgYmFzZTY0O1xuXG4gIHJldHVybiAnLyojICcgKyBkYXRhICsgJyAqLyc7XG59XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vY3NzLWxvYWRlci9saWIvY3NzLWJhc2UuanNcbi8vIG1vZHVsZSBpZCA9IDhcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLypcblx0TUlUIExpY2Vuc2UgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHBcblx0QXV0aG9yIFRvYmlhcyBLb3BwZXJzIEBzb2tyYVxuKi9cbnZhciBzdHlsZXNJbkRvbSA9IHt9LFxuXHRtZW1vaXplID0gZnVuY3Rpb24oZm4pIHtcblx0XHR2YXIgbWVtbztcblx0XHRyZXR1cm4gZnVuY3Rpb24gKCkge1xuXHRcdFx0aWYgKHR5cGVvZiBtZW1vID09PSBcInVuZGVmaW5lZFwiKSBtZW1vID0gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdHJldHVybiBtZW1vO1xuXHRcdH07XG5cdH0sXG5cdGlzT2xkSUUgPSBtZW1vaXplKGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiAvbXNpZSBbNi05XVxcYi8udGVzdChzZWxmLm5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKSk7XG5cdH0pLFxuXHRnZXRIZWFkRWxlbWVudCA9IG1lbW9pemUoZnVuY3Rpb24gKCkge1xuXHRcdHJldHVybiBkb2N1bWVudC5oZWFkIHx8IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaGVhZFwiKVswXTtcblx0fSksXG5cdHNpbmdsZXRvbkVsZW1lbnQgPSBudWxsLFxuXHRzaW5nbGV0b25Db3VudGVyID0gMCxcblx0c3R5bGVFbGVtZW50c0luc2VydGVkQXRUb3AgPSBbXTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihsaXN0LCBvcHRpb25zKSB7XG5cdGlmKHR5cGVvZiBERUJVRyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBERUJVRykge1xuXHRcdGlmKHR5cGVvZiBkb2N1bWVudCAhPT0gXCJvYmplY3RcIikgdGhyb3cgbmV3IEVycm9yKFwiVGhlIHN0eWxlLWxvYWRlciBjYW5ub3QgYmUgdXNlZCBpbiBhIG5vbi1icm93c2VyIGVudmlyb25tZW50XCIpO1xuXHR9XG5cblx0b3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdC8vIEZvcmNlIHNpbmdsZS10YWcgc29sdXRpb24gb24gSUU2LTksIHdoaWNoIGhhcyBhIGhhcmQgbGltaXQgb24gdGhlICMgb2YgPHN0eWxlPlxuXHQvLyB0YWdzIGl0IHdpbGwgYWxsb3cgb24gYSBwYWdlXG5cdGlmICh0eXBlb2Ygb3B0aW9ucy5zaW5nbGV0b24gPT09IFwidW5kZWZpbmVkXCIpIG9wdGlvbnMuc2luZ2xldG9uID0gaXNPbGRJRSgpO1xuXG5cdC8vIEJ5IGRlZmF1bHQsIGFkZCA8c3R5bGU+IHRhZ3MgdG8gdGhlIGJvdHRvbSBvZiA8aGVhZD4uXG5cdGlmICh0eXBlb2Ygb3B0aW9ucy5pbnNlcnRBdCA9PT0gXCJ1bmRlZmluZWRcIikgb3B0aW9ucy5pbnNlcnRBdCA9IFwiYm90dG9tXCI7XG5cblx0dmFyIHN0eWxlcyA9IGxpc3RUb1N0eWxlcyhsaXN0KTtcblx0YWRkU3R5bGVzVG9Eb20oc3R5bGVzLCBvcHRpb25zKTtcblxuXHRyZXR1cm4gZnVuY3Rpb24gdXBkYXRlKG5ld0xpc3QpIHtcblx0XHR2YXIgbWF5UmVtb3ZlID0gW107XG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IHN0eWxlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIGl0ZW0gPSBzdHlsZXNbaV07XG5cdFx0XHR2YXIgZG9tU3R5bGUgPSBzdHlsZXNJbkRvbVtpdGVtLmlkXTtcblx0XHRcdGRvbVN0eWxlLnJlZnMtLTtcblx0XHRcdG1heVJlbW92ZS5wdXNoKGRvbVN0eWxlKTtcblx0XHR9XG5cdFx0aWYobmV3TGlzdCkge1xuXHRcdFx0dmFyIG5ld1N0eWxlcyA9IGxpc3RUb1N0eWxlcyhuZXdMaXN0KTtcblx0XHRcdGFkZFN0eWxlc1RvRG9tKG5ld1N0eWxlcywgb3B0aW9ucyk7XG5cdFx0fVxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBtYXlSZW1vdmUubGVuZ3RoOyBpKyspIHtcblx0XHRcdHZhciBkb21TdHlsZSA9IG1heVJlbW92ZVtpXTtcblx0XHRcdGlmKGRvbVN0eWxlLnJlZnMgPT09IDApIHtcblx0XHRcdFx0Zm9yKHZhciBqID0gMDsgaiA8IGRvbVN0eWxlLnBhcnRzLmxlbmd0aDsgaisrKVxuXHRcdFx0XHRcdGRvbVN0eWxlLnBhcnRzW2pdKCk7XG5cdFx0XHRcdGRlbGV0ZSBzdHlsZXNJbkRvbVtkb21TdHlsZS5pZF07XG5cdFx0XHR9XG5cdFx0fVxuXHR9O1xufVxuXG5mdW5jdGlvbiBhZGRTdHlsZXNUb0RvbShzdHlsZXMsIG9wdGlvbnMpIHtcblx0Zm9yKHZhciBpID0gMDsgaSA8IHN0eWxlcy5sZW5ndGg7IGkrKykge1xuXHRcdHZhciBpdGVtID0gc3R5bGVzW2ldO1xuXHRcdHZhciBkb21TdHlsZSA9IHN0eWxlc0luRG9tW2l0ZW0uaWRdO1xuXHRcdGlmKGRvbVN0eWxlKSB7XG5cdFx0XHRkb21TdHlsZS5yZWZzKys7XG5cdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgZG9tU3R5bGUucGFydHMubGVuZ3RoOyBqKyspIHtcblx0XHRcdFx0ZG9tU3R5bGUucGFydHNbal0oaXRlbS5wYXJ0c1tqXSk7XG5cdFx0XHR9XG5cdFx0XHRmb3IoOyBqIDwgaXRlbS5wYXJ0cy5sZW5ndGg7IGorKykge1xuXHRcdFx0XHRkb21TdHlsZS5wYXJ0cy5wdXNoKGFkZFN0eWxlKGl0ZW0ucGFydHNbal0sIG9wdGlvbnMpKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0dmFyIHBhcnRzID0gW107XG5cdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgaXRlbS5wYXJ0cy5sZW5ndGg7IGorKykge1xuXHRcdFx0XHRwYXJ0cy5wdXNoKGFkZFN0eWxlKGl0ZW0ucGFydHNbal0sIG9wdGlvbnMpKTtcblx0XHRcdH1cblx0XHRcdHN0eWxlc0luRG9tW2l0ZW0uaWRdID0ge2lkOiBpdGVtLmlkLCByZWZzOiAxLCBwYXJ0czogcGFydHN9O1xuXHRcdH1cblx0fVxufVxuXG5mdW5jdGlvbiBsaXN0VG9TdHlsZXMobGlzdCkge1xuXHR2YXIgc3R5bGVzID0gW107XG5cdHZhciBuZXdTdHlsZXMgPSB7fTtcblx0Zm9yKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcblx0XHR2YXIgaXRlbSA9IGxpc3RbaV07XG5cdFx0dmFyIGlkID0gaXRlbVswXTtcblx0XHR2YXIgY3NzID0gaXRlbVsxXTtcblx0XHR2YXIgbWVkaWEgPSBpdGVtWzJdO1xuXHRcdHZhciBzb3VyY2VNYXAgPSBpdGVtWzNdO1xuXHRcdHZhciBwYXJ0ID0ge2NzczogY3NzLCBtZWRpYTogbWVkaWEsIHNvdXJjZU1hcDogc291cmNlTWFwfTtcblx0XHRpZighbmV3U3R5bGVzW2lkXSlcblx0XHRcdHN0eWxlcy5wdXNoKG5ld1N0eWxlc1tpZF0gPSB7aWQ6IGlkLCBwYXJ0czogW3BhcnRdfSk7XG5cdFx0ZWxzZVxuXHRcdFx0bmV3U3R5bGVzW2lkXS5wYXJ0cy5wdXNoKHBhcnQpO1xuXHR9XG5cdHJldHVybiBzdHlsZXM7XG59XG5cbmZ1bmN0aW9uIGluc2VydFN0eWxlRWxlbWVudChvcHRpb25zLCBzdHlsZUVsZW1lbnQpIHtcblx0dmFyIGhlYWQgPSBnZXRIZWFkRWxlbWVudCgpO1xuXHR2YXIgbGFzdFN0eWxlRWxlbWVudEluc2VydGVkQXRUb3AgPSBzdHlsZUVsZW1lbnRzSW5zZXJ0ZWRBdFRvcFtzdHlsZUVsZW1lbnRzSW5zZXJ0ZWRBdFRvcC5sZW5ndGggLSAxXTtcblx0aWYgKG9wdGlvbnMuaW5zZXJ0QXQgPT09IFwidG9wXCIpIHtcblx0XHRpZighbGFzdFN0eWxlRWxlbWVudEluc2VydGVkQXRUb3ApIHtcblx0XHRcdGhlYWQuaW5zZXJ0QmVmb3JlKHN0eWxlRWxlbWVudCwgaGVhZC5maXJzdENoaWxkKTtcblx0XHR9IGVsc2UgaWYobGFzdFN0eWxlRWxlbWVudEluc2VydGVkQXRUb3AubmV4dFNpYmxpbmcpIHtcblx0XHRcdGhlYWQuaW5zZXJ0QmVmb3JlKHN0eWxlRWxlbWVudCwgbGFzdFN0eWxlRWxlbWVudEluc2VydGVkQXRUb3AubmV4dFNpYmxpbmcpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRoZWFkLmFwcGVuZENoaWxkKHN0eWxlRWxlbWVudCk7XG5cdFx0fVxuXHRcdHN0eWxlRWxlbWVudHNJbnNlcnRlZEF0VG9wLnB1c2goc3R5bGVFbGVtZW50KTtcblx0fSBlbHNlIGlmIChvcHRpb25zLmluc2VydEF0ID09PSBcImJvdHRvbVwiKSB7XG5cdFx0aGVhZC5hcHBlbmRDaGlsZChzdHlsZUVsZW1lbnQpO1xuXHR9IGVsc2Uge1xuXHRcdHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdmFsdWUgZm9yIHBhcmFtZXRlciAnaW5zZXJ0QXQnLiBNdXN0IGJlICd0b3AnIG9yICdib3R0b20nLlwiKTtcblx0fVxufVxuXG5mdW5jdGlvbiByZW1vdmVTdHlsZUVsZW1lbnQoc3R5bGVFbGVtZW50KSB7XG5cdHN0eWxlRWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHN0eWxlRWxlbWVudCk7XG5cdHZhciBpZHggPSBzdHlsZUVsZW1lbnRzSW5zZXJ0ZWRBdFRvcC5pbmRleE9mKHN0eWxlRWxlbWVudCk7XG5cdGlmKGlkeCA+PSAwKSB7XG5cdFx0c3R5bGVFbGVtZW50c0luc2VydGVkQXRUb3Auc3BsaWNlKGlkeCwgMSk7XG5cdH1cbn1cblxuZnVuY3Rpb24gY3JlYXRlU3R5bGVFbGVtZW50KG9wdGlvbnMpIHtcblx0dmFyIHN0eWxlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzdHlsZVwiKTtcblx0c3R5bGVFbGVtZW50LnR5cGUgPSBcInRleHQvY3NzXCI7XG5cdGluc2VydFN0eWxlRWxlbWVudChvcHRpb25zLCBzdHlsZUVsZW1lbnQpO1xuXHRyZXR1cm4gc3R5bGVFbGVtZW50O1xufVxuXG5mdW5jdGlvbiBjcmVhdGVMaW5rRWxlbWVudChvcHRpb25zKSB7XG5cdHZhciBsaW5rRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaW5rXCIpO1xuXHRsaW5rRWxlbWVudC5yZWwgPSBcInN0eWxlc2hlZXRcIjtcblx0aW5zZXJ0U3R5bGVFbGVtZW50KG9wdGlvbnMsIGxpbmtFbGVtZW50KTtcblx0cmV0dXJuIGxpbmtFbGVtZW50O1xufVxuXG5mdW5jdGlvbiBhZGRTdHlsZShvYmosIG9wdGlvbnMpIHtcblx0dmFyIHN0eWxlRWxlbWVudCwgdXBkYXRlLCByZW1vdmU7XG5cblx0aWYgKG9wdGlvbnMuc2luZ2xldG9uKSB7XG5cdFx0dmFyIHN0eWxlSW5kZXggPSBzaW5nbGV0b25Db3VudGVyKys7XG5cdFx0c3R5bGVFbGVtZW50ID0gc2luZ2xldG9uRWxlbWVudCB8fCAoc2luZ2xldG9uRWxlbWVudCA9IGNyZWF0ZVN0eWxlRWxlbWVudChvcHRpb25zKSk7XG5cdFx0dXBkYXRlID0gYXBwbHlUb1NpbmdsZXRvblRhZy5iaW5kKG51bGwsIHN0eWxlRWxlbWVudCwgc3R5bGVJbmRleCwgZmFsc2UpO1xuXHRcdHJlbW92ZSA9IGFwcGx5VG9TaW5nbGV0b25UYWcuYmluZChudWxsLCBzdHlsZUVsZW1lbnQsIHN0eWxlSW5kZXgsIHRydWUpO1xuXHR9IGVsc2UgaWYob2JqLnNvdXJjZU1hcCAmJlxuXHRcdHR5cGVvZiBVUkwgPT09IFwiZnVuY3Rpb25cIiAmJlxuXHRcdHR5cGVvZiBVUkwuY3JlYXRlT2JqZWN0VVJMID09PSBcImZ1bmN0aW9uXCIgJiZcblx0XHR0eXBlb2YgVVJMLnJldm9rZU9iamVjdFVSTCA9PT0gXCJmdW5jdGlvblwiICYmXG5cdFx0dHlwZW9mIEJsb2IgPT09IFwiZnVuY3Rpb25cIiAmJlxuXHRcdHR5cGVvZiBidG9hID09PSBcImZ1bmN0aW9uXCIpIHtcblx0XHRzdHlsZUVsZW1lbnQgPSBjcmVhdGVMaW5rRWxlbWVudChvcHRpb25zKTtcblx0XHR1cGRhdGUgPSB1cGRhdGVMaW5rLmJpbmQobnVsbCwgc3R5bGVFbGVtZW50KTtcblx0XHRyZW1vdmUgPSBmdW5jdGlvbigpIHtcblx0XHRcdHJlbW92ZVN0eWxlRWxlbWVudChzdHlsZUVsZW1lbnQpO1xuXHRcdFx0aWYoc3R5bGVFbGVtZW50LmhyZWYpXG5cdFx0XHRcdFVSTC5yZXZva2VPYmplY3RVUkwoc3R5bGVFbGVtZW50LmhyZWYpO1xuXHRcdH07XG5cdH0gZWxzZSB7XG5cdFx0c3R5bGVFbGVtZW50ID0gY3JlYXRlU3R5bGVFbGVtZW50KG9wdGlvbnMpO1xuXHRcdHVwZGF0ZSA9IGFwcGx5VG9UYWcuYmluZChudWxsLCBzdHlsZUVsZW1lbnQpO1xuXHRcdHJlbW92ZSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmVtb3ZlU3R5bGVFbGVtZW50KHN0eWxlRWxlbWVudCk7XG5cdFx0fTtcblx0fVxuXG5cdHVwZGF0ZShvYmopO1xuXG5cdHJldHVybiBmdW5jdGlvbiB1cGRhdGVTdHlsZShuZXdPYmopIHtcblx0XHRpZihuZXdPYmopIHtcblx0XHRcdGlmKG5ld09iai5jc3MgPT09IG9iai5jc3MgJiYgbmV3T2JqLm1lZGlhID09PSBvYmoubWVkaWEgJiYgbmV3T2JqLnNvdXJjZU1hcCA9PT0gb2JqLnNvdXJjZU1hcClcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0dXBkYXRlKG9iaiA9IG5ld09iaik7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJlbW92ZSgpO1xuXHRcdH1cblx0fTtcbn1cblxudmFyIHJlcGxhY2VUZXh0ID0gKGZ1bmN0aW9uICgpIHtcblx0dmFyIHRleHRTdG9yZSA9IFtdO1xuXG5cdHJldHVybiBmdW5jdGlvbiAoaW5kZXgsIHJlcGxhY2VtZW50KSB7XG5cdFx0dGV4dFN0b3JlW2luZGV4XSA9IHJlcGxhY2VtZW50O1xuXHRcdHJldHVybiB0ZXh0U3RvcmUuZmlsdGVyKEJvb2xlYW4pLmpvaW4oJ1xcbicpO1xuXHR9O1xufSkoKTtcblxuZnVuY3Rpb24gYXBwbHlUb1NpbmdsZXRvblRhZyhzdHlsZUVsZW1lbnQsIGluZGV4LCByZW1vdmUsIG9iaikge1xuXHR2YXIgY3NzID0gcmVtb3ZlID8gXCJcIiA6IG9iai5jc3M7XG5cblx0aWYgKHN0eWxlRWxlbWVudC5zdHlsZVNoZWV0KSB7XG5cdFx0c3R5bGVFbGVtZW50LnN0eWxlU2hlZXQuY3NzVGV4dCA9IHJlcGxhY2VUZXh0KGluZGV4LCBjc3MpO1xuXHR9IGVsc2Uge1xuXHRcdHZhciBjc3NOb2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY3NzKTtcblx0XHR2YXIgY2hpbGROb2RlcyA9IHN0eWxlRWxlbWVudC5jaGlsZE5vZGVzO1xuXHRcdGlmIChjaGlsZE5vZGVzW2luZGV4XSkgc3R5bGVFbGVtZW50LnJlbW92ZUNoaWxkKGNoaWxkTm9kZXNbaW5kZXhdKTtcblx0XHRpZiAoY2hpbGROb2Rlcy5sZW5ndGgpIHtcblx0XHRcdHN0eWxlRWxlbWVudC5pbnNlcnRCZWZvcmUoY3NzTm9kZSwgY2hpbGROb2Rlc1tpbmRleF0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRzdHlsZUVsZW1lbnQuYXBwZW5kQ2hpbGQoY3NzTm9kZSk7XG5cdFx0fVxuXHR9XG59XG5cbmZ1bmN0aW9uIGFwcGx5VG9UYWcoc3R5bGVFbGVtZW50LCBvYmopIHtcblx0dmFyIGNzcyA9IG9iai5jc3M7XG5cdHZhciBtZWRpYSA9IG9iai5tZWRpYTtcblxuXHRpZihtZWRpYSkge1xuXHRcdHN0eWxlRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJtZWRpYVwiLCBtZWRpYSlcblx0fVxuXG5cdGlmKHN0eWxlRWxlbWVudC5zdHlsZVNoZWV0KSB7XG5cdFx0c3R5bGVFbGVtZW50LnN0eWxlU2hlZXQuY3NzVGV4dCA9IGNzcztcblx0fSBlbHNlIHtcblx0XHR3aGlsZShzdHlsZUVsZW1lbnQuZmlyc3RDaGlsZCkge1xuXHRcdFx0c3R5bGVFbGVtZW50LnJlbW92ZUNoaWxkKHN0eWxlRWxlbWVudC5maXJzdENoaWxkKTtcblx0XHR9XG5cdFx0c3R5bGVFbGVtZW50LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNzcykpO1xuXHR9XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUxpbmsobGlua0VsZW1lbnQsIG9iaikge1xuXHR2YXIgY3NzID0gb2JqLmNzcztcblx0dmFyIHNvdXJjZU1hcCA9IG9iai5zb3VyY2VNYXA7XG5cblx0aWYoc291cmNlTWFwKSB7XG5cdFx0Ly8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMjY2MDM4NzVcblx0XHRjc3MgKz0gXCJcXG4vKiMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LFwiICsgYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkoc291cmNlTWFwKSkpKSArIFwiICovXCI7XG5cdH1cblxuXHR2YXIgYmxvYiA9IG5ldyBCbG9iKFtjc3NdLCB7IHR5cGU6IFwidGV4dC9jc3NcIiB9KTtcblxuXHR2YXIgb2xkU3JjID0gbGlua0VsZW1lbnQuaHJlZjtcblxuXHRsaW5rRWxlbWVudC5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcblxuXHRpZihvbGRTcmMpXG5cdFx0VVJMLnJldm9rZU9iamVjdFVSTChvbGRTcmMpO1xufVxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L3N0eWxlLWxvYWRlci9hZGRTdHlsZXMuanNcbi8vIG1vZHVsZSBpZCA9IDlcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IE1pbmltYWwgZnJvbSAnLi9kZW1vcy9NaW5pbWFsLmpzJztcclxuaW1wb3J0IG1pbmltYWxDb2RlIGZyb20gJ3Jhdy1sb2FkZXIhLi9kZW1vcy9NaW5pbWFsLmpzJztcclxuaW1wb3J0IFBpbm5lZENvbHVtbnMgZnJvbSAnLi9kZW1vcy9QaW5uZWRDb2x1bW5zLmpzJztcclxuaW1wb3J0IHBpbm5lZENvbHVtbnNDb2RlIGZyb20gJ3Jhdy1sb2FkZXIhLi9kZW1vcy9QaW5uZWRDb2x1bW5zLmpzJztcclxuaW1wb3J0IEdyaWREZW1vIGZyb20gJy4vZGVtb3MvR3JpZERlbW8uanMnO1xyXG5pbXBvcnQgZ3JpZERlbW9Db2RlIGZyb20gJ3Jhdy1sb2FkZXIhLi9kZW1vcy9HcmlkRGVtby5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBbXHJcbiAgICB7XHJcbiAgICAgICAgaHJlZjogJ21pbmltYWwnLFxyXG4gICAgICAgIHRpdGxlOiAnTWluaW1hbCcsXHJcbiAgICAgICAgY29tcG9uZW50OiBNaW5pbWFsLFxyXG4gICAgICAgIGNvZGU6IG1pbmltYWxDb2RlXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIGhyZWY6ICdwaW5uZWQtY29sdW1ucycsXHJcbiAgICAgICAgdGl0bGU6ICdQaW5uZWQgY29sdW1ucycsXHJcbiAgICAgICAgY29tcG9uZW50OiBQaW5uZWRDb2x1bW5zLFxyXG4gICAgICAgIGNvZGU6IHBpbm5lZENvbHVtbnNDb2RlXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIGhyZWY6ICdjb21wbGV4JyxcclxuICAgICAgICB0aXRsZTogJ0NvbXBsZXggZGVtbycsXHJcbiAgICAgICAgY29tcG9uZW50OiBHcmlkRGVtbyxcclxuICAgICAgICBjb2RlOiBncmlkRGVtb0NvZGVcclxuICAgIH1cclxuXTtcclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2V4YW1wbGVzL25hdi5qcyIsImltcG9ydCBjcmVhdGVFbGVtZW50IGZyb20gJ2luZmVybm8tY3JlYXRlLWVsZW1lbnQnO1xyXG5pbXBvcnQgeyB3aXRoTGlua2VkSGFuZGxlcnMgfSBmcm9tICcuL2hvYy9pbmRleC5qcyc7XHJcbmltcG9ydCB7IGZpbHRlckNvbHVtbiwgc29ydENvbHVtbiB9IGZyb20gJy4vYWN0aW9uQ3JlYXRvcnMuanMnO1xyXG5cclxuY29uc3QgYm9yZGVyID0gJzFweCBzb2xpZCAjZDRkNGQ0JztcclxuY29uc3QgYWN0aXZlQm9yZGVyID0gJzFweCBzb2xpZCAjMDAwJztcclxuXHJcbmNvbnN0IGdldENvbHVtblN0eWxlID0gKHN0YXRlLCBjb2x1bW4sIGxhc3QsIGdob3N0KSA9PiAoe1xyXG4gICAgcG9zaXRpb246ICdyZWxhdGl2ZScsXHJcbiAgICBoZWlnaHQ6ICdpbmhlcml0JyxcclxuICAgIGJveFNpemluZzogJ2JvcmRlci1ib3gnLFxyXG4gICAgcGFkZGluZzogJzAgOHB4JyxcclxuICAgIGJvcmRlclRvcDogYm9yZGVyLFxyXG4gICAgYm9yZGVyQm90dG9tOiBib3JkZXIsXHJcbiAgICBib3JkZXJMZWZ0OiBnaG9zdCAmJiBib3JkZXJcclxuICAgICAgICB8fCAoc3RhdGUubW92aW5nICYmIHN0YXRlLm1vdmluZy5yaWdodCA9PT0gY29sdW1uLm5hbWUgPyBhY3RpdmVCb3JkZXIgOiBib3JkZXIpXHJcbiAgICAgICAgfHwgJycsXHJcblxyXG4gICAgYm9yZGVyUmlnaHQ6IGdob3N0ICYmIGJvcmRlclxyXG4gICAgICAgIHx8IGxhc3QgJiYgKHN0YXRlLm1vdmluZyAmJiBzdGF0ZS5tb3ZpbmcubGVmdCA9PT0gY29sdW1uLm5hbWUgPyBhY3RpdmVCb3JkZXIgOiBib3JkZXIpXHJcbiAgICAgICAgfHwgJycsXHJcbiAgICBiYWNrZ3JvdW5kOiAnbGluZWFyLWdyYWRpZW50KHRvIHRvcCwgI2VlZWVlZSwgI2ZmZmZmZiknLFxyXG4gICAgb3BhY2l0eTogZ2hvc3QgPyAuOCA6IDFcclxufSk7XHJcblxyXG5jb25zdCBnZXRJbnB1dFN0eWxlID0gKCkgPT4gKHtcclxuICAgIHdpZHRoOiAnMTAwJScsXHJcbiAgICBib3hTaXppbmc6ICdib3JkZXItYm94JyxcclxuICAgIHBhZGRpbmc6ICcwIDhweCcsXHJcbiAgICBib3JkZXI6IDAsXHJcbiAgICBib3JkZXJCb3R0b206IGJvcmRlcixcclxuICAgIG1hcmdpbkJvdHRvbTogOFxyXG59KTtcclxuXHJcbmNvbnN0IEFycm93ID0gKHsgZGlyZWN0aW9uIH0pID0+IChcclxuICAgIDxkaXYgc3R5bGU9e3tcclxuICAgICAgICBbZGlyZWN0aW9uID09PSAnYXNjJyA/ICdib3JkZXJCb3R0b20nIDogJ2JvcmRlclRvcCddOiAnNHB4IHNvbGlkJyxcclxuICAgICAgICBib3JkZXJMZWZ0OiAnNHB4IHNvbGlkIHRyYW5zcGFyZW50JyxcclxuICAgICAgICBib3JkZXJSaWdodDogJzRweCBzb2xpZCB0cmFuc3BhcmVudCdcclxuICAgIH19PlxyXG4gICAgPC9kaXY+XHJcbik7XHJcblxyXG5leHBvcnQgZGVmYXVsdCB3aXRoTGlua2VkSGFuZGxlcnMoe1xyXG4gICAgb25Tb3J0Q2xpbms6IHByb3BzID0+IHByb3BzLmNhbGxiYWNrKHNvcnRDb2x1bW4ocHJvcHMuY29sdW1uLm5hbWUpKSxcclxuICAgIG9uRmlsdGVySW5wdXQ6IChwcm9wcywgZXZlbnQpID0+IHByb3BzLmNhbGxiYWNrKGZpbHRlckNvbHVtbihwcm9wcy5jb2x1bW4ubmFtZSwgZXZlbnQudGFyZ2V0LnZhbHVlKSlcclxufSkocHJvcHMgPT5cclxuICAgIDxkaXYgc3R5bGU9e2dldENvbHVtblN0eWxlKHByb3BzLnN0YXRlLCBwcm9wcy5jb2x1bW4sIHByb3BzLmxhc3QsIHByb3BzLmdob3N0KX0+XHJcbiAgICAgICAgPGRpdiBzdHlsZT17eyBkaXNwbGF5OiAnZmxleCcsIGFsaWduSXRlbXM6ICdjZW50ZXInLCBoZWlnaHQ6IDMwLCB9fSBvbkNsaWNrPXtwcm9wcy5vblNvcnRDbGluayhwcm9wcyl9PlxyXG4gICAgICAgICAgICB7cHJvcHMuY29sdW1uLmRpc3BsYXlOYW1lIHx8IHByb3BzLmNvbHVtbi5uYW1lfVxyXG4gICAgICAgICAgICB7cHJvcHMuY29sdW1uLnNvcnQgJiZcclxuICAgICAgICAgICAgICAgIDxBcnJvdyBkaXJlY3Rpb249e3Byb3BzLmNvbHVtbi5zb3J0fSAvPlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAge3Byb3BzLmNvbHVtbi5lbmFibGVGaWx0ZXJpbmcgJiZcclxuICAgICAgICAgICAgPGlucHV0IHN0eWxlPXtnZXRJbnB1dFN0eWxlKCl9XHJcbiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17cHJvcHMuY29sdW1uLnBsYWNlaG9sZGVyfVxyXG4gICAgICAgICAgICAgICAgdmFsdWU9e3Byb3BzLmNvbHVtbi5maWx0ZXJ9XHJcbiAgICAgICAgICAgICAgICBvbklucHV0PXtwcm9wcy5vbkZpbHRlcklucHV0KHByb3BzKX0gLz5cclxuICAgICAgICB9XHJcbiAgICA8L2Rpdj5cclxuKTtcclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL0RlZmF1bHRDb2x1bW4uanMiLCJpbXBvcnQgY3JlYXRlRWxlbWVudCBmcm9tICdpbmZlcm5vLWNyZWF0ZS1lbGVtZW50JztcclxuaW1wb3J0IHsgd2l0aExpbmtlZEhhbmRsZXJzIH0gZnJvbSAnLi9ob2MvaW5kZXguanMnO1xyXG5pbXBvcnQgeyBzZWxlY3RSb3cgfSBmcm9tICcuL2FjdGlvbkNyZWF0b3JzLmpzJztcclxuXHJcbmNvbnN0IGJvcmRlciA9ICcxcHggc29saWQgI2Q0ZDRkNCc7XHJcblxyXG5jb25zdCBnZXRSb3dTdHlsZSA9IChzdGF0ZSwgaW5kZXgpID0+ICh7XHJcbiAgICBkaXNwbGF5OiAnZmxleCcsXHJcbiAgICBoZWlnaHQ6ICdpbmhlcml0JyxcclxuICAgIGN1cnNvcjogJ2RlZmF1bHQnLFxyXG4gICAgYmFja2dyb3VuZDogc3RhdGUuc2VsZWN0ZWRJbmRleCA9PT0gaW5kZXggPyAnI2M5ZGRlMScgOiBpbmRleCAlIDIgPT09IDAgPyAnI2ZmZicgOiAnI2YzZjNmMydcclxufSk7XHJcblxyXG5jb25zdCBnZXRDb2x1bW5TdHlsZSA9IChjb2x1bW4sIGxhc3QpID0+ICh7XHJcbiAgICBmbGV4U2hyaW5rOiAwLFxyXG4gICAgZGlzcGxheTogJ2ZsZXgnLFxyXG4gICAgYWxpZ25JdGVtczogJ2NlbnRlcicsXHJcbiAgICB3aWR0aDogY29sdW1uLndpZHRoLFxyXG4gICAgcGFkZGluZzogJzAgOHB4JyxcclxuICAgIGJveFNpemluZzogJ2JvcmRlci1ib3gnLFxyXG4gICAgYm9yZGVyTGVmdDogYm9yZGVyLFxyXG4gICAgYm9yZGVyUmlnaHQ6IGxhc3QgPyBib3JkZXIgOiAnJ1xyXG59KTtcclxuXHJcbmNvbnN0IERlZmF1bHRSb3cgPSB3aXRoTGlua2VkSGFuZGxlcnMoe1xyXG4gICAgc2VsZWN0Um93OiBwcm9wcyA9PiBwcm9wcy5jYWxsYmFjayhzZWxlY3RSb3cocHJvcHMuaW5kZXgpKVxyXG59KShwcm9wcyA9PlxyXG4gICAgPGRpdiBzdHlsZT17Z2V0Um93U3R5bGUocHJvcHMuc3RhdGUsIHByb3BzLmluZGV4KX0gb25DbGljaz17cHJvcHMuc2VsZWN0Um93KHByb3BzKX0+XHJcbiAgICAgICAge3Byb3BzLmNvbHVtbnMubWFwKChpdGVtLCBjb2x1bW5JbmRleCkgPT5cclxuICAgICAgICAgICAgPGRpdiBzdHlsZT17Z2V0Q29sdW1uU3R5bGUoaXRlbSwgY29sdW1uSW5kZXggPT09IHByb3BzLmNvbHVtbnMubGVuZ3RoIC0gMSl9PlxyXG4gICAgICAgICAgICAgICAgPGRpdiBzdHlsZT17eyBvdmVyZmxvdzogJ2hpZGRlbicsIHdoaXRlU3BhY2U6ICdub3dyYXAnLCB0ZXh0T3ZlcmZsb3c6ICdlbGxpcHNpcycgfX0+XHJcbiAgICAgICAgICAgICAgICAgICAge3Byb3BzLmRhdHVtW2l0ZW0ubmFtZV19XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgKX1cclxuICAgIDwvZGl2PlxyXG4pO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgRGVmYXVsdFJvdztcclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL0RlZmF1bHRSb3cuanMiLCJpbXBvcnQgY3JlYXRlRWxlbWVudCBmcm9tICdpbmZlcm5vLWNyZWF0ZS1lbGVtZW50JztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IG1hcFByb3BzID0+IEJhc2VDb21wb25lbnQgPT4gcHJvcHMgPT4gPEJhc2VDb21wb25lbnQgey4uLnByb3BzfSB7Li4ubWFwUHJvcHMocHJvcHMpfSAvPjtcclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2hvYy93aXRoUHJvcHMuanMiLCJleHBvcnQgZGVmYXVsdCAoY29sdW1ucywgeCkgPT4ge1xyXG4gICAgaWYgKHggPCAwIHx8IGNvbHVtbnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgcmV0dXJuIFstMSwgeF07XHJcbiAgICB9XHJcbiAgICBsZXQgc3VtID0gMDtcclxuICAgIHJldHVybiBjb2x1bW5zLnJlZHVjZSgoYWNjLCB7IHdpZHRoIH0sIGluZGV4KSA9PiB7XHJcbiAgICAgICAgY29uc3QgbGVmdCA9IHN1bTtcclxuICAgICAgICBzdW0gKz0gd2lkdGg7XHJcbiAgICAgICAgaWYgKGxlZnQgPD0geCAmJiB4IDwgc3VtKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbaW5kZXgsIHggLSBsZWZ0XTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHN1bSA9PT0geCkge1xyXG4gICAgICAgICAgICByZXR1cm4gW2luZGV4LCB3aWR0aF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzdW0gPCB4KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbaW5kZXggKyAxLCB4IC0gc3VtXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGFjYztcclxuICAgIH0sIG51bGwpO1xyXG59O1xyXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvdXRpbHMvZmluZENvbHVtbi5qcyIsIid1c2Ugc3RyaWN0JztcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbnZhciBhZGRMZWFkaW5nU2xhc2ggPSBleHBvcnRzLmFkZExlYWRpbmdTbGFzaCA9IGZ1bmN0aW9uIGFkZExlYWRpbmdTbGFzaChwYXRoKSB7XG4gIHJldHVybiBwYXRoLmNoYXJBdCgwKSA9PT0gJy8nID8gcGF0aCA6ICcvJyArIHBhdGg7XG59O1xuXG52YXIgc3RyaXBMZWFkaW5nU2xhc2ggPSBleHBvcnRzLnN0cmlwTGVhZGluZ1NsYXNoID0gZnVuY3Rpb24gc3RyaXBMZWFkaW5nU2xhc2gocGF0aCkge1xuICByZXR1cm4gcGF0aC5jaGFyQXQoMCkgPT09ICcvJyA/IHBhdGguc3Vic3RyKDEpIDogcGF0aDtcbn07XG5cbnZhciBzdHJpcFByZWZpeCA9IGV4cG9ydHMuc3RyaXBQcmVmaXggPSBmdW5jdGlvbiBzdHJpcFByZWZpeChwYXRoLCBwcmVmaXgpIHtcbiAgcmV0dXJuIHBhdGguaW5kZXhPZihwcmVmaXgpID09PSAwID8gcGF0aC5zdWJzdHIocHJlZml4Lmxlbmd0aCkgOiBwYXRoO1xufTtcblxudmFyIHN0cmlwVHJhaWxpbmdTbGFzaCA9IGV4cG9ydHMuc3RyaXBUcmFpbGluZ1NsYXNoID0gZnVuY3Rpb24gc3RyaXBUcmFpbGluZ1NsYXNoKHBhdGgpIHtcbiAgcmV0dXJuIHBhdGguY2hhckF0KHBhdGgubGVuZ3RoIC0gMSkgPT09ICcvJyA/IHBhdGguc2xpY2UoMCwgLTEpIDogcGF0aDtcbn07XG5cbnZhciBwYXJzZVBhdGggPSBleHBvcnRzLnBhcnNlUGF0aCA9IGZ1bmN0aW9uIHBhcnNlUGF0aChwYXRoKSB7XG4gIHZhciBwYXRobmFtZSA9IHBhdGggfHwgJy8nO1xuICB2YXIgc2VhcmNoID0gJyc7XG4gIHZhciBoYXNoID0gJyc7XG5cbiAgcGF0aG5hbWUgPSBkZWNvZGVVUkkocGF0aG5hbWUpO1xuICB2YXIgaGFzaEluZGV4ID0gcGF0aG5hbWUuaW5kZXhPZignIycpO1xuICBpZiAoaGFzaEluZGV4ICE9PSAtMSkge1xuICAgIGhhc2ggPSBwYXRobmFtZS5zdWJzdHIoaGFzaEluZGV4KTtcbiAgICBwYXRobmFtZSA9IHBhdGhuYW1lLnN1YnN0cigwLCBoYXNoSW5kZXgpO1xuICB9XG5cbiAgdmFyIHNlYXJjaEluZGV4ID0gcGF0aG5hbWUuaW5kZXhPZignPycpO1xuICBpZiAoc2VhcmNoSW5kZXggIT09IC0xKSB7XG4gICAgc2VhcmNoID0gcGF0aG5hbWUuc3Vic3RyKHNlYXJjaEluZGV4KTtcbiAgICBwYXRobmFtZSA9IHBhdGhuYW1lLnN1YnN0cigwLCBzZWFyY2hJbmRleCk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHBhdGhuYW1lOiBwYXRobmFtZSxcbiAgICBzZWFyY2g6IHNlYXJjaCA9PT0gJz8nID8gJycgOiBzZWFyY2gsXG4gICAgaGFzaDogaGFzaCA9PT0gJyMnID8gJycgOiBoYXNoXG4gIH07XG59O1xuXG52YXIgY3JlYXRlUGF0aCA9IGV4cG9ydHMuY3JlYXRlUGF0aCA9IGZ1bmN0aW9uIGNyZWF0ZVBhdGgobG9jYXRpb24pIHtcbiAgdmFyIHBhdGhuYW1lID0gbG9jYXRpb24ucGF0aG5hbWUsXG4gICAgICBzZWFyY2ggPSBsb2NhdGlvbi5zZWFyY2gsXG4gICAgICBoYXNoID0gbG9jYXRpb24uaGFzaDtcblxuXG4gIHZhciBwYXRoID0gcGF0aG5hbWUgfHwgJy8nO1xuXG4gIGlmIChzZWFyY2ggJiYgc2VhcmNoICE9PSAnPycpIHBhdGggKz0gc2VhcmNoLmNoYXJBdCgwKSA9PT0gJz8nID8gc2VhcmNoIDogJz8nICsgc2VhcmNoO1xuXG4gIGlmIChoYXNoICYmIGhhc2ggIT09ICcjJykgcGF0aCArPSBoYXNoLmNoYXJBdCgwKSA9PT0gJyMnID8gaGFzaCA6ICcjJyArIGhhc2g7XG5cbiAgcmV0dXJuIGVuY29kZVVSSShwYXRoKTtcbn07XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2hpc3RvcnkvUGF0aFV0aWxzLmpzXG4vLyBtb2R1bGUgaWQgPSAxNVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcbiAqIENvcHlyaWdodCAyMDE0LTIwMTUsIEZhY2Vib29rLCBJbmMuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIEJTRC1zdHlsZSBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLiBBbiBhZGRpdGlvbmFsIGdyYW50XG4gKiBvZiBwYXRlbnQgcmlnaHRzIGNhbiBiZSBmb3VuZCBpbiB0aGUgUEFURU5UUyBmaWxlIGluIHRoZSBzYW1lIGRpcmVjdG9yeS5cbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbi8qKlxuICogU2ltaWxhciB0byBpbnZhcmlhbnQgYnV0IG9ubHkgbG9ncyBhIHdhcm5pbmcgaWYgdGhlIGNvbmRpdGlvbiBpcyBub3QgbWV0LlxuICogVGhpcyBjYW4gYmUgdXNlZCB0byBsb2cgaXNzdWVzIGluIGRldmVsb3BtZW50IGVudmlyb25tZW50cyBpbiBjcml0aWNhbFxuICogcGF0aHMuIFJlbW92aW5nIHRoZSBsb2dnaW5nIGNvZGUgZm9yIHByb2R1Y3Rpb24gZW52aXJvbm1lbnRzIHdpbGwga2VlcCB0aGVcbiAqIHNhbWUgbG9naWMgYW5kIGZvbGxvdyB0aGUgc2FtZSBjb2RlIHBhdGhzLlxuICovXG5cbnZhciB3YXJuaW5nID0gZnVuY3Rpb24oKSB7fTtcblxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgd2FybmluZyA9IGZ1bmN0aW9uKGNvbmRpdGlvbiwgZm9ybWF0LCBhcmdzKSB7XG4gICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgYXJncyA9IG5ldyBBcnJheShsZW4gPiAyID8gbGVuIC0gMiA6IDApO1xuICAgIGZvciAodmFyIGtleSA9IDI7IGtleSA8IGxlbjsga2V5KyspIHtcbiAgICAgIGFyZ3Nba2V5IC0gMl0gPSBhcmd1bWVudHNba2V5XTtcbiAgICB9XG4gICAgaWYgKGZvcm1hdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICdgd2FybmluZyhjb25kaXRpb24sIGZvcm1hdCwgLi4uYXJncylgIHJlcXVpcmVzIGEgd2FybmluZyAnICtcbiAgICAgICAgJ21lc3NhZ2UgYXJndW1lbnQnXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChmb3JtYXQubGVuZ3RoIDwgMTAgfHwgKC9eW3NcXFddKiQvKS50ZXN0KGZvcm1hdCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgJ1RoZSB3YXJuaW5nIGZvcm1hdCBzaG91bGQgYmUgYWJsZSB0byB1bmlxdWVseSBpZGVudGlmeSB0aGlzICcgK1xuICAgICAgICAnd2FybmluZy4gUGxlYXNlLCB1c2UgYSBtb3JlIGRlc2NyaXB0aXZlIGZvcm1hdCB0aGFuOiAnICsgZm9ybWF0XG4gICAgICApO1xuICAgIH1cblxuICAgIGlmICghY29uZGl0aW9uKSB7XG4gICAgICB2YXIgYXJnSW5kZXggPSAwO1xuICAgICAgdmFyIG1lc3NhZ2UgPSAnV2FybmluZzogJyArXG4gICAgICAgIGZvcm1hdC5yZXBsYWNlKC8lcy9nLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gYXJnc1thcmdJbmRleCsrXTtcbiAgICAgICAgfSk7XG4gICAgICBpZiAodHlwZW9mIGNvbnNvbGUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IobWVzc2FnZSk7XG4gICAgICB9XG4gICAgICB0cnkge1xuICAgICAgICAvLyBUaGlzIGVycm9yIHdhcyB0aHJvd24gYXMgYSBjb252ZW5pZW5jZSBzbyB0aGF0IHlvdSBjYW4gdXNlIHRoaXMgc3RhY2tcbiAgICAgICAgLy8gdG8gZmluZCB0aGUgY2FsbHNpdGUgdGhhdCBjYXVzZWQgdGhpcyB3YXJuaW5nIHRvIGZpcmUuXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihtZXNzYWdlKTtcbiAgICAgIH0gY2F0Y2goeCkge31cbiAgICB9XG4gIH07XG59XG5cbm1vZHVsZS5leHBvcnRzID0gd2FybmluZztcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi93YXJuaW5nL2Jyb3dzZXIuanNcbi8vIG1vZHVsZSBpZCA9IDE2XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCBjcmVhdGVFbGVtZW50IGZyb20gJ2luZmVybm8tY3JlYXRlLWVsZW1lbnQnO1xyXG5pbXBvcnQgbmF2IGZyb20gJy4vbmF2LmpzJztcclxuaW1wb3J0ICcuL0FwcC5jc3MnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgcHJvcHMgPT4gKFxyXG4gICAgPGRpdiBjbGFzc05hbWU9J0FwcF9fdmlld3BvcnQnPlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPSdBcHBfX2NvbnRhaW5lcic+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdBcHBfX25hdic+XHJcbiAgICAgICAgICAgICAgICB7bmF2Lm1hcChpdGVtID0+XHJcbiAgICAgICAgICAgICAgICAgICAgPGEga2V5PXtpdGVtLmhyZWZ9IGNsYXNzTmFtZT0nQXBwX19saW5rJyBocmVmPXtgIyR7aXRlbS5ocmVmfWB9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7aXRlbS50aXRsZX1cclxuICAgICAgICAgICAgICAgICAgICA8L2E+XHJcbiAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J0FwcF9fbWFpbic+XHJcbiAgICAgICAgICAgICAgICB7cHJvcHMuY2hpbGRyZW59XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgPC9kaXY+XHJcbik7XHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9leGFtcGxlcy9BcHAuanMiLCJpbXBvcnQgY3JlYXRlRWxlbWVudCBmcm9tICdpbmZlcm5vLWNyZWF0ZS1lbGVtZW50JztcclxuaW1wb3J0IENvZGUgZnJvbSAnLi9Db2RlLmpzJztcclxuaW1wb3J0ICcuL1BhZ2UuY3NzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IHByb3BzID0+IChcclxuICAgIDxkaXYgY2xhc3NOYW1lPSdQYWdlX19jb250YWluZXInPlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPSdQYWdlX19oZWFkZXInPntwcm9wcy50aXRsZX08L2Rpdj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nUGFnZV9fY29udGVudCc+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdQYWdlX19kZW1vJz5cclxuICAgICAgICAgICAgICAgIDxwcm9wcy5jb21wb25lbnQgLz5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdQYWdlX19jb2RlJz5cclxuICAgICAgICAgICAgICAgIDxDb2RlIHZhbHVlPXtwcm9wcy5jb2RlfSAvPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgIDwvZGl2PlxyXG4pO1xyXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvZXhhbXBsZXMvUGFnZS5qcyIsIid1c2Ugc3RyaWN0JztcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblxudmFyIF9leHRlbmRzID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiAodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07IGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHsgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTsgfSB9IH0gcmV0dXJuIHRhcmdldDsgfTtcblxudmFyIF93YXJuaW5nID0gcmVxdWlyZSgnd2FybmluZycpO1xuXG52YXIgX3dhcm5pbmcyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfd2FybmluZyk7XG5cbnZhciBfaW52YXJpYW50ID0gcmVxdWlyZSgnaW52YXJpYW50Jyk7XG5cbnZhciBfaW52YXJpYW50MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2ludmFyaWFudCk7XG5cbnZhciBfTG9jYXRpb25VdGlscyA9IHJlcXVpcmUoJy4vTG9jYXRpb25VdGlscycpO1xuXG52YXIgX1BhdGhVdGlscyA9IHJlcXVpcmUoJy4vUGF0aFV0aWxzJyk7XG5cbnZhciBfY3JlYXRlVHJhbnNpdGlvbk1hbmFnZXIgPSByZXF1aXJlKCcuL2NyZWF0ZVRyYW5zaXRpb25NYW5hZ2VyJyk7XG5cbnZhciBfY3JlYXRlVHJhbnNpdGlvbk1hbmFnZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlVHJhbnNpdGlvbk1hbmFnZXIpO1xuXG52YXIgX0RPTVV0aWxzID0gcmVxdWlyZSgnLi9ET01VdGlscycpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG52YXIgSGFzaENoYW5nZUV2ZW50ID0gJ2hhc2hjaGFuZ2UnO1xuXG52YXIgSGFzaFBhdGhDb2RlcnMgPSB7XG4gIGhhc2hiYW5nOiB7XG4gICAgZW5jb2RlUGF0aDogZnVuY3Rpb24gZW5jb2RlUGF0aChwYXRoKSB7XG4gICAgICByZXR1cm4gcGF0aC5jaGFyQXQoMCkgPT09ICchJyA/IHBhdGggOiAnIS8nICsgKDAsIF9QYXRoVXRpbHMuc3RyaXBMZWFkaW5nU2xhc2gpKHBhdGgpO1xuICAgIH0sXG4gICAgZGVjb2RlUGF0aDogZnVuY3Rpb24gZGVjb2RlUGF0aChwYXRoKSB7XG4gICAgICByZXR1cm4gcGF0aC5jaGFyQXQoMCkgPT09ICchJyA/IHBhdGguc3Vic3RyKDEpIDogcGF0aDtcbiAgICB9XG4gIH0sXG4gIG5vc2xhc2g6IHtcbiAgICBlbmNvZGVQYXRoOiBfUGF0aFV0aWxzLnN0cmlwTGVhZGluZ1NsYXNoLFxuICAgIGRlY29kZVBhdGg6IF9QYXRoVXRpbHMuYWRkTGVhZGluZ1NsYXNoXG4gIH0sXG4gIHNsYXNoOiB7XG4gICAgZW5jb2RlUGF0aDogX1BhdGhVdGlscy5hZGRMZWFkaW5nU2xhc2gsXG4gICAgZGVjb2RlUGF0aDogX1BhdGhVdGlscy5hZGRMZWFkaW5nU2xhc2hcbiAgfVxufTtcblxudmFyIGdldEhhc2hQYXRoID0gZnVuY3Rpb24gZ2V0SGFzaFBhdGgoKSB7XG4gIC8vIFdlIGNhbid0IHVzZSB3aW5kb3cubG9jYXRpb24uaGFzaCBoZXJlIGJlY2F1c2UgaXQncyBub3RcbiAgLy8gY29uc2lzdGVudCBhY3Jvc3MgYnJvd3NlcnMgLSBGaXJlZm94IHdpbGwgcHJlLWRlY29kZSBpdCFcbiAgdmFyIGhyZWYgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcbiAgdmFyIGhhc2hJbmRleCA9IGhyZWYuaW5kZXhPZignIycpO1xuICByZXR1cm4gaGFzaEluZGV4ID09PSAtMSA/ICcnIDogaHJlZi5zdWJzdHJpbmcoaGFzaEluZGV4ICsgMSk7XG59O1xuXG52YXIgcHVzaEhhc2hQYXRoID0gZnVuY3Rpb24gcHVzaEhhc2hQYXRoKHBhdGgpIHtcbiAgcmV0dXJuIHdpbmRvdy5sb2NhdGlvbi5oYXNoID0gcGF0aDtcbn07XG5cbnZhciByZXBsYWNlSGFzaFBhdGggPSBmdW5jdGlvbiByZXBsYWNlSGFzaFBhdGgocGF0aCkge1xuICB2YXIgaGFzaEluZGV4ID0gd2luZG93LmxvY2F0aW9uLmhyZWYuaW5kZXhPZignIycpO1xuXG4gIHdpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKHdpbmRvdy5sb2NhdGlvbi5ocmVmLnNsaWNlKDAsIGhhc2hJbmRleCA+PSAwID8gaGFzaEluZGV4IDogMCkgKyAnIycgKyBwYXRoKTtcbn07XG5cbnZhciBjcmVhdGVIYXNoSGlzdG9yeSA9IGZ1bmN0aW9uIGNyZWF0ZUhhc2hIaXN0b3J5KCkge1xuICB2YXIgcHJvcHMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuXG4gICgwLCBfaW52YXJpYW50Mi5kZWZhdWx0KShfRE9NVXRpbHMuY2FuVXNlRE9NLCAnSGFzaCBoaXN0b3J5IG5lZWRzIGEgRE9NJyk7XG5cbiAgdmFyIGdsb2JhbEhpc3RvcnkgPSB3aW5kb3cuaGlzdG9yeTtcbiAgdmFyIGNhbkdvV2l0aG91dFJlbG9hZCA9ICgwLCBfRE9NVXRpbHMuc3VwcG9ydHNHb1dpdGhvdXRSZWxvYWRVc2luZ0hhc2gpKCk7XG5cbiAgdmFyIF9wcm9wcyRnZXRVc2VyQ29uZmlybSA9IHByb3BzLmdldFVzZXJDb25maXJtYXRpb24sXG4gICAgICBnZXRVc2VyQ29uZmlybWF0aW9uID0gX3Byb3BzJGdldFVzZXJDb25maXJtID09PSB1bmRlZmluZWQgPyBfRE9NVXRpbHMuZ2V0Q29uZmlybWF0aW9uIDogX3Byb3BzJGdldFVzZXJDb25maXJtLFxuICAgICAgX3Byb3BzJGhhc2hUeXBlID0gcHJvcHMuaGFzaFR5cGUsXG4gICAgICBoYXNoVHlwZSA9IF9wcm9wcyRoYXNoVHlwZSA9PT0gdW5kZWZpbmVkID8gJ3NsYXNoJyA6IF9wcm9wcyRoYXNoVHlwZTtcblxuICB2YXIgYmFzZW5hbWUgPSBwcm9wcy5iYXNlbmFtZSA/ICgwLCBfUGF0aFV0aWxzLnN0cmlwVHJhaWxpbmdTbGFzaCkoKDAsIF9QYXRoVXRpbHMuYWRkTGVhZGluZ1NsYXNoKShwcm9wcy5iYXNlbmFtZSkpIDogJyc7XG5cbiAgdmFyIF9IYXNoUGF0aENvZGVycyRoYXNoVCA9IEhhc2hQYXRoQ29kZXJzW2hhc2hUeXBlXSxcbiAgICAgIGVuY29kZVBhdGggPSBfSGFzaFBhdGhDb2RlcnMkaGFzaFQuZW5jb2RlUGF0aCxcbiAgICAgIGRlY29kZVBhdGggPSBfSGFzaFBhdGhDb2RlcnMkaGFzaFQuZGVjb2RlUGF0aDtcblxuXG4gIHZhciBnZXRET01Mb2NhdGlvbiA9IGZ1bmN0aW9uIGdldERPTUxvY2F0aW9uKCkge1xuICAgIHZhciBwYXRoID0gZGVjb2RlUGF0aChnZXRIYXNoUGF0aCgpKTtcblxuICAgIGlmIChiYXNlbmFtZSkgcGF0aCA9ICgwLCBfUGF0aFV0aWxzLnN0cmlwUHJlZml4KShwYXRoLCBiYXNlbmFtZSk7XG5cbiAgICByZXR1cm4gKDAsIF9QYXRoVXRpbHMucGFyc2VQYXRoKShwYXRoKTtcbiAgfTtcblxuICB2YXIgdHJhbnNpdGlvbk1hbmFnZXIgPSAoMCwgX2NyZWF0ZVRyYW5zaXRpb25NYW5hZ2VyMi5kZWZhdWx0KSgpO1xuXG4gIHZhciBzZXRTdGF0ZSA9IGZ1bmN0aW9uIHNldFN0YXRlKG5leHRTdGF0ZSkge1xuICAgIF9leHRlbmRzKGhpc3RvcnksIG5leHRTdGF0ZSk7XG5cbiAgICBoaXN0b3J5Lmxlbmd0aCA9IGdsb2JhbEhpc3RvcnkubGVuZ3RoO1xuXG4gICAgdHJhbnNpdGlvbk1hbmFnZXIubm90aWZ5TGlzdGVuZXJzKGhpc3RvcnkubG9jYXRpb24sIGhpc3RvcnkuYWN0aW9uKTtcbiAgfTtcblxuICB2YXIgZm9yY2VOZXh0UG9wID0gZmFsc2U7XG4gIHZhciBpZ25vcmVQYXRoID0gbnVsbDtcblxuICB2YXIgaGFuZGxlSGFzaENoYW5nZSA9IGZ1bmN0aW9uIGhhbmRsZUhhc2hDaGFuZ2UoKSB7XG4gICAgdmFyIHBhdGggPSBnZXRIYXNoUGF0aCgpO1xuICAgIHZhciBlbmNvZGVkUGF0aCA9IGVuY29kZVBhdGgocGF0aCk7XG5cbiAgICBpZiAocGF0aCAhPT0gZW5jb2RlZFBhdGgpIHtcbiAgICAgIC8vIEVuc3VyZSB3ZSBhbHdheXMgaGF2ZSBhIHByb3Blcmx5LWVuY29kZWQgaGFzaC5cbiAgICAgIHJlcGxhY2VIYXNoUGF0aChlbmNvZGVkUGF0aCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBsb2NhdGlvbiA9IGdldERPTUxvY2F0aW9uKCk7XG4gICAgICB2YXIgcHJldkxvY2F0aW9uID0gaGlzdG9yeS5sb2NhdGlvbjtcblxuICAgICAgaWYgKCFmb3JjZU5leHRQb3AgJiYgKDAsIF9Mb2NhdGlvblV0aWxzLmxvY2F0aW9uc0FyZUVxdWFsKShwcmV2TG9jYXRpb24sIGxvY2F0aW9uKSkgcmV0dXJuOyAvLyBBIGhhc2hjaGFuZ2UgZG9lc24ndCBhbHdheXMgPT0gbG9jYXRpb24gY2hhbmdlLlxuXG4gICAgICBpZiAoaWdub3JlUGF0aCA9PT0gKDAsIF9QYXRoVXRpbHMuY3JlYXRlUGF0aCkobG9jYXRpb24pKSByZXR1cm47IC8vIElnbm9yZSB0aGlzIGNoYW5nZTsgd2UgYWxyZWFkeSBzZXRTdGF0ZSBpbiBwdXNoL3JlcGxhY2UuXG5cbiAgICAgIGlnbm9yZVBhdGggPSBudWxsO1xuXG4gICAgICBoYW5kbGVQb3AobG9jYXRpb24pO1xuICAgIH1cbiAgfTtcblxuICB2YXIgaGFuZGxlUG9wID0gZnVuY3Rpb24gaGFuZGxlUG9wKGxvY2F0aW9uKSB7XG4gICAgaWYgKGZvcmNlTmV4dFBvcCkge1xuICAgICAgZm9yY2VOZXh0UG9wID0gZmFsc2U7XG4gICAgICBzZXRTdGF0ZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgYWN0aW9uID0gJ1BPUCc7XG5cbiAgICAgIHRyYW5zaXRpb25NYW5hZ2VyLmNvbmZpcm1UcmFuc2l0aW9uVG8obG9jYXRpb24sIGFjdGlvbiwgZ2V0VXNlckNvbmZpcm1hdGlvbiwgZnVuY3Rpb24gKG9rKSB7XG4gICAgICAgIGlmIChvaykge1xuICAgICAgICAgIHNldFN0YXRlKHsgYWN0aW9uOiBhY3Rpb24sIGxvY2F0aW9uOiBsb2NhdGlvbiB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXZlcnRQb3AobG9jYXRpb24pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIHJldmVydFBvcCA9IGZ1bmN0aW9uIHJldmVydFBvcChmcm9tTG9jYXRpb24pIHtcbiAgICB2YXIgdG9Mb2NhdGlvbiA9IGhpc3RvcnkubG9jYXRpb247XG5cbiAgICAvLyBUT0RPOiBXZSBjb3VsZCBwcm9iYWJseSBtYWtlIHRoaXMgbW9yZSByZWxpYWJsZSBieVxuICAgIC8vIGtlZXBpbmcgYSBsaXN0IG9mIHBhdGhzIHdlJ3ZlIHNlZW4gaW4gc2Vzc2lvblN0b3JhZ2UuXG4gICAgLy8gSW5zdGVhZCwgd2UganVzdCBkZWZhdWx0IHRvIDAgZm9yIHBhdGhzIHdlIGRvbid0IGtub3cuXG5cbiAgICB2YXIgdG9JbmRleCA9IGFsbFBhdGhzLmxhc3RJbmRleE9mKCgwLCBfUGF0aFV0aWxzLmNyZWF0ZVBhdGgpKHRvTG9jYXRpb24pKTtcblxuICAgIGlmICh0b0luZGV4ID09PSAtMSkgdG9JbmRleCA9IDA7XG5cbiAgICB2YXIgZnJvbUluZGV4ID0gYWxsUGF0aHMubGFzdEluZGV4T2YoKDAsIF9QYXRoVXRpbHMuY3JlYXRlUGF0aCkoZnJvbUxvY2F0aW9uKSk7XG5cbiAgICBpZiAoZnJvbUluZGV4ID09PSAtMSkgZnJvbUluZGV4ID0gMDtcblxuICAgIHZhciBkZWx0YSA9IHRvSW5kZXggLSBmcm9tSW5kZXg7XG5cbiAgICBpZiAoZGVsdGEpIHtcbiAgICAgIGZvcmNlTmV4dFBvcCA9IHRydWU7XG4gICAgICBnbyhkZWx0YSk7XG4gICAgfVxuICB9O1xuXG4gIC8vIEVuc3VyZSB0aGUgaGFzaCBpcyBlbmNvZGVkIHByb3Blcmx5IGJlZm9yZSBkb2luZyBhbnl0aGluZyBlbHNlLlxuICB2YXIgcGF0aCA9IGdldEhhc2hQYXRoKCk7XG4gIHZhciBlbmNvZGVkUGF0aCA9IGVuY29kZVBhdGgocGF0aCk7XG5cbiAgaWYgKHBhdGggIT09IGVuY29kZWRQYXRoKSByZXBsYWNlSGFzaFBhdGgoZW5jb2RlZFBhdGgpO1xuXG4gIHZhciBpbml0aWFsTG9jYXRpb24gPSBnZXRET01Mb2NhdGlvbigpO1xuICB2YXIgYWxsUGF0aHMgPSBbKDAsIF9QYXRoVXRpbHMuY3JlYXRlUGF0aCkoaW5pdGlhbExvY2F0aW9uKV07XG5cbiAgLy8gUHVibGljIGludGVyZmFjZVxuXG4gIHZhciBjcmVhdGVIcmVmID0gZnVuY3Rpb24gY3JlYXRlSHJlZihsb2NhdGlvbikge1xuICAgIHJldHVybiAnIycgKyBlbmNvZGVQYXRoKGJhc2VuYW1lICsgKDAsIF9QYXRoVXRpbHMuY3JlYXRlUGF0aCkobG9jYXRpb24pKTtcbiAgfTtcblxuICB2YXIgcHVzaCA9IGZ1bmN0aW9uIHB1c2gocGF0aCwgc3RhdGUpIHtcbiAgICAoMCwgX3dhcm5pbmcyLmRlZmF1bHQpKHN0YXRlID09PSB1bmRlZmluZWQsICdIYXNoIGhpc3RvcnkgY2Fubm90IHB1c2ggc3RhdGU7IGl0IGlzIGlnbm9yZWQnKTtcblxuICAgIHZhciBhY3Rpb24gPSAnUFVTSCc7XG4gICAgdmFyIGxvY2F0aW9uID0gKDAsIF9Mb2NhdGlvblV0aWxzLmNyZWF0ZUxvY2F0aW9uKShwYXRoLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgaGlzdG9yeS5sb2NhdGlvbik7XG5cbiAgICB0cmFuc2l0aW9uTWFuYWdlci5jb25maXJtVHJhbnNpdGlvblRvKGxvY2F0aW9uLCBhY3Rpb24sIGdldFVzZXJDb25maXJtYXRpb24sIGZ1bmN0aW9uIChvaykge1xuICAgICAgaWYgKCFvaykgcmV0dXJuO1xuXG4gICAgICB2YXIgcGF0aCA9ICgwLCBfUGF0aFV0aWxzLmNyZWF0ZVBhdGgpKGxvY2F0aW9uKTtcbiAgICAgIHZhciBlbmNvZGVkUGF0aCA9IGVuY29kZVBhdGgoYmFzZW5hbWUgKyBwYXRoKTtcbiAgICAgIHZhciBoYXNoQ2hhbmdlZCA9IGdldEhhc2hQYXRoKCkgIT09IGVuY29kZWRQYXRoO1xuXG4gICAgICBpZiAoaGFzaENoYW5nZWQpIHtcbiAgICAgICAgLy8gV2UgY2Fubm90IHRlbGwgaWYgYSBoYXNoY2hhbmdlIHdhcyBjYXVzZWQgYnkgYSBQVVNILCBzbyB3ZSdkXG4gICAgICAgIC8vIHJhdGhlciBzZXRTdGF0ZSBoZXJlIGFuZCBpZ25vcmUgdGhlIGhhc2hjaGFuZ2UuIFRoZSBjYXZlYXQgaGVyZVxuICAgICAgICAvLyBpcyB0aGF0IG90aGVyIGhhc2ggaGlzdG9yaWVzIGluIHRoZSBwYWdlIHdpbGwgY29uc2lkZXIgaXQgYSBQT1AuXG4gICAgICAgIGlnbm9yZVBhdGggPSBwYXRoO1xuICAgICAgICBwdXNoSGFzaFBhdGgoZW5jb2RlZFBhdGgpO1xuXG4gICAgICAgIHZhciBwcmV2SW5kZXggPSBhbGxQYXRocy5sYXN0SW5kZXhPZigoMCwgX1BhdGhVdGlscy5jcmVhdGVQYXRoKShoaXN0b3J5LmxvY2F0aW9uKSk7XG4gICAgICAgIHZhciBuZXh0UGF0aHMgPSBhbGxQYXRocy5zbGljZSgwLCBwcmV2SW5kZXggPT09IC0xID8gMCA6IHByZXZJbmRleCArIDEpO1xuXG4gICAgICAgIG5leHRQYXRocy5wdXNoKHBhdGgpO1xuICAgICAgICBhbGxQYXRocyA9IG5leHRQYXRocztcblxuICAgICAgICBzZXRTdGF0ZSh7IGFjdGlvbjogYWN0aW9uLCBsb2NhdGlvbjogbG9jYXRpb24gfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAoMCwgX3dhcm5pbmcyLmRlZmF1bHQpKGZhbHNlLCAnSGFzaCBoaXN0b3J5IGNhbm5vdCBQVVNIIHRoZSBzYW1lIHBhdGg7IGEgbmV3IGVudHJ5IHdpbGwgbm90IGJlIGFkZGVkIHRvIHRoZSBoaXN0b3J5IHN0YWNrJyk7XG5cbiAgICAgICAgc2V0U3RhdGUoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICB2YXIgcmVwbGFjZSA9IGZ1bmN0aW9uIHJlcGxhY2UocGF0aCwgc3RhdGUpIHtcbiAgICAoMCwgX3dhcm5pbmcyLmRlZmF1bHQpKHN0YXRlID09PSB1bmRlZmluZWQsICdIYXNoIGhpc3RvcnkgY2Fubm90IHJlcGxhY2Ugc3RhdGU7IGl0IGlzIGlnbm9yZWQnKTtcblxuICAgIHZhciBhY3Rpb24gPSAnUkVQTEFDRSc7XG4gICAgdmFyIGxvY2F0aW9uID0gKDAsIF9Mb2NhdGlvblV0aWxzLmNyZWF0ZUxvY2F0aW9uKShwYXRoLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgaGlzdG9yeS5sb2NhdGlvbik7XG5cbiAgICB0cmFuc2l0aW9uTWFuYWdlci5jb25maXJtVHJhbnNpdGlvblRvKGxvY2F0aW9uLCBhY3Rpb24sIGdldFVzZXJDb25maXJtYXRpb24sIGZ1bmN0aW9uIChvaykge1xuICAgICAgaWYgKCFvaykgcmV0dXJuO1xuXG4gICAgICB2YXIgcGF0aCA9ICgwLCBfUGF0aFV0aWxzLmNyZWF0ZVBhdGgpKGxvY2F0aW9uKTtcbiAgICAgIHZhciBlbmNvZGVkUGF0aCA9IGVuY29kZVBhdGgoYmFzZW5hbWUgKyBwYXRoKTtcbiAgICAgIHZhciBoYXNoQ2hhbmdlZCA9IGdldEhhc2hQYXRoKCkgIT09IGVuY29kZWRQYXRoO1xuXG4gICAgICBpZiAoaGFzaENoYW5nZWQpIHtcbiAgICAgICAgLy8gV2UgY2Fubm90IHRlbGwgaWYgYSBoYXNoY2hhbmdlIHdhcyBjYXVzZWQgYnkgYSBSRVBMQUNFLCBzbyB3ZSdkXG4gICAgICAgIC8vIHJhdGhlciBzZXRTdGF0ZSBoZXJlIGFuZCBpZ25vcmUgdGhlIGhhc2hjaGFuZ2UuIFRoZSBjYXZlYXQgaGVyZVxuICAgICAgICAvLyBpcyB0aGF0IG90aGVyIGhhc2ggaGlzdG9yaWVzIGluIHRoZSBwYWdlIHdpbGwgY29uc2lkZXIgaXQgYSBQT1AuXG4gICAgICAgIGlnbm9yZVBhdGggPSBwYXRoO1xuICAgICAgICByZXBsYWNlSGFzaFBhdGgoZW5jb2RlZFBhdGgpO1xuICAgICAgfVxuXG4gICAgICB2YXIgcHJldkluZGV4ID0gYWxsUGF0aHMuaW5kZXhPZigoMCwgX1BhdGhVdGlscy5jcmVhdGVQYXRoKShoaXN0b3J5LmxvY2F0aW9uKSk7XG5cbiAgICAgIGlmIChwcmV2SW5kZXggIT09IC0xKSBhbGxQYXRoc1twcmV2SW5kZXhdID0gcGF0aDtcblxuICAgICAgc2V0U3RhdGUoeyBhY3Rpb246IGFjdGlvbiwgbG9jYXRpb246IGxvY2F0aW9uIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIHZhciBnbyA9IGZ1bmN0aW9uIGdvKG4pIHtcbiAgICAoMCwgX3dhcm5pbmcyLmRlZmF1bHQpKGNhbkdvV2l0aG91dFJlbG9hZCwgJ0hhc2ggaGlzdG9yeSBnbyhuKSBjYXVzZXMgYSBmdWxsIHBhZ2UgcmVsb2FkIGluIHRoaXMgYnJvd3NlcicpO1xuXG4gICAgZ2xvYmFsSGlzdG9yeS5nbyhuKTtcbiAgfTtcblxuICB2YXIgZ29CYWNrID0gZnVuY3Rpb24gZ29CYWNrKCkge1xuICAgIHJldHVybiBnbygtMSk7XG4gIH07XG5cbiAgdmFyIGdvRm9yd2FyZCA9IGZ1bmN0aW9uIGdvRm9yd2FyZCgpIHtcbiAgICByZXR1cm4gZ28oMSk7XG4gIH07XG5cbiAgdmFyIGxpc3RlbmVyQ291bnQgPSAwO1xuXG4gIHZhciBjaGVja0RPTUxpc3RlbmVycyA9IGZ1bmN0aW9uIGNoZWNrRE9NTGlzdGVuZXJzKGRlbHRhKSB7XG4gICAgbGlzdGVuZXJDb3VudCArPSBkZWx0YTtcblxuICAgIGlmIChsaXN0ZW5lckNvdW50ID09PSAxKSB7XG4gICAgICAoMCwgX0RPTVV0aWxzLmFkZEV2ZW50TGlzdGVuZXIpKHdpbmRvdywgSGFzaENoYW5nZUV2ZW50LCBoYW5kbGVIYXNoQ2hhbmdlKTtcbiAgICB9IGVsc2UgaWYgKGxpc3RlbmVyQ291bnQgPT09IDApIHtcbiAgICAgICgwLCBfRE9NVXRpbHMucmVtb3ZlRXZlbnRMaXN0ZW5lcikod2luZG93LCBIYXNoQ2hhbmdlRXZlbnQsIGhhbmRsZUhhc2hDaGFuZ2UpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgaXNCbG9ja2VkID0gZmFsc2U7XG5cbiAgdmFyIGJsb2NrID0gZnVuY3Rpb24gYmxvY2soKSB7XG4gICAgdmFyIHByb21wdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogZmFsc2U7XG5cbiAgICB2YXIgdW5ibG9jayA9IHRyYW5zaXRpb25NYW5hZ2VyLnNldFByb21wdChwcm9tcHQpO1xuXG4gICAgaWYgKCFpc0Jsb2NrZWQpIHtcbiAgICAgIGNoZWNrRE9NTGlzdGVuZXJzKDEpO1xuICAgICAgaXNCbG9ja2VkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKGlzQmxvY2tlZCkge1xuICAgICAgICBpc0Jsb2NrZWQgPSBmYWxzZTtcbiAgICAgICAgY2hlY2tET01MaXN0ZW5lcnMoLTEpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdW5ibG9jaygpO1xuICAgIH07XG4gIH07XG5cbiAgdmFyIGxpc3RlbiA9IGZ1bmN0aW9uIGxpc3RlbihsaXN0ZW5lcikge1xuICAgIHZhciB1bmxpc3RlbiA9IHRyYW5zaXRpb25NYW5hZ2VyLmFwcGVuZExpc3RlbmVyKGxpc3RlbmVyKTtcbiAgICBjaGVja0RPTUxpc3RlbmVycygxKTtcblxuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICBjaGVja0RPTUxpc3RlbmVycygtMSk7XG4gICAgICB1bmxpc3RlbigpO1xuICAgIH07XG4gIH07XG5cbiAgdmFyIGhpc3RvcnkgPSB7XG4gICAgbGVuZ3RoOiBnbG9iYWxIaXN0b3J5Lmxlbmd0aCxcbiAgICBhY3Rpb246ICdQT1AnLFxuICAgIGxvY2F0aW9uOiBpbml0aWFsTG9jYXRpb24sXG4gICAgY3JlYXRlSHJlZjogY3JlYXRlSHJlZixcbiAgICBwdXNoOiBwdXNoLFxuICAgIHJlcGxhY2U6IHJlcGxhY2UsXG4gICAgZ286IGdvLFxuICAgIGdvQmFjazogZ29CYWNrLFxuICAgIGdvRm9yd2FyZDogZ29Gb3J3YXJkLFxuICAgIGJsb2NrOiBibG9jayxcbiAgICBsaXN0ZW46IGxpc3RlblxuICB9O1xuXG4gIHJldHVybiBoaXN0b3J5O1xufTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gY3JlYXRlSGFzaEhpc3Rvcnk7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2hpc3RvcnkvY3JlYXRlSGFzaEhpc3RvcnkuanNcbi8vIG1vZHVsZSBpZCA9IDE5XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnaW5mZXJuby9kaXN0L2luZmVybm8tcm91dGVyLm5vZGUnKTtcbm1vZHVsZS5leHBvcnRzLmRlZmF1bHQgPSBtb2R1bGUuZXhwb3J0cztcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vaW5mZXJuby1yb3V0ZXIvaW5mZXJuby1yb3V0ZXIuanNcbi8vIG1vZHVsZSBpZCA9IDIwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCBjcmVhdGVFbGVtZW50IGZyb20gJ2luZmVybm8tY3JlYXRlLWVsZW1lbnQnO1xyXG5pbXBvcnQgQ29tcG9uZW50IGZyb20gJ2luZmVybm8tY29tcG9uZW50JztcclxuaW1wb3J0IEhlYWRlciBmcm9tICcuL0hlYWRlci5qcyc7XHJcbmltcG9ydCBSZXNpemVHaG9zdCBmcm9tICcuL1Jlc2l6ZUdob3N0LmpzJztcclxuaW1wb3J0IExpc3QgZnJvbSAnLi9MaXN0LmpzJztcclxuaW1wb3J0IHsgd2l0aFByb3BzT25DaGFuZ2UsIHdpdGhEZWZhdWx0cywgd2l0aFBpbm5lZENvbHVtbnMgfSBmcm9tICcuL2hvYy9pbmRleC5qcyc7XHJcbmltcG9ydCB7IGNvbXBvc2UgfSBmcm9tICcuL3V0aWxzL2luZGV4LmpzJztcclxuaW1wb3J0IHsgbWFya01vdmVEZXN0LCBtb3ZlQ29sdW1uLCByZXNpemVDb2x1bW4gfSBmcm9tICcuL2FjdGlvbkNyZWF0b3JzLmpzJztcclxuXHJcbi8qXHJcblxyXG50eXBlIENvbHVtbiA9IHtcclxuICAgIG5hbWU6IHN0cmluZyxcclxuICAgIGRpc3BsYXlOYW1lOiBzdHJpbmcsXHJcbiAgICB3aWR0aDogbnVtYmVyIHwgc3RyaW5nLFxyXG4gICAgbWluV2lkdGg6IG51bWJlcixcclxuICAgIG1heFdpZHRoOiBudW1iZXIsXHJcbiAgICBlbmFibGVSZXNpemluZzogYm9vbGVhbixcclxuICAgIGVuYWJsZU1vdmluZzogYm9vbGVhbixcclxuICAgIGVuYWJsZUZpbHRlcmluZzogYm9vbGVhbixcclxuICAgIGVuYWJsZVNvcnRpbmc6IGJvb2xlYW4sXHJcblxyXG4gICAgc29ydDogbnVsbCB8ICdhc2MnIHwgJ2Rlc2MnLFxyXG4gICAgcGxhY2Vob2xkZXI6IHN0cmluZyxcclxuICAgIGZpbHRlcjogc3RyaW5nXHJcbn07XHJcblxyXG50eXBlIFN0YXRlID0ge1xyXG4gICAgY29sdW1uczogQ29sdW1uW10sXHJcbiAgICBjb2x1bW5TdGF0ZToge1xyXG4gICAgICAgIG1vdmluZzogbnVsbCB8IHtcclxuICAgICAgICAgICAgbmFtZTogc3RyaW5nLFxyXG4gICAgICAgICAgICBsZWZ0OiBzdHJpbmcsXHJcbiAgICAgICAgICAgIHJpZ2h0OiBzdHJpbmdcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgcm93U3RhdGU6IHtcclxuICAgICAgICBzZWxlY3RlZEluZGV4OiBudW1iZXJcclxuICAgIH1cclxufVxyXG5cclxuKi9cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNvbXBvc2UoXHJcbiAgICB3aXRoRGVmYXVsdHMoKSxcclxuICAgIHdpdGhQaW5uZWRDb2x1bW5zKCksXHJcbiAgICB3aXRoUHJvcHNPbkNoYW5nZShcclxuICAgICAgICBbJ2NvbHVtbnMnXSxcclxuICAgICAgICAoeyBjb2x1bW5zIH0pID0+ICh7XHJcbiAgICAgICAgICAgIHRhYmxlV2lkdGg6IGNvbHVtbnMucmVkdWNlKChhY2MsIGl0ZW0pID0+IGFjYyArIGl0ZW0ud2lkdGgsIDApXHJcbiAgICAgICAgfSlcclxuICAgICksXHJcbiAgICB3aXRoUHJvcHNPbkNoYW5nZShcclxuICAgICAgICBbJ2NvbHVtblN0YXRlJywgJ2NhbGxiYWNrJywgJ2NvbHVtbkNvbXBvbmVudCddLFxyXG4gICAgICAgICh7IGNvbHVtblN0YXRlLCBjYWxsYmFjaywgY29sdW1uQ29tcG9uZW50OiBDb2x1bW4gfSkgPT4gKHtcclxuICAgICAgICAgICAgY29sdW1uQ29tcG9uZW50OiBwcm9wcyA9PiA8Q29sdW1uIHN0YXRlPXtjb2x1bW5TdGF0ZX0gY2FsbGJhY2s9e2NhbGxiYWNrfSB7Li4ucHJvcHN9IC8+XHJcbiAgICAgICAgfSlcclxuICAgICksXHJcbiAgICB3aXRoUHJvcHNPbkNoYW5nZShcclxuICAgICAgICBbJ3Jvd1N0YXRlJywgJ2NvbHVtbnMnLCAnY2FsbGJhY2snLCAncm93Q29tcG9uZW50J10sXHJcbiAgICAgICAgKHsgcm93U3RhdGUsIGNvbHVtbnMsICBjYWxsYmFjaywgcm93Q29tcG9uZW50OiBSb3cgfSkgPT4gKHtcclxuICAgICAgICAgICAgcm93Q29tcG9uZW50OiBwcm9wcyA9PiA8Um93IHN0YXRlPXtyb3dTdGF0ZX0gY29sdW1ucz17Y29sdW1uc30gY2FsbGJhY2s9e2NhbGxiYWNrfSB7Li4ucHJvcHN9IC8+XHJcbiAgICAgICAgfSlcclxuICAgIClcclxuKShjbGFzcyBHcmlkV3JhcHBlciBleHRlbmRzIENvbXBvbmVudCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xyXG4gICAgICAgIHN1cGVyKHByb3BzKTtcclxuICAgICAgICB0aGlzLnN0YXRlID0ge1xyXG4gICAgICAgICAgICBnaG9zdDogZmFsc2UsXHJcbiAgICAgICAgICAgIGdob3N0WDogMFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5vblJlc2l6aW5nID0gdGhpcy5vblJlc2l6aW5nLmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5vblJlc2l6ZSA9IHRoaXMub25SZXNpemUuYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLm9uTW92aW5nID0gdGhpcy5vbk1vdmluZy5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMub25Nb3ZlID0gdGhpcy5vbk1vdmUuYmluZCh0aGlzKTtcclxuICAgIH1cclxuXHJcbiAgICBvblJlc2l6aW5nKG5hbWUsIGdob3N0WCkge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICBnaG9zdDogdHJ1ZSxcclxuICAgICAgICAgICAgZ2hvc3RYXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25SZXNpemUobmFtZSwgY29sdW1uV2lkdGgpIHtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgZ2hvc3Q6IGZhbHNlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5wcm9wcy5jYWxsYmFjayhyZXNpemVDb2x1bW4obmFtZSwgY29sdW1uV2lkdGgpKTtcclxuICAgIH1cclxuXHJcbiAgICBvbk1vdmluZyhuYW1lLCBsZWZ0LCByaWdodCkge1xyXG4gICAgICAgIGlmIChuYW1lICE9PSB0aGlzLm1vdmluZ05hbWUgfHwgbGVmdCAhPT0gdGhpcy5tb3ZpbmdMZWZ0IHx8IHJpZ2h0ICE9PSB0aGlzLm1vdmluZ1JpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRoaXMubW92aW5nTmFtZSA9IG5hbWU7XHJcbiAgICAgICAgICAgIHRoaXMubW92aW5nTGVmdCA9IGxlZnQ7XHJcbiAgICAgICAgICAgIHRoaXMubW92aW5nUmlnaHQgPSByaWdodDtcclxuICAgICAgICAgICAgdGhpcy5wcm9wcy5jYWxsYmFjayhtYXJrTW92ZURlc3QobmFtZSwgbGVmdCwgcmlnaHQpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25Nb3ZlKG5hbWUsIGxlZnQsIHJpZ2h0KSB7XHJcbiAgICAgICAgdGhpcy5tb3ZpbmdOYW1lID0gbnVsbDtcclxuICAgICAgICB0aGlzLm1vdmluZ0xlZnQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMubW92aW5nUmlnaHQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMucHJvcHMuY2FsbGJhY2sobW92ZUNvbHVtbihuYW1lLCBsZWZ0LCByaWdodCkpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcihwcm9wcywgeyBnaG9zdCwgZ2hvc3RYIH0pIHtcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8ZGl2IHN0eWxlPXt7IHBvc2l0aW9uOiAncmVsYXRpdmUnLCB3aWR0aDogcHJvcHMudGFibGVXaWR0aCwgZmxleFNocmluazogMCB9fT5cclxuICAgICAgICAgICAgICAgIHtCb29sZWFuKHByb3BzLmhlYWRlckhlaWdodCkgJiZcclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPXt7IHBvc2l0aW9uOiAnc3RpY2t5JywgekluZGV4OiAxLCB0b3A6IDAsIGhlaWdodDogcHJvcHMuaGVhZGVySGVpZ2h0IH19PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8SGVhZGVyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW5zPXtwcm9wcy5jb2x1bW5zfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PXtwcm9wcy5jb2x1bW5Db21wb25lbnR9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbk1vdmU9e3RoaXMub25Nb3ZlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25Nb3Zpbmc9e3RoaXMub25Nb3Zpbmd9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblJlc2l6ZT17dGhpcy5vblJlc2l6ZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uUmVzaXppbmc9e3RoaXMub25SZXNpemluZ30gLz5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHtnaG9zdCAmJiA8UmVzaXplR2hvc3QgeD17Z2hvc3RYfSAvPn1cclxuICAgICAgICAgICAgICAgIDxMaXN0XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YT17cHJvcHMuZGF0YX1cclxuICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb3A9e3Byb3BzLnNjcm9sbFRvcCAtIHByb3BzLmhlYWRlckhlaWdodH1cclxuICAgICAgICAgICAgICAgICAgICB2aWV3cG9ydEhlaWdodD17cHJvcHMudmlld3BvcnRIZWlnaHQgLSBwcm9wcy5oZWFkZXJIZWlnaHR9XHJcbiAgICAgICAgICAgICAgICAgICAgcm93SGVpZ2h0PXtwcm9wcy5yb3dIZWlnaHR9XHJcbiAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50PXtwcm9wcy5yb3dDb21wb25lbnR9IC8+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn0pO1xyXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvR3JpZC5qcyIsImltcG9ydCBjcmVhdGVFbGVtZW50IGZyb20gJ2luZmVybm8tY3JlYXRlLWVsZW1lbnQnO1xyXG5pbXBvcnQgeyBzaG91bGRVcGRhdGUsIHdpdGhNaWRkbGVTdGF0ZSB9IGZyb20gJy4vaG9jL2luZGV4LmpzJztcclxuaW1wb3J0IHsgY29tcG9zZSwgY2hlY2tQcm9wcywgZ2V0VmlzaWJsZVJvd3MsIGdldEtleXNCeUluZGV4IH0gZnJvbSAnLi91dGlscy9pbmRleC5qcyc7XHJcblxyXG5jb25zdCBDb250YWluZXIgPSAoeyBoZWlnaHQsIHJlbmRlcmVkVG9wLCBjaGlsZHJlbiB9KSA9PiAoXHJcbiAgICA8ZGl2IHN0eWxlPXt7IHBvc2l0aW9uOiAncmVsYXRpdmUnLCBoZWlnaHQgfX0+XHJcbiAgICAgICAgPGRpdiBzdHlsZT17eyBwb3NpdGlvbjogJ2Fic29sdXRlJywgbGVmdDogMCwgcmlnaHQ6IDAsIHRvcDogcmVuZGVyZWRUb3AgfX0+XHJcbiAgICAgICAgICAgIHtjaGlsZHJlbn1cclxuICAgICAgICA8L2Rpdj5cclxuICAgIDwvZGl2PlxyXG4pO1xyXG5cclxuY29uc3QgUm93V3JhcHBlciA9IGNvbXBvc2UoXHJcbiAgICBzaG91bGRVcGRhdGUoY2hlY2tQcm9wcygnaGVpZ2h0JywgJ2NvbXBvbmVudCcsICdkYXR1bScpKVxyXG4pKCh7IGhlaWdodCwgZGF0dW0sIGluZGV4LCBjb21wb25lbnQ6IFJvdyB9KSA9PlxyXG4gICAgPGRpdiBzdHlsZT17eyBoZWlnaHQgfX0+XHJcbiAgICAgICAgPFJvdyBkYXR1bT17ZGF0dW19IGluZGV4PXtpbmRleH0gLz5cclxuICAgIDwvZGl2PlxyXG4pO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY29tcG9zZShcclxuICAgIHdpdGhNaWRkbGVTdGF0ZSgocHJvcHMsIHN0YXRlID0ge30pID0+IHtcclxuICAgICAgICBjb25zdCBbc3RhcnQsIGVuZF0gPSBnZXRWaXNpYmxlUm93cyh7XHJcbiAgICAgICAgICAgIHNjcm9sbFRvcDogcHJvcHMuc2Nyb2xsVG9wLFxyXG4gICAgICAgICAgICB2aWV3cG9ydEhlaWdodDogcHJvcHMudmlld3BvcnRIZWlnaHQsXHJcbiAgICAgICAgICAgIHJvd0hlaWdodDogcHJvcHMucm93SGVpZ2h0LFxyXG4gICAgICAgICAgICByb3dzQ291bnQ6IHByb3BzLmRhdGEubGVuZ3RoXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3RhcnQsXHJcbiAgICAgICAgICAgIGVuZCxcclxuICAgICAgICAgICAga2V5czogZ2V0S2V5c0J5SW5kZXgoc3RhdGUua2V5cywgc3RhcnQsIGVuZClcclxuICAgICAgICB9O1xyXG4gICAgfSksXHJcbiAgICBzaG91bGRVcGRhdGUoY2hlY2tQcm9wcygnc3RhcnQnLCAnZW5kJywgJ2RhdGEnLCAncm93SGVpZ2h0JywgJ2NvbXBvbmVudCcpKVxyXG4pKCh7IGRhdGEsIHJvd0hlaWdodCwgY29tcG9uZW50LCBzdGFydCwgZW5kLCBrZXlzIH0pID0+XHJcbiAgICA8Q29udGFpbmVyIGhlaWdodD17ZGF0YS5sZW5ndGggKiByb3dIZWlnaHR9IHJlbmRlcmVkVG9wPXtzdGFydCAqIHJvd0hlaWdodH0+XHJcbiAgICAgICAge2RhdGEuc2xpY2Uoc3RhcnQsIGVuZCArIDEpLm1hcCgoZGF0dW0sIGluZGV4KSA9PlxyXG4gICAgICAgICAgICA8Um93V3JhcHBlclxyXG4gICAgICAgICAgICAgICAga2V5PXtrZXlzW3N0YXJ0ICsgaW5kZXhdfVxyXG4gICAgICAgICAgICAgICAgaGVpZ2h0PXtyb3dIZWlnaHR9XHJcbiAgICAgICAgICAgICAgICBpbmRleD17c3RhcnQgKyBpbmRleH1cclxuICAgICAgICAgICAgICAgIGRhdHVtPXtkYXR1bX1cclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudD17Y29tcG9uZW50fVxyXG4gICAgICAgICAgICAvPlxyXG4gICAgICAgICl9XHJcbiAgICA8L0NvbnRhaW5lcj5cclxuKTtcclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL0xpc3QuanMiLCJpbXBvcnQgY3JlYXRlRWxlbWVudCBmcm9tICdpbmZlcm5vLWNyZWF0ZS1lbGVtZW50JztcclxuXHJcbmV4cG9ydCBkZWZhdWx0ICh7IHggfSkgPT4gKFxyXG4gICAgPGRpdiBzdHlsZT17e1xyXG4gICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxyXG4gICAgICAgIHpJbmRleDogMyxcclxuICAgICAgICB0b3A6IDAsXHJcbiAgICAgICAgYm90dG9tOiAwLFxyXG4gICAgICAgIGJvcmRlckxlZnQ6ICcxcHggZG90dGVkICMwMDAnLFxyXG4gICAgICAgIHBvaW50ZXJFdmVudHM6ICdub25lJyxcclxuICAgICAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGVYKCR7eH1weClgXHJcbiAgICB9fT5cclxuICAgIDwvZGl2PlxyXG4pO1xyXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvUmVzaXplR2hvc3QuanMiLCJpbXBvcnQgY3JlYXRlRWxlbWVudCBmcm9tICdpbmZlcm5vLWNyZWF0ZS1lbGVtZW50JztcclxuaW1wb3J0IENvbXBvbmVudCBmcm9tICdpbmZlcm5vLWNvbXBvbmVudCc7XHJcbmltcG9ydCBobGpzIGZyb20gJ2hpZ2hsaWdodC5qcy9saWIvaGlnaGxpZ2h0LmpzJztcclxuaW1wb3J0IGphdmFzY3JpcHQgZnJvbSAnaGlnaGxpZ2h0LmpzL2xpYi9sYW5ndWFnZXMvamF2YXNjcmlwdC5qcyc7XHJcbmltcG9ydCAnaGlnaGxpZ2h0LmpzL3N0eWxlcy9tb25va2FpLmNzcyc7XHJcblxyXG5obGpzLnJlZ2lzdGVyTGFuZ3VhZ2UoJ2phdmFzY3JpcHQnLCBqYXZhc2NyaXB0KTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENvZGUgZXh0ZW5kcyBDb21wb25lbnQge1xyXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcclxuICAgICAgICBzdXBlcihwcm9wcyk7XHJcbiAgICAgICAgdGhpcy5odG1sID0gaGxqcy5oaWdobGlnaHRBdXRvKHByb3BzLnZhbHVlKS52YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wcykge1xyXG4gICAgICAgIGlmICh0aGlzLnByb3BzLnZhbHVlICE9PSBuZXh0UHJvcHMudmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5odG1sID0gaGxqcy5oaWdobGlnaHRBdXRvKG5leHRQcm9wcy52YWx1ZSkudmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8cHJlIHN0eWxlPXt7IG1hcmdpbjogJzAgMCAwIDE1cHgnIH19PlxyXG4gICAgICAgICAgICAgICAgPGNvZGUgY2xhc3M9J2hsanMnIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7IF9faHRtbDogdGhpcy5odG1sIH19PjwvY29kZT5cclxuICAgICAgICAgICAgPC9wcmU+XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvZXhhbXBsZXMvQ29kZS5qcyIsImltcG9ydCBjcmVhdGVFbGVtZW50IGZyb20gJ2luZmVybm8tY3JlYXRlLWVsZW1lbnQnO1xyXG5pbXBvcnQgQ29tcG9uZW50IGZyb20gJ2luZmVybm8tY29tcG9uZW50JztcclxuaW1wb3J0IHsgR3JpZCwgcmVkdWNlciwgc2VsZWN0R3JpZERhdGEsIHdpdGhTY3JvbGxQcm9wcyB9IGZyb20gJy4uLy4uL2luZGV4LmpzJztcclxuXHJcbmNvbnN0IFRyYWNrZWRHcmlkID0gd2l0aFNjcm9sbFByb3BzKEdyaWQpO1xyXG5cclxuY29uc3QgZGF0YSA9IEFycmF5KDEwMDAwMCkuZmlsbCgwKS5tYXAoKGl0ZW0sIGkpID0+ICh7XHJcbiAgICBjb2wxMTogYFBpbm5lZCBsZWZ0ICR7aX1gLFxyXG4gICAgY29sMTogaSxcclxuICAgIGNvbDI6IGBUaXRsZSAke2l9YCxcclxuICAgIGNvbDIxOiBgUGlubmVkIHJpZ2h0ICR7aX1gLFxyXG4gICAgY29sMzogJ0xvcmVtIElwc3VtIGlzIHNpbXBseSBkdW1teSB0ZXh0IG9mIHRoZSBwcmludGluZyBhbmQgdHlwZXNldHRpbmcgaW5kdXN0cnkuJ1xyXG59KSk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBWaWV3cG9ydCBleHRlbmRzIENvbXBvbmVudCB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG5cclxuICAgICAgICB0aGlzLnN0YXRlID0ge1xyXG4gICAgICAgICAgICBncmlkU3RhdGU6IHtcclxuICAgICAgICAgICAgICAgIGNvbHVtbnM6IFtcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdjb2wxJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlU29ydGluZzogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnY29sMTEnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogMTIwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwaW5uZWRMZWZ0OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVSZXNpemluZzogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnY29sMicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1pbldpZHRoOiA2MCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlTW92aW5nOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVGaWx0ZXJpbmc6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAnU2VhcmNoJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDE1MCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlUmVzaXppbmc6IHRydWVcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2NvbDIxJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDEyMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGlubmVkUmlnaHQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZVJlc2l6aW5nOiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdjb2wzJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICdDb2x1bW4gMycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiAyMDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heFdpZHRoOiAzMDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZU1vdmluZzogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlUmVzaXppbmc6IHRydWVcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJzQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogJzUwJSdcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICAgICAgcm93U3RhdGU6IHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEluZGV4OiAwXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIG9yaWdpbmFsRGF0YTogZGF0YVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuY2FsbGJhY2sgPSB0aGlzLmNhbGxiYWNrLmJpbmQodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgY2FsbGJhY2soYWN0aW9uKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYWN0aW9uKTtcclxuICAgICAgICBzd2l0Y2ggKGFjdGlvbi50eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ0ZJTFRFUl9DT0xVTU4nOlxyXG4gICAgICAgICAgICBjYXNlICdTT1JUX0NPTFVNTic6IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGdyaWRTdGF0ZSA9IHJlZHVjZXIodGhpcy5zdGF0ZS5ncmlkU3RhdGUsIGFjdGlvbik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBncmlkU3RhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogc2VsZWN0R3JpZERhdGEoZ3JpZFN0YXRlLCB0aGlzLnN0YXRlLm9yaWdpbmFsRGF0YSlcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBncmlkU3RhdGU6IHJlZHVjZXIodGhpcy5zdGF0ZS5ncmlkU3RhdGUsIGFjdGlvbilcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcih7fSwgeyBncmlkU3RhdGUsIGRhdGEgfSkge1xyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIDxUcmFja2VkR3JpZFxyXG4gICAgICAgICAgICAgICAgdmlld3BvcnRXaWR0aD17NjAwfVxyXG4gICAgICAgICAgICAgICAgdmlld3BvcnRIZWlnaHQ9ezM2MH1cclxuICAgICAgICAgICAgICAgIGhlYWRlckhlaWdodD17NjB9XHJcbiAgICAgICAgICAgICAgICBjb2x1bW5Db21wb25lbnQ9e3VuZGVmaW5lZH1cclxuICAgICAgICAgICAgICAgIHJvd0NvbXBvbmVudD17dW5kZWZpbmVkfVxyXG4gICAgICAgICAgICAgICAgc3RhdGU9e2dyaWRTdGF0ZX1cclxuICAgICAgICAgICAgICAgIGRhdGE9e2RhdGF9XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjaz17dGhpcy5jYWxsYmFja31cclxuICAgICAgICAgICAgLz5cclxuICAgICAgICApO1xyXG4gICAgfVxyXG59XHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9leGFtcGxlcy9kZW1vcy9HcmlkRGVtby5qcyIsImltcG9ydCBjcmVhdGVFbGVtZW50IGZyb20gJ2luZmVybm8tY3JlYXRlLWVsZW1lbnQnO1xyXG5pbXBvcnQgQ29tcG9uZW50IGZyb20gJ2luZmVybm8tY29tcG9uZW50JztcclxuaW1wb3J0IHsgd2l0aFNjcm9sbFByb3BzLCBHcmlkIH0gZnJvbSAnLi4vLi4vaW5kZXguanMnO1xyXG5cclxuY29uc3QgVHJhY2tlZEdyaWQgPSB3aXRoU2Nyb2xsUHJvcHMoR3JpZCk7XHJcblxyXG5jb25zdCBncmlkU3RhdGUgPSB7XHJcbiAgICBjb2x1bW5zOiBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBuYW1lOiAnY29sMScsXHJcbiAgICAgICAgICAgIHdpZHRoOiAnMjAlJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBuYW1lOiAnY29sMicsXHJcbiAgICAgICAgICAgIHdpZHRoOiAnMzUlJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBuYW1lOiAnY29sMycsXHJcbiAgICAgICAgICAgIHdpZHRoOiAnNDUlJ1xyXG4gICAgICAgIH1cclxuICAgIF1cclxufTtcclxuXHJcbmNvbnN0IGRhdGEgPSBBcnJheSgxMDAwMDApLmZpbGwoMCkubWFwKChpdGVtLCBpKSA9PiAoe1xyXG4gICAgY29sMTogaSxcclxuICAgIGNvbDI6IGBDb2wyICR7aX1gLFxyXG4gICAgY29sMzogJ0xvcmVtIElwc3VtIGlzIHNpbXBseSBkdW1teSB0ZXh0IG9mIHRoZSBwcmludGluZyBhbmQgdHlwZXNldHRpbmcgaW5kdXN0cnkuJ1xyXG59KSk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNaW5pbWFsIGV4dGVuZHMgQ29tcG9uZW50IHtcclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8VHJhY2tlZEdyaWRcclxuICAgICAgICAgICAgICAgIHZpZXdwb3J0V2lkdGg9ezcyMH1cclxuICAgICAgICAgICAgICAgIHZpZXdwb3J0SGVpZ2h0PXs0ODB9XHJcbiAgICAgICAgICAgICAgICBzdGF0ZT17Z3JpZFN0YXRlfVxyXG4gICAgICAgICAgICAgICAgZGF0YT17ZGF0YX0gLz5cclxuICAgICAgICApO1xyXG4gICAgfVxyXG59XHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9leGFtcGxlcy9kZW1vcy9NaW5pbWFsLmpzIiwiaW1wb3J0IGNyZWF0ZUVsZW1lbnQgZnJvbSAnaW5mZXJuby1jcmVhdGUtZWxlbWVudCc7XHJcbmltcG9ydCB7IHdpdGhTY3JvbGxQcm9wcywgR3JpZCB9IGZyb20gJy4uLy4uL2luZGV4LmpzJztcclxuXHJcbmNvbnN0IFRyYWNrZWRHcmlkID0gd2l0aFNjcm9sbFByb3BzKEdyaWQpO1xyXG5cclxuY29uc3QgZ3JpZFN0YXRlID0ge1xyXG4gICAgY29sdW1uczogW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgbmFtZTogJ2NvbDEnLFxyXG4gICAgICAgICAgICB3aWR0aDogJzUwJSdcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgbmFtZTogJ2NvbDExJyxcclxuICAgICAgICAgICAgd2lkdGg6IDEyMCxcclxuICAgICAgICAgICAgcGlubmVkTGVmdDogdHJ1ZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBuYW1lOiAnY29sMicsXHJcbiAgICAgICAgICAgIHdpZHRoOiAnNTAlJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBuYW1lOiAnY29sMjEnLFxyXG4gICAgICAgICAgICB3aWR0aDogMTIwLFxyXG4gICAgICAgICAgICBwaW5uZWRSaWdodDogdHJ1ZVxyXG4gICAgICAgIH1cclxuICAgIF1cclxufTtcclxuXHJcbmNvbnN0IGRhdGEgPSBBcnJheSgxMDAwMDApLmZpbGwoMCkubWFwKChpdGVtLCBpKSA9PiAoe1xyXG4gICAgY29sMTE6IGBQaW5uZWQgbGVmdCAke2l9YCxcclxuICAgIGNvbDE6IGksXHJcbiAgICBjb2wyOiBgVGl0bGUgJHtpfWAsXHJcbiAgICBjb2wyMTogYFBpbm5lZCByaWdodCAke2l9YCxcclxuICAgIGNvbDM6ICdMb3JlbSBJcHN1bSBpcyBzaW1wbHkgZHVtbXkgdGV4dCBvZiB0aGUgcHJpbnRpbmcgYW5kIHR5cGVzZXR0aW5nIGluZHVzdHJ5LidcclxufSkpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgKCkgPT4gKFxyXG4gICAgPFRyYWNrZWRHcmlkXHJcbiAgICAgICAgdmlld3BvcnRXaWR0aD17NjAwfVxyXG4gICAgICAgIHZpZXdwb3J0SGVpZ2h0PXszNjB9XHJcbiAgICAgICAgc3RhdGU9e2dyaWRTdGF0ZX1cclxuICAgICAgICBkYXRhPXtkYXRhfSAvPlxyXG4pO1xyXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvZXhhbXBsZXMvZGVtb3MvUGlubmVkQ29sdW1ucy5qcyIsImltcG9ydCBjcmVhdGVFbGVtZW50IGZyb20gJ2luZmVybm8tY3JlYXRlLWVsZW1lbnQnO1xyXG5pbXBvcnQgQ29tcG9uZW50IGZyb20gJ2luZmVybm8tY29tcG9uZW50JztcclxuXHJcbmV4cG9ydCBkZWZhdWx0ICh7IG9mZnNldCA9IDMsIHN0eWxlID0ge30gfSA9IHt9KSA9PiBCYXNlQ29tcG9uZW50ID0+IGNsYXNzIGV4dGVuZHMgQ29tcG9uZW50IHtcclxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XHJcbiAgICAgICAgc3VwZXIocHJvcHMpO1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgICAgICAgIGRyYWdnaW5nOiBmYWxzZVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5vbk1vdXNlRG93biA9IHRoaXMub25Nb3VzZURvd24uYmluZCh0aGlzKTtcclxuICAgIH1cclxuXHJcbiAgICBvbk1vdXNlRG93bihkb3duRXZlbnQpIHtcclxuICAgICAgICBjb25zdCBjbGllbnRYID0gZG93bkV2ZW50LmN1cnJlbnRUYXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdDtcclxuICAgICAgICBjb25zdCBzdGFydFggPSBkb3duRXZlbnQuY2xpZW50WCAtIGNsaWVudFg7XHJcbiAgICAgICAgY29uc3Qgb25Nb3VzZU1vdmUgPSBlID0+IHtcclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBjb25zdCB4ID0gZS5jbGllbnRYIC0gY2xpZW50WDtcclxuICAgICAgICAgICAgY29uc3QgZHggPSB4IC0gc3RhcnRYO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zdGF0ZS5kcmFnZ2luZyB8fCBNYXRoLmFicyhkeCkgPiBvZmZzZXQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRyYWdnaW5nOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGR4LFxyXG4gICAgICAgICAgICAgICAgICAgIHhcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb25zdCBvbk1vdXNlVXAgPSBlID0+IHtcclxuICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgb25Nb3VzZU1vdmUpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgb25Nb3VzZVVwKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc3RhdGUuZHJhZ2dpbmcgfHwgTWF0aC5hYnMoZS5jbGllbnRYIC0gY2xpZW50WCAtIHN0YXJ0WCkgPiBvZmZzZXQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRyYWdnaW5nOiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIG9uTW91c2VNb3ZlKTtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgb25Nb3VzZVVwKTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXIocHJvcHMsIHN0YXRlKSB7XHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgPGRpdiBvbk1vdXNlRG93bj17dGhpcy5vbk1vdXNlRG93bn0gc3R5bGU9e3N0eWxlfT5cclxuICAgICAgICAgICAgICAgIDxCYXNlQ29tcG9uZW50IHsuLi5wcm9wc30gey4uLnN0YXRlfSAvPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICApO1xyXG4gICAgfVxyXG59O1xyXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvaG9jL2RyYWdnYWJsZS5qcyIsImltcG9ydCBjcmVhdGVFbGVtZW50IGZyb20gJ2luZmVybm8tY3JlYXRlLWVsZW1lbnQnO1xyXG5pbXBvcnQgQ29tcG9uZW50IGZyb20gJ2luZmVybm8tY29tcG9uZW50JztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IHRlc3QgPT4gQmFzZUNvbXBvbmVudCA9PiBjbGFzcyBleHRlbmRzIENvbXBvbmVudCB7XHJcbiAgICBzaG91bGRDb21wb25lbnRVcGRhdGUobmV4dFByb3BzKSB7XHJcbiAgICAgICAgcmV0dXJuIHRlc3QodGhpcy5wcm9wcywgbmV4dFByb3BzKTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXIocHJvcHMpIHtcclxuICAgICAgICByZXR1cm4gPEJhc2VDb21wb25lbnQgey4uLnByb3BzfSAvPjtcclxuICAgIH1cclxufTtcclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2hvYy9zaG91bGRVcGRhdGUuanMiLCJpbXBvcnQgY3JlYXRlRWxlbWVudCBmcm9tICdpbmZlcm5vLWNyZWF0ZS1lbGVtZW50JztcclxuaW1wb3J0IENvbXBvbmVudCBmcm9tICdpbmZlcm5vLWNvbXBvbmVudCc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBoYW5kbGVycyA9PiBCYXNlQ29tcG9uZW50ID0+IGNsYXNzIGV4dGVuZHMgQ29tcG9uZW50IHtcclxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XHJcbiAgICAgICAgc3VwZXIocHJvcHMpO1xyXG4gICAgICAgIHRoaXMuaGFuZGxlcnMgPSBPYmplY3Qua2V5cyhoYW5kbGVycykucmVkdWNlKChhY2MsIG5hbWUpID0+IHtcclxuICAgICAgICAgICAgYWNjW25hbWVdID0gKC4uLmFyZ3MpID0+IGhhbmRsZXJzW25hbWVdKHRoaXMucHJvcHMsIC4uLmFyZ3MpO1xyXG4gICAgICAgICAgICByZXR1cm4gYWNjO1xyXG4gICAgICAgIH0sIHt9KTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXIocHJvcHMpIHtcclxuICAgICAgICByZXR1cm4gPEJhc2VDb21wb25lbnQgey4uLnByb3BzfSB7Li4udGhpcy5oYW5kbGVyc30gLz47XHJcbiAgICB9XHJcbn07XHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9ob2Mvd2l0aEhhbmRsZXJzLmpzIiwiaW1wb3J0IGNyZWF0ZUVsZW1lbnQgZnJvbSAnaW5mZXJuby1jcmVhdGUtZWxlbWVudCc7XHJcbmltcG9ydCBDb21wb25lbnQgZnJvbSAnaW5mZXJuby1jb21wb25lbnQnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgaGFuZGxlcnMgPT4gQmFzZUNvbXBvbmVudCA9PiBjbGFzcyBleHRlbmRzIENvbXBvbmVudCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xyXG4gICAgICAgIHN1cGVyKHByb3BzKTtcclxuICAgICAgICBjb25zdCBoYW5kbGVyc0tleXMgPSBPYmplY3Qua2V5cyhoYW5kbGVycyk7XHJcbiAgICAgICAgY29uc3QgaGFuZGxlcnNQcm9wcyA9IHt9O1xyXG4gICAgICAgIGNvbnN0IGJvdW5kSGFuZGxlcnMgPSBoYW5kbGVyc0tleXMucmVkdWNlKChhY2MsIGtleSkgPT4ge1xyXG4gICAgICAgICAgICBhY2Nba2V5XSA9ICguLi5hcmdzKSA9PiBoYW5kbGVyc1trZXldKGhhbmRsZXJzUHJvcHNba2V5XSwgLi4uYXJncyk7XHJcbiAgICAgICAgICAgIHJldHVybiBhY2M7XHJcbiAgICAgICAgfSwge30pO1xyXG4gICAgICAgIHRoaXMuaGFuZGxlcnMgPSBoYW5kbGVyc0tleXMucmVkdWNlKChhY2MsIGtleSkgPT4ge1xyXG4gICAgICAgICAgICBhY2Nba2V5XSA9IHByb3AgPT4ge1xyXG4gICAgICAgICAgICAgICAgaGFuZGxlcnNQcm9wc1trZXldID0gcHJvcDtcclxuICAgICAgICAgICAgICAgIHJldHVybiBib3VuZEhhbmRsZXJzW2tleV07XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHJldHVybiBhY2M7XHJcbiAgICAgICAgfSwge30pO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcihwcm9wcykge1xyXG4gICAgICAgIHJldHVybiA8QmFzZUNvbXBvbmVudCB7Li4ucHJvcHN9IHsuLi50aGlzLmhhbmRsZXJzfSAvPjtcclxuICAgIH1cclxufTtcclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2hvYy93aXRoTGlua2VkSGFuZGxlcnMuanMiLCJpbXBvcnQgY3JlYXRlRWxlbWVudCBmcm9tICdpbmZlcm5vLWNyZWF0ZS1lbGVtZW50JztcclxuaW1wb3J0IENvbXBvbmVudCBmcm9tICdpbmZlcm5vLWNvbXBvbmVudCc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCByZWR1Y2VyID0+IEJhc2VDb21wb25lbnQgPT4gY2xhc3MgZXh0ZW5kcyBDb21wb25lbnQge1xyXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcclxuICAgICAgICBzdXBlcihwcm9wcyk7XHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHJlZHVjZXIocHJvcHMpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzKSB7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZShyZWR1Y2VyKG5leHRQcm9wcywgdGhpcy5zdGF0ZSkpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcihwcm9wcywgc3RhdGUpIHtcclxuICAgICAgICByZXR1cm4gPEJhc2VDb21wb25lbnQgey4uLnByb3BzfSB7Li4uc3RhdGV9IC8+O1xyXG4gICAgfVxyXG59O1xyXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvaG9jL3dpdGhNaWRkbGVTdGF0ZS5qcyIsImltcG9ydCBjcmVhdGVFbGVtZW50IGZyb20gJ2luZmVybm8tY3JlYXRlLWVsZW1lbnQnO1xyXG5pbXBvcnQgeyBjb21wb3NlLCBjaGVja1Byb3BzIH0gZnJvbSAnLi4vdXRpbHMvaW5kZXguanMnO1xyXG5pbXBvcnQgd2l0aFByb3BzT25DaGFuZ2UgZnJvbSAnLi93aXRoUHJvcHNPbkNoYW5nZS5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCAoKSA9PiBCYXNlQ29tcG9uZW50ID0+IGNvbXBvc2UoXHJcbiAgICB3aXRoUHJvcHNPbkNoYW5nZShjaGVja1Byb3BzKCdjb2x1bW5zJyksIHByb3BzID0+ICh7XHJcbiAgICAgICAgbGVmdFBpbm5lZENvbHVtbnM6IHByb3BzLmNvbHVtbnMuZmlsdGVyKGNvbHVtbiA9PiBjb2x1bW4ucGlubmVkTGVmdCksXHJcbiAgICAgICAgY2VudGVyQ29sdW1uczogcHJvcHMuY29sdW1ucy5maWx0ZXIoY29sdW1uID0+ICFjb2x1bW4ucGlubmVkTGVmdCAmJiAhY29sdW1uLnBpbm5lZFJpZ2h0KSxcclxuICAgICAgICByaWdodFBpbm5lZENvbHVtbnM6IHByb3BzLmNvbHVtbnMuZmlsdGVyKGNvbHVtbiA9PiBjb2x1bW4ucGlubmVkUmlnaHQpXHJcbiAgICB9KSlcclxuKShwcm9wcyA9PlxyXG4gICAgPGRpdiBzdHlsZT17eyBkaXNwbGF5OiAnZmxleCcgfX0+XHJcbiAgICAgICAge3Byb3BzLmxlZnRQaW5uZWRDb2x1bW5zLmxlbmd0aCAhPT0gMCAmJlxyXG4gICAgICAgICAgICA8ZGl2IHN0eWxlPXt7IHBvc2l0aW9uOiAnc3RpY2t5JywgekluZGV4OiAyLCBsZWZ0OiAwIH19PlxyXG4gICAgICAgICAgICAgICAgPEJhc2VDb21wb25lbnQgey4uLnByb3BzfSBjb2x1bW5zPXtwcm9wcy5sZWZ0UGlubmVkQ29sdW1uc30gLz5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgfVxyXG4gICAgICAgIDxCYXNlQ29tcG9uZW50IHsuLi5wcm9wc30gY29sdW1ucz17cHJvcHMuY2VudGVyQ29sdW1uc30gLz5cclxuICAgICAgICB7cHJvcHMucmlnaHRQaW5uZWRDb2x1bW5zLmxlbmd0aCAhPT0gMCAmJlxyXG4gICAgICAgICAgICA8ZGl2IHN0eWxlPXt7IHBvc2l0aW9uOiAnc3RpY2t5JywgekluZGV4OiAyLCByaWdodDogMCB9fT5cclxuICAgICAgICAgICAgICAgIDxCYXNlQ29tcG9uZW50IHsuLi5wcm9wc30gY29sdW1ucz17cHJvcHMucmlnaHRQaW5uZWRDb2x1bW5zfSAvPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICB9XHJcbiAgICA8L2Rpdj5cclxuKTtcclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2hvYy93aXRoUGlubmVkQ29sdW1ucy5qcyIsImltcG9ydCBjcmVhdGVFbGVtZW50IGZyb20gJ2luZmVybm8tY3JlYXRlLWVsZW1lbnQnO1xyXG5pbXBvcnQgQ29tcG9uZW50IGZyb20gJ2luZmVybm8tY29tcG9uZW50JztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IEJhc2VDb21wb25lbnQgPT4gY2xhc3MgZXh0ZW5kcyBDb21wb25lbnQge1xyXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcclxuICAgICAgICBzdXBlcihwcm9wcyk7XHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgICAgICAgc2Nyb2xsVG9wOiAwLFxyXG4gICAgICAgICAgICBzY3JvbGxMZWZ0OiAwLFxyXG4gICAgICAgICAgICB2aWV3cG9ydFdpZHRoOiBwcm9wcy52aWV3cG9ydFdpZHRoLFxyXG4gICAgICAgICAgICB2aWV3cG9ydEhlaWdodDogcHJvcHMudmlld3BvcnRIZWlnaHRcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMucmVmID0gZWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XHJcbiAgICAgICAgICAgIGlmIChlbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB2aWV3cG9ydFdpZHRoOiBlbGVtZW50LmNsaWVudFdpZHRoLFxyXG4gICAgICAgICAgICAgICAgICAgIHZpZXdwb3J0SGVpZ2h0OiBlbGVtZW50LmNsaWVudEhlaWdodFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMub25TY3JvbGwgPSBlID0+IHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICBzY3JvbGxUb3A6IGUudGFyZ2V0LnNjcm9sbFRvcCxcclxuICAgICAgICAgICAgc2Nyb2xsTGVmdDogZS50YXJnZXQuc2Nyb2xsTGVmdFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzKSB7XHJcbiAgICAgICAgaWYgKHRoaXMucHJvcHMudmlld3BvcnRXaWR0aCAhPT0gbmV4dFByb3BzLnZpZXdwb3J0V2lkdGggfHxcclxuICAgICAgICAgICAgdGhpcy5wcm9wcy52aWV3cG9ydEhlaWdodCAhPT0gbmV4dFByb3BzLnZpZXdwb3J0SGVpZ2h0XHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHZpZXdwb3J0V2lkdGg6IHRoaXMuZWxlbWVudC5jbGllbnRXaWR0aCxcclxuICAgICAgICAgICAgICAgICAgICB2aWV3cG9ydEhlaWdodDogdGhpcy5lbGVtZW50LmNsaWVudEhlaWdodFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyKHByb3BzLCBzdGF0ZSkge1xyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIDxkaXYgc3R5bGU9e3sgd2lkdGg6IHByb3BzLnZpZXdwb3J0V2lkdGgsIGhlaWdodDogcHJvcHMudmlld3BvcnRIZWlnaHQsIG92ZXJmbG93OiAnYXV0bycgfX1cclxuICAgICAgICAgICAgICAgIG9uU2Nyb2xsPXt0aGlzLm9uU2Nyb2xsfVxyXG4gICAgICAgICAgICAgICAgcmVmPXt0aGlzLnJlZn0+XHJcbiAgICAgICAgICAgICAgICA8QmFzZUNvbXBvbmVudCB7Li4ucHJvcHN9IHsuLi5zdGF0ZX0gLz5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufTtcclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2hvYy93aXRoU2Nyb2xsUHJvcHMuanMiLCJleHBvcnQgZGVmYXVsdCAoc3RhdGUgPSB7fSwgYWN0aW9uKSA9PiB7XHJcbiAgICBzd2l0Y2ggKGFjdGlvbi50eXBlKSB7XHJcbiAgICAgICAgY2FzZSAnTUFSS19NT1ZFX0RFU1QnOlxyXG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUsIHtcclxuICAgICAgICAgICAgICAgIG1vdmluZzoge1xyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IGFjdGlvbi5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIGxlZnQ6IGFjdGlvbi5sZWZ0LFxyXG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0OiBhY3Rpb24ucmlnaHRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNhc2UgJ01PVkVfQ09MVU1OJzpcclxuICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLCB7XHJcbiAgICAgICAgICAgICAgICBtb3Zpbmc6IG51bGxcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNhc2UgJ1JFU0laRV9DT0xVTU4nOlxyXG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUsIHtcclxuICAgICAgICAgICAgICAgIHJlc2l6aW5nOiBudWxsXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICByZXR1cm4gc3RhdGU7XHJcbiAgICB9XHJcbn07XHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9yZWR1Y2Vycy9jb2x1bW5TdGF0ZS5qcyIsImV4cG9ydCBkZWZhdWx0IChzdGF0ZSA9IFtdLCBhY3Rpb24pID0+IHtcclxuICAgIHN3aXRjaCAoYWN0aW9uLnR5cGUpIHtcclxuICAgICAgICBjYXNlICdNT1ZFX0NPTFVNTic6XHJcbiAgICAgICAgICAgIGlmIChhY3Rpb24ubGVmdCB8fCBhY3Rpb24ucmlnaHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4XHJcbiAgICAgICAgICAgICAgICAgICAgPSBhY3Rpb24ubGVmdFxyXG4gICAgICAgICAgICAgICAgICAgID8gc3RhdGUuZmluZEluZGV4KGl0ZW0gPT4gaXRlbS5uYW1lID09PSBhY3Rpb24ubGVmdCkgKyAxXHJcbiAgICAgICAgICAgICAgICAgICAgOiBzdGF0ZS5maW5kSW5kZXgoaXRlbSA9PiBpdGVtLm5hbWUgPT09IGFjdGlvbi5yaWdodCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAgICAgICAgIC4uLnN0YXRlLnNsaWNlKDAsIGluZGV4KS5maWx0ZXIoaXRlbSA9PiBpdGVtLm5hbWUgIT09IGFjdGlvbi5uYW1lKSxcclxuICAgICAgICAgICAgICAgICAgICAuLi5zdGF0ZS5maWx0ZXIoaXRlbSA9PiBpdGVtLm5hbWUgPT09IGFjdGlvbi5uYW1lKSxcclxuICAgICAgICAgICAgICAgICAgICAuLi5zdGF0ZS5zbGljZShpbmRleCkuZmlsdGVyKGl0ZW0gPT4gaXRlbS5uYW1lICE9PSBhY3Rpb24ubmFtZSlcclxuICAgICAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHN0YXRlO1xyXG5cclxuICAgICAgICBjYXNlICdSRVNJWkVfQ09MVU1OJzpcclxuICAgICAgICAgICAgcmV0dXJuIHN0YXRlLm1hcChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChpdGVtLm5hbWUgPT09IGFjdGlvbi5uYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIGl0ZW0sIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IGFjdGlvbi5zaXplXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNhc2UgJ0ZJTFRFUl9DT0xVTU4nOlxyXG4gICAgICAgICAgICByZXR1cm4gc3RhdGUubWFwKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0ubmFtZSA9PT0gYWN0aW9uLm5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgaXRlbSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXI6IGFjdGlvbi5maWx0ZXJcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY2FzZSAnU09SVF9DT0xVTU4nOlxyXG4gICAgICAgICAgICByZXR1cm4gc3RhdGUubWFwKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0ubmFtZSA9PT0gYWN0aW9uLm5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgaXRlbSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3J0OiAhaXRlbS5zb3J0ICYmICdhc2MnIHx8IGl0ZW0uc29ydCA9PT0gJ2FzYycgJiYgJ2Rlc2MnIHx8IGl0ZW0uc29ydCA9PT0gJ2Rlc2MnICYmIG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChpdGVtLnNvcnQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgaXRlbSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3J0OiBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHJldHVybiBzdGF0ZTtcclxuICAgIH1cclxufTtcclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3JlZHVjZXJzL2NvbHVtbnMuanMiLCJpbXBvcnQgY29sdW1uc1JlZHVjZXIgZnJvbSAnLi9jb2x1bW5zLmpzJztcclxuaW1wb3J0IGNvbHVtblN0YXRlUmVkdWNlciBmcm9tICcuL2NvbHVtblN0YXRlLmpzJztcclxuaW1wb3J0IHJvd1N0YXRlUmVkdWNlciBmcm9tICcuL3Jvd1N0YXRlLmpzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IChzdGF0ZSA9IHt9LCBhY3Rpb24pID0+IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLCB7XHJcbiAgICBjb2x1bW5zOiBjb2x1bW5zUmVkdWNlcihzdGF0ZS5jb2x1bW5zLCBhY3Rpb24pLFxyXG4gICAgY29sdW1uU3RhdGU6IGNvbHVtblN0YXRlUmVkdWNlcihzdGF0ZS5jb2x1bW5TdGF0ZSwgYWN0aW9uKSxcclxuICAgIHJvd1N0YXRlOiByb3dTdGF0ZVJlZHVjZXIoc3RhdGUucm93U3RhdGUsIGFjdGlvbilcclxufSk7XHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9yZWR1Y2Vycy9pbmRleC5qcyIsImV4cG9ydCBkZWZhdWx0IChzdGF0ZSA9IHt9LCBhY3Rpb24pID0+IHtcclxuICAgIHN3aXRjaCAoYWN0aW9uLnR5cGUpIHtcclxuICAgICAgICBjYXNlICdTRUxFQ1RfUk9XJzpcclxuICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLCB7XHJcbiAgICAgICAgICAgICAgICBzZWxlY3RlZEluZGV4OiBhY3Rpb24ucm93SW5kZXhcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHJldHVybiBzdGF0ZTtcclxuICAgIH1cclxufTtcclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3JlZHVjZXJzL3Jvd1N0YXRlLmpzIiwiaW1wb3J0IGZpbmRDb2x1bW4gZnJvbSAnLi9maW5kQ29sdW1uLmpzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IChjb2x1bW5zLCBwb3NpdGlvbikgPT4ge1xyXG4gICAgaWYgKGNvbHVtbnMubGVuZ3RoIDwgMikge1xyXG4gICAgICAgIHJldHVybiBbLTEsIDBdO1xyXG4gICAgfVxyXG4gICAgY29uc3QgW2NvbHVtbkluZGV4LCBjb2x1bW5Qb3NpdGlvbl0gPSBmaW5kQ29sdW1uKGNvbHVtbnMsIHBvc2l0aW9uKTtcclxuICAgIGlmIChjb2x1bW5JbmRleCA9PT0gLTEpIHtcclxuICAgICAgICByZXR1cm4gWy0xLCAwXTtcclxuICAgIH1cclxuICAgIGlmIChjb2x1bW5JbmRleCA9PT0gY29sdW1ucy5sZW5ndGgpIHtcclxuICAgICAgICByZXR1cm4gW2NvbHVtbnMubGVuZ3RoIC0gMSwgLTFdO1xyXG4gICAgfVxyXG4gICAgY29uc3Qgd2lkdGggPSBjb2x1bW5zW2NvbHVtbkluZGV4XS53aWR0aDtcclxuICAgIGlmIChjb2x1bW5Qb3NpdGlvbiA8IHdpZHRoIC8gMikge1xyXG4gICAgICAgIHJldHVybiBbY29sdW1uSW5kZXggLSAxLCBjb2x1bW5JbmRleF07XHJcbiAgICB9IGVsc2UgaWYgKGNvbHVtbkluZGV4ID09PSBjb2x1bW5zLmxlbmd0aCAtIDEpIHtcclxuICAgICAgICByZXR1cm4gW2NvbHVtbkluZGV4LCAtMV07XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBbY29sdW1uSW5kZXgsIGNvbHVtbkluZGV4ICsgMV07XHJcbiAgICB9XHJcbn07XHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy91dGlscy9iaXNlY3RDb2x1bW5zLmpzIiwiZXhwb3J0IGRlZmF1bHQgKC4uLmxpc3QpID0+IChwcm9wcywgbmV4dFByb3BzKSA9PlxyXG4gICAgbGlzdC5zb21lKGtleSA9PiBwcm9wc1trZXldICE9PSBuZXh0UHJvcHNba2V5XSk7XHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy91dGlscy9jaGVja1Byb3BzLmpzIiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gY29tcG9zZSguLi5mdW5jcykge1xyXG4gICAgaWYgKGZ1bmNzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIHJldHVybiBhcmcgPT4gYXJnO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChmdW5jcy5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3NbMF07XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGZ1bmNzLnJlZHVjZSgoYSwgYikgPT4gKC4uLmFyZ3MpID0+IGEoYiguLi5hcmdzKSkpO1xyXG59XHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy91dGlscy9jb21wb3NlLmpzIiwiY29uc3QgZW1wdHkgPSAoKSA9PiBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG5cclxuY29uc3QgaW52ZXJ0ID0gb2JqID0+IE9iamVjdC5rZXlzKG9iaikucmVkdWNlKChhY2MsIGtleSkgPT4gKGFjY1tvYmpba2V5XV0gPSBrZXksIGFjYyksIGVtcHR5KCkpO1xyXG5cclxuY29uc3QgY3JlYXRlRnJlZUtleUdlbmVyYXRvciA9IChpbmRleGVzKSA9PiB7XHJcbiAgICBsZXQgbGFzdFBvaW50ZXIgPSAwO1xyXG4gICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgICB3aGlsZSAodHJ1ZSkge1xyXG4gICAgICAgICAgICBjb25zdCBrZXkgPSBga2V5XyR7bGFzdFBvaW50ZXJ9YDtcclxuICAgICAgICAgICAgbGFzdFBvaW50ZXIgKz0gMTtcclxuICAgICAgICAgICAgaWYgKCEoa2V5IGluIGluZGV4ZXMpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ga2V5O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufTtcclxuXHJcbmNvbnN0IGdldFJlY292ZXJlZEtleXMgPSAobGFzdEtleXMsIHN0YXJ0LCBlbmQpID0+IHtcclxuICAgIGNvbnN0IGtleXMgPSBlbXB0eSgpO1xyXG4gICAgZm9yIChsZXQgaSA9IHN0YXJ0OyBpIDwgZW5kICsgMTsgaSArPSAxKSB7XHJcbiAgICAgICAgaWYgKGkgaW4gbGFzdEtleXMpIHtcclxuICAgICAgICAgICAga2V5c1tpXSA9IGxhc3RLZXlzW2ldO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBrZXlzO1xyXG59O1xyXG5cclxuY29uc3QgZ2VuZXJhdGVLZXlzID0gKGxhc3RLZXlzLCBzdGFydCwgZW5kKSA9PiB7XHJcbiAgICBjb25zdCBrZXlzID0gZW1wdHkoKTtcclxuICAgIGNvbnN0IGdlbmVyYXRlS2V5ID0gY3JlYXRlRnJlZUtleUdlbmVyYXRvcihpbnZlcnQobGFzdEtleXMpKTtcclxuICAgIGZvciAobGV0IGkgPSBzdGFydDsgaSA8IGVuZCArIDE7IGkgKz0gMSkge1xyXG4gICAgICAgIGlmICghKGkgaW4gbGFzdEtleXMpKSB7XHJcbiAgICAgICAgICAgIGtleXNbaV0gPSBnZW5lcmF0ZUtleSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBrZXlzO1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgKGxhc3RLZXlzID0gZW1wdHkoKSwgc3RhcnQsIGVuZCkgPT4ge1xyXG4gICAgY29uc3QgcmVjb3ZlcmVkID0gZ2V0UmVjb3ZlcmVkS2V5cyhsYXN0S2V5cywgc3RhcnQsIGVuZCk7XHJcbiAgICBjb25zdCBnZW5lcmF0ZWQgPSBnZW5lcmF0ZUtleXMocmVjb3ZlcmVkLCBzdGFydCwgZW5kKTtcclxuICAgIHJldHVybiBPYmplY3QuYXNzaWduKGVtcHR5KCksIHJlY292ZXJlZCwgZ2VuZXJhdGVkKTtcclxufTtcclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3V0aWxzL2dldEtleXNCeUluZGV4LmpzIiwiY29uc3QgZmlsdGVyUm93QnlDb2x1bW5zID0gKHJvdywgY29sdW1ucykgPT5cclxuICAgIGNvbHVtbnMuZXZlcnkoY29sdW1uID0+IHJvd1tjb2x1bW4ubmFtZV0udG9Mb3dlckNhc2UoKS5pbmRleE9mKGNvbHVtbi5maWx0ZXIpICE9PSAtMSk7XHJcblxyXG5jb25zdCBzb3J0Um93c0J5Q29sdW1ucyA9IChhLCBiLCBjb2x1bW4pID0+IHtcclxuICAgIGlmIChhW2NvbHVtbi5uYW1lXSA9PT0gYltjb2x1bW4ubmFtZV0pIHtcclxuICAgICAgICByZXR1cm4gMDtcclxuICAgIH1cclxuICAgIGlmIChjb2x1bW4uc29ydCA9PT0gJ2FzYycpIHtcclxuICAgICAgICByZXR1cm4gYVtjb2x1bW4ubmFtZV0gPCBiW2NvbHVtbi5uYW1lXSA/IC0xIDogMTtcclxuICAgIH1cclxuICAgIHJldHVybiBhW2NvbHVtbi5uYW1lXSA+IGJbY29sdW1uLm5hbWVdID8gLTEgOiAxO1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgKGdyaWRTdGF0ZSwgZGF0YSkgPT4ge1xyXG4gICAgY29uc3QgZmlsdGVyZWRDb2x1bW5zID0gZ3JpZFN0YXRlLmNvbHVtbnMuZmlsdGVyKGNvbHVtbiA9PiBjb2x1bW4uZmlsdGVyKTtcclxuICAgIGNvbnN0IHNvcnRlZENvbHVtbiA9IGdyaWRTdGF0ZS5jb2x1bW5zLmZpbmQoY29sdW1uID0+IGNvbHVtbi5zb3J0ID09PSAnYXNjJyB8fCBjb2x1bW4uc29ydCA9PT0gJ2Rlc2MnKTtcclxuICAgIGNvbnN0IGZpbHRlcmVkXHJcbiAgICAgICAgPSBmaWx0ZXJlZENvbHVtbnMubGVuZ3RoXHJcbiAgICAgICAgPyBkYXRhLmZpbHRlcihkYXR1bSA9PiBmaWx0ZXJSb3dCeUNvbHVtbnMoZGF0dW0sIGZpbHRlcmVkQ29sdW1ucykpXHJcbiAgICAgICAgOiBkYXRhO1xyXG4gICAgY29uc3Qgc29ydGVkXHJcbiAgICAgICAgPSBzb3J0ZWRDb2x1bW5cclxuICAgICAgICA/IGZpbHRlcmVkLnNsaWNlKCkuc29ydCgoYSwgYikgPT4gc29ydFJvd3NCeUNvbHVtbnMoYSwgYiwgc29ydGVkQ29sdW1uKSlcclxuICAgICAgICA6IGZpbHRlcmVkO1xyXG4gICAgcmV0dXJuIHNvcnRlZDtcclxufTtcclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3V0aWxzL3NlbGVjdEdyaWREYXRhLmpzIiwiZXhwb3J0IGRlZmF1bHQgKGNvbHVtbiwgd2lkdGgpID0+IE1hdGgubWluKE1hdGgubWF4KGNvbHVtbi5taW5XaWR0aCB8fCAwLCB3aWR0aCksIGNvbHVtbi5tYXhXaWR0aCB8fCBJbmZpbml0eSk7XHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy91dGlscy90cmltQ29sdW1uV2lkdGguanMiLCIndXNlIHN0cmljdCdcblxuZXhwb3J0cy5ieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aFxuZXhwb3J0cy50b0J5dGVBcnJheSA9IHRvQnl0ZUFycmF5XG5leHBvcnRzLmZyb21CeXRlQXJyYXkgPSBmcm9tQnl0ZUFycmF5XG5cbnZhciBsb29rdXAgPSBbXVxudmFyIHJldkxvb2t1cCA9IFtdXG52YXIgQXJyID0gdHlwZW9mIFVpbnQ4QXJyYXkgIT09ICd1bmRlZmluZWQnID8gVWludDhBcnJheSA6IEFycmF5XG5cbnZhciBjb2RlID0gJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky8nXG5mb3IgKHZhciBpID0gMCwgbGVuID0gY29kZS5sZW5ndGg7IGkgPCBsZW47ICsraSkge1xuICBsb29rdXBbaV0gPSBjb2RlW2ldXG4gIHJldkxvb2t1cFtjb2RlLmNoYXJDb2RlQXQoaSldID0gaVxufVxuXG5yZXZMb29rdXBbJy0nLmNoYXJDb2RlQXQoMCldID0gNjJcbnJldkxvb2t1cFsnXycuY2hhckNvZGVBdCgwKV0gPSA2M1xuXG5mdW5jdGlvbiBwbGFjZUhvbGRlcnNDb3VudCAoYjY0KSB7XG4gIHZhciBsZW4gPSBiNjQubGVuZ3RoXG4gIGlmIChsZW4gJSA0ID4gMCkge1xuICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBzdHJpbmcuIExlbmd0aCBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgNCcpXG4gIH1cblxuICAvLyB0aGUgbnVtYmVyIG9mIGVxdWFsIHNpZ25zIChwbGFjZSBob2xkZXJzKVxuICAvLyBpZiB0aGVyZSBhcmUgdHdvIHBsYWNlaG9sZGVycywgdGhhbiB0aGUgdHdvIGNoYXJhY3RlcnMgYmVmb3JlIGl0XG4gIC8vIHJlcHJlc2VudCBvbmUgYnl0ZVxuICAvLyBpZiB0aGVyZSBpcyBvbmx5IG9uZSwgdGhlbiB0aGUgdGhyZWUgY2hhcmFjdGVycyBiZWZvcmUgaXQgcmVwcmVzZW50IDIgYnl0ZXNcbiAgLy8gdGhpcyBpcyBqdXN0IGEgY2hlYXAgaGFjayB0byBub3QgZG8gaW5kZXhPZiB0d2ljZVxuICByZXR1cm4gYjY0W2xlbiAtIDJdID09PSAnPScgPyAyIDogYjY0W2xlbiAtIDFdID09PSAnPScgPyAxIDogMFxufVxuXG5mdW5jdGlvbiBieXRlTGVuZ3RoIChiNjQpIHtcbiAgLy8gYmFzZTY0IGlzIDQvMyArIHVwIHRvIHR3byBjaGFyYWN0ZXJzIG9mIHRoZSBvcmlnaW5hbCBkYXRhXG4gIHJldHVybiBiNjQubGVuZ3RoICogMyAvIDQgLSBwbGFjZUhvbGRlcnNDb3VudChiNjQpXG59XG5cbmZ1bmN0aW9uIHRvQnl0ZUFycmF5IChiNjQpIHtcbiAgdmFyIGksIGosIGwsIHRtcCwgcGxhY2VIb2xkZXJzLCBhcnJcbiAgdmFyIGxlbiA9IGI2NC5sZW5ndGhcbiAgcGxhY2VIb2xkZXJzID0gcGxhY2VIb2xkZXJzQ291bnQoYjY0KVxuXG4gIGFyciA9IG5ldyBBcnIobGVuICogMyAvIDQgLSBwbGFjZUhvbGRlcnMpXG5cbiAgLy8gaWYgdGhlcmUgYXJlIHBsYWNlaG9sZGVycywgb25seSBnZXQgdXAgdG8gdGhlIGxhc3QgY29tcGxldGUgNCBjaGFyc1xuICBsID0gcGxhY2VIb2xkZXJzID4gMCA/IGxlbiAtIDQgOiBsZW5cblxuICB2YXIgTCA9IDBcblxuICBmb3IgKGkgPSAwLCBqID0gMDsgaSA8IGw7IGkgKz0gNCwgaiArPSAzKSB7XG4gICAgdG1wID0gKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpKV0gPDwgMTgpIHwgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMSldIDw8IDEyKSB8IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSArIDIpXSA8PCA2KSB8IHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMyldXG4gICAgYXJyW0wrK10gPSAodG1wID4+IDE2KSAmIDB4RkZcbiAgICBhcnJbTCsrXSA9ICh0bXAgPj4gOCkgJiAweEZGXG4gICAgYXJyW0wrK10gPSB0bXAgJiAweEZGXG4gIH1cblxuICBpZiAocGxhY2VIb2xkZXJzID09PSAyKSB7XG4gICAgdG1wID0gKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpKV0gPDwgMikgfCAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkgKyAxKV0gPj4gNClcbiAgICBhcnJbTCsrXSA9IHRtcCAmIDB4RkZcbiAgfSBlbHNlIGlmIChwbGFjZUhvbGRlcnMgPT09IDEpIHtcbiAgICB0bXAgPSAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkpXSA8PCAxMCkgfCAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkgKyAxKV0gPDwgNCkgfCAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkgKyAyKV0gPj4gMilcbiAgICBhcnJbTCsrXSA9ICh0bXAgPj4gOCkgJiAweEZGXG4gICAgYXJyW0wrK10gPSB0bXAgJiAweEZGXG4gIH1cblxuICByZXR1cm4gYXJyXG59XG5cbmZ1bmN0aW9uIHRyaXBsZXRUb0Jhc2U2NCAobnVtKSB7XG4gIHJldHVybiBsb29rdXBbbnVtID4+IDE4ICYgMHgzRl0gKyBsb29rdXBbbnVtID4+IDEyICYgMHgzRl0gKyBsb29rdXBbbnVtID4+IDYgJiAweDNGXSArIGxvb2t1cFtudW0gJiAweDNGXVxufVxuXG5mdW5jdGlvbiBlbmNvZGVDaHVuayAodWludDgsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIHRtcFxuICB2YXIgb3V0cHV0ID0gW11cbiAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyBpICs9IDMpIHtcbiAgICB0bXAgPSAodWludDhbaV0gPDwgMTYpICsgKHVpbnQ4W2kgKyAxXSA8PCA4KSArICh1aW50OFtpICsgMl0pXG4gICAgb3V0cHV0LnB1c2godHJpcGxldFRvQmFzZTY0KHRtcCkpXG4gIH1cbiAgcmV0dXJuIG91dHB1dC5qb2luKCcnKVxufVxuXG5mdW5jdGlvbiBmcm9tQnl0ZUFycmF5ICh1aW50OCkge1xuICB2YXIgdG1wXG4gIHZhciBsZW4gPSB1aW50OC5sZW5ndGhcbiAgdmFyIGV4dHJhQnl0ZXMgPSBsZW4gJSAzIC8vIGlmIHdlIGhhdmUgMSBieXRlIGxlZnQsIHBhZCAyIGJ5dGVzXG4gIHZhciBvdXRwdXQgPSAnJ1xuICB2YXIgcGFydHMgPSBbXVxuICB2YXIgbWF4Q2h1bmtMZW5ndGggPSAxNjM4MyAvLyBtdXN0IGJlIG11bHRpcGxlIG9mIDNcblxuICAvLyBnbyB0aHJvdWdoIHRoZSBhcnJheSBldmVyeSB0aHJlZSBieXRlcywgd2UnbGwgZGVhbCB3aXRoIHRyYWlsaW5nIHN0dWZmIGxhdGVyXG4gIGZvciAodmFyIGkgPSAwLCBsZW4yID0gbGVuIC0gZXh0cmFCeXRlczsgaSA8IGxlbjI7IGkgKz0gbWF4Q2h1bmtMZW5ndGgpIHtcbiAgICBwYXJ0cy5wdXNoKGVuY29kZUNodW5rKHVpbnQ4LCBpLCAoaSArIG1heENodW5rTGVuZ3RoKSA+IGxlbjIgPyBsZW4yIDogKGkgKyBtYXhDaHVua0xlbmd0aCkpKVxuICB9XG5cbiAgLy8gcGFkIHRoZSBlbmQgd2l0aCB6ZXJvcywgYnV0IG1ha2Ugc3VyZSB0byBub3QgZm9yZ2V0IHRoZSBleHRyYSBieXRlc1xuICBpZiAoZXh0cmFCeXRlcyA9PT0gMSkge1xuICAgIHRtcCA9IHVpbnQ4W2xlbiAtIDFdXG4gICAgb3V0cHV0ICs9IGxvb2t1cFt0bXAgPj4gMl1cbiAgICBvdXRwdXQgKz0gbG9va3VwWyh0bXAgPDwgNCkgJiAweDNGXVxuICAgIG91dHB1dCArPSAnPT0nXG4gIH0gZWxzZSBpZiAoZXh0cmFCeXRlcyA9PT0gMikge1xuICAgIHRtcCA9ICh1aW50OFtsZW4gLSAyXSA8PCA4KSArICh1aW50OFtsZW4gLSAxXSlcbiAgICBvdXRwdXQgKz0gbG9va3VwW3RtcCA+PiAxMF1cbiAgICBvdXRwdXQgKz0gbG9va3VwWyh0bXAgPj4gNCkgJiAweDNGXVxuICAgIG91dHB1dCArPSBsb29rdXBbKHRtcCA8PCAyKSAmIDB4M0ZdXG4gICAgb3V0cHV0ICs9ICc9J1xuICB9XG5cbiAgcGFydHMucHVzaChvdXRwdXQpXG5cbiAgcmV0dXJuIHBhcnRzLmpvaW4oJycpXG59XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYmFzZTY0LWpzL2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSA0OFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKiFcbiAqIFRoZSBidWZmZXIgbW9kdWxlIGZyb20gbm9kZS5qcywgZm9yIHRoZSBicm93c2VyLlxuICpcbiAqIEBhdXRob3IgICBGZXJvc3MgQWJvdWtoYWRpamVoIDxmZXJvc3NAZmVyb3NzLm9yZz4gPGh0dHA6Ly9mZXJvc3Mub3JnPlxuICogQGxpY2Vuc2UgIE1JVFxuICovXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1wcm90byAqL1xuXG4ndXNlIHN0cmljdCdcblxudmFyIGJhc2U2NCA9IHJlcXVpcmUoJ2Jhc2U2NC1qcycpXG52YXIgaWVlZTc1NCA9IHJlcXVpcmUoJ2llZWU3NTQnKVxudmFyIGlzQXJyYXkgPSByZXF1aXJlKCdpc2FycmF5JylcblxuZXhwb3J0cy5CdWZmZXIgPSBCdWZmZXJcbmV4cG9ydHMuU2xvd0J1ZmZlciA9IFNsb3dCdWZmZXJcbmV4cG9ydHMuSU5TUEVDVF9NQVhfQllURVMgPSA1MFxuXG4vKipcbiAqIElmIGBCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVGA6XG4gKiAgID09PSB0cnVlICAgIFVzZSBVaW50OEFycmF5IGltcGxlbWVudGF0aW9uIChmYXN0ZXN0KVxuICogICA9PT0gZmFsc2UgICBVc2UgT2JqZWN0IGltcGxlbWVudGF0aW9uIChtb3N0IGNvbXBhdGlibGUsIGV2ZW4gSUU2KVxuICpcbiAqIEJyb3dzZXJzIHRoYXQgc3VwcG9ydCB0eXBlZCBhcnJheXMgYXJlIElFIDEwKywgRmlyZWZveCA0KywgQ2hyb21lIDcrLCBTYWZhcmkgNS4xKyxcbiAqIE9wZXJhIDExLjYrLCBpT1MgNC4yKy5cbiAqXG4gKiBEdWUgdG8gdmFyaW91cyBicm93c2VyIGJ1Z3MsIHNvbWV0aW1lcyB0aGUgT2JqZWN0IGltcGxlbWVudGF0aW9uIHdpbGwgYmUgdXNlZCBldmVuXG4gKiB3aGVuIHRoZSBicm93c2VyIHN1cHBvcnRzIHR5cGVkIGFycmF5cy5cbiAqXG4gKiBOb3RlOlxuICpcbiAqICAgLSBGaXJlZm94IDQtMjkgbGFja3Mgc3VwcG9ydCBmb3IgYWRkaW5nIG5ldyBwcm9wZXJ0aWVzIHRvIGBVaW50OEFycmF5YCBpbnN0YW5jZXMsXG4gKiAgICAgU2VlOiBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD02OTU0MzguXG4gKlxuICogICAtIENocm9tZSA5LTEwIGlzIG1pc3NpbmcgdGhlIGBUeXBlZEFycmF5LnByb3RvdHlwZS5zdWJhcnJheWAgZnVuY3Rpb24uXG4gKlxuICogICAtIElFMTAgaGFzIGEgYnJva2VuIGBUeXBlZEFycmF5LnByb3RvdHlwZS5zdWJhcnJheWAgZnVuY3Rpb24gd2hpY2ggcmV0dXJucyBhcnJheXMgb2ZcbiAqICAgICBpbmNvcnJlY3QgbGVuZ3RoIGluIHNvbWUgc2l0dWF0aW9ucy5cblxuICogV2UgZGV0ZWN0IHRoZXNlIGJ1Z2d5IGJyb3dzZXJzIGFuZCBzZXQgYEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUYCB0byBgZmFsc2VgIHNvIHRoZXlcbiAqIGdldCB0aGUgT2JqZWN0IGltcGxlbWVudGF0aW9uLCB3aGljaCBpcyBzbG93ZXIgYnV0IGJlaGF2ZXMgY29ycmVjdGx5LlxuICovXG5CdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCA9IGdsb2JhbC5UWVBFRF9BUlJBWV9TVVBQT1JUICE9PSB1bmRlZmluZWRcbiAgPyBnbG9iYWwuVFlQRURfQVJSQVlfU1VQUE9SVFxuICA6IHR5cGVkQXJyYXlTdXBwb3J0KClcblxuLypcbiAqIEV4cG9ydCBrTWF4TGVuZ3RoIGFmdGVyIHR5cGVkIGFycmF5IHN1cHBvcnQgaXMgZGV0ZXJtaW5lZC5cbiAqL1xuZXhwb3J0cy5rTWF4TGVuZ3RoID0ga01heExlbmd0aCgpXG5cbmZ1bmN0aW9uIHR5cGVkQXJyYXlTdXBwb3J0ICgpIHtcbiAgdHJ5IHtcbiAgICB2YXIgYXJyID0gbmV3IFVpbnQ4QXJyYXkoMSlcbiAgICBhcnIuX19wcm90b19fID0ge19fcHJvdG9fXzogVWludDhBcnJheS5wcm90b3R5cGUsIGZvbzogZnVuY3Rpb24gKCkgeyByZXR1cm4gNDIgfX1cbiAgICByZXR1cm4gYXJyLmZvbygpID09PSA0MiAmJiAvLyB0eXBlZCBhcnJheSBpbnN0YW5jZXMgY2FuIGJlIGF1Z21lbnRlZFxuICAgICAgICB0eXBlb2YgYXJyLnN1YmFycmF5ID09PSAnZnVuY3Rpb24nICYmIC8vIGNocm9tZSA5LTEwIGxhY2sgYHN1YmFycmF5YFxuICAgICAgICBhcnIuc3ViYXJyYXkoMSwgMSkuYnl0ZUxlbmd0aCA9PT0gMCAvLyBpZTEwIGhhcyBicm9rZW4gYHN1YmFycmF5YFxuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbn1cblxuZnVuY3Rpb24ga01heExlbmd0aCAoKSB7XG4gIHJldHVybiBCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVFxuICAgID8gMHg3ZmZmZmZmZlxuICAgIDogMHgzZmZmZmZmZlxufVxuXG5mdW5jdGlvbiBjcmVhdGVCdWZmZXIgKHRoYXQsIGxlbmd0aCkge1xuICBpZiAoa01heExlbmd0aCgpIDwgbGVuZ3RoKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0ludmFsaWQgdHlwZWQgYXJyYXkgbGVuZ3RoJylcbiAgfVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICAvLyBSZXR1cm4gYW4gYXVnbWVudGVkIGBVaW50OEFycmF5YCBpbnN0YW5jZSwgZm9yIGJlc3QgcGVyZm9ybWFuY2VcbiAgICB0aGF0ID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoKVxuICAgIHRoYXQuX19wcm90b19fID0gQnVmZmVyLnByb3RvdHlwZVxuICB9IGVsc2Uge1xuICAgIC8vIEZhbGxiYWNrOiBSZXR1cm4gYW4gb2JqZWN0IGluc3RhbmNlIG9mIHRoZSBCdWZmZXIgY2xhc3NcbiAgICBpZiAodGhhdCA9PT0gbnVsbCkge1xuICAgICAgdGhhdCA9IG5ldyBCdWZmZXIobGVuZ3RoKVxuICAgIH1cbiAgICB0aGF0Lmxlbmd0aCA9IGxlbmd0aFxuICB9XG5cbiAgcmV0dXJuIHRoYXRcbn1cblxuLyoqXG4gKiBUaGUgQnVmZmVyIGNvbnN0cnVjdG9yIHJldHVybnMgaW5zdGFuY2VzIG9mIGBVaW50OEFycmF5YCB0aGF0IGhhdmUgdGhlaXJcbiAqIHByb3RvdHlwZSBjaGFuZ2VkIHRvIGBCdWZmZXIucHJvdG90eXBlYC4gRnVydGhlcm1vcmUsIGBCdWZmZXJgIGlzIGEgc3ViY2xhc3Mgb2ZcbiAqIGBVaW50OEFycmF5YCwgc28gdGhlIHJldHVybmVkIGluc3RhbmNlcyB3aWxsIGhhdmUgYWxsIHRoZSBub2RlIGBCdWZmZXJgIG1ldGhvZHNcbiAqIGFuZCB0aGUgYFVpbnQ4QXJyYXlgIG1ldGhvZHMuIFNxdWFyZSBicmFja2V0IG5vdGF0aW9uIHdvcmtzIGFzIGV4cGVjdGVkIC0tIGl0XG4gKiByZXR1cm5zIGEgc2luZ2xlIG9jdGV0LlxuICpcbiAqIFRoZSBgVWludDhBcnJheWAgcHJvdG90eXBlIHJlbWFpbnMgdW5tb2RpZmllZC5cbiAqL1xuXG5mdW5jdGlvbiBCdWZmZXIgKGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKSB7XG4gIGlmICghQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQgJiYgISh0aGlzIGluc3RhbmNlb2YgQnVmZmVyKSkge1xuICAgIHJldHVybiBuZXcgQnVmZmVyKGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKVxuICB9XG5cbiAgLy8gQ29tbW9uIGNhc2UuXG4gIGlmICh0eXBlb2YgYXJnID09PSAnbnVtYmVyJykge1xuICAgIGlmICh0eXBlb2YgZW5jb2RpbmdPck9mZnNldCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgJ0lmIGVuY29kaW5nIGlzIHNwZWNpZmllZCB0aGVuIHRoZSBmaXJzdCBhcmd1bWVudCBtdXN0IGJlIGEgc3RyaW5nJ1xuICAgICAgKVxuICAgIH1cbiAgICByZXR1cm4gYWxsb2NVbnNhZmUodGhpcywgYXJnKVxuICB9XG4gIHJldHVybiBmcm9tKHRoaXMsIGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKVxufVxuXG5CdWZmZXIucG9vbFNpemUgPSA4MTkyIC8vIG5vdCB1c2VkIGJ5IHRoaXMgaW1wbGVtZW50YXRpb25cblxuLy8gVE9ETzogTGVnYWN5LCBub3QgbmVlZGVkIGFueW1vcmUuIFJlbW92ZSBpbiBuZXh0IG1ham9yIHZlcnNpb24uXG5CdWZmZXIuX2F1Z21lbnQgPSBmdW5jdGlvbiAoYXJyKSB7XG4gIGFyci5fX3Byb3RvX18gPSBCdWZmZXIucHJvdG90eXBlXG4gIHJldHVybiBhcnJcbn1cblxuZnVuY3Rpb24gZnJvbSAodGhhdCwgdmFsdWUsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkge1xuICBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJykge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1widmFsdWVcIiBhcmd1bWVudCBtdXN0IG5vdCBiZSBhIG51bWJlcicpXG4gIH1cblxuICBpZiAodHlwZW9mIEFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJyAmJiB2YWx1ZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgcmV0dXJuIGZyb21BcnJheUJ1ZmZlcih0aGF0LCB2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKVxuICB9XG5cbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gZnJvbVN0cmluZyh0aGF0LCB2YWx1ZSwgZW5jb2RpbmdPck9mZnNldClcbiAgfVxuXG4gIHJldHVybiBmcm9tT2JqZWN0KHRoYXQsIHZhbHVlKVxufVxuXG4vKipcbiAqIEZ1bmN0aW9uYWxseSBlcXVpdmFsZW50IHRvIEJ1ZmZlcihhcmcsIGVuY29kaW5nKSBidXQgdGhyb3dzIGEgVHlwZUVycm9yXG4gKiBpZiB2YWx1ZSBpcyBhIG51bWJlci5cbiAqIEJ1ZmZlci5mcm9tKHN0clssIGVuY29kaW5nXSlcbiAqIEJ1ZmZlci5mcm9tKGFycmF5KVxuICogQnVmZmVyLmZyb20oYnVmZmVyKVxuICogQnVmZmVyLmZyb20oYXJyYXlCdWZmZXJbLCBieXRlT2Zmc2V0WywgbGVuZ3RoXV0pXG4gKiovXG5CdWZmZXIuZnJvbSA9IGZ1bmN0aW9uICh2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBmcm9tKG51bGwsIHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpXG59XG5cbmlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICBCdWZmZXIucHJvdG90eXBlLl9fcHJvdG9fXyA9IFVpbnQ4QXJyYXkucHJvdG90eXBlXG4gIEJ1ZmZlci5fX3Byb3RvX18gPSBVaW50OEFycmF5XG4gIGlmICh0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wuc3BlY2llcyAmJlxuICAgICAgQnVmZmVyW1N5bWJvbC5zcGVjaWVzXSA9PT0gQnVmZmVyKSB7XG4gICAgLy8gRml4IHN1YmFycmF5KCkgaW4gRVMyMDE2LiBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9mZXJvc3MvYnVmZmVyL3B1bGwvOTdcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQnVmZmVyLCBTeW1ib2wuc3BlY2llcywge1xuICAgICAgdmFsdWU6IG51bGwsXG4gICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KVxuICB9XG59XG5cbmZ1bmN0aW9uIGFzc2VydFNpemUgKHNpemUpIHtcbiAgaWYgKHR5cGVvZiBzaXplICE9PSAnbnVtYmVyJykge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wic2l6ZVwiIGFyZ3VtZW50IG11c3QgYmUgYSBudW1iZXInKVxuICB9IGVsc2UgaWYgKHNpemUgPCAwKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1wic2l6ZVwiIGFyZ3VtZW50IG11c3Qgbm90IGJlIG5lZ2F0aXZlJylcbiAgfVxufVxuXG5mdW5jdGlvbiBhbGxvYyAodGhhdCwgc2l6ZSwgZmlsbCwgZW5jb2RpbmcpIHtcbiAgYXNzZXJ0U2l6ZShzaXplKVxuICBpZiAoc2l6ZSA8PSAwKSB7XG4gICAgcmV0dXJuIGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplKVxuICB9XG4gIGlmIChmaWxsICE9PSB1bmRlZmluZWQpIHtcbiAgICAvLyBPbmx5IHBheSBhdHRlbnRpb24gdG8gZW5jb2RpbmcgaWYgaXQncyBhIHN0cmluZy4gVGhpc1xuICAgIC8vIHByZXZlbnRzIGFjY2lkZW50YWxseSBzZW5kaW5nIGluIGEgbnVtYmVyIHRoYXQgd291bGRcbiAgICAvLyBiZSBpbnRlcnByZXR0ZWQgYXMgYSBzdGFydCBvZmZzZXQuXG4gICAgcmV0dXJuIHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZydcbiAgICAgID8gY3JlYXRlQnVmZmVyKHRoYXQsIHNpemUpLmZpbGwoZmlsbCwgZW5jb2RpbmcpXG4gICAgICA6IGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplKS5maWxsKGZpbGwpXG4gIH1cbiAgcmV0dXJuIGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplKVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgZmlsbGVkIEJ1ZmZlciBpbnN0YW5jZS5cbiAqIGFsbG9jKHNpemVbLCBmaWxsWywgZW5jb2RpbmddXSlcbiAqKi9cbkJ1ZmZlci5hbGxvYyA9IGZ1bmN0aW9uIChzaXplLCBmaWxsLCBlbmNvZGluZykge1xuICByZXR1cm4gYWxsb2MobnVsbCwgc2l6ZSwgZmlsbCwgZW5jb2RpbmcpXG59XG5cbmZ1bmN0aW9uIGFsbG9jVW5zYWZlICh0aGF0LCBzaXplKSB7XG4gIGFzc2VydFNpemUoc2l6ZSlcbiAgdGhhdCA9IGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplIDwgMCA/IDAgOiBjaGVja2VkKHNpemUpIHwgMClcbiAgaWYgKCFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2l6ZTsgKytpKSB7XG4gICAgICB0aGF0W2ldID0gMFxuICAgIH1cbiAgfVxuICByZXR1cm4gdGhhdFxufVxuXG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gQnVmZmVyKG51bSksIGJ5IGRlZmF1bHQgY3JlYXRlcyBhIG5vbi16ZXJvLWZpbGxlZCBCdWZmZXIgaW5zdGFuY2UuXG4gKiAqL1xuQnVmZmVyLmFsbG9jVW5zYWZlID0gZnVuY3Rpb24gKHNpemUpIHtcbiAgcmV0dXJuIGFsbG9jVW5zYWZlKG51bGwsIHNpemUpXG59XG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gU2xvd0J1ZmZlcihudW0pLCBieSBkZWZhdWx0IGNyZWF0ZXMgYSBub24temVyby1maWxsZWQgQnVmZmVyIGluc3RhbmNlLlxuICovXG5CdWZmZXIuYWxsb2NVbnNhZmVTbG93ID0gZnVuY3Rpb24gKHNpemUpIHtcbiAgcmV0dXJuIGFsbG9jVW5zYWZlKG51bGwsIHNpemUpXG59XG5cbmZ1bmN0aW9uIGZyb21TdHJpbmcgKHRoYXQsIHN0cmluZywgZW5jb2RpbmcpIHtcbiAgaWYgKHR5cGVvZiBlbmNvZGluZyAhPT0gJ3N0cmluZycgfHwgZW5jb2RpbmcgPT09ICcnKSB7XG4gICAgZW5jb2RpbmcgPSAndXRmOCdcbiAgfVxuXG4gIGlmICghQnVmZmVyLmlzRW5jb2RpbmcoZW5jb2RpbmcpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJlbmNvZGluZ1wiIG11c3QgYmUgYSB2YWxpZCBzdHJpbmcgZW5jb2RpbmcnKVxuICB9XG5cbiAgdmFyIGxlbmd0aCA9IGJ5dGVMZW5ndGgoc3RyaW5nLCBlbmNvZGluZykgfCAwXG4gIHRoYXQgPSBjcmVhdGVCdWZmZXIodGhhdCwgbGVuZ3RoKVxuXG4gIHZhciBhY3R1YWwgPSB0aGF0LndyaXRlKHN0cmluZywgZW5jb2RpbmcpXG5cbiAgaWYgKGFjdHVhbCAhPT0gbGVuZ3RoKSB7XG4gICAgLy8gV3JpdGluZyBhIGhleCBzdHJpbmcsIGZvciBleGFtcGxlLCB0aGF0IGNvbnRhaW5zIGludmFsaWQgY2hhcmFjdGVycyB3aWxsXG4gICAgLy8gY2F1c2UgZXZlcnl0aGluZyBhZnRlciB0aGUgZmlyc3QgaW52YWxpZCBjaGFyYWN0ZXIgdG8gYmUgaWdub3JlZC4gKGUuZy5cbiAgICAvLyAnYWJ4eGNkJyB3aWxsIGJlIHRyZWF0ZWQgYXMgJ2FiJylcbiAgICB0aGF0ID0gdGhhdC5zbGljZSgwLCBhY3R1YWwpXG4gIH1cblxuICByZXR1cm4gdGhhdFxufVxuXG5mdW5jdGlvbiBmcm9tQXJyYXlMaWtlICh0aGF0LCBhcnJheSkge1xuICB2YXIgbGVuZ3RoID0gYXJyYXkubGVuZ3RoIDwgMCA/IDAgOiBjaGVja2VkKGFycmF5Lmxlbmd0aCkgfCAwXG4gIHRoYXQgPSBjcmVhdGVCdWZmZXIodGhhdCwgbGVuZ3RoKVxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSArPSAxKSB7XG4gICAgdGhhdFtpXSA9IGFycmF5W2ldICYgMjU1XG4gIH1cbiAgcmV0dXJuIHRoYXRcbn1cblxuZnVuY3Rpb24gZnJvbUFycmF5QnVmZmVyICh0aGF0LCBhcnJheSwgYnl0ZU9mZnNldCwgbGVuZ3RoKSB7XG4gIGFycmF5LmJ5dGVMZW5ndGggLy8gdGhpcyB0aHJvd3MgaWYgYGFycmF5YCBpcyBub3QgYSB2YWxpZCBBcnJheUJ1ZmZlclxuXG4gIGlmIChieXRlT2Zmc2V0IDwgMCB8fCBhcnJheS5ieXRlTGVuZ3RoIDwgYnl0ZU9mZnNldCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcXCdvZmZzZXRcXCcgaXMgb3V0IG9mIGJvdW5kcycpXG4gIH1cblxuICBpZiAoYXJyYXkuYnl0ZUxlbmd0aCA8IGJ5dGVPZmZzZXQgKyAobGVuZ3RoIHx8IDApKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1xcJ2xlbmd0aFxcJyBpcyBvdXQgb2YgYm91bmRzJylcbiAgfVxuXG4gIGlmIChieXRlT2Zmc2V0ID09PSB1bmRlZmluZWQgJiYgbGVuZ3RoID09PSB1bmRlZmluZWQpIHtcbiAgICBhcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5KVxuICB9IGVsc2UgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgYXJyYXkgPSBuZXcgVWludDhBcnJheShhcnJheSwgYnl0ZU9mZnNldClcbiAgfSBlbHNlIHtcbiAgICBhcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5LCBieXRlT2Zmc2V0LCBsZW5ndGgpXG4gIH1cblxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICAvLyBSZXR1cm4gYW4gYXVnbWVudGVkIGBVaW50OEFycmF5YCBpbnN0YW5jZSwgZm9yIGJlc3QgcGVyZm9ybWFuY2VcbiAgICB0aGF0ID0gYXJyYXlcbiAgICB0aGF0Ll9fcHJvdG9fXyA9IEJ1ZmZlci5wcm90b3R5cGVcbiAgfSBlbHNlIHtcbiAgICAvLyBGYWxsYmFjazogUmV0dXJuIGFuIG9iamVjdCBpbnN0YW5jZSBvZiB0aGUgQnVmZmVyIGNsYXNzXG4gICAgdGhhdCA9IGZyb21BcnJheUxpa2UodGhhdCwgYXJyYXkpXG4gIH1cbiAgcmV0dXJuIHRoYXRcbn1cblxuZnVuY3Rpb24gZnJvbU9iamVjdCAodGhhdCwgb2JqKSB7XG4gIGlmIChCdWZmZXIuaXNCdWZmZXIob2JqKSkge1xuICAgIHZhciBsZW4gPSBjaGVja2VkKG9iai5sZW5ndGgpIHwgMFxuICAgIHRoYXQgPSBjcmVhdGVCdWZmZXIodGhhdCwgbGVuKVxuXG4gICAgaWYgKHRoYXQubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gdGhhdFxuICAgIH1cblxuICAgIG9iai5jb3B5KHRoYXQsIDAsIDAsIGxlbilcbiAgICByZXR1cm4gdGhhdFxuICB9XG5cbiAgaWYgKG9iaikge1xuICAgIGlmICgodHlwZW9mIEFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAgICBvYmouYnVmZmVyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHx8ICdsZW5ndGgnIGluIG9iaikge1xuICAgICAgaWYgKHR5cGVvZiBvYmoubGVuZ3RoICE9PSAnbnVtYmVyJyB8fCBpc25hbihvYmoubGVuZ3RoKSkge1xuICAgICAgICByZXR1cm4gY3JlYXRlQnVmZmVyKHRoYXQsIDApXG4gICAgICB9XG4gICAgICByZXR1cm4gZnJvbUFycmF5TGlrZSh0aGF0LCBvYmopXG4gICAgfVxuXG4gICAgaWYgKG9iai50eXBlID09PSAnQnVmZmVyJyAmJiBpc0FycmF5KG9iai5kYXRhKSkge1xuICAgICAgcmV0dXJuIGZyb21BcnJheUxpa2UodGhhdCwgb2JqLmRhdGEpXG4gICAgfVxuICB9XG5cbiAgdGhyb3cgbmV3IFR5cGVFcnJvcignRmlyc3QgYXJndW1lbnQgbXVzdCBiZSBhIHN0cmluZywgQnVmZmVyLCBBcnJheUJ1ZmZlciwgQXJyYXksIG9yIGFycmF5LWxpa2Ugb2JqZWN0LicpXG59XG5cbmZ1bmN0aW9uIGNoZWNrZWQgKGxlbmd0aCkge1xuICAvLyBOb3RlOiBjYW5ub3QgdXNlIGBsZW5ndGggPCBrTWF4TGVuZ3RoKClgIGhlcmUgYmVjYXVzZSB0aGF0IGZhaWxzIHdoZW5cbiAgLy8gbGVuZ3RoIGlzIE5hTiAod2hpY2ggaXMgb3RoZXJ3aXNlIGNvZXJjZWQgdG8gemVyby4pXG4gIGlmIChsZW5ndGggPj0ga01heExlbmd0aCgpKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0F0dGVtcHQgdG8gYWxsb2NhdGUgQnVmZmVyIGxhcmdlciB0aGFuIG1heGltdW0gJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgJ3NpemU6IDB4JyArIGtNYXhMZW5ndGgoKS50b1N0cmluZygxNikgKyAnIGJ5dGVzJylcbiAgfVxuICByZXR1cm4gbGVuZ3RoIHwgMFxufVxuXG5mdW5jdGlvbiBTbG93QnVmZmVyIChsZW5ndGgpIHtcbiAgaWYgKCtsZW5ndGggIT0gbGVuZ3RoKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgZXFlcWVxXG4gICAgbGVuZ3RoID0gMFxuICB9XG4gIHJldHVybiBCdWZmZXIuYWxsb2MoK2xlbmd0aClcbn1cblxuQnVmZmVyLmlzQnVmZmVyID0gZnVuY3Rpb24gaXNCdWZmZXIgKGIpIHtcbiAgcmV0dXJuICEhKGIgIT0gbnVsbCAmJiBiLl9pc0J1ZmZlcilcbn1cblxuQnVmZmVyLmNvbXBhcmUgPSBmdW5jdGlvbiBjb21wYXJlIChhLCBiKSB7XG4gIGlmICghQnVmZmVyLmlzQnVmZmVyKGEpIHx8ICFCdWZmZXIuaXNCdWZmZXIoYikpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudHMgbXVzdCBiZSBCdWZmZXJzJylcbiAgfVxuXG4gIGlmIChhID09PSBiKSByZXR1cm4gMFxuXG4gIHZhciB4ID0gYS5sZW5ndGhcbiAgdmFyIHkgPSBiLmxlbmd0aFxuXG4gIGZvciAodmFyIGkgPSAwLCBsZW4gPSBNYXRoLm1pbih4LCB5KTsgaSA8IGxlbjsgKytpKSB7XG4gICAgaWYgKGFbaV0gIT09IGJbaV0pIHtcbiAgICAgIHggPSBhW2ldXG4gICAgICB5ID0gYltpXVxuICAgICAgYnJlYWtcbiAgICB9XG4gIH1cblxuICBpZiAoeCA8IHkpIHJldHVybiAtMVxuICBpZiAoeSA8IHgpIHJldHVybiAxXG4gIHJldHVybiAwXG59XG5cbkJ1ZmZlci5pc0VuY29kaW5nID0gZnVuY3Rpb24gaXNFbmNvZGluZyAoZW5jb2RpbmcpIHtcbiAgc3dpdGNoIChTdHJpbmcoZW5jb2RpbmcpLnRvTG93ZXJDYXNlKCkpIHtcbiAgICBjYXNlICdoZXgnOlxuICAgIGNhc2UgJ3V0ZjgnOlxuICAgIGNhc2UgJ3V0Zi04JzpcbiAgICBjYXNlICdhc2NpaSc6XG4gICAgY2FzZSAnbGF0aW4xJzpcbiAgICBjYXNlICdiaW5hcnknOlxuICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgY2FzZSAndWNzMic6XG4gICAgY2FzZSAndWNzLTInOlxuICAgIGNhc2UgJ3V0ZjE2bGUnOlxuICAgIGNhc2UgJ3V0Zi0xNmxlJzpcbiAgICAgIHJldHVybiB0cnVlXG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBmYWxzZVxuICB9XG59XG5cbkJ1ZmZlci5jb25jYXQgPSBmdW5jdGlvbiBjb25jYXQgKGxpc3QsIGxlbmd0aCkge1xuICBpZiAoIWlzQXJyYXkobGlzdCkpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcImxpc3RcIiBhcmd1bWVudCBtdXN0IGJlIGFuIEFycmF5IG9mIEJ1ZmZlcnMnKVxuICB9XG5cbiAgaWYgKGxpc3QubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIEJ1ZmZlci5hbGxvYygwKVxuICB9XG5cbiAgdmFyIGlcbiAgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgbGVuZ3RoID0gMFxuICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgKytpKSB7XG4gICAgICBsZW5ndGggKz0gbGlzdFtpXS5sZW5ndGhcbiAgICB9XG4gIH1cblxuICB2YXIgYnVmZmVyID0gQnVmZmVyLmFsbG9jVW5zYWZlKGxlbmd0aClcbiAgdmFyIHBvcyA9IDBcbiAgZm9yIChpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyArK2kpIHtcbiAgICB2YXIgYnVmID0gbGlzdFtpXVxuICAgIGlmICghQnVmZmVyLmlzQnVmZmVyKGJ1ZikpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wibGlzdFwiIGFyZ3VtZW50IG11c3QgYmUgYW4gQXJyYXkgb2YgQnVmZmVycycpXG4gICAgfVxuICAgIGJ1Zi5jb3B5KGJ1ZmZlciwgcG9zKVxuICAgIHBvcyArPSBidWYubGVuZ3RoXG4gIH1cbiAgcmV0dXJuIGJ1ZmZlclxufVxuXG5mdW5jdGlvbiBieXRlTGVuZ3RoIChzdHJpbmcsIGVuY29kaW5nKSB7XG4gIGlmIChCdWZmZXIuaXNCdWZmZXIoc3RyaW5nKSkge1xuICAgIHJldHVybiBzdHJpbmcubGVuZ3RoXG4gIH1cbiAgaWYgKHR5cGVvZiBBcnJheUJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIEFycmF5QnVmZmVyLmlzVmlldyA9PT0gJ2Z1bmN0aW9uJyAmJlxuICAgICAgKEFycmF5QnVmZmVyLmlzVmlldyhzdHJpbmcpIHx8IHN0cmluZyBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSkge1xuICAgIHJldHVybiBzdHJpbmcuYnl0ZUxlbmd0aFxuICB9XG4gIGlmICh0eXBlb2Ygc3RyaW5nICE9PSAnc3RyaW5nJykge1xuICAgIHN0cmluZyA9ICcnICsgc3RyaW5nXG4gIH1cblxuICB2YXIgbGVuID0gc3RyaW5nLmxlbmd0aFxuICBpZiAobGVuID09PSAwKSByZXR1cm4gMFxuXG4gIC8vIFVzZSBhIGZvciBsb29wIHRvIGF2b2lkIHJlY3Vyc2lvblxuICB2YXIgbG93ZXJlZENhc2UgPSBmYWxzZVxuICBmb3IgKDs7KSB7XG4gICAgc3dpdGNoIChlbmNvZGluZykge1xuICAgICAgY2FzZSAnYXNjaWknOlxuICAgICAgY2FzZSAnbGF0aW4xJzpcbiAgICAgIGNhc2UgJ2JpbmFyeSc6XG4gICAgICAgIHJldHVybiBsZW5cbiAgICAgIGNhc2UgJ3V0ZjgnOlxuICAgICAgY2FzZSAndXRmLTgnOlxuICAgICAgY2FzZSB1bmRlZmluZWQ6XG4gICAgICAgIHJldHVybiB1dGY4VG9CeXRlcyhzdHJpbmcpLmxlbmd0aFxuICAgICAgY2FzZSAndWNzMic6XG4gICAgICBjYXNlICd1Y3MtMic6XG4gICAgICBjYXNlICd1dGYxNmxlJzpcbiAgICAgIGNhc2UgJ3V0Zi0xNmxlJzpcbiAgICAgICAgcmV0dXJuIGxlbiAqIDJcbiAgICAgIGNhc2UgJ2hleCc6XG4gICAgICAgIHJldHVybiBsZW4gPj4+IDFcbiAgICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgICAgIHJldHVybiBiYXNlNjRUb0J5dGVzKHN0cmluZykubGVuZ3RoXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBpZiAobG93ZXJlZENhc2UpIHJldHVybiB1dGY4VG9CeXRlcyhzdHJpbmcpLmxlbmd0aCAvLyBhc3N1bWUgdXRmOFxuICAgICAgICBlbmNvZGluZyA9ICgnJyArIGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpXG4gICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZVxuICAgIH1cbiAgfVxufVxuQnVmZmVyLmJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoXG5cbmZ1bmN0aW9uIHNsb3dUb1N0cmluZyAoZW5jb2RpbmcsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIGxvd2VyZWRDYXNlID0gZmFsc2VcblxuICAvLyBObyBuZWVkIHRvIHZlcmlmeSB0aGF0IFwidGhpcy5sZW5ndGggPD0gTUFYX1VJTlQzMlwiIHNpbmNlIGl0J3MgYSByZWFkLW9ubHlcbiAgLy8gcHJvcGVydHkgb2YgYSB0eXBlZCBhcnJheS5cblxuICAvLyBUaGlzIGJlaGF2ZXMgbmVpdGhlciBsaWtlIFN0cmluZyBub3IgVWludDhBcnJheSBpbiB0aGF0IHdlIHNldCBzdGFydC9lbmRcbiAgLy8gdG8gdGhlaXIgdXBwZXIvbG93ZXIgYm91bmRzIGlmIHRoZSB2YWx1ZSBwYXNzZWQgaXMgb3V0IG9mIHJhbmdlLlxuICAvLyB1bmRlZmluZWQgaXMgaGFuZGxlZCBzcGVjaWFsbHkgYXMgcGVyIEVDTUEtMjYyIDZ0aCBFZGl0aW9uLFxuICAvLyBTZWN0aW9uIDEzLjMuMy43IFJ1bnRpbWUgU2VtYW50aWNzOiBLZXllZEJpbmRpbmdJbml0aWFsaXphdGlvbi5cbiAgaWYgKHN0YXJ0ID09PSB1bmRlZmluZWQgfHwgc3RhcnQgPCAwKSB7XG4gICAgc3RhcnQgPSAwXG4gIH1cbiAgLy8gUmV0dXJuIGVhcmx5IGlmIHN0YXJ0ID4gdGhpcy5sZW5ndGguIERvbmUgaGVyZSB0byBwcmV2ZW50IHBvdGVudGlhbCB1aW50MzJcbiAgLy8gY29lcmNpb24gZmFpbCBiZWxvdy5cbiAgaWYgKHN0YXJ0ID4gdGhpcy5sZW5ndGgpIHtcbiAgICByZXR1cm4gJydcbiAgfVxuXG4gIGlmIChlbmQgPT09IHVuZGVmaW5lZCB8fCBlbmQgPiB0aGlzLmxlbmd0aCkge1xuICAgIGVuZCA9IHRoaXMubGVuZ3RoXG4gIH1cblxuICBpZiAoZW5kIDw9IDApIHtcbiAgICByZXR1cm4gJydcbiAgfVxuXG4gIC8vIEZvcmNlIGNvZXJzaW9uIHRvIHVpbnQzMi4gVGhpcyB3aWxsIGFsc28gY29lcmNlIGZhbHNleS9OYU4gdmFsdWVzIHRvIDAuXG4gIGVuZCA+Pj49IDBcbiAgc3RhcnQgPj4+PSAwXG5cbiAgaWYgKGVuZCA8PSBzdGFydCkge1xuICAgIHJldHVybiAnJ1xuICB9XG5cbiAgaWYgKCFlbmNvZGluZykgZW5jb2RpbmcgPSAndXRmOCdcblxuICB3aGlsZSAodHJ1ZSkge1xuICAgIHN3aXRjaCAoZW5jb2RpbmcpIHtcbiAgICAgIGNhc2UgJ2hleCc6XG4gICAgICAgIHJldHVybiBoZXhTbGljZSh0aGlzLCBzdGFydCwgZW5kKVxuXG4gICAgICBjYXNlICd1dGY4JzpcbiAgICAgIGNhc2UgJ3V0Zi04JzpcbiAgICAgICAgcmV0dXJuIHV0ZjhTbGljZSh0aGlzLCBzdGFydCwgZW5kKVxuXG4gICAgICBjYXNlICdhc2NpaSc6XG4gICAgICAgIHJldHVybiBhc2NpaVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ2xhdGluMSc6XG4gICAgICBjYXNlICdiaW5hcnknOlxuICAgICAgICByZXR1cm4gbGF0aW4xU2xpY2UodGhpcywgc3RhcnQsIGVuZClcblxuICAgICAgY2FzZSAnYmFzZTY0JzpcbiAgICAgICAgcmV0dXJuIGJhc2U2NFNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ3VjczInOlxuICAgICAgY2FzZSAndWNzLTInOlxuICAgICAgY2FzZSAndXRmMTZsZSc6XG4gICAgICBjYXNlICd1dGYtMTZsZSc6XG4gICAgICAgIHJldHVybiB1dGYxNmxlU2xpY2UodGhpcywgc3RhcnQsIGVuZClcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgaWYgKGxvd2VyZWRDYXNlKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdVbmtub3duIGVuY29kaW5nOiAnICsgZW5jb2RpbmcpXG4gICAgICAgIGVuY29kaW5nID0gKGVuY29kaW5nICsgJycpLnRvTG93ZXJDYXNlKClcbiAgICAgICAgbG93ZXJlZENhc2UgPSB0cnVlXG4gICAgfVxuICB9XG59XG5cbi8vIFRoZSBwcm9wZXJ0eSBpcyB1c2VkIGJ5IGBCdWZmZXIuaXNCdWZmZXJgIGFuZCBgaXMtYnVmZmVyYCAoaW4gU2FmYXJpIDUtNykgdG8gZGV0ZWN0XG4vLyBCdWZmZXIgaW5zdGFuY2VzLlxuQnVmZmVyLnByb3RvdHlwZS5faXNCdWZmZXIgPSB0cnVlXG5cbmZ1bmN0aW9uIHN3YXAgKGIsIG4sIG0pIHtcbiAgdmFyIGkgPSBiW25dXG4gIGJbbl0gPSBiW21dXG4gIGJbbV0gPSBpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuc3dhcDE2ID0gZnVuY3Rpb24gc3dhcDE2ICgpIHtcbiAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoXG4gIGlmIChsZW4gJSAyICE9PSAwKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0J1ZmZlciBzaXplIG11c3QgYmUgYSBtdWx0aXBsZSBvZiAxNi1iaXRzJylcbiAgfVxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSArPSAyKSB7XG4gICAgc3dhcCh0aGlzLCBpLCBpICsgMSlcbiAgfVxuICByZXR1cm4gdGhpc1xufVxuXG5CdWZmZXIucHJvdG90eXBlLnN3YXAzMiA9IGZ1bmN0aW9uIHN3YXAzMiAoKSB7XG4gIHZhciBsZW4gPSB0aGlzLmxlbmd0aFxuICBpZiAobGVuICUgNCAhPT0gMCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgMzItYml0cycpXG4gIH1cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gNCkge1xuICAgIHN3YXAodGhpcywgaSwgaSArIDMpXG4gICAgc3dhcCh0aGlzLCBpICsgMSwgaSArIDIpXG4gIH1cbiAgcmV0dXJuIHRoaXNcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5zd2FwNjQgPSBmdW5jdGlvbiBzd2FwNjQgKCkge1xuICB2YXIgbGVuID0gdGhpcy5sZW5ndGhcbiAgaWYgKGxlbiAlIDggIT09IDApIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignQnVmZmVyIHNpemUgbXVzdCBiZSBhIG11bHRpcGxlIG9mIDY0LWJpdHMnKVxuICB9XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpICs9IDgpIHtcbiAgICBzd2FwKHRoaXMsIGksIGkgKyA3KVxuICAgIHN3YXAodGhpcywgaSArIDEsIGkgKyA2KVxuICAgIHN3YXAodGhpcywgaSArIDIsIGkgKyA1KVxuICAgIHN3YXAodGhpcywgaSArIDMsIGkgKyA0KVxuICB9XG4gIHJldHVybiB0aGlzXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZyAoKSB7XG4gIHZhciBsZW5ndGggPSB0aGlzLmxlbmd0aCB8IDBcbiAgaWYgKGxlbmd0aCA9PT0gMCkgcmV0dXJuICcnXG4gIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSByZXR1cm4gdXRmOFNsaWNlKHRoaXMsIDAsIGxlbmd0aClcbiAgcmV0dXJuIHNsb3dUb1N0cmluZy5hcHBseSh0aGlzLCBhcmd1bWVudHMpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gZXF1YWxzIChiKSB7XG4gIGlmICghQnVmZmVyLmlzQnVmZmVyKGIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudCBtdXN0IGJlIGEgQnVmZmVyJylcbiAgaWYgKHRoaXMgPT09IGIpIHJldHVybiB0cnVlXG4gIHJldHVybiBCdWZmZXIuY29tcGFyZSh0aGlzLCBiKSA9PT0gMFxufVxuXG5CdWZmZXIucHJvdG90eXBlLmluc3BlY3QgPSBmdW5jdGlvbiBpbnNwZWN0ICgpIHtcbiAgdmFyIHN0ciA9ICcnXG4gIHZhciBtYXggPSBleHBvcnRzLklOU1BFQ1RfTUFYX0JZVEVTXG4gIGlmICh0aGlzLmxlbmd0aCA+IDApIHtcbiAgICBzdHIgPSB0aGlzLnRvU3RyaW5nKCdoZXgnLCAwLCBtYXgpLm1hdGNoKC8uezJ9L2cpLmpvaW4oJyAnKVxuICAgIGlmICh0aGlzLmxlbmd0aCA+IG1heCkgc3RyICs9ICcgLi4uICdcbiAgfVxuICByZXR1cm4gJzxCdWZmZXIgJyArIHN0ciArICc+J1xufVxuXG5CdWZmZXIucHJvdG90eXBlLmNvbXBhcmUgPSBmdW5jdGlvbiBjb21wYXJlICh0YXJnZXQsIHN0YXJ0LCBlbmQsIHRoaXNTdGFydCwgdGhpc0VuZCkge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcih0YXJnZXQpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlcicpXG4gIH1cblxuICBpZiAoc3RhcnQgPT09IHVuZGVmaW5lZCkge1xuICAgIHN0YXJ0ID0gMFxuICB9XG4gIGlmIChlbmQgPT09IHVuZGVmaW5lZCkge1xuICAgIGVuZCA9IHRhcmdldCA/IHRhcmdldC5sZW5ndGggOiAwXG4gIH1cbiAgaWYgKHRoaXNTdGFydCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdGhpc1N0YXJ0ID0gMFxuICB9XG4gIGlmICh0aGlzRW5kID09PSB1bmRlZmluZWQpIHtcbiAgICB0aGlzRW5kID0gdGhpcy5sZW5ndGhcbiAgfVxuXG4gIGlmIChzdGFydCA8IDAgfHwgZW5kID4gdGFyZ2V0Lmxlbmd0aCB8fCB0aGlzU3RhcnQgPCAwIHx8IHRoaXNFbmQgPiB0aGlzLmxlbmd0aCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdvdXQgb2YgcmFuZ2UgaW5kZXgnKVxuICB9XG5cbiAgaWYgKHRoaXNTdGFydCA+PSB0aGlzRW5kICYmIHN0YXJ0ID49IGVuZCkge1xuICAgIHJldHVybiAwXG4gIH1cbiAgaWYgKHRoaXNTdGFydCA+PSB0aGlzRW5kKSB7XG4gICAgcmV0dXJuIC0xXG4gIH1cbiAgaWYgKHN0YXJ0ID49IGVuZCkge1xuICAgIHJldHVybiAxXG4gIH1cblxuICBzdGFydCA+Pj49IDBcbiAgZW5kID4+Pj0gMFxuICB0aGlzU3RhcnQgPj4+PSAwXG4gIHRoaXNFbmQgPj4+PSAwXG5cbiAgaWYgKHRoaXMgPT09IHRhcmdldCkgcmV0dXJuIDBcblxuICB2YXIgeCA9IHRoaXNFbmQgLSB0aGlzU3RhcnRcbiAgdmFyIHkgPSBlbmQgLSBzdGFydFxuICB2YXIgbGVuID0gTWF0aC5taW4oeCwgeSlcblxuICB2YXIgdGhpc0NvcHkgPSB0aGlzLnNsaWNlKHRoaXNTdGFydCwgdGhpc0VuZClcbiAgdmFyIHRhcmdldENvcHkgPSB0YXJnZXQuc2xpY2Uoc3RhcnQsIGVuZClcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgaWYgKHRoaXNDb3B5W2ldICE9PSB0YXJnZXRDb3B5W2ldKSB7XG4gICAgICB4ID0gdGhpc0NvcHlbaV1cbiAgICAgIHkgPSB0YXJnZXRDb3B5W2ldXG4gICAgICBicmVha1xuICAgIH1cbiAgfVxuXG4gIGlmICh4IDwgeSkgcmV0dXJuIC0xXG4gIGlmICh5IDwgeCkgcmV0dXJuIDFcbiAgcmV0dXJuIDBcbn1cblxuLy8gRmluZHMgZWl0aGVyIHRoZSBmaXJzdCBpbmRleCBvZiBgdmFsYCBpbiBgYnVmZmVyYCBhdCBvZmZzZXQgPj0gYGJ5dGVPZmZzZXRgLFxuLy8gT1IgdGhlIGxhc3QgaW5kZXggb2YgYHZhbGAgaW4gYGJ1ZmZlcmAgYXQgb2Zmc2V0IDw9IGBieXRlT2Zmc2V0YC5cbi8vXG4vLyBBcmd1bWVudHM6XG4vLyAtIGJ1ZmZlciAtIGEgQnVmZmVyIHRvIHNlYXJjaFxuLy8gLSB2YWwgLSBhIHN0cmluZywgQnVmZmVyLCBvciBudW1iZXJcbi8vIC0gYnl0ZU9mZnNldCAtIGFuIGluZGV4IGludG8gYGJ1ZmZlcmA7IHdpbGwgYmUgY2xhbXBlZCB0byBhbiBpbnQzMlxuLy8gLSBlbmNvZGluZyAtIGFuIG9wdGlvbmFsIGVuY29kaW5nLCByZWxldmFudCBpcyB2YWwgaXMgYSBzdHJpbmdcbi8vIC0gZGlyIC0gdHJ1ZSBmb3IgaW5kZXhPZiwgZmFsc2UgZm9yIGxhc3RJbmRleE9mXG5mdW5jdGlvbiBiaWRpcmVjdGlvbmFsSW5kZXhPZiAoYnVmZmVyLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBkaXIpIHtcbiAgLy8gRW1wdHkgYnVmZmVyIG1lYW5zIG5vIG1hdGNoXG4gIGlmIChidWZmZXIubGVuZ3RoID09PSAwKSByZXR1cm4gLTFcblxuICAvLyBOb3JtYWxpemUgYnl0ZU9mZnNldFxuICBpZiAodHlwZW9mIGJ5dGVPZmZzZXQgPT09ICdzdHJpbmcnKSB7XG4gICAgZW5jb2RpbmcgPSBieXRlT2Zmc2V0XG4gICAgYnl0ZU9mZnNldCA9IDBcbiAgfSBlbHNlIGlmIChieXRlT2Zmc2V0ID4gMHg3ZmZmZmZmZikge1xuICAgIGJ5dGVPZmZzZXQgPSAweDdmZmZmZmZmXG4gIH0gZWxzZSBpZiAoYnl0ZU9mZnNldCA8IC0weDgwMDAwMDAwKSB7XG4gICAgYnl0ZU9mZnNldCA9IC0weDgwMDAwMDAwXG4gIH1cbiAgYnl0ZU9mZnNldCA9ICtieXRlT2Zmc2V0ICAvLyBDb2VyY2UgdG8gTnVtYmVyLlxuICBpZiAoaXNOYU4oYnl0ZU9mZnNldCkpIHtcbiAgICAvLyBieXRlT2Zmc2V0OiBpdCBpdCdzIHVuZGVmaW5lZCwgbnVsbCwgTmFOLCBcImZvb1wiLCBldGMsIHNlYXJjaCB3aG9sZSBidWZmZXJcbiAgICBieXRlT2Zmc2V0ID0gZGlyID8gMCA6IChidWZmZXIubGVuZ3RoIC0gMSlcbiAgfVxuXG4gIC8vIE5vcm1hbGl6ZSBieXRlT2Zmc2V0OiBuZWdhdGl2ZSBvZmZzZXRzIHN0YXJ0IGZyb20gdGhlIGVuZCBvZiB0aGUgYnVmZmVyXG4gIGlmIChieXRlT2Zmc2V0IDwgMCkgYnl0ZU9mZnNldCA9IGJ1ZmZlci5sZW5ndGggKyBieXRlT2Zmc2V0XG4gIGlmIChieXRlT2Zmc2V0ID49IGJ1ZmZlci5sZW5ndGgpIHtcbiAgICBpZiAoZGlyKSByZXR1cm4gLTFcbiAgICBlbHNlIGJ5dGVPZmZzZXQgPSBidWZmZXIubGVuZ3RoIC0gMVxuICB9IGVsc2UgaWYgKGJ5dGVPZmZzZXQgPCAwKSB7XG4gICAgaWYgKGRpcikgYnl0ZU9mZnNldCA9IDBcbiAgICBlbHNlIHJldHVybiAtMVxuICB9XG5cbiAgLy8gTm9ybWFsaXplIHZhbFxuICBpZiAodHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHtcbiAgICB2YWwgPSBCdWZmZXIuZnJvbSh2YWwsIGVuY29kaW5nKVxuICB9XG5cbiAgLy8gRmluYWxseSwgc2VhcmNoIGVpdGhlciBpbmRleE9mIChpZiBkaXIgaXMgdHJ1ZSkgb3IgbGFzdEluZGV4T2ZcbiAgaWYgKEJ1ZmZlci5pc0J1ZmZlcih2YWwpKSB7XG4gICAgLy8gU3BlY2lhbCBjYXNlOiBsb29raW5nIGZvciBlbXB0eSBzdHJpbmcvYnVmZmVyIGFsd2F5cyBmYWlsc1xuICAgIGlmICh2YWwubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gLTFcbiAgICB9XG4gICAgcmV0dXJuIGFycmF5SW5kZXhPZihidWZmZXIsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcilcbiAgfSBlbHNlIGlmICh0eXBlb2YgdmFsID09PSAnbnVtYmVyJykge1xuICAgIHZhbCA9IHZhbCAmIDB4RkYgLy8gU2VhcmNoIGZvciBhIGJ5dGUgdmFsdWUgWzAtMjU1XVxuICAgIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCAmJlxuICAgICAgICB0eXBlb2YgVWludDhBcnJheS5wcm90b3R5cGUuaW5kZXhPZiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgaWYgKGRpcikge1xuICAgICAgICByZXR1cm4gVWludDhBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGJ1ZmZlciwgdmFsLCBieXRlT2Zmc2V0KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIFVpbnQ4QXJyYXkucHJvdG90eXBlLmxhc3RJbmRleE9mLmNhbGwoYnVmZmVyLCB2YWwsIGJ5dGVPZmZzZXQpXG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBhcnJheUluZGV4T2YoYnVmZmVyLCBbIHZhbCBdLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZGlyKVxuICB9XG5cbiAgdGhyb3cgbmV3IFR5cGVFcnJvcigndmFsIG11c3QgYmUgc3RyaW5nLCBudW1iZXIgb3IgQnVmZmVyJylcbn1cblxuZnVuY3Rpb24gYXJyYXlJbmRleE9mIChhcnIsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcikge1xuICB2YXIgaW5kZXhTaXplID0gMVxuICB2YXIgYXJyTGVuZ3RoID0gYXJyLmxlbmd0aFxuICB2YXIgdmFsTGVuZ3RoID0gdmFsLmxlbmd0aFxuXG4gIGlmIChlbmNvZGluZyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgZW5jb2RpbmcgPSBTdHJpbmcoZW5jb2RpbmcpLnRvTG93ZXJDYXNlKClcbiAgICBpZiAoZW5jb2RpbmcgPT09ICd1Y3MyJyB8fCBlbmNvZGluZyA9PT0gJ3Vjcy0yJyB8fFxuICAgICAgICBlbmNvZGluZyA9PT0gJ3V0ZjE2bGUnIHx8IGVuY29kaW5nID09PSAndXRmLTE2bGUnKSB7XG4gICAgICBpZiAoYXJyLmxlbmd0aCA8IDIgfHwgdmFsLmxlbmd0aCA8IDIpIHtcbiAgICAgICAgcmV0dXJuIC0xXG4gICAgICB9XG4gICAgICBpbmRleFNpemUgPSAyXG4gICAgICBhcnJMZW5ndGggLz0gMlxuICAgICAgdmFsTGVuZ3RoIC89IDJcbiAgICAgIGJ5dGVPZmZzZXQgLz0gMlxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHJlYWQgKGJ1ZiwgaSkge1xuICAgIGlmIChpbmRleFNpemUgPT09IDEpIHtcbiAgICAgIHJldHVybiBidWZbaV1cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGJ1Zi5yZWFkVUludDE2QkUoaSAqIGluZGV4U2l6ZSlcbiAgICB9XG4gIH1cblxuICB2YXIgaVxuICBpZiAoZGlyKSB7XG4gICAgdmFyIGZvdW5kSW5kZXggPSAtMVxuICAgIGZvciAoaSA9IGJ5dGVPZmZzZXQ7IGkgPCBhcnJMZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHJlYWQoYXJyLCBpKSA9PT0gcmVhZCh2YWwsIGZvdW5kSW5kZXggPT09IC0xID8gMCA6IGkgLSBmb3VuZEluZGV4KSkge1xuICAgICAgICBpZiAoZm91bmRJbmRleCA9PT0gLTEpIGZvdW5kSW5kZXggPSBpXG4gICAgICAgIGlmIChpIC0gZm91bmRJbmRleCArIDEgPT09IHZhbExlbmd0aCkgcmV0dXJuIGZvdW5kSW5kZXggKiBpbmRleFNpemVcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChmb3VuZEluZGV4ICE9PSAtMSkgaSAtPSBpIC0gZm91bmRJbmRleFxuICAgICAgICBmb3VuZEluZGV4ID0gLTFcbiAgICAgIH1cbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgaWYgKGJ5dGVPZmZzZXQgKyB2YWxMZW5ndGggPiBhcnJMZW5ndGgpIGJ5dGVPZmZzZXQgPSBhcnJMZW5ndGggLSB2YWxMZW5ndGhcbiAgICBmb3IgKGkgPSBieXRlT2Zmc2V0OyBpID49IDA7IGktLSkge1xuICAgICAgdmFyIGZvdW5kID0gdHJ1ZVxuICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB2YWxMZW5ndGg7IGorKykge1xuICAgICAgICBpZiAocmVhZChhcnIsIGkgKyBqKSAhPT0gcmVhZCh2YWwsIGopKSB7XG4gICAgICAgICAgZm91bmQgPSBmYWxzZVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChmb3VuZCkgcmV0dXJuIGlcbiAgICB9XG4gIH1cblxuICByZXR1cm4gLTFcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5pbmNsdWRlcyA9IGZ1bmN0aW9uIGluY2x1ZGVzICh2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nKSB7XG4gIHJldHVybiB0aGlzLmluZGV4T2YodmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZykgIT09IC0xXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuaW5kZXhPZiA9IGZ1bmN0aW9uIGluZGV4T2YgKHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcpIHtcbiAgcmV0dXJuIGJpZGlyZWN0aW9uYWxJbmRleE9mKHRoaXMsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIHRydWUpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUubGFzdEluZGV4T2YgPSBmdW5jdGlvbiBsYXN0SW5kZXhPZiAodmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZykge1xuICByZXR1cm4gYmlkaXJlY3Rpb25hbEluZGV4T2YodGhpcywgdmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZmFsc2UpXG59XG5cbmZ1bmN0aW9uIGhleFdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgb2Zmc2V0ID0gTnVtYmVyKG9mZnNldCkgfHwgMFxuICB2YXIgcmVtYWluaW5nID0gYnVmLmxlbmd0aCAtIG9mZnNldFxuICBpZiAoIWxlbmd0aCkge1xuICAgIGxlbmd0aCA9IHJlbWFpbmluZ1xuICB9IGVsc2Uge1xuICAgIGxlbmd0aCA9IE51bWJlcihsZW5ndGgpXG4gICAgaWYgKGxlbmd0aCA+IHJlbWFpbmluZykge1xuICAgICAgbGVuZ3RoID0gcmVtYWluaW5nXG4gICAgfVxuICB9XG5cbiAgLy8gbXVzdCBiZSBhbiBldmVuIG51bWJlciBvZiBkaWdpdHNcbiAgdmFyIHN0ckxlbiA9IHN0cmluZy5sZW5ndGhcbiAgaWYgKHN0ckxlbiAlIDIgIT09IDApIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgaGV4IHN0cmluZycpXG5cbiAgaWYgKGxlbmd0aCA+IHN0ckxlbiAvIDIpIHtcbiAgICBsZW5ndGggPSBzdHJMZW4gLyAyXG4gIH1cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIHZhciBwYXJzZWQgPSBwYXJzZUludChzdHJpbmcuc3Vic3RyKGkgKiAyLCAyKSwgMTYpXG4gICAgaWYgKGlzTmFOKHBhcnNlZCkpIHJldHVybiBpXG4gICAgYnVmW29mZnNldCArIGldID0gcGFyc2VkXG4gIH1cbiAgcmV0dXJuIGlcbn1cblxuZnVuY3Rpb24gdXRmOFdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgcmV0dXJuIGJsaXRCdWZmZXIodXRmOFRvQnl0ZXMoc3RyaW5nLCBidWYubGVuZ3RoIC0gb2Zmc2V0KSwgYnVmLCBvZmZzZXQsIGxlbmd0aClcbn1cblxuZnVuY3Rpb24gYXNjaWlXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBibGl0QnVmZmVyKGFzY2lpVG9CeXRlcyhzdHJpbmcpLCBidWYsIG9mZnNldCwgbGVuZ3RoKVxufVxuXG5mdW5jdGlvbiBsYXRpbjFXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBhc2NpaVdyaXRlKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcbn1cblxuZnVuY3Rpb24gYmFzZTY0V3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkge1xuICByZXR1cm4gYmxpdEJ1ZmZlcihiYXNlNjRUb0J5dGVzKHN0cmluZyksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpXG59XG5cbmZ1bmN0aW9uIHVjczJXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBibGl0QnVmZmVyKHV0ZjE2bGVUb0J5dGVzKHN0cmluZywgYnVmLmxlbmd0aCAtIG9mZnNldCksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGUgPSBmdW5jdGlvbiB3cml0ZSAoc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCwgZW5jb2RpbmcpIHtcbiAgLy8gQnVmZmVyI3dyaXRlKHN0cmluZylcbiAgaWYgKG9mZnNldCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgZW5jb2RpbmcgPSAndXRmOCdcbiAgICBsZW5ndGggPSB0aGlzLmxlbmd0aFxuICAgIG9mZnNldCA9IDBcbiAgLy8gQnVmZmVyI3dyaXRlKHN0cmluZywgZW5jb2RpbmcpXG4gIH0gZWxzZSBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQgJiYgdHlwZW9mIG9mZnNldCA9PT0gJ3N0cmluZycpIHtcbiAgICBlbmNvZGluZyA9IG9mZnNldFxuICAgIGxlbmd0aCA9IHRoaXMubGVuZ3RoXG4gICAgb2Zmc2V0ID0gMFxuICAvLyBCdWZmZXIjd3JpdGUoc3RyaW5nLCBvZmZzZXRbLCBsZW5ndGhdWywgZW5jb2RpbmddKVxuICB9IGVsc2UgaWYgKGlzRmluaXRlKG9mZnNldCkpIHtcbiAgICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gICAgaWYgKGlzRmluaXRlKGxlbmd0aCkpIHtcbiAgICAgIGxlbmd0aCA9IGxlbmd0aCB8IDBcbiAgICAgIGlmIChlbmNvZGluZyA9PT0gdW5kZWZpbmVkKSBlbmNvZGluZyA9ICd1dGY4J1xuICAgIH0gZWxzZSB7XG4gICAgICBlbmNvZGluZyA9IGxlbmd0aFxuICAgICAgbGVuZ3RoID0gdW5kZWZpbmVkXG4gICAgfVxuICAvLyBsZWdhY3kgd3JpdGUoc3RyaW5nLCBlbmNvZGluZywgb2Zmc2V0LCBsZW5ndGgpIC0gcmVtb3ZlIGluIHYwLjEzXG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgJ0J1ZmZlci53cml0ZShzdHJpbmcsIGVuY29kaW5nLCBvZmZzZXRbLCBsZW5ndGhdKSBpcyBubyBsb25nZXIgc3VwcG9ydGVkJ1xuICAgIClcbiAgfVxuXG4gIHZhciByZW1haW5pbmcgPSB0aGlzLmxlbmd0aCAtIG9mZnNldFxuICBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQgfHwgbGVuZ3RoID4gcmVtYWluaW5nKSBsZW5ndGggPSByZW1haW5pbmdcblxuICBpZiAoKHN0cmluZy5sZW5ndGggPiAwICYmIChsZW5ndGggPCAwIHx8IG9mZnNldCA8IDApKSB8fCBvZmZzZXQgPiB0aGlzLmxlbmd0aCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdBdHRlbXB0IHRvIHdyaXRlIG91dHNpZGUgYnVmZmVyIGJvdW5kcycpXG4gIH1cblxuICBpZiAoIWVuY29kaW5nKSBlbmNvZGluZyA9ICd1dGY4J1xuXG4gIHZhciBsb3dlcmVkQ2FzZSA9IGZhbHNlXG4gIGZvciAoOzspIHtcbiAgICBzd2l0Y2ggKGVuY29kaW5nKSB7XG4gICAgICBjYXNlICdoZXgnOlxuICAgICAgICByZXR1cm4gaGV4V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcblxuICAgICAgY2FzZSAndXRmOCc6XG4gICAgICBjYXNlICd1dGYtOCc6XG4gICAgICAgIHJldHVybiB1dGY4V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcblxuICAgICAgY2FzZSAnYXNjaWknOlxuICAgICAgICByZXR1cm4gYXNjaWlXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBjYXNlICdsYXRpbjEnOlxuICAgICAgY2FzZSAnYmluYXJ5JzpcbiAgICAgICAgcmV0dXJuIGxhdGluMVdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG5cbiAgICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgICAgIC8vIFdhcm5pbmc6IG1heExlbmd0aCBub3QgdGFrZW4gaW50byBhY2NvdW50IGluIGJhc2U2NFdyaXRlXG4gICAgICAgIHJldHVybiBiYXNlNjRXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBjYXNlICd1Y3MyJzpcbiAgICAgIGNhc2UgJ3Vjcy0yJzpcbiAgICAgIGNhc2UgJ3V0ZjE2bGUnOlxuICAgICAgY2FzZSAndXRmLTE2bGUnOlxuICAgICAgICByZXR1cm4gdWNzMldyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGlmIChsb3dlcmVkQ2FzZSkgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKVxuICAgICAgICBlbmNvZGluZyA9ICgnJyArIGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpXG4gICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZVxuICAgIH1cbiAgfVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIHRvSlNPTiAoKSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ0J1ZmZlcicsXG4gICAgZGF0YTogQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwodGhpcy5fYXJyIHx8IHRoaXMsIDApXG4gIH1cbn1cblxuZnVuY3Rpb24gYmFzZTY0U2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICBpZiAoc3RhcnQgPT09IDAgJiYgZW5kID09PSBidWYubGVuZ3RoKSB7XG4gICAgcmV0dXJuIGJhc2U2NC5mcm9tQnl0ZUFycmF5KGJ1ZilcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYmFzZTY0LmZyb21CeXRlQXJyYXkoYnVmLnNsaWNlKHN0YXJ0LCBlbmQpKVxuICB9XG59XG5cbmZ1bmN0aW9uIHV0ZjhTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7XG4gIGVuZCA9IE1hdGgubWluKGJ1Zi5sZW5ndGgsIGVuZClcbiAgdmFyIHJlcyA9IFtdXG5cbiAgdmFyIGkgPSBzdGFydFxuICB3aGlsZSAoaSA8IGVuZCkge1xuICAgIHZhciBmaXJzdEJ5dGUgPSBidWZbaV1cbiAgICB2YXIgY29kZVBvaW50ID0gbnVsbFxuICAgIHZhciBieXRlc1BlclNlcXVlbmNlID0gKGZpcnN0Qnl0ZSA+IDB4RUYpID8gNFxuICAgICAgOiAoZmlyc3RCeXRlID4gMHhERikgPyAzXG4gICAgICA6IChmaXJzdEJ5dGUgPiAweEJGKSA/IDJcbiAgICAgIDogMVxuXG4gICAgaWYgKGkgKyBieXRlc1BlclNlcXVlbmNlIDw9IGVuZCkge1xuICAgICAgdmFyIHNlY29uZEJ5dGUsIHRoaXJkQnl0ZSwgZm91cnRoQnl0ZSwgdGVtcENvZGVQb2ludFxuXG4gICAgICBzd2l0Y2ggKGJ5dGVzUGVyU2VxdWVuY2UpIHtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgIGlmIChmaXJzdEJ5dGUgPCAweDgwKSB7XG4gICAgICAgICAgICBjb2RlUG9pbnQgPSBmaXJzdEJ5dGVcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgIHNlY29uZEJ5dGUgPSBidWZbaSArIDFdXG4gICAgICAgICAgaWYgKChzZWNvbmRCeXRlICYgMHhDMCkgPT09IDB4ODApIHtcbiAgICAgICAgICAgIHRlbXBDb2RlUG9pbnQgPSAoZmlyc3RCeXRlICYgMHgxRikgPDwgMHg2IHwgKHNlY29uZEJ5dGUgJiAweDNGKVxuICAgICAgICAgICAgaWYgKHRlbXBDb2RlUG9pbnQgPiAweDdGKSB7XG4gICAgICAgICAgICAgIGNvZGVQb2ludCA9IHRlbXBDb2RlUG9pbnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgIHNlY29uZEJ5dGUgPSBidWZbaSArIDFdXG4gICAgICAgICAgdGhpcmRCeXRlID0gYnVmW2kgKyAyXVxuICAgICAgICAgIGlmICgoc2Vjb25kQnl0ZSAmIDB4QzApID09PSAweDgwICYmICh0aGlyZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCkge1xuICAgICAgICAgICAgdGVtcENvZGVQb2ludCA9IChmaXJzdEJ5dGUgJiAweEYpIDw8IDB4QyB8IChzZWNvbmRCeXRlICYgMHgzRikgPDwgMHg2IHwgKHRoaXJkQnl0ZSAmIDB4M0YpXG4gICAgICAgICAgICBpZiAodGVtcENvZGVQb2ludCA+IDB4N0ZGICYmICh0ZW1wQ29kZVBvaW50IDwgMHhEODAwIHx8IHRlbXBDb2RlUG9pbnQgPiAweERGRkYpKSB7XG4gICAgICAgICAgICAgIGNvZGVQb2ludCA9IHRlbXBDb2RlUG9pbnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSA0OlxuICAgICAgICAgIHNlY29uZEJ5dGUgPSBidWZbaSArIDFdXG4gICAgICAgICAgdGhpcmRCeXRlID0gYnVmW2kgKyAyXVxuICAgICAgICAgIGZvdXJ0aEJ5dGUgPSBidWZbaSArIDNdXG4gICAgICAgICAgaWYgKChzZWNvbmRCeXRlICYgMHhDMCkgPT09IDB4ODAgJiYgKHRoaXJkQnl0ZSAmIDB4QzApID09PSAweDgwICYmIChmb3VydGhCeXRlICYgMHhDMCkgPT09IDB4ODApIHtcbiAgICAgICAgICAgIHRlbXBDb2RlUG9pbnQgPSAoZmlyc3RCeXRlICYgMHhGKSA8PCAweDEyIHwgKHNlY29uZEJ5dGUgJiAweDNGKSA8PCAweEMgfCAodGhpcmRCeXRlICYgMHgzRikgPDwgMHg2IHwgKGZvdXJ0aEJ5dGUgJiAweDNGKVxuICAgICAgICAgICAgaWYgKHRlbXBDb2RlUG9pbnQgPiAweEZGRkYgJiYgdGVtcENvZGVQb2ludCA8IDB4MTEwMDAwKSB7XG4gICAgICAgICAgICAgIGNvZGVQb2ludCA9IHRlbXBDb2RlUG9pbnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGNvZGVQb2ludCA9PT0gbnVsbCkge1xuICAgICAgLy8gd2UgZGlkIG5vdCBnZW5lcmF0ZSBhIHZhbGlkIGNvZGVQb2ludCBzbyBpbnNlcnQgYVxuICAgICAgLy8gcmVwbGFjZW1lbnQgY2hhciAoVStGRkZEKSBhbmQgYWR2YW5jZSBvbmx5IDEgYnl0ZVxuICAgICAgY29kZVBvaW50ID0gMHhGRkZEXG4gICAgICBieXRlc1BlclNlcXVlbmNlID0gMVxuICAgIH0gZWxzZSBpZiAoY29kZVBvaW50ID4gMHhGRkZGKSB7XG4gICAgICAvLyBlbmNvZGUgdG8gdXRmMTYgKHN1cnJvZ2F0ZSBwYWlyIGRhbmNlKVxuICAgICAgY29kZVBvaW50IC09IDB4MTAwMDBcbiAgICAgIHJlcy5wdXNoKGNvZGVQb2ludCA+Pj4gMTAgJiAweDNGRiB8IDB4RDgwMClcbiAgICAgIGNvZGVQb2ludCA9IDB4REMwMCB8IGNvZGVQb2ludCAmIDB4M0ZGXG4gICAgfVxuXG4gICAgcmVzLnB1c2goY29kZVBvaW50KVxuICAgIGkgKz0gYnl0ZXNQZXJTZXF1ZW5jZVxuICB9XG5cbiAgcmV0dXJuIGRlY29kZUNvZGVQb2ludHNBcnJheShyZXMpXG59XG5cbi8vIEJhc2VkIG9uIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzIyNzQ3MjcyLzY4MDc0MiwgdGhlIGJyb3dzZXIgd2l0aFxuLy8gdGhlIGxvd2VzdCBsaW1pdCBpcyBDaHJvbWUsIHdpdGggMHgxMDAwMCBhcmdzLlxuLy8gV2UgZ28gMSBtYWduaXR1ZGUgbGVzcywgZm9yIHNhZmV0eVxudmFyIE1BWF9BUkdVTUVOVFNfTEVOR1RIID0gMHgxMDAwXG5cbmZ1bmN0aW9uIGRlY29kZUNvZGVQb2ludHNBcnJheSAoY29kZVBvaW50cykge1xuICB2YXIgbGVuID0gY29kZVBvaW50cy5sZW5ndGhcbiAgaWYgKGxlbiA8PSBNQVhfQVJHVU1FTlRTX0xFTkdUSCkge1xuICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KFN0cmluZywgY29kZVBvaW50cykgLy8gYXZvaWQgZXh0cmEgc2xpY2UoKVxuICB9XG5cbiAgLy8gRGVjb2RlIGluIGNodW5rcyB0byBhdm9pZCBcImNhbGwgc3RhY2sgc2l6ZSBleGNlZWRlZFwiLlxuICB2YXIgcmVzID0gJydcbiAgdmFyIGkgPSAwXG4gIHdoaWxlIChpIDwgbGVuKSB7XG4gICAgcmVzICs9IFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkoXG4gICAgICBTdHJpbmcsXG4gICAgICBjb2RlUG9pbnRzLnNsaWNlKGksIGkgKz0gTUFYX0FSR1VNRU5UU19MRU5HVEgpXG4gICAgKVxuICB9XG4gIHJldHVybiByZXNcbn1cblxuZnVuY3Rpb24gYXNjaWlTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7XG4gIHZhciByZXQgPSAnJ1xuICBlbmQgPSBNYXRoLm1pbihidWYubGVuZ3RoLCBlbmQpXG5cbiAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyArK2kpIHtcbiAgICByZXQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShidWZbaV0gJiAweDdGKVxuICB9XG4gIHJldHVybiByZXRcbn1cblxuZnVuY3Rpb24gbGF0aW4xU2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICB2YXIgcmV0ID0gJydcbiAgZW5kID0gTWF0aC5taW4oYnVmLmxlbmd0aCwgZW5kKVxuXG4gIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7XG4gICAgcmV0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnVmW2ldKVxuICB9XG4gIHJldHVybiByZXRcbn1cblxuZnVuY3Rpb24gaGV4U2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICB2YXIgbGVuID0gYnVmLmxlbmd0aFxuXG4gIGlmICghc3RhcnQgfHwgc3RhcnQgPCAwKSBzdGFydCA9IDBcbiAgaWYgKCFlbmQgfHwgZW5kIDwgMCB8fCBlbmQgPiBsZW4pIGVuZCA9IGxlblxuXG4gIHZhciBvdXQgPSAnJ1xuICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7ICsraSkge1xuICAgIG91dCArPSB0b0hleChidWZbaV0pXG4gIH1cbiAgcmV0dXJuIG91dFxufVxuXG5mdW5jdGlvbiB1dGYxNmxlU2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICB2YXIgYnl0ZXMgPSBidWYuc2xpY2Uoc3RhcnQsIGVuZClcbiAgdmFyIHJlcyA9ICcnXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgYnl0ZXMubGVuZ3RoOyBpICs9IDIpIHtcbiAgICByZXMgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShieXRlc1tpXSArIGJ5dGVzW2kgKyAxXSAqIDI1NilcbiAgfVxuICByZXR1cm4gcmVzXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuc2xpY2UgPSBmdW5jdGlvbiBzbGljZSAoc3RhcnQsIGVuZCkge1xuICB2YXIgbGVuID0gdGhpcy5sZW5ndGhcbiAgc3RhcnQgPSB+fnN0YXJ0XG4gIGVuZCA9IGVuZCA9PT0gdW5kZWZpbmVkID8gbGVuIDogfn5lbmRcblxuICBpZiAoc3RhcnQgPCAwKSB7XG4gICAgc3RhcnQgKz0gbGVuXG4gICAgaWYgKHN0YXJ0IDwgMCkgc3RhcnQgPSAwXG4gIH0gZWxzZSBpZiAoc3RhcnQgPiBsZW4pIHtcbiAgICBzdGFydCA9IGxlblxuICB9XG5cbiAgaWYgKGVuZCA8IDApIHtcbiAgICBlbmQgKz0gbGVuXG4gICAgaWYgKGVuZCA8IDApIGVuZCA9IDBcbiAgfSBlbHNlIGlmIChlbmQgPiBsZW4pIHtcbiAgICBlbmQgPSBsZW5cbiAgfVxuXG4gIGlmIChlbmQgPCBzdGFydCkgZW5kID0gc3RhcnRcblxuICB2YXIgbmV3QnVmXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIG5ld0J1ZiA9IHRoaXMuc3ViYXJyYXkoc3RhcnQsIGVuZClcbiAgICBuZXdCdWYuX19wcm90b19fID0gQnVmZmVyLnByb3RvdHlwZVxuICB9IGVsc2Uge1xuICAgIHZhciBzbGljZUxlbiA9IGVuZCAtIHN0YXJ0XG4gICAgbmV3QnVmID0gbmV3IEJ1ZmZlcihzbGljZUxlbiwgdW5kZWZpbmVkKVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2xpY2VMZW47ICsraSkge1xuICAgICAgbmV3QnVmW2ldID0gdGhpc1tpICsgc3RhcnRdXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG5ld0J1ZlxufVxuXG4vKlxuICogTmVlZCB0byBtYWtlIHN1cmUgdGhhdCBidWZmZXIgaXNuJ3QgdHJ5aW5nIHRvIHdyaXRlIG91dCBvZiBib3VuZHMuXG4gKi9cbmZ1bmN0aW9uIGNoZWNrT2Zmc2V0IChvZmZzZXQsIGV4dCwgbGVuZ3RoKSB7XG4gIGlmICgob2Zmc2V0ICUgMSkgIT09IDAgfHwgb2Zmc2V0IDwgMCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ29mZnNldCBpcyBub3QgdWludCcpXG4gIGlmIChvZmZzZXQgKyBleHQgPiBsZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdUcnlpbmcgdG8gYWNjZXNzIGJleW9uZCBidWZmZXIgbGVuZ3RoJylcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludExFID0gZnVuY3Rpb24gcmVhZFVJbnRMRSAob2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIGJ5dGVMZW5ndGgsIHRoaXMubGVuZ3RoKVxuXG4gIHZhciB2YWwgPSB0aGlzW29mZnNldF1cbiAgdmFyIG11bCA9IDFcbiAgdmFyIGkgPSAwXG4gIHdoaWxlICgrK2kgPCBieXRlTGVuZ3RoICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgaV0gKiBtdWxcbiAgfVxuXG4gIHJldHVybiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludEJFID0gZnVuY3Rpb24gcmVhZFVJbnRCRSAob2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMFxuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aClcbiAgfVxuXG4gIHZhciB2YWwgPSB0aGlzW29mZnNldCArIC0tYnl0ZUxlbmd0aF1cbiAgdmFyIG11bCA9IDFcbiAgd2hpbGUgKGJ5dGVMZW5ndGggPiAwICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgLS1ieXRlTGVuZ3RoXSAqIG11bFxuICB9XG5cbiAgcmV0dXJuIHZhbFxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50OCA9IGZ1bmN0aW9uIHJlYWRVSW50OCAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDEsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gdGhpc1tvZmZzZXRdXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQxNkxFID0gZnVuY3Rpb24gcmVhZFVJbnQxNkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMiwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiB0aGlzW29mZnNldF0gfCAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MTZCRSA9IGZ1bmN0aW9uIHJlYWRVSW50MTZCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gKHRoaXNbb2Zmc2V0XSA8PCA4KSB8IHRoaXNbb2Zmc2V0ICsgMV1cbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDMyTEUgPSBmdW5jdGlvbiByZWFkVUludDMyTEUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA0LCB0aGlzLmxlbmd0aClcblxuICByZXR1cm4gKCh0aGlzW29mZnNldF0pIHxcbiAgICAgICh0aGlzW29mZnNldCArIDFdIDw8IDgpIHxcbiAgICAgICh0aGlzW29mZnNldCArIDJdIDw8IDE2KSkgK1xuICAgICAgKHRoaXNbb2Zmc2V0ICsgM10gKiAweDEwMDAwMDApXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQzMkJFID0gZnVuY3Rpb24gcmVhZFVJbnQzMkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG5cbiAgcmV0dXJuICh0aGlzW29mZnNldF0gKiAweDEwMDAwMDApICtcbiAgICAoKHRoaXNbb2Zmc2V0ICsgMV0gPDwgMTYpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCA4KSB8XG4gICAgdGhpc1tvZmZzZXQgKyAzXSlcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50TEUgPSBmdW5jdGlvbiByZWFkSW50TEUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aClcblxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdXG4gIHZhciBtdWwgPSAxXG4gIHZhciBpID0gMFxuICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHZhbCArPSB0aGlzW29mZnNldCArIGldICogbXVsXG4gIH1cbiAgbXVsICo9IDB4ODBcblxuICBpZiAodmFsID49IG11bCkgdmFsIC09IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKVxuXG4gIHJldHVybiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50QkUgPSBmdW5jdGlvbiByZWFkSW50QkUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aClcblxuICB2YXIgaSA9IGJ5dGVMZW5ndGhcbiAgdmFyIG11bCA9IDFcbiAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0ICsgLS1pXVxuICB3aGlsZSAoaSA+IDAgJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICB2YWwgKz0gdGhpc1tvZmZzZXQgKyAtLWldICogbXVsXG4gIH1cbiAgbXVsICo9IDB4ODBcblxuICBpZiAodmFsID49IG11bCkgdmFsIC09IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKVxuXG4gIHJldHVybiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50OCA9IGZ1bmN0aW9uIHJlYWRJbnQ4IChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMSwgdGhpcy5sZW5ndGgpXG4gIGlmICghKHRoaXNbb2Zmc2V0XSAmIDB4ODApKSByZXR1cm4gKHRoaXNbb2Zmc2V0XSlcbiAgcmV0dXJuICgoMHhmZiAtIHRoaXNbb2Zmc2V0XSArIDEpICogLTEpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDE2TEUgPSBmdW5jdGlvbiByZWFkSW50MTZMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKVxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdIHwgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOClcbiAgcmV0dXJuICh2YWwgJiAweDgwMDApID8gdmFsIHwgMHhGRkZGMDAwMCA6IHZhbFxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRJbnQxNkJFID0gZnVuY3Rpb24gcmVhZEludDE2QkUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aClcbiAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0ICsgMV0gfCAodGhpc1tvZmZzZXRdIDw8IDgpXG4gIHJldHVybiAodmFsICYgMHg4MDAwKSA/IHZhbCB8IDB4RkZGRjAwMDAgOiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50MzJMRSA9IGZ1bmN0aW9uIHJlYWRJbnQzMkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG5cbiAgcmV0dXJuICh0aGlzW29mZnNldF0pIHxcbiAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgMl0gPDwgMTYpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAzXSA8PCAyNClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50MzJCRSA9IGZ1bmN0aW9uIHJlYWRJbnQzMkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG5cbiAgcmV0dXJuICh0aGlzW29mZnNldF0gPDwgMjQpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCAxNikgfFxuICAgICh0aGlzW29mZnNldCArIDJdIDw8IDgpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAzXSlcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkRmxvYXRMRSA9IGZ1bmN0aW9uIHJlYWRGbG9hdExFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCB0cnVlLCAyMywgNClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkRmxvYXRCRSA9IGZ1bmN0aW9uIHJlYWRGbG9hdEJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCBmYWxzZSwgMjMsIDQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZERvdWJsZUxFID0gZnVuY3Rpb24gcmVhZERvdWJsZUxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgOCwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCB0cnVlLCA1MiwgOClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkRG91YmxlQkUgPSBmdW5jdGlvbiByZWFkRG91YmxlQkUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA4LCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuIGllZWU3NTQucmVhZCh0aGlzLCBvZmZzZXQsIGZhbHNlLCA1MiwgOClcbn1cblxuZnVuY3Rpb24gY2hlY2tJbnQgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgZXh0LCBtYXgsIG1pbikge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihidWYpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdcImJ1ZmZlclwiIGFyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXIgaW5zdGFuY2UnKVxuICBpZiAodmFsdWUgPiBtYXggfHwgdmFsdWUgPCBtaW4pIHRocm93IG5ldyBSYW5nZUVycm9yKCdcInZhbHVlXCIgYXJndW1lbnQgaXMgb3V0IG9mIGJvdW5kcycpXG4gIGlmIChvZmZzZXQgKyBleHQgPiBidWYubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignSW5kZXggb3V0IG9mIHJhbmdlJylcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnRMRSA9IGZ1bmN0aW9uIHdyaXRlVUludExFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMFxuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgdmFyIG1heEJ5dGVzID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGgpIC0gMVxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG1heEJ5dGVzLCAwKVxuICB9XG5cbiAgdmFyIG11bCA9IDFcbiAgdmFyIGkgPSAwXG4gIHRoaXNbb2Zmc2V0XSA9IHZhbHVlICYgMHhGRlxuICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAodmFsdWUgLyBtdWwpICYgMHhGRlxuICB9XG5cbiAgcmV0dXJuIG9mZnNldCArIGJ5dGVMZW5ndGhcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnRCRSA9IGZ1bmN0aW9uIHdyaXRlVUludEJFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMFxuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgdmFyIG1heEJ5dGVzID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGgpIC0gMVxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG1heEJ5dGVzLCAwKVxuICB9XG5cbiAgdmFyIGkgPSBieXRlTGVuZ3RoIC0gMVxuICB2YXIgbXVsID0gMVxuICB0aGlzW29mZnNldCArIGldID0gdmFsdWUgJiAweEZGXG4gIHdoaWxlICgtLWkgPj0gMCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAodmFsdWUgLyBtdWwpICYgMHhGRlxuICB9XG5cbiAgcmV0dXJuIG9mZnNldCArIGJ5dGVMZW5ndGhcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQ4ID0gZnVuY3Rpb24gd3JpdGVVSW50OCAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAxLCAweGZmLCAwKVxuICBpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB2YWx1ZSA9IE1hdGguZmxvb3IodmFsdWUpXG4gIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpXG4gIHJldHVybiBvZmZzZXQgKyAxXG59XG5cbmZ1bmN0aW9uIG9iamVjdFdyaXRlVUludDE2IChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbikge1xuICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmZmZiArIHZhbHVlICsgMVxuICBmb3IgKHZhciBpID0gMCwgaiA9IE1hdGgubWluKGJ1Zi5sZW5ndGggLSBvZmZzZXQsIDIpOyBpIDwgajsgKytpKSB7XG4gICAgYnVmW29mZnNldCArIGldID0gKHZhbHVlICYgKDB4ZmYgPDwgKDggKiAobGl0dGxlRW5kaWFuID8gaSA6IDEgLSBpKSkpKSA+Pj5cbiAgICAgIChsaXR0bGVFbmRpYW4gPyBpIDogMSAtIGkpICogOFxuICB9XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MTZMRSA9IGZ1bmN0aW9uIHdyaXRlVUludDE2TEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMiwgMHhmZmZmLCAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MTYodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgMlxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludDE2QkUgPSBmdW5jdGlvbiB3cml0ZVVJbnQxNkJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4ZmZmZiwgMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgJiAweGZmKVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDE2KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyAyXG59XG5cbmZ1bmN0aW9uIG9iamVjdFdyaXRlVUludDMyIChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbikge1xuICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmZmZmZmZmYgKyB2YWx1ZSArIDFcbiAgZm9yICh2YXIgaSA9IDAsIGogPSBNYXRoLm1pbihidWYubGVuZ3RoIC0gb2Zmc2V0LCA0KTsgaSA8IGo7ICsraSkge1xuICAgIGJ1ZltvZmZzZXQgKyBpXSA9ICh2YWx1ZSA+Pj4gKGxpdHRsZUVuZGlhbiA/IGkgOiAzIC0gaSkgKiA4KSAmIDB4ZmZcbiAgfVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludDMyTEUgPSBmdW5jdGlvbiB3cml0ZVVJbnQzMkxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4ZmZmZmZmZmYsIDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgPj4+IDI0KVxuICAgIHRoaXNbb2Zmc2V0ICsgMl0gPSAodmFsdWUgPj4+IDE2KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQzMih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyA0XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MzJCRSA9IGZ1bmN0aW9uIHdyaXRlVUludDMyQkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgNCwgMHhmZmZmZmZmZiwgMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiAyNClcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiAxNilcbiAgICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgJiAweGZmKVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyA0XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnRMRSA9IGZ1bmN0aW9uIHdyaXRlSW50TEUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIHZhciBsaW1pdCA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoIC0gMSlcblxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIGxpbWl0IC0gMSwgLWxpbWl0KVxuICB9XG5cbiAgdmFyIGkgPSAwXG4gIHZhciBtdWwgPSAxXG4gIHZhciBzdWIgPSAwXG4gIHRoaXNbb2Zmc2V0XSA9IHZhbHVlICYgMHhGRlxuICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIGlmICh2YWx1ZSA8IDAgJiYgc3ViID09PSAwICYmIHRoaXNbb2Zmc2V0ICsgaSAtIDFdICE9PSAwKSB7XG4gICAgICBzdWIgPSAxXG4gICAgfVxuICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAoKHZhbHVlIC8gbXVsKSA+PiAwKSAtIHN1YiAmIDB4RkZcbiAgfVxuXG4gIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnRCRSA9IGZ1bmN0aW9uIHdyaXRlSW50QkUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIHZhciBsaW1pdCA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoIC0gMSlcblxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIGxpbWl0IC0gMSwgLWxpbWl0KVxuICB9XG5cbiAgdmFyIGkgPSBieXRlTGVuZ3RoIC0gMVxuICB2YXIgbXVsID0gMVxuICB2YXIgc3ViID0gMFxuICB0aGlzW29mZnNldCArIGldID0gdmFsdWUgJiAweEZGXG4gIHdoaWxlICgtLWkgPj0gMCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIGlmICh2YWx1ZSA8IDAgJiYgc3ViID09PSAwICYmIHRoaXNbb2Zmc2V0ICsgaSArIDFdICE9PSAwKSB7XG4gICAgICBzdWIgPSAxXG4gICAgfVxuICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAoKHZhbHVlIC8gbXVsKSA+PiAwKSAtIHN1YiAmIDB4RkZcbiAgfVxuXG4gIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQ4ID0gZnVuY3Rpb24gd3JpdGVJbnQ4ICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDEsIDB4N2YsIC0weDgwKVxuICBpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB2YWx1ZSA9IE1hdGguZmxvb3IodmFsdWUpXG4gIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZiArIHZhbHVlICsgMVxuICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICByZXR1cm4gb2Zmc2V0ICsgMVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MTZMRSA9IGZ1bmN0aW9uIHdyaXRlSW50MTZMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweDdmZmYsIC0weDgwMDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOClcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyAyXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQxNkJFID0gZnVuY3Rpb24gd3JpdGVJbnQxNkJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4N2ZmZiwgLTB4ODAwMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgJiAweGZmKVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDE2KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyAyXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQzMkxFID0gZnVuY3Rpb24gd3JpdGVJbnQzMkxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4N2ZmZmZmZmYsIC0weDgwMDAwMDAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gMTYpXG4gICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSA+Pj4gMjQpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MzIodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgNFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MzJCRSA9IGZ1bmN0aW9uIHdyaXRlSW50MzJCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweDdmZmZmZmZmLCAtMHg4MDAwMDAwMClcbiAgaWYgKHZhbHVlIDwgMCkgdmFsdWUgPSAweGZmZmZmZmZmICsgdmFsdWUgKyAxXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gMjQpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gMTYpXG4gICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gOClcbiAgICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlICYgMHhmZilcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQzMih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgNFxufVxuXG5mdW5jdGlvbiBjaGVja0lFRUU3NTQgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgZXh0LCBtYXgsIG1pbikge1xuICBpZiAob2Zmc2V0ICsgZXh0ID4gYnVmLmxlbmd0aCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0luZGV4IG91dCBvZiByYW5nZScpXG4gIGlmIChvZmZzZXQgPCAwKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignSW5kZXggb3V0IG9mIHJhbmdlJylcbn1cblxuZnVuY3Rpb24gd3JpdGVGbG9hdCAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIHtcbiAgICBjaGVja0lFRUU3NTQoYnVmLCB2YWx1ZSwgb2Zmc2V0LCA0LCAzLjQwMjgyMzQ2NjM4NTI4ODZlKzM4LCAtMy40MDI4MjM0NjYzODUyODg2ZSszOClcbiAgfVxuICBpZWVlNzU0LndyaXRlKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCAyMywgNClcbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUZsb2F0TEUgPSBmdW5jdGlvbiB3cml0ZUZsb2F0TEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHJldHVybiB3cml0ZUZsb2F0KHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUsIG5vQXNzZXJ0KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlRmxvYXRCRSA9IGZ1bmN0aW9uIHdyaXRlRmxvYXRCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgcmV0dXJuIHdyaXRlRmxvYXQodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UsIG5vQXNzZXJ0KVxufVxuXG5mdW5jdGlvbiB3cml0ZURvdWJsZSAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIHtcbiAgICBjaGVja0lFRUU3NTQoYnVmLCB2YWx1ZSwgb2Zmc2V0LCA4LCAxLjc5NzY5MzEzNDg2MjMxNTdFKzMwOCwgLTEuNzk3NjkzMTM0ODYyMzE1N0UrMzA4KVxuICB9XG4gIGllZWU3NTQud3JpdGUoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIDUyLCA4KVxuICByZXR1cm4gb2Zmc2V0ICsgOFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlRG91YmxlTEUgPSBmdW5jdGlvbiB3cml0ZURvdWJsZUxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICByZXR1cm4gd3JpdGVEb3VibGUodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSwgbm9Bc3NlcnQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVEb3VibGVCRSA9IGZ1bmN0aW9uIHdyaXRlRG91YmxlQkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHJldHVybiB3cml0ZURvdWJsZSh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSwgbm9Bc3NlcnQpXG59XG5cbi8vIGNvcHkodGFyZ2V0QnVmZmVyLCB0YXJnZXRTdGFydD0wLCBzb3VyY2VTdGFydD0wLCBzb3VyY2VFbmQ9YnVmZmVyLmxlbmd0aClcbkJ1ZmZlci5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIGNvcHkgKHRhcmdldCwgdGFyZ2V0U3RhcnQsIHN0YXJ0LCBlbmQpIHtcbiAgaWYgKCFzdGFydCkgc3RhcnQgPSAwXG4gIGlmICghZW5kICYmIGVuZCAhPT0gMCkgZW5kID0gdGhpcy5sZW5ndGhcbiAgaWYgKHRhcmdldFN0YXJ0ID49IHRhcmdldC5sZW5ndGgpIHRhcmdldFN0YXJ0ID0gdGFyZ2V0Lmxlbmd0aFxuICBpZiAoIXRhcmdldFN0YXJ0KSB0YXJnZXRTdGFydCA9IDBcbiAgaWYgKGVuZCA+IDAgJiYgZW5kIDwgc3RhcnQpIGVuZCA9IHN0YXJ0XG5cbiAgLy8gQ29weSAwIGJ5dGVzOyB3ZSdyZSBkb25lXG4gIGlmIChlbmQgPT09IHN0YXJ0KSByZXR1cm4gMFxuICBpZiAodGFyZ2V0Lmxlbmd0aCA9PT0gMCB8fCB0aGlzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIDBcblxuICAvLyBGYXRhbCBlcnJvciBjb25kaXRpb25zXG4gIGlmICh0YXJnZXRTdGFydCA8IDApIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcigndGFyZ2V0U3RhcnQgb3V0IG9mIGJvdW5kcycpXG4gIH1cbiAgaWYgKHN0YXJ0IDwgMCB8fCBzdGFydCA+PSB0aGlzLmxlbmd0aCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3NvdXJjZVN0YXJ0IG91dCBvZiBib3VuZHMnKVxuICBpZiAoZW5kIDwgMCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3NvdXJjZUVuZCBvdXQgb2YgYm91bmRzJylcblxuICAvLyBBcmUgd2Ugb29iP1xuICBpZiAoZW5kID4gdGhpcy5sZW5ndGgpIGVuZCA9IHRoaXMubGVuZ3RoXG4gIGlmICh0YXJnZXQubGVuZ3RoIC0gdGFyZ2V0U3RhcnQgPCBlbmQgLSBzdGFydCkge1xuICAgIGVuZCA9IHRhcmdldC5sZW5ndGggLSB0YXJnZXRTdGFydCArIHN0YXJ0XG4gIH1cblxuICB2YXIgbGVuID0gZW5kIC0gc3RhcnRcbiAgdmFyIGlcblxuICBpZiAodGhpcyA9PT0gdGFyZ2V0ICYmIHN0YXJ0IDwgdGFyZ2V0U3RhcnQgJiYgdGFyZ2V0U3RhcnQgPCBlbmQpIHtcbiAgICAvLyBkZXNjZW5kaW5nIGNvcHkgZnJvbSBlbmRcbiAgICBmb3IgKGkgPSBsZW4gLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgdGFyZ2V0W2kgKyB0YXJnZXRTdGFydF0gPSB0aGlzW2kgKyBzdGFydF1cbiAgICB9XG4gIH0gZWxzZSBpZiAobGVuIDwgMTAwMCB8fCAhQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICAvLyBhc2NlbmRpbmcgY29weSBmcm9tIHN0YXJ0XG4gICAgZm9yIChpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICB0YXJnZXRbaSArIHRhcmdldFN0YXJ0XSA9IHRoaXNbaSArIHN0YXJ0XVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBVaW50OEFycmF5LnByb3RvdHlwZS5zZXQuY2FsbChcbiAgICAgIHRhcmdldCxcbiAgICAgIHRoaXMuc3ViYXJyYXkoc3RhcnQsIHN0YXJ0ICsgbGVuKSxcbiAgICAgIHRhcmdldFN0YXJ0XG4gICAgKVxuICB9XG5cbiAgcmV0dXJuIGxlblxufVxuXG4vLyBVc2FnZTpcbi8vICAgIGJ1ZmZlci5maWxsKG51bWJlclssIG9mZnNldFssIGVuZF1dKVxuLy8gICAgYnVmZmVyLmZpbGwoYnVmZmVyWywgb2Zmc2V0WywgZW5kXV0pXG4vLyAgICBidWZmZXIuZmlsbChzdHJpbmdbLCBvZmZzZXRbLCBlbmRdXVssIGVuY29kaW5nXSlcbkJ1ZmZlci5wcm90b3R5cGUuZmlsbCA9IGZ1bmN0aW9uIGZpbGwgKHZhbCwgc3RhcnQsIGVuZCwgZW5jb2RpbmcpIHtcbiAgLy8gSGFuZGxlIHN0cmluZyBjYXNlczpcbiAgaWYgKHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnKSB7XG4gICAgaWYgKHR5cGVvZiBzdGFydCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGVuY29kaW5nID0gc3RhcnRcbiAgICAgIHN0YXJ0ID0gMFxuICAgICAgZW5kID0gdGhpcy5sZW5ndGhcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBlbmQgPT09ICdzdHJpbmcnKSB7XG4gICAgICBlbmNvZGluZyA9IGVuZFxuICAgICAgZW5kID0gdGhpcy5sZW5ndGhcbiAgICB9XG4gICAgaWYgKHZhbC5sZW5ndGggPT09IDEpIHtcbiAgICAgIHZhciBjb2RlID0gdmFsLmNoYXJDb2RlQXQoMClcbiAgICAgIGlmIChjb2RlIDwgMjU2KSB7XG4gICAgICAgIHZhbCA9IGNvZGVcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGVuY29kaW5nICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIGVuY29kaW5nICE9PSAnc3RyaW5nJykge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignZW5jb2RpbmcgbXVzdCBiZSBhIHN0cmluZycpXG4gICAgfVxuICAgIGlmICh0eXBlb2YgZW5jb2RpbmcgPT09ICdzdHJpbmcnICYmICFCdWZmZXIuaXNFbmNvZGluZyhlbmNvZGluZykpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Vua25vd24gZW5jb2Rpbmc6ICcgKyBlbmNvZGluZylcbiAgICB9XG4gIH0gZWxzZSBpZiAodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpIHtcbiAgICB2YWwgPSB2YWwgJiAyNTVcbiAgfVxuXG4gIC8vIEludmFsaWQgcmFuZ2VzIGFyZSBub3Qgc2V0IHRvIGEgZGVmYXVsdCwgc28gY2FuIHJhbmdlIGNoZWNrIGVhcmx5LlxuICBpZiAoc3RhcnQgPCAwIHx8IHRoaXMubGVuZ3RoIDwgc3RhcnQgfHwgdGhpcy5sZW5ndGggPCBlbmQpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignT3V0IG9mIHJhbmdlIGluZGV4JylcbiAgfVxuXG4gIGlmIChlbmQgPD0gc3RhcnQpIHtcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgc3RhcnQgPSBzdGFydCA+Pj4gMFxuICBlbmQgPSBlbmQgPT09IHVuZGVmaW5lZCA/IHRoaXMubGVuZ3RoIDogZW5kID4+PiAwXG5cbiAgaWYgKCF2YWwpIHZhbCA9IDBcblxuICB2YXIgaVxuICBpZiAodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpIHtcbiAgICBmb3IgKGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7XG4gICAgICB0aGlzW2ldID0gdmFsXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHZhciBieXRlcyA9IEJ1ZmZlci5pc0J1ZmZlcih2YWwpXG4gICAgICA/IHZhbFxuICAgICAgOiB1dGY4VG9CeXRlcyhuZXcgQnVmZmVyKHZhbCwgZW5jb2RpbmcpLnRvU3RyaW5nKCkpXG4gICAgdmFyIGxlbiA9IGJ5dGVzLmxlbmd0aFxuICAgIGZvciAoaSA9IDA7IGkgPCBlbmQgLSBzdGFydDsgKytpKSB7XG4gICAgICB0aGlzW2kgKyBzdGFydF0gPSBieXRlc1tpICUgbGVuXVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0aGlzXG59XG5cbi8vIEhFTFBFUiBGVU5DVElPTlNcbi8vID09PT09PT09PT09PT09PT1cblxudmFyIElOVkFMSURfQkFTRTY0X1JFID0gL1teK1xcLzAtOUEtWmEtei1fXS9nXG5cbmZ1bmN0aW9uIGJhc2U2NGNsZWFuIChzdHIpIHtcbiAgLy8gTm9kZSBzdHJpcHMgb3V0IGludmFsaWQgY2hhcmFjdGVycyBsaWtlIFxcbiBhbmQgXFx0IGZyb20gdGhlIHN0cmluZywgYmFzZTY0LWpzIGRvZXMgbm90XG4gIHN0ciA9IHN0cmluZ3RyaW0oc3RyKS5yZXBsYWNlKElOVkFMSURfQkFTRTY0X1JFLCAnJylcbiAgLy8gTm9kZSBjb252ZXJ0cyBzdHJpbmdzIHdpdGggbGVuZ3RoIDwgMiB0byAnJ1xuICBpZiAoc3RyLmxlbmd0aCA8IDIpIHJldHVybiAnJ1xuICAvLyBOb2RlIGFsbG93cyBmb3Igbm9uLXBhZGRlZCBiYXNlNjQgc3RyaW5ncyAobWlzc2luZyB0cmFpbGluZyA9PT0pLCBiYXNlNjQtanMgZG9lcyBub3RcbiAgd2hpbGUgKHN0ci5sZW5ndGggJSA0ICE9PSAwKSB7XG4gICAgc3RyID0gc3RyICsgJz0nXG4gIH1cbiAgcmV0dXJuIHN0clxufVxuXG5mdW5jdGlvbiBzdHJpbmd0cmltIChzdHIpIHtcbiAgaWYgKHN0ci50cmltKSByZXR1cm4gc3RyLnRyaW0oKVxuICByZXR1cm4gc3RyLnJlcGxhY2UoL15cXHMrfFxccyskL2csICcnKVxufVxuXG5mdW5jdGlvbiB0b0hleCAobikge1xuICBpZiAobiA8IDE2KSByZXR1cm4gJzAnICsgbi50b1N0cmluZygxNilcbiAgcmV0dXJuIG4udG9TdHJpbmcoMTYpXG59XG5cbmZ1bmN0aW9uIHV0ZjhUb0J5dGVzIChzdHJpbmcsIHVuaXRzKSB7XG4gIHVuaXRzID0gdW5pdHMgfHwgSW5maW5pdHlcbiAgdmFyIGNvZGVQb2ludFxuICB2YXIgbGVuZ3RoID0gc3RyaW5nLmxlbmd0aFxuICB2YXIgbGVhZFN1cnJvZ2F0ZSA9IG51bGxcbiAgdmFyIGJ5dGVzID0gW11cblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgY29kZVBvaW50ID0gc3RyaW5nLmNoYXJDb2RlQXQoaSlcblxuICAgIC8vIGlzIHN1cnJvZ2F0ZSBjb21wb25lbnRcbiAgICBpZiAoY29kZVBvaW50ID4gMHhEN0ZGICYmIGNvZGVQb2ludCA8IDB4RTAwMCkge1xuICAgICAgLy8gbGFzdCBjaGFyIHdhcyBhIGxlYWRcbiAgICAgIGlmICghbGVhZFN1cnJvZ2F0ZSkge1xuICAgICAgICAvLyBubyBsZWFkIHlldFxuICAgICAgICBpZiAoY29kZVBvaW50ID4gMHhEQkZGKSB7XG4gICAgICAgICAgLy8gdW5leHBlY3RlZCB0cmFpbFxuICAgICAgICAgIGlmICgodW5pdHMgLT0gMykgPiAtMSkgYnl0ZXMucHVzaCgweEVGLCAweEJGLCAweEJEKVxuICAgICAgICAgIGNvbnRpbnVlXG4gICAgICAgIH0gZWxzZSBpZiAoaSArIDEgPT09IGxlbmd0aCkge1xuICAgICAgICAgIC8vIHVucGFpcmVkIGxlYWRcbiAgICAgICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRClcbiAgICAgICAgICBjb250aW51ZVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gdmFsaWQgbGVhZFxuICAgICAgICBsZWFkU3Vycm9nYXRlID0gY29kZVBvaW50XG5cbiAgICAgICAgY29udGludWVcbiAgICAgIH1cblxuICAgICAgLy8gMiBsZWFkcyBpbiBhIHJvd1xuICAgICAgaWYgKGNvZGVQb2ludCA8IDB4REMwMCkge1xuICAgICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRClcbiAgICAgICAgbGVhZFN1cnJvZ2F0ZSA9IGNvZGVQb2ludFxuICAgICAgICBjb250aW51ZVxuICAgICAgfVxuXG4gICAgICAvLyB2YWxpZCBzdXJyb2dhdGUgcGFpclxuICAgICAgY29kZVBvaW50ID0gKGxlYWRTdXJyb2dhdGUgLSAweEQ4MDAgPDwgMTAgfCBjb2RlUG9pbnQgLSAweERDMDApICsgMHgxMDAwMFxuICAgIH0gZWxzZSBpZiAobGVhZFN1cnJvZ2F0ZSkge1xuICAgICAgLy8gdmFsaWQgYm1wIGNoYXIsIGJ1dCBsYXN0IGNoYXIgd2FzIGEgbGVhZFxuICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpXG4gICAgfVxuXG4gICAgbGVhZFN1cnJvZ2F0ZSA9IG51bGxcblxuICAgIC8vIGVuY29kZSB1dGY4XG4gICAgaWYgKGNvZGVQb2ludCA8IDB4ODApIHtcbiAgICAgIGlmICgodW5pdHMgLT0gMSkgPCAwKSBicmVha1xuICAgICAgYnl0ZXMucHVzaChjb2RlUG9pbnQpXG4gICAgfSBlbHNlIGlmIChjb2RlUG9pbnQgPCAweDgwMCkge1xuICAgICAgaWYgKCh1bml0cyAtPSAyKSA8IDApIGJyZWFrXG4gICAgICBieXRlcy5wdXNoKFxuICAgICAgICBjb2RlUG9pbnQgPj4gMHg2IHwgMHhDMCxcbiAgICAgICAgY29kZVBvaW50ICYgMHgzRiB8IDB4ODBcbiAgICAgIClcbiAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA8IDB4MTAwMDApIHtcbiAgICAgIGlmICgodW5pdHMgLT0gMykgPCAwKSBicmVha1xuICAgICAgYnl0ZXMucHVzaChcbiAgICAgICAgY29kZVBvaW50ID4+IDB4QyB8IDB4RTAsXG4gICAgICAgIGNvZGVQb2ludCA+PiAweDYgJiAweDNGIHwgMHg4MCxcbiAgICAgICAgY29kZVBvaW50ICYgMHgzRiB8IDB4ODBcbiAgICAgIClcbiAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA8IDB4MTEwMDAwKSB7XG4gICAgICBpZiAoKHVuaXRzIC09IDQpIDwgMCkgYnJlYWtcbiAgICAgIGJ5dGVzLnB1c2goXG4gICAgICAgIGNvZGVQb2ludCA+PiAweDEyIHwgMHhGMCxcbiAgICAgICAgY29kZVBvaW50ID4+IDB4QyAmIDB4M0YgfCAweDgwLFxuICAgICAgICBjb2RlUG9pbnQgPj4gMHg2ICYgMHgzRiB8IDB4ODAsXG4gICAgICAgIGNvZGVQb2ludCAmIDB4M0YgfCAweDgwXG4gICAgICApXG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBjb2RlIHBvaW50JylcbiAgICB9XG4gIH1cblxuICByZXR1cm4gYnl0ZXNcbn1cblxuZnVuY3Rpb24gYXNjaWlUb0J5dGVzIChzdHIpIHtcbiAgdmFyIGJ5dGVBcnJheSA9IFtdXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgKytpKSB7XG4gICAgLy8gTm9kZSdzIGNvZGUgc2VlbXMgdG8gYmUgZG9pbmcgdGhpcyBhbmQgbm90ICYgMHg3Ri4uXG4gICAgYnl0ZUFycmF5LnB1c2goc3RyLmNoYXJDb2RlQXQoaSkgJiAweEZGKVxuICB9XG4gIHJldHVybiBieXRlQXJyYXlcbn1cblxuZnVuY3Rpb24gdXRmMTZsZVRvQnl0ZXMgKHN0ciwgdW5pdHMpIHtcbiAgdmFyIGMsIGhpLCBsb1xuICB2YXIgYnl0ZUFycmF5ID0gW11cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyArK2kpIHtcbiAgICBpZiAoKHVuaXRzIC09IDIpIDwgMCkgYnJlYWtcblxuICAgIGMgPSBzdHIuY2hhckNvZGVBdChpKVxuICAgIGhpID0gYyA+PiA4XG4gICAgbG8gPSBjICUgMjU2XG4gICAgYnl0ZUFycmF5LnB1c2gobG8pXG4gICAgYnl0ZUFycmF5LnB1c2goaGkpXG4gIH1cblxuICByZXR1cm4gYnl0ZUFycmF5XG59XG5cbmZ1bmN0aW9uIGJhc2U2NFRvQnl0ZXMgKHN0cikge1xuICByZXR1cm4gYmFzZTY0LnRvQnl0ZUFycmF5KGJhc2U2NGNsZWFuKHN0cikpXG59XG5cbmZ1bmN0aW9uIGJsaXRCdWZmZXIgKHNyYywgZHN0LCBvZmZzZXQsIGxlbmd0aCkge1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgaWYgKChpICsgb2Zmc2V0ID49IGRzdC5sZW5ndGgpIHx8IChpID49IHNyYy5sZW5ndGgpKSBicmVha1xuICAgIGRzdFtpICsgb2Zmc2V0XSA9IHNyY1tpXVxuICB9XG4gIHJldHVybiBpXG59XG5cbmZ1bmN0aW9uIGlzbmFuICh2YWwpIHtcbiAgcmV0dXJuIHZhbCAhPT0gdmFsIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tc2VsZi1jb21wYXJlXG59XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYnVmZmVyL2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSA0OVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiLi4vLi4vY3NzLWxvYWRlci9saWIvY3NzLWJhc2UuanNcIikodW5kZWZpbmVkKTtcbi8vIGltcG9ydHNcblxuXG4vLyBtb2R1bGVcbmV4cG9ydHMucHVzaChbbW9kdWxlLmlkLCBcIi5obGpze2Rpc3BsYXk6YmxvY2s7b3ZlcmZsb3cteDphdXRvO3BhZGRpbmc6LjVlbTtiYWNrZ3JvdW5kOiMyNzI4MjI7Y29sb3I6I2RkZH0uaGxqcy1rZXl3b3JkLC5obGpzLWxpdGVyYWwsLmhsanMtbmFtZSwuaGxqcy1zZWxlY3Rvci10YWcsLmhsanMtc3Ryb25nLC5obGpzLXRhZ3tjb2xvcjojZjkyNjcyfS5obGpzLWNvZGV7Y29sb3I6IzY2ZDllZn0uaGxqcy1jbGFzcyAuaGxqcy10aXRsZXtjb2xvcjojZmZmfS5obGpzLWF0dHJpYnV0ZSwuaGxqcy1saW5rLC5obGpzLXJlZ2V4cCwuaGxqcy1zeW1ib2x7Y29sb3I6I2JmNzlkYn0uaGxqcy1hZGRpdGlvbiwuaGxqcy1idWlsdF9pbiwuaGxqcy1idWlsdGluLW5hbWUsLmhsanMtYnVsbGV0LC5obGpzLWVtcGhhc2lzLC5obGpzLXNlY3Rpb24sLmhsanMtc2VsZWN0b3ItYXR0ciwuaGxqcy1zZWxlY3Rvci1wc2V1ZG8sLmhsanMtc3RyaW5nLC5obGpzLXN1YnN0LC5obGpzLXRlbXBsYXRlLXRhZywuaGxqcy10ZW1wbGF0ZS12YXJpYWJsZSwuaGxqcy10aXRsZSwuaGxqcy10eXBlLC5obGpzLXZhcmlhYmxle2NvbG9yOiNhNmUyMmV9LmhsanMtY29tbWVudCwuaGxqcy1kZWxldGlvbiwuaGxqcy1tZXRhLC5obGpzLXF1b3Rle2NvbG9yOiM3NTcxNWV9LmhsanMtZG9jdGFnLC5obGpzLWtleXdvcmQsLmhsanMtbGl0ZXJhbCwuaGxqcy1zZWN0aW9uLC5obGpzLXNlbGVjdG9yLWlkLC5obGpzLXNlbGVjdG9yLXRhZywuaGxqcy10aXRsZSwuaGxqcy10eXBle2ZvbnQtd2VpZ2h0OjcwMH1cIiwgXCJcIl0pO1xuXG4vLyBleHBvcnRzXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vY3NzLWxvYWRlcj97XCJtaW5pbWl6ZVwiOnRydWV9IS4vfi9oaWdobGlnaHQuanMvc3R5bGVzL21vbm9rYWkuY3NzXG4vLyBtb2R1bGUgaWQgPSA1MFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvbGliL2Nzcy1iYXNlLmpzXCIpKHVuZGVmaW5lZCk7XG4vLyBpbXBvcnRzXG5cblxuLy8gbW9kdWxlXG5leHBvcnRzLnB1c2goW21vZHVsZS5pZCwgXCIuQXBwX192aWV3cG9ydHtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtsZWZ0OjA7d2lkdGg6MTAwdnc7aGVpZ2h0OjEwMHZoO292ZXJmbG93OmF1dG99LkFwcF9fY29udGFpbmVye3Bvc2l0aW9uOmFic29sdXRlO3dpZHRoOjEwMCU7bWluLWhlaWdodDoxMDB2aDtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6c3RyZXRjaDtmb250LWZhbWlseTpzYW5zLXNlcmlmfS5BcHBfX25hdntmbGV4LXNocmluazowO2JveC1zaXppbmc6Ym9yZGVyLWJveDt3aWR0aDozMDBweDtwYWRkaW5nOjE1cHg7YmFja2dyb3VuZDojZWVlfS5BcHBfX2xpbmt7ZGlzcGxheTpibG9jaztwYWRkaW5nOjRweCAwO2NvbG9yOiM2NjZ9LkFwcF9fbGluazpob3Zlcntjb2xvcjojMDAwfS5BcHBfX21haW57ZmxleDoxfVwiLCBcIlwiXSk7XG5cbi8vIGV4cG9ydHNcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9jc3MtbG9hZGVyP3tcIm1pbmltaXplXCI6dHJ1ZX0hLi9zcmMvZXhhbXBsZXMvQXBwLmNzc1xuLy8gbW9kdWxlIGlkID0gNTFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIi4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2xpYi9jc3MtYmFzZS5qc1wiKSh1bmRlZmluZWQpO1xuLy8gaW1wb3J0c1xuXG5cbi8vIG1vZHVsZVxuZXhwb3J0cy5wdXNoKFttb2R1bGUuaWQsIFwiLlBhZ2VfX2hlYWRlcntwYWRkaW5nOjE1cHg7YmFja2dyb3VuZDojZGRkO2ZvbnQtc2l6ZToyZW19LlBhZ2VfX2NvbnRlbnR7ZGlzcGxheTpmbGV4O3BhZGRpbmc6MTVweH1cIiwgXCJcIl0pO1xuXG4vLyBleHBvcnRzXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vY3NzLWxvYWRlcj97XCJtaW5pbWl6ZVwiOnRydWV9IS4vc3JjL2V4YW1wbGVzL1BhZ2UuY3NzXG4vLyBtb2R1bGUgaWQgPSA1MlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKlxuU3ludGF4IGhpZ2hsaWdodGluZyB3aXRoIGxhbmd1YWdlIGF1dG9kZXRlY3Rpb24uXG5odHRwczovL2hpZ2hsaWdodGpzLm9yZy9cbiovXG5cbihmdW5jdGlvbihmYWN0b3J5KSB7XG5cbiAgLy8gRmluZCB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgZXhwb3J0IHRvIGJvdGggdGhlIGJyb3dzZXIgYW5kIHdlYiB3b3JrZXJzLlxuICB2YXIgZ2xvYmFsT2JqZWN0ID0gdHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgJiYgd2luZG93IHx8XG4gICAgICAgICAgICAgICAgICAgICB0eXBlb2Ygc2VsZiA9PT0gJ29iamVjdCcgJiYgc2VsZjtcblxuICAvLyBTZXR1cCBoaWdobGlnaHQuanMgZm9yIGRpZmZlcmVudCBlbnZpcm9ubWVudHMuIEZpcnN0IGlzIE5vZGUuanMgb3JcbiAgLy8gQ29tbW9uSlMuXG4gIGlmKHR5cGVvZiBleHBvcnRzICE9PSAndW5kZWZpbmVkJykge1xuICAgIGZhY3RvcnkoZXhwb3J0cyk7XG4gIH0gZWxzZSBpZihnbG9iYWxPYmplY3QpIHtcbiAgICAvLyBFeHBvcnQgaGxqcyBnbG9iYWxseSBldmVuIHdoZW4gdXNpbmcgQU1EIGZvciBjYXNlcyB3aGVuIHRoaXMgc2NyaXB0XG4gICAgLy8gaXMgbG9hZGVkIHdpdGggb3RoZXJzIHRoYXQgbWF5IHN0aWxsIGV4cGVjdCBhIGdsb2JhbCBobGpzLlxuICAgIGdsb2JhbE9iamVjdC5obGpzID0gZmFjdG9yeSh7fSk7XG5cbiAgICAvLyBGaW5hbGx5IHJlZ2lzdGVyIHRoZSBnbG9iYWwgaGxqcyB3aXRoIEFNRC5cbiAgICBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICAgIGRlZmluZShbXSwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBnbG9iYWxPYmplY3QuaGxqcztcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG59KGZ1bmN0aW9uKGhsanMpIHtcbiAgLy8gQ29udmVuaWVuY2UgdmFyaWFibGVzIGZvciBidWlsZC1pbiBvYmplY3RzXG4gIHZhciBBcnJheVByb3RvID0gW10sXG4gICAgICBvYmplY3RLZXlzID0gT2JqZWN0LmtleXM7XG5cbiAgLy8gR2xvYmFsIGludGVybmFsIHZhcmlhYmxlcyB1c2VkIHdpdGhpbiB0aGUgaGlnaGxpZ2h0LmpzIGxpYnJhcnkuXG4gIHZhciBsYW5ndWFnZXMgPSB7fSxcbiAgICAgIGFsaWFzZXMgICA9IHt9O1xuXG4gIC8vIFJlZ3VsYXIgZXhwcmVzc2lvbnMgdXNlZCB0aHJvdWdob3V0IHRoZSBoaWdobGlnaHQuanMgbGlicmFyeS5cbiAgdmFyIG5vSGlnaGxpZ2h0UmUgICAgPSAvXihuby0/aGlnaGxpZ2h0fHBsYWlufHRleHQpJC9pLFxuICAgICAgbGFuZ3VhZ2VQcmVmaXhSZSA9IC9cXGJsYW5nKD86dWFnZSk/LShbXFx3LV0rKVxcYi9pLFxuICAgICAgZml4TWFya3VwUmUgICAgICA9IC8oKF4oPFtePl0rPnxcXHR8KSt8KD86XFxuKSkpL2dtO1xuXG4gIHZhciBzcGFuRW5kVGFnID0gJzwvc3Bhbj4nO1xuXG4gIC8vIEdsb2JhbCBvcHRpb25zIHVzZWQgd2hlbiB3aXRoaW4gZXh0ZXJuYWwgQVBJcy4gVGhpcyBpcyBtb2RpZmllZCB3aGVuXG4gIC8vIGNhbGxpbmcgdGhlIGBobGpzLmNvbmZpZ3VyZWAgZnVuY3Rpb24uXG4gIHZhciBvcHRpb25zID0ge1xuICAgIGNsYXNzUHJlZml4OiAnaGxqcy0nLFxuICAgIHRhYlJlcGxhY2U6IG51bGwsXG4gICAgdXNlQlI6IGZhbHNlLFxuICAgIGxhbmd1YWdlczogdW5kZWZpbmVkXG4gIH07XG5cbiAgLy8gT2JqZWN0IG1hcCB0aGF0IGlzIHVzZWQgdG8gZXNjYXBlIHNvbWUgY29tbW9uIEhUTUwgY2hhcmFjdGVycy5cbiAgdmFyIGVzY2FwZVJlZ2V4TWFwID0ge1xuICAgICcmJzogJyZhbXA7JyxcbiAgICAnPCc6ICcmbHQ7JyxcbiAgICAnPic6ICcmZ3Q7J1xuICB9O1xuXG4gIC8qIFV0aWxpdHkgZnVuY3Rpb25zICovXG5cbiAgZnVuY3Rpb24gZXNjYXBlKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlLnJlcGxhY2UoL1smPD5dL2dtLCBmdW5jdGlvbihjaGFyYWN0ZXIpIHtcbiAgICAgIHJldHVybiBlc2NhcGVSZWdleE1hcFtjaGFyYWN0ZXJdO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gdGFnKG5vZGUpIHtcbiAgICByZXR1cm4gbm9kZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gdGVzdFJlKHJlLCBsZXhlbWUpIHtcbiAgICB2YXIgbWF0Y2ggPSByZSAmJiByZS5leGVjKGxleGVtZSk7XG4gICAgcmV0dXJuIG1hdGNoICYmIG1hdGNoLmluZGV4ID09PSAwO1xuICB9XG5cbiAgZnVuY3Rpb24gaXNOb3RIaWdobGlnaHRlZChsYW5ndWFnZSkge1xuICAgIHJldHVybiBub0hpZ2hsaWdodFJlLnRlc3QobGFuZ3VhZ2UpO1xuICB9XG5cbiAgZnVuY3Rpb24gYmxvY2tMYW5ndWFnZShibG9jaykge1xuICAgIHZhciBpLCBtYXRjaCwgbGVuZ3RoLCBfY2xhc3M7XG4gICAgdmFyIGNsYXNzZXMgPSBibG9jay5jbGFzc05hbWUgKyAnICc7XG5cbiAgICBjbGFzc2VzICs9IGJsb2NrLnBhcmVudE5vZGUgPyBibG9jay5wYXJlbnROb2RlLmNsYXNzTmFtZSA6ICcnO1xuXG4gICAgLy8gbGFuZ3VhZ2UtKiB0YWtlcyBwcmVjZWRlbmNlIG92ZXIgbm9uLXByZWZpeGVkIGNsYXNzIG5hbWVzLlxuICAgIG1hdGNoID0gbGFuZ3VhZ2VQcmVmaXhSZS5leGVjKGNsYXNzZXMpO1xuICAgIGlmIChtYXRjaCkge1xuICAgICAgcmV0dXJuIGdldExhbmd1YWdlKG1hdGNoWzFdKSA/IG1hdGNoWzFdIDogJ25vLWhpZ2hsaWdodCc7XG4gICAgfVxuXG4gICAgY2xhc3NlcyA9IGNsYXNzZXMuc3BsaXQoL1xccysvKTtcblxuICAgIGZvciAoaSA9IDAsIGxlbmd0aCA9IGNsYXNzZXMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIF9jbGFzcyA9IGNsYXNzZXNbaV1cblxuICAgICAgaWYgKGlzTm90SGlnaGxpZ2h0ZWQoX2NsYXNzKSB8fCBnZXRMYW5ndWFnZShfY2xhc3MpKSB7XG4gICAgICAgIHJldHVybiBfY2xhc3M7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gaW5oZXJpdChwYXJlbnQpIHsgIC8vIGluaGVyaXQocGFyZW50LCBvdmVycmlkZV9vYmosIG92ZXJyaWRlX29iaiwgLi4uKVxuICAgIHZhciBrZXk7XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIHZhciBvYmplY3RzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTtcblxuICAgIGZvciAoa2V5IGluIHBhcmVudClcbiAgICAgIHJlc3VsdFtrZXldID0gcGFyZW50W2tleV07XG4gICAgb2JqZWN0cy5mb3JFYWNoKGZ1bmN0aW9uKG9iaikge1xuICAgICAgZm9yIChrZXkgaW4gb2JqKVxuICAgICAgICByZXN1bHRba2V5XSA9IG9ialtrZXldO1xuICAgIH0pO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKiBTdHJlYW0gbWVyZ2luZyAqL1xuXG4gIGZ1bmN0aW9uIG5vZGVTdHJlYW0obm9kZSkge1xuICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAoZnVuY3Rpb24gX25vZGVTdHJlYW0obm9kZSwgb2Zmc2V0KSB7XG4gICAgICBmb3IgKHZhciBjaGlsZCA9IG5vZGUuZmlyc3RDaGlsZDsgY2hpbGQ7IGNoaWxkID0gY2hpbGQubmV4dFNpYmxpbmcpIHtcbiAgICAgICAgaWYgKGNoaWxkLm5vZGVUeXBlID09PSAzKVxuICAgICAgICAgIG9mZnNldCArPSBjaGlsZC5ub2RlVmFsdWUubGVuZ3RoO1xuICAgICAgICBlbHNlIGlmIChjaGlsZC5ub2RlVHlwZSA9PT0gMSkge1xuICAgICAgICAgIHJlc3VsdC5wdXNoKHtcbiAgICAgICAgICAgIGV2ZW50OiAnc3RhcnQnLFxuICAgICAgICAgICAgb2Zmc2V0OiBvZmZzZXQsXG4gICAgICAgICAgICBub2RlOiBjaGlsZFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIG9mZnNldCA9IF9ub2RlU3RyZWFtKGNoaWxkLCBvZmZzZXQpO1xuICAgICAgICAgIC8vIFByZXZlbnQgdm9pZCBlbGVtZW50cyBmcm9tIGhhdmluZyBhbiBlbmQgdGFnIHRoYXQgd291bGQgYWN0dWFsbHlcbiAgICAgICAgICAvLyBkb3VibGUgdGhlbSBpbiB0aGUgb3V0cHV0LiBUaGVyZSBhcmUgbW9yZSB2b2lkIGVsZW1lbnRzIGluIEhUTUxcbiAgICAgICAgICAvLyBidXQgd2UgbGlzdCBvbmx5IHRob3NlIHJlYWxpc3RpY2FsbHkgZXhwZWN0ZWQgaW4gY29kZSBkaXNwbGF5LlxuICAgICAgICAgIGlmICghdGFnKGNoaWxkKS5tYXRjaCgvYnJ8aHJ8aW1nfGlucHV0LykpIHtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKHtcbiAgICAgICAgICAgICAgZXZlbnQ6ICdzdG9wJyxcbiAgICAgICAgICAgICAgb2Zmc2V0OiBvZmZzZXQsXG4gICAgICAgICAgICAgIG5vZGU6IGNoaWxkXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBvZmZzZXQ7XG4gICAgfSkobm9kZSwgMCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIGZ1bmN0aW9uIG1lcmdlU3RyZWFtcyhvcmlnaW5hbCwgaGlnaGxpZ2h0ZWQsIHZhbHVlKSB7XG4gICAgdmFyIHByb2Nlc3NlZCA9IDA7XG4gICAgdmFyIHJlc3VsdCA9ICcnO1xuICAgIHZhciBub2RlU3RhY2sgPSBbXTtcblxuICAgIGZ1bmN0aW9uIHNlbGVjdFN0cmVhbSgpIHtcbiAgICAgIGlmICghb3JpZ2luYWwubGVuZ3RoIHx8ICFoaWdobGlnaHRlZC5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIG9yaWdpbmFsLmxlbmd0aCA/IG9yaWdpbmFsIDogaGlnaGxpZ2h0ZWQ7XG4gICAgICB9XG4gICAgICBpZiAob3JpZ2luYWxbMF0ub2Zmc2V0ICE9PSBoaWdobGlnaHRlZFswXS5vZmZzZXQpIHtcbiAgICAgICAgcmV0dXJuIChvcmlnaW5hbFswXS5vZmZzZXQgPCBoaWdobGlnaHRlZFswXS5vZmZzZXQpID8gb3JpZ2luYWwgOiBoaWdobGlnaHRlZDtcbiAgICAgIH1cblxuICAgICAgLypcbiAgICAgIFRvIGF2b2lkIHN0YXJ0aW5nIHRoZSBzdHJlYW0ganVzdCBiZWZvcmUgaXQgc2hvdWxkIHN0b3AgdGhlIG9yZGVyIGlzXG4gICAgICBlbnN1cmVkIHRoYXQgb3JpZ2luYWwgYWx3YXlzIHN0YXJ0cyBmaXJzdCBhbmQgY2xvc2VzIGxhc3Q6XG5cbiAgICAgIGlmIChldmVudDEgPT0gJ3N0YXJ0JyAmJiBldmVudDIgPT0gJ3N0YXJ0JylcbiAgICAgICAgcmV0dXJuIG9yaWdpbmFsO1xuICAgICAgaWYgKGV2ZW50MSA9PSAnc3RhcnQnICYmIGV2ZW50MiA9PSAnc3RvcCcpXG4gICAgICAgIHJldHVybiBoaWdobGlnaHRlZDtcbiAgICAgIGlmIChldmVudDEgPT0gJ3N0b3AnICYmIGV2ZW50MiA9PSAnc3RhcnQnKVxuICAgICAgICByZXR1cm4gb3JpZ2luYWw7XG4gICAgICBpZiAoZXZlbnQxID09ICdzdG9wJyAmJiBldmVudDIgPT0gJ3N0b3AnKVxuICAgICAgICByZXR1cm4gaGlnaGxpZ2h0ZWQ7XG5cbiAgICAgIC4uLiB3aGljaCBpcyBjb2xsYXBzZWQgdG86XG4gICAgICAqL1xuICAgICAgcmV0dXJuIGhpZ2hsaWdodGVkWzBdLmV2ZW50ID09PSAnc3RhcnQnID8gb3JpZ2luYWwgOiBoaWdobGlnaHRlZDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvcGVuKG5vZGUpIHtcbiAgICAgIGZ1bmN0aW9uIGF0dHJfc3RyKGEpIHtyZXR1cm4gJyAnICsgYS5ub2RlTmFtZSArICc9XCInICsgZXNjYXBlKGEudmFsdWUpICsgJ1wiJzt9XG4gICAgICByZXN1bHQgKz0gJzwnICsgdGFnKG5vZGUpICsgQXJyYXlQcm90by5tYXAuY2FsbChub2RlLmF0dHJpYnV0ZXMsIGF0dHJfc3RyKS5qb2luKCcnKSArICc+JztcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjbG9zZShub2RlKSB7XG4gICAgICByZXN1bHQgKz0gJzwvJyArIHRhZyhub2RlKSArICc+JztcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZW5kZXIoZXZlbnQpIHtcbiAgICAgIChldmVudC5ldmVudCA9PT0gJ3N0YXJ0JyA/IG9wZW4gOiBjbG9zZSkoZXZlbnQubm9kZSk7XG4gICAgfVxuXG4gICAgd2hpbGUgKG9yaWdpbmFsLmxlbmd0aCB8fCBoaWdobGlnaHRlZC5sZW5ndGgpIHtcbiAgICAgIHZhciBzdHJlYW0gPSBzZWxlY3RTdHJlYW0oKTtcbiAgICAgIHJlc3VsdCArPSBlc2NhcGUodmFsdWUuc3Vic3RyaW5nKHByb2Nlc3NlZCwgc3RyZWFtWzBdLm9mZnNldCkpO1xuICAgICAgcHJvY2Vzc2VkID0gc3RyZWFtWzBdLm9mZnNldDtcbiAgICAgIGlmIChzdHJlYW0gPT09IG9yaWdpbmFsKSB7XG4gICAgICAgIC8qXG4gICAgICAgIE9uIGFueSBvcGVuaW5nIG9yIGNsb3NpbmcgdGFnIG9mIHRoZSBvcmlnaW5hbCBtYXJrdXAgd2UgZmlyc3QgY2xvc2VcbiAgICAgICAgdGhlIGVudGlyZSBoaWdobGlnaHRlZCBub2RlIHN0YWNrLCB0aGVuIHJlbmRlciB0aGUgb3JpZ2luYWwgdGFnIGFsb25nXG4gICAgICAgIHdpdGggYWxsIHRoZSBmb2xsb3dpbmcgb3JpZ2luYWwgdGFncyBhdCB0aGUgc2FtZSBvZmZzZXQgYW5kIHRoZW5cbiAgICAgICAgcmVvcGVuIGFsbCB0aGUgdGFncyBvbiB0aGUgaGlnaGxpZ2h0ZWQgc3RhY2suXG4gICAgICAgICovXG4gICAgICAgIG5vZGVTdGFjay5yZXZlcnNlKCkuZm9yRWFjaChjbG9zZSk7XG4gICAgICAgIGRvIHtcbiAgICAgICAgICByZW5kZXIoc3RyZWFtLnNwbGljZSgwLCAxKVswXSk7XG4gICAgICAgICAgc3RyZWFtID0gc2VsZWN0U3RyZWFtKCk7XG4gICAgICAgIH0gd2hpbGUgKHN0cmVhbSA9PT0gb3JpZ2luYWwgJiYgc3RyZWFtLmxlbmd0aCAmJiBzdHJlYW1bMF0ub2Zmc2V0ID09PSBwcm9jZXNzZWQpO1xuICAgICAgICBub2RlU3RhY2sucmV2ZXJzZSgpLmZvckVhY2gob3Blbik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoc3RyZWFtWzBdLmV2ZW50ID09PSAnc3RhcnQnKSB7XG4gICAgICAgICAgbm9kZVN0YWNrLnB1c2goc3RyZWFtWzBdLm5vZGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5vZGVTdGFjay5wb3AoKTtcbiAgICAgICAgfVxuICAgICAgICByZW5kZXIoc3RyZWFtLnNwbGljZSgwLCAxKVswXSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQgKyBlc2NhcGUodmFsdWUuc3Vic3RyKHByb2Nlc3NlZCkpO1xuICB9XG5cbiAgLyogSW5pdGlhbGl6YXRpb24gKi9cblxuICBmdW5jdGlvbiBleHBhbmRfbW9kZShtb2RlKSB7XG4gICAgaWYgKG1vZGUudmFyaWFudHMgJiYgIW1vZGUuY2FjaGVkX3ZhcmlhbnRzKSB7XG4gICAgICBtb2RlLmNhY2hlZF92YXJpYW50cyA9IG1vZGUudmFyaWFudHMubWFwKGZ1bmN0aW9uKHZhcmlhbnQpIHtcbiAgICAgICAgcmV0dXJuIGluaGVyaXQobW9kZSwge3ZhcmlhbnRzOiBudWxsfSwgdmFyaWFudCk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIG1vZGUuY2FjaGVkX3ZhcmlhbnRzIHx8IChtb2RlLmVuZHNXaXRoUGFyZW50ICYmIFtpbmhlcml0KG1vZGUpXSkgfHwgW21vZGVdO1xuICB9XG5cbiAgZnVuY3Rpb24gY29tcGlsZUxhbmd1YWdlKGxhbmd1YWdlKSB7XG5cbiAgICBmdW5jdGlvbiByZVN0cihyZSkge1xuICAgICAgICByZXR1cm4gKHJlICYmIHJlLnNvdXJjZSkgfHwgcmU7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbGFuZ1JlKHZhbHVlLCBnbG9iYWwpIHtcbiAgICAgIHJldHVybiBuZXcgUmVnRXhwKFxuICAgICAgICByZVN0cih2YWx1ZSksXG4gICAgICAgICdtJyArIChsYW5ndWFnZS5jYXNlX2luc2Vuc2l0aXZlID8gJ2knIDogJycpICsgKGdsb2JhbCA/ICdnJyA6ICcnKVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb21waWxlTW9kZShtb2RlLCBwYXJlbnQpIHtcbiAgICAgIGlmIChtb2RlLmNvbXBpbGVkKVxuICAgICAgICByZXR1cm47XG4gICAgICBtb2RlLmNvbXBpbGVkID0gdHJ1ZTtcblxuICAgICAgbW9kZS5rZXl3b3JkcyA9IG1vZGUua2V5d29yZHMgfHwgbW9kZS5iZWdpbktleXdvcmRzO1xuICAgICAgaWYgKG1vZGUua2V5d29yZHMpIHtcbiAgICAgICAgdmFyIGNvbXBpbGVkX2tleXdvcmRzID0ge307XG5cbiAgICAgICAgdmFyIGZsYXR0ZW4gPSBmdW5jdGlvbihjbGFzc05hbWUsIHN0cikge1xuICAgICAgICAgIGlmIChsYW5ndWFnZS5jYXNlX2luc2Vuc2l0aXZlKSB7XG4gICAgICAgICAgICBzdHIgPSBzdHIudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgc3RyLnNwbGl0KCcgJykuZm9yRWFjaChmdW5jdGlvbihrdykge1xuICAgICAgICAgICAgdmFyIHBhaXIgPSBrdy5zcGxpdCgnfCcpO1xuICAgICAgICAgICAgY29tcGlsZWRfa2V5d29yZHNbcGFpclswXV0gPSBbY2xhc3NOYW1lLCBwYWlyWzFdID8gTnVtYmVyKHBhaXJbMV0pIDogMV07XG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKHR5cGVvZiBtb2RlLmtleXdvcmRzID09PSAnc3RyaW5nJykgeyAvLyBzdHJpbmdcbiAgICAgICAgICBmbGF0dGVuKCdrZXl3b3JkJywgbW9kZS5rZXl3b3Jkcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgb2JqZWN0S2V5cyhtb2RlLmtleXdvcmRzKS5mb3JFYWNoKGZ1bmN0aW9uIChjbGFzc05hbWUpIHtcbiAgICAgICAgICAgIGZsYXR0ZW4oY2xhc3NOYW1lLCBtb2RlLmtleXdvcmRzW2NsYXNzTmFtZV0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIG1vZGUua2V5d29yZHMgPSBjb21waWxlZF9rZXl3b3JkcztcbiAgICAgIH1cbiAgICAgIG1vZGUubGV4ZW1lc1JlID0gbGFuZ1JlKG1vZGUubGV4ZW1lcyB8fCAvXFx3Ky8sIHRydWUpO1xuXG4gICAgICBpZiAocGFyZW50KSB7XG4gICAgICAgIGlmIChtb2RlLmJlZ2luS2V5d29yZHMpIHtcbiAgICAgICAgICBtb2RlLmJlZ2luID0gJ1xcXFxiKCcgKyBtb2RlLmJlZ2luS2V5d29yZHMuc3BsaXQoJyAnKS5qb2luKCd8JykgKyAnKVxcXFxiJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoIW1vZGUuYmVnaW4pXG4gICAgICAgICAgbW9kZS5iZWdpbiA9IC9cXEJ8XFxiLztcbiAgICAgICAgbW9kZS5iZWdpblJlID0gbGFuZ1JlKG1vZGUuYmVnaW4pO1xuICAgICAgICBpZiAoIW1vZGUuZW5kICYmICFtb2RlLmVuZHNXaXRoUGFyZW50KVxuICAgICAgICAgIG1vZGUuZW5kID0gL1xcQnxcXGIvO1xuICAgICAgICBpZiAobW9kZS5lbmQpXG4gICAgICAgICAgbW9kZS5lbmRSZSA9IGxhbmdSZShtb2RlLmVuZCk7XG4gICAgICAgIG1vZGUudGVybWluYXRvcl9lbmQgPSByZVN0cihtb2RlLmVuZCkgfHwgJyc7XG4gICAgICAgIGlmIChtb2RlLmVuZHNXaXRoUGFyZW50ICYmIHBhcmVudC50ZXJtaW5hdG9yX2VuZClcbiAgICAgICAgICBtb2RlLnRlcm1pbmF0b3JfZW5kICs9IChtb2RlLmVuZCA/ICd8JyA6ICcnKSArIHBhcmVudC50ZXJtaW5hdG9yX2VuZDtcbiAgICAgIH1cbiAgICAgIGlmIChtb2RlLmlsbGVnYWwpXG4gICAgICAgIG1vZGUuaWxsZWdhbFJlID0gbGFuZ1JlKG1vZGUuaWxsZWdhbCk7XG4gICAgICBpZiAobW9kZS5yZWxldmFuY2UgPT0gbnVsbClcbiAgICAgICAgbW9kZS5yZWxldmFuY2UgPSAxO1xuICAgICAgaWYgKCFtb2RlLmNvbnRhaW5zKSB7XG4gICAgICAgIG1vZGUuY29udGFpbnMgPSBbXTtcbiAgICAgIH1cbiAgICAgIG1vZGUuY29udGFpbnMgPSBBcnJheS5wcm90b3R5cGUuY29uY2F0LmFwcGx5KFtdLCBtb2RlLmNvbnRhaW5zLm1hcChmdW5jdGlvbihjKSB7XG4gICAgICAgIHJldHVybiBleHBhbmRfbW9kZShjID09PSAnc2VsZicgPyBtb2RlIDogYylcbiAgICAgIH0pKTtcbiAgICAgIG1vZGUuY29udGFpbnMuZm9yRWFjaChmdW5jdGlvbihjKSB7Y29tcGlsZU1vZGUoYywgbW9kZSk7fSk7XG5cbiAgICAgIGlmIChtb2RlLnN0YXJ0cykge1xuICAgICAgICBjb21waWxlTW9kZShtb2RlLnN0YXJ0cywgcGFyZW50KTtcbiAgICAgIH1cblxuICAgICAgdmFyIHRlcm1pbmF0b3JzID1cbiAgICAgICAgbW9kZS5jb250YWlucy5tYXAoZnVuY3Rpb24oYykge1xuICAgICAgICAgIHJldHVybiBjLmJlZ2luS2V5d29yZHMgPyAnXFxcXC4/KCcgKyBjLmJlZ2luICsgJylcXFxcLj8nIDogYy5iZWdpbjtcbiAgICAgICAgfSlcbiAgICAgICAgLmNvbmNhdChbbW9kZS50ZXJtaW5hdG9yX2VuZCwgbW9kZS5pbGxlZ2FsXSlcbiAgICAgICAgLm1hcChyZVN0cilcbiAgICAgICAgLmZpbHRlcihCb29sZWFuKTtcbiAgICAgIG1vZGUudGVybWluYXRvcnMgPSB0ZXJtaW5hdG9ycy5sZW5ndGggPyBsYW5nUmUodGVybWluYXRvcnMuam9pbignfCcpLCB0cnVlKSA6IHtleGVjOiBmdW5jdGlvbigvKnMqLykge3JldHVybiBudWxsO319O1xuICAgIH1cblxuICAgIGNvbXBpbGVNb2RlKGxhbmd1YWdlKTtcbiAgfVxuXG4gIC8qXG4gIENvcmUgaGlnaGxpZ2h0aW5nIGZ1bmN0aW9uLiBBY2NlcHRzIGEgbGFuZ3VhZ2UgbmFtZSwgb3IgYW4gYWxpYXMsIGFuZCBhXG4gIHN0cmluZyB3aXRoIHRoZSBjb2RlIHRvIGhpZ2hsaWdodC4gUmV0dXJucyBhbiBvYmplY3Qgd2l0aCB0aGUgZm9sbG93aW5nXG4gIHByb3BlcnRpZXM6XG5cbiAgLSByZWxldmFuY2UgKGludClcbiAgLSB2YWx1ZSAoYW4gSFRNTCBzdHJpbmcgd2l0aCBoaWdobGlnaHRpbmcgbWFya3VwKVxuXG4gICovXG4gIGZ1bmN0aW9uIGhpZ2hsaWdodChuYW1lLCB2YWx1ZSwgaWdub3JlX2lsbGVnYWxzLCBjb250aW51YXRpb24pIHtcblxuICAgIGZ1bmN0aW9uIHN1Yk1vZGUobGV4ZW1lLCBtb2RlKSB7XG4gICAgICB2YXIgaSwgbGVuZ3RoO1xuXG4gICAgICBmb3IgKGkgPSAwLCBsZW5ndGggPSBtb2RlLmNvbnRhaW5zLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmICh0ZXN0UmUobW9kZS5jb250YWluc1tpXS5iZWdpblJlLCBsZXhlbWUpKSB7XG4gICAgICAgICAgcmV0dXJuIG1vZGUuY29udGFpbnNbaV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBlbmRPZk1vZGUobW9kZSwgbGV4ZW1lKSB7XG4gICAgICBpZiAodGVzdFJlKG1vZGUuZW5kUmUsIGxleGVtZSkpIHtcbiAgICAgICAgd2hpbGUgKG1vZGUuZW5kc1BhcmVudCAmJiBtb2RlLnBhcmVudCkge1xuICAgICAgICAgIG1vZGUgPSBtb2RlLnBhcmVudDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbW9kZTtcbiAgICAgIH1cbiAgICAgIGlmIChtb2RlLmVuZHNXaXRoUGFyZW50KSB7XG4gICAgICAgIHJldHVybiBlbmRPZk1vZGUobW9kZS5wYXJlbnQsIGxleGVtZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaXNJbGxlZ2FsKGxleGVtZSwgbW9kZSkge1xuICAgICAgcmV0dXJuICFpZ25vcmVfaWxsZWdhbHMgJiYgdGVzdFJlKG1vZGUuaWxsZWdhbFJlLCBsZXhlbWUpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGtleXdvcmRNYXRjaChtb2RlLCBtYXRjaCkge1xuICAgICAgdmFyIG1hdGNoX3N0ciA9IGxhbmd1YWdlLmNhc2VfaW5zZW5zaXRpdmUgPyBtYXRjaFswXS50b0xvd2VyQ2FzZSgpIDogbWF0Y2hbMF07XG4gICAgICByZXR1cm4gbW9kZS5rZXl3b3Jkcy5oYXNPd25Qcm9wZXJ0eShtYXRjaF9zdHIpICYmIG1vZGUua2V5d29yZHNbbWF0Y2hfc3RyXTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBidWlsZFNwYW4oY2xhc3NuYW1lLCBpbnNpZGVTcGFuLCBsZWF2ZU9wZW4sIG5vUHJlZml4KSB7XG4gICAgICB2YXIgY2xhc3NQcmVmaXggPSBub1ByZWZpeCA/ICcnIDogb3B0aW9ucy5jbGFzc1ByZWZpeCxcbiAgICAgICAgICBvcGVuU3BhbiAgICA9ICc8c3BhbiBjbGFzcz1cIicgKyBjbGFzc1ByZWZpeCxcbiAgICAgICAgICBjbG9zZVNwYW4gICA9IGxlYXZlT3BlbiA/ICcnIDogc3BhbkVuZFRhZ1xuXG4gICAgICBvcGVuU3BhbiArPSBjbGFzc25hbWUgKyAnXCI+JztcblxuICAgICAgcmV0dXJuIG9wZW5TcGFuICsgaW5zaWRlU3BhbiArIGNsb3NlU3BhbjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwcm9jZXNzS2V5d29yZHMoKSB7XG4gICAgICB2YXIga2V5d29yZF9tYXRjaCwgbGFzdF9pbmRleCwgbWF0Y2gsIHJlc3VsdDtcblxuICAgICAgaWYgKCF0b3Aua2V5d29yZHMpXG4gICAgICAgIHJldHVybiBlc2NhcGUobW9kZV9idWZmZXIpO1xuXG4gICAgICByZXN1bHQgPSAnJztcbiAgICAgIGxhc3RfaW5kZXggPSAwO1xuICAgICAgdG9wLmxleGVtZXNSZS5sYXN0SW5kZXggPSAwO1xuICAgICAgbWF0Y2ggPSB0b3AubGV4ZW1lc1JlLmV4ZWMobW9kZV9idWZmZXIpO1xuXG4gICAgICB3aGlsZSAobWF0Y2gpIHtcbiAgICAgICAgcmVzdWx0ICs9IGVzY2FwZShtb2RlX2J1ZmZlci5zdWJzdHJpbmcobGFzdF9pbmRleCwgbWF0Y2guaW5kZXgpKTtcbiAgICAgICAga2V5d29yZF9tYXRjaCA9IGtleXdvcmRNYXRjaCh0b3AsIG1hdGNoKTtcbiAgICAgICAgaWYgKGtleXdvcmRfbWF0Y2gpIHtcbiAgICAgICAgICByZWxldmFuY2UgKz0ga2V5d29yZF9tYXRjaFsxXTtcbiAgICAgICAgICByZXN1bHQgKz0gYnVpbGRTcGFuKGtleXdvcmRfbWF0Y2hbMF0sIGVzY2FwZShtYXRjaFswXSkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc3VsdCArPSBlc2NhcGUobWF0Y2hbMF0pO1xuICAgICAgICB9XG4gICAgICAgIGxhc3RfaW5kZXggPSB0b3AubGV4ZW1lc1JlLmxhc3RJbmRleDtcbiAgICAgICAgbWF0Y2ggPSB0b3AubGV4ZW1lc1JlLmV4ZWMobW9kZV9idWZmZXIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdCArIGVzY2FwZShtb2RlX2J1ZmZlci5zdWJzdHIobGFzdF9pbmRleCkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHByb2Nlc3NTdWJMYW5ndWFnZSgpIHtcbiAgICAgIHZhciBleHBsaWNpdCA9IHR5cGVvZiB0b3Auc3ViTGFuZ3VhZ2UgPT09ICdzdHJpbmcnO1xuICAgICAgaWYgKGV4cGxpY2l0ICYmICFsYW5ndWFnZXNbdG9wLnN1Ykxhbmd1YWdlXSkge1xuICAgICAgICByZXR1cm4gZXNjYXBlKG1vZGVfYnVmZmVyKTtcbiAgICAgIH1cblxuICAgICAgdmFyIHJlc3VsdCA9IGV4cGxpY2l0ID9cbiAgICAgICAgICAgICAgICAgICBoaWdobGlnaHQodG9wLnN1Ykxhbmd1YWdlLCBtb2RlX2J1ZmZlciwgdHJ1ZSwgY29udGludWF0aW9uc1t0b3Auc3ViTGFuZ3VhZ2VdKSA6XG4gICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0QXV0byhtb2RlX2J1ZmZlciwgdG9wLnN1Ykxhbmd1YWdlLmxlbmd0aCA/IHRvcC5zdWJMYW5ndWFnZSA6IHVuZGVmaW5lZCk7XG5cbiAgICAgIC8vIENvdW50aW5nIGVtYmVkZGVkIGxhbmd1YWdlIHNjb3JlIHRvd2FyZHMgdGhlIGhvc3QgbGFuZ3VhZ2UgbWF5IGJlIGRpc2FibGVkXG4gICAgICAvLyB3aXRoIHplcm9pbmcgdGhlIGNvbnRhaW5pbmcgbW9kZSByZWxldmFuY2UuIFVzZWNhc2UgaW4gcG9pbnQgaXMgTWFya2Rvd24gdGhhdFxuICAgICAgLy8gYWxsb3dzIFhNTCBldmVyeXdoZXJlIGFuZCBtYWtlcyBldmVyeSBYTUwgc25pcHBldCB0byBoYXZlIGEgbXVjaCBsYXJnZXIgTWFya2Rvd25cbiAgICAgIC8vIHNjb3JlLlxuICAgICAgaWYgKHRvcC5yZWxldmFuY2UgPiAwKSB7XG4gICAgICAgIHJlbGV2YW5jZSArPSByZXN1bHQucmVsZXZhbmNlO1xuICAgICAgfVxuICAgICAgaWYgKGV4cGxpY2l0KSB7XG4gICAgICAgIGNvbnRpbnVhdGlvbnNbdG9wLnN1Ykxhbmd1YWdlXSA9IHJlc3VsdC50b3A7XG4gICAgICB9XG4gICAgICByZXR1cm4gYnVpbGRTcGFuKHJlc3VsdC5sYW5ndWFnZSwgcmVzdWx0LnZhbHVlLCBmYWxzZSwgdHJ1ZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcHJvY2Vzc0J1ZmZlcigpIHtcbiAgICAgIHJlc3VsdCArPSAodG9wLnN1Ykxhbmd1YWdlICE9IG51bGwgPyBwcm9jZXNzU3ViTGFuZ3VhZ2UoKSA6IHByb2Nlc3NLZXl3b3JkcygpKTtcbiAgICAgIG1vZGVfYnVmZmVyID0gJyc7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3RhcnROZXdNb2RlKG1vZGUpIHtcbiAgICAgIHJlc3VsdCArPSBtb2RlLmNsYXNzTmFtZT8gYnVpbGRTcGFuKG1vZGUuY2xhc3NOYW1lLCAnJywgdHJ1ZSk6ICcnO1xuICAgICAgdG9wID0gT2JqZWN0LmNyZWF0ZShtb2RlLCB7cGFyZW50OiB7dmFsdWU6IHRvcH19KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwcm9jZXNzTGV4ZW1lKGJ1ZmZlciwgbGV4ZW1lKSB7XG5cbiAgICAgIG1vZGVfYnVmZmVyICs9IGJ1ZmZlcjtcblxuICAgICAgaWYgKGxleGVtZSA9PSBudWxsKSB7XG4gICAgICAgIHByb2Nlc3NCdWZmZXIoKTtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9XG5cbiAgICAgIHZhciBuZXdfbW9kZSA9IHN1Yk1vZGUobGV4ZW1lLCB0b3ApO1xuICAgICAgaWYgKG5ld19tb2RlKSB7XG4gICAgICAgIGlmIChuZXdfbW9kZS5za2lwKSB7XG4gICAgICAgICAgbW9kZV9idWZmZXIgKz0gbGV4ZW1lO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChuZXdfbW9kZS5leGNsdWRlQmVnaW4pIHtcbiAgICAgICAgICAgIG1vZGVfYnVmZmVyICs9IGxleGVtZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcHJvY2Vzc0J1ZmZlcigpO1xuICAgICAgICAgIGlmICghbmV3X21vZGUucmV0dXJuQmVnaW4gJiYgIW5ld19tb2RlLmV4Y2x1ZGVCZWdpbikge1xuICAgICAgICAgICAgbW9kZV9idWZmZXIgPSBsZXhlbWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHN0YXJ0TmV3TW9kZShuZXdfbW9kZSwgbGV4ZW1lKTtcbiAgICAgICAgcmV0dXJuIG5ld19tb2RlLnJldHVybkJlZ2luID8gMCA6IGxleGVtZS5sZW5ndGg7XG4gICAgICB9XG5cbiAgICAgIHZhciBlbmRfbW9kZSA9IGVuZE9mTW9kZSh0b3AsIGxleGVtZSk7XG4gICAgICBpZiAoZW5kX21vZGUpIHtcbiAgICAgICAgdmFyIG9yaWdpbiA9IHRvcDtcbiAgICAgICAgaWYgKG9yaWdpbi5za2lwKSB7XG4gICAgICAgICAgbW9kZV9idWZmZXIgKz0gbGV4ZW1lO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICghKG9yaWdpbi5yZXR1cm5FbmQgfHwgb3JpZ2luLmV4Y2x1ZGVFbmQpKSB7XG4gICAgICAgICAgICBtb2RlX2J1ZmZlciArPSBsZXhlbWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIHByb2Nlc3NCdWZmZXIoKTtcbiAgICAgICAgICBpZiAob3JpZ2luLmV4Y2x1ZGVFbmQpIHtcbiAgICAgICAgICAgIG1vZGVfYnVmZmVyID0gbGV4ZW1lO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBkbyB7XG4gICAgICAgICAgaWYgKHRvcC5jbGFzc05hbWUpIHtcbiAgICAgICAgICAgIHJlc3VsdCArPSBzcGFuRW5kVGFnO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIXRvcC5za2lwKSB7XG4gICAgICAgICAgICByZWxldmFuY2UgKz0gdG9wLnJlbGV2YW5jZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdG9wID0gdG9wLnBhcmVudDtcbiAgICAgICAgfSB3aGlsZSAodG9wICE9PSBlbmRfbW9kZS5wYXJlbnQpO1xuICAgICAgICBpZiAoZW5kX21vZGUuc3RhcnRzKSB7XG4gICAgICAgICAgc3RhcnROZXdNb2RlKGVuZF9tb2RlLnN0YXJ0cywgJycpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvcmlnaW4ucmV0dXJuRW5kID8gMCA6IGxleGVtZS5sZW5ndGg7XG4gICAgICB9XG5cbiAgICAgIGlmIChpc0lsbGVnYWwobGV4ZW1lLCB0b3ApKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0lsbGVnYWwgbGV4ZW1lIFwiJyArIGxleGVtZSArICdcIiBmb3IgbW9kZSBcIicgKyAodG9wLmNsYXNzTmFtZSB8fCAnPHVubmFtZWQ+JykgKyAnXCInKTtcblxuICAgICAgLypcbiAgICAgIFBhcnNlciBzaG91bGQgbm90IHJlYWNoIHRoaXMgcG9pbnQgYXMgYWxsIHR5cGVzIG9mIGxleGVtZXMgc2hvdWxkIGJlIGNhdWdodFxuICAgICAgZWFybGllciwgYnV0IGlmIGl0IGRvZXMgZHVlIHRvIHNvbWUgYnVnIG1ha2Ugc3VyZSBpdCBhZHZhbmNlcyBhdCBsZWFzdCBvbmVcbiAgICAgIGNoYXJhY3RlciBmb3J3YXJkIHRvIHByZXZlbnQgaW5maW5pdGUgbG9vcGluZy5cbiAgICAgICovXG4gICAgICBtb2RlX2J1ZmZlciArPSBsZXhlbWU7XG4gICAgICByZXR1cm4gbGV4ZW1lLmxlbmd0aCB8fCAxO1xuICAgIH1cblxuICAgIHZhciBsYW5ndWFnZSA9IGdldExhbmd1YWdlKG5hbWUpO1xuICAgIGlmICghbGFuZ3VhZ2UpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignVW5rbm93biBsYW5ndWFnZTogXCInICsgbmFtZSArICdcIicpO1xuICAgIH1cblxuICAgIGNvbXBpbGVMYW5ndWFnZShsYW5ndWFnZSk7XG4gICAgdmFyIHRvcCA9IGNvbnRpbnVhdGlvbiB8fCBsYW5ndWFnZTtcbiAgICB2YXIgY29udGludWF0aW9ucyA9IHt9OyAvLyBrZWVwIGNvbnRpbnVhdGlvbnMgZm9yIHN1Yi1sYW5ndWFnZXNcbiAgICB2YXIgcmVzdWx0ID0gJycsIGN1cnJlbnQ7XG4gICAgZm9yKGN1cnJlbnQgPSB0b3A7IGN1cnJlbnQgIT09IGxhbmd1YWdlOyBjdXJyZW50ID0gY3VycmVudC5wYXJlbnQpIHtcbiAgICAgIGlmIChjdXJyZW50LmNsYXNzTmFtZSkge1xuICAgICAgICByZXN1bHQgPSBidWlsZFNwYW4oY3VycmVudC5jbGFzc05hbWUsICcnLCB0cnVlKSArIHJlc3VsdDtcbiAgICAgIH1cbiAgICB9XG4gICAgdmFyIG1vZGVfYnVmZmVyID0gJyc7XG4gICAgdmFyIHJlbGV2YW5jZSA9IDA7XG4gICAgdHJ5IHtcbiAgICAgIHZhciBtYXRjaCwgY291bnQsIGluZGV4ID0gMDtcbiAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgIHRvcC50ZXJtaW5hdG9ycy5sYXN0SW5kZXggPSBpbmRleDtcbiAgICAgICAgbWF0Y2ggPSB0b3AudGVybWluYXRvcnMuZXhlYyh2YWx1ZSk7XG4gICAgICAgIGlmICghbWF0Y2gpXG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNvdW50ID0gcHJvY2Vzc0xleGVtZSh2YWx1ZS5zdWJzdHJpbmcoaW5kZXgsIG1hdGNoLmluZGV4KSwgbWF0Y2hbMF0pO1xuICAgICAgICBpbmRleCA9IG1hdGNoLmluZGV4ICsgY291bnQ7XG4gICAgICB9XG4gICAgICBwcm9jZXNzTGV4ZW1lKHZhbHVlLnN1YnN0cihpbmRleCkpO1xuICAgICAgZm9yKGN1cnJlbnQgPSB0b3A7IGN1cnJlbnQucGFyZW50OyBjdXJyZW50ID0gY3VycmVudC5wYXJlbnQpIHsgLy8gY2xvc2UgZGFuZ2xpbmcgbW9kZXNcbiAgICAgICAgaWYgKGN1cnJlbnQuY2xhc3NOYW1lKSB7XG4gICAgICAgICAgcmVzdWx0ICs9IHNwYW5FbmRUYWc7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHJlbGV2YW5jZTogcmVsZXZhbmNlLFxuICAgICAgICB2YWx1ZTogcmVzdWx0LFxuICAgICAgICBsYW5ndWFnZTogbmFtZSxcbiAgICAgICAgdG9wOiB0b3BcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgaWYgKGUubWVzc2FnZSAmJiBlLm1lc3NhZ2UuaW5kZXhPZignSWxsZWdhbCcpICE9PSAtMSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHJlbGV2YW5jZTogMCxcbiAgICAgICAgICB2YWx1ZTogZXNjYXBlKHZhbHVlKVxuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKlxuICBIaWdobGlnaHRpbmcgd2l0aCBsYW5ndWFnZSBkZXRlY3Rpb24uIEFjY2VwdHMgYSBzdHJpbmcgd2l0aCB0aGUgY29kZSB0b1xuICBoaWdobGlnaHQuIFJldHVybnMgYW4gb2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzOlxuXG4gIC0gbGFuZ3VhZ2UgKGRldGVjdGVkIGxhbmd1YWdlKVxuICAtIHJlbGV2YW5jZSAoaW50KVxuICAtIHZhbHVlIChhbiBIVE1MIHN0cmluZyB3aXRoIGhpZ2hsaWdodGluZyBtYXJrdXApXG4gIC0gc2Vjb25kX2Jlc3QgKG9iamVjdCB3aXRoIHRoZSBzYW1lIHN0cnVjdHVyZSBmb3Igc2Vjb25kLWJlc3QgaGV1cmlzdGljYWxseVxuICAgIGRldGVjdGVkIGxhbmd1YWdlLCBtYXkgYmUgYWJzZW50KVxuXG4gICovXG4gIGZ1bmN0aW9uIGhpZ2hsaWdodEF1dG8odGV4dCwgbGFuZ3VhZ2VTdWJzZXQpIHtcbiAgICBsYW5ndWFnZVN1YnNldCA9IGxhbmd1YWdlU3Vic2V0IHx8IG9wdGlvbnMubGFuZ3VhZ2VzIHx8IG9iamVjdEtleXMobGFuZ3VhZ2VzKTtcbiAgICB2YXIgcmVzdWx0ID0ge1xuICAgICAgcmVsZXZhbmNlOiAwLFxuICAgICAgdmFsdWU6IGVzY2FwZSh0ZXh0KVxuICAgIH07XG4gICAgdmFyIHNlY29uZF9iZXN0ID0gcmVzdWx0O1xuICAgIGxhbmd1YWdlU3Vic2V0LmZpbHRlcihnZXRMYW5ndWFnZSkuZm9yRWFjaChmdW5jdGlvbihuYW1lKSB7XG4gICAgICB2YXIgY3VycmVudCA9IGhpZ2hsaWdodChuYW1lLCB0ZXh0LCBmYWxzZSk7XG4gICAgICBjdXJyZW50Lmxhbmd1YWdlID0gbmFtZTtcbiAgICAgIGlmIChjdXJyZW50LnJlbGV2YW5jZSA+IHNlY29uZF9iZXN0LnJlbGV2YW5jZSkge1xuICAgICAgICBzZWNvbmRfYmVzdCA9IGN1cnJlbnQ7XG4gICAgICB9XG4gICAgICBpZiAoY3VycmVudC5yZWxldmFuY2UgPiByZXN1bHQucmVsZXZhbmNlKSB7XG4gICAgICAgIHNlY29uZF9iZXN0ID0gcmVzdWx0O1xuICAgICAgICByZXN1bHQgPSBjdXJyZW50O1xuICAgICAgfVxuICAgIH0pO1xuICAgIGlmIChzZWNvbmRfYmVzdC5sYW5ndWFnZSkge1xuICAgICAgcmVzdWx0LnNlY29uZF9iZXN0ID0gc2Vjb25kX2Jlc3Q7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKlxuICBQb3N0LXByb2Nlc3Npbmcgb2YgdGhlIGhpZ2hsaWdodGVkIG1hcmt1cDpcblxuICAtIHJlcGxhY2UgVEFCcyB3aXRoIHNvbWV0aGluZyBtb3JlIHVzZWZ1bFxuICAtIHJlcGxhY2UgcmVhbCBsaW5lLWJyZWFrcyB3aXRoICc8YnI+JyBmb3Igbm9uLXByZSBjb250YWluZXJzXG5cbiAgKi9cbiAgZnVuY3Rpb24gZml4TWFya3VwKHZhbHVlKSB7XG4gICAgcmV0dXJuICEob3B0aW9ucy50YWJSZXBsYWNlIHx8IG9wdGlvbnMudXNlQlIpXG4gICAgICA/IHZhbHVlXG4gICAgICA6IHZhbHVlLnJlcGxhY2UoZml4TWFya3VwUmUsIGZ1bmN0aW9uKG1hdGNoLCBwMSkge1xuICAgICAgICAgIGlmIChvcHRpb25zLnVzZUJSICYmIG1hdGNoID09PSAnXFxuJykge1xuICAgICAgICAgICAgcmV0dXJuICc8YnI+JztcbiAgICAgICAgICB9IGVsc2UgaWYgKG9wdGlvbnMudGFiUmVwbGFjZSkge1xuICAgICAgICAgICAgcmV0dXJuIHAxLnJlcGxhY2UoL1xcdC9nLCBvcHRpb25zLnRhYlJlcGxhY2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGJ1aWxkQ2xhc3NOYW1lKHByZXZDbGFzc05hbWUsIGN1cnJlbnRMYW5nLCByZXN1bHRMYW5nKSB7XG4gICAgdmFyIGxhbmd1YWdlID0gY3VycmVudExhbmcgPyBhbGlhc2VzW2N1cnJlbnRMYW5nXSA6IHJlc3VsdExhbmcsXG4gICAgICAgIHJlc3VsdCAgID0gW3ByZXZDbGFzc05hbWUudHJpbSgpXTtcblxuICAgIGlmICghcHJldkNsYXNzTmFtZS5tYXRjaCgvXFxiaGxqc1xcYi8pKSB7XG4gICAgICByZXN1bHQucHVzaCgnaGxqcycpO1xuICAgIH1cblxuICAgIGlmIChwcmV2Q2xhc3NOYW1lLmluZGV4T2YobGFuZ3VhZ2UpID09PSAtMSkge1xuICAgICAgcmVzdWx0LnB1c2gobGFuZ3VhZ2UpO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQuam9pbignICcpLnRyaW0oKTtcbiAgfVxuXG4gIC8qXG4gIEFwcGxpZXMgaGlnaGxpZ2h0aW5nIHRvIGEgRE9NIG5vZGUgY29udGFpbmluZyBjb2RlLiBBY2NlcHRzIGEgRE9NIG5vZGUgYW5kXG4gIHR3byBvcHRpb25hbCBwYXJhbWV0ZXJzIGZvciBmaXhNYXJrdXAuXG4gICovXG4gIGZ1bmN0aW9uIGhpZ2hsaWdodEJsb2NrKGJsb2NrKSB7XG4gICAgdmFyIG5vZGUsIG9yaWdpbmFsU3RyZWFtLCByZXN1bHQsIHJlc3VsdE5vZGUsIHRleHQ7XG4gICAgdmFyIGxhbmd1YWdlID0gYmxvY2tMYW5ndWFnZShibG9jayk7XG5cbiAgICBpZiAoaXNOb3RIaWdobGlnaHRlZChsYW5ndWFnZSkpXG4gICAgICAgIHJldHVybjtcblxuICAgIGlmIChvcHRpb25zLnVzZUJSKSB7XG4gICAgICBub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sJywgJ2RpdicpO1xuICAgICAgbm9kZS5pbm5lckhUTUwgPSBibG9jay5pbm5lckhUTUwucmVwbGFjZSgvXFxuL2csICcnKS5yZXBsYWNlKC88YnJbIFxcL10qPi9nLCAnXFxuJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG5vZGUgPSBibG9jaztcbiAgICB9XG4gICAgdGV4dCA9IG5vZGUudGV4dENvbnRlbnQ7XG4gICAgcmVzdWx0ID0gbGFuZ3VhZ2UgPyBoaWdobGlnaHQobGFuZ3VhZ2UsIHRleHQsIHRydWUpIDogaGlnaGxpZ2h0QXV0byh0ZXh0KTtcblxuICAgIG9yaWdpbmFsU3RyZWFtID0gbm9kZVN0cmVhbShub2RlKTtcbiAgICBpZiAob3JpZ2luYWxTdHJlYW0ubGVuZ3RoKSB7XG4gICAgICByZXN1bHROb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sJywgJ2RpdicpO1xuICAgICAgcmVzdWx0Tm9kZS5pbm5lckhUTUwgPSByZXN1bHQudmFsdWU7XG4gICAgICByZXN1bHQudmFsdWUgPSBtZXJnZVN0cmVhbXMob3JpZ2luYWxTdHJlYW0sIG5vZGVTdHJlYW0ocmVzdWx0Tm9kZSksIHRleHQpO1xuICAgIH1cbiAgICByZXN1bHQudmFsdWUgPSBmaXhNYXJrdXAocmVzdWx0LnZhbHVlKTtcblxuICAgIGJsb2NrLmlubmVySFRNTCA9IHJlc3VsdC52YWx1ZTtcbiAgICBibG9jay5jbGFzc05hbWUgPSBidWlsZENsYXNzTmFtZShibG9jay5jbGFzc05hbWUsIGxhbmd1YWdlLCByZXN1bHQubGFuZ3VhZ2UpO1xuICAgIGJsb2NrLnJlc3VsdCA9IHtcbiAgICAgIGxhbmd1YWdlOiByZXN1bHQubGFuZ3VhZ2UsXG4gICAgICByZTogcmVzdWx0LnJlbGV2YW5jZVxuICAgIH07XG4gICAgaWYgKHJlc3VsdC5zZWNvbmRfYmVzdCkge1xuICAgICAgYmxvY2suc2Vjb25kX2Jlc3QgPSB7XG4gICAgICAgIGxhbmd1YWdlOiByZXN1bHQuc2Vjb25kX2Jlc3QubGFuZ3VhZ2UsXG4gICAgICAgIHJlOiByZXN1bHQuc2Vjb25kX2Jlc3QucmVsZXZhbmNlXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8qXG4gIFVwZGF0ZXMgaGlnaGxpZ2h0LmpzIGdsb2JhbCBvcHRpb25zIHdpdGggdmFsdWVzIHBhc3NlZCBpbiB0aGUgZm9ybSBvZiBhbiBvYmplY3QuXG4gICovXG4gIGZ1bmN0aW9uIGNvbmZpZ3VyZSh1c2VyX29wdGlvbnMpIHtcbiAgICBvcHRpb25zID0gaW5oZXJpdChvcHRpb25zLCB1c2VyX29wdGlvbnMpO1xuICB9XG5cbiAgLypcbiAgQXBwbGllcyBoaWdobGlnaHRpbmcgdG8gYWxsIDxwcmU+PGNvZGU+Li48L2NvZGU+PC9wcmU+IGJsb2NrcyBvbiBhIHBhZ2UuXG4gICovXG4gIGZ1bmN0aW9uIGluaXRIaWdobGlnaHRpbmcoKSB7XG4gICAgaWYgKGluaXRIaWdobGlnaHRpbmcuY2FsbGVkKVxuICAgICAgcmV0dXJuO1xuICAgIGluaXRIaWdobGlnaHRpbmcuY2FsbGVkID0gdHJ1ZTtcblxuICAgIHZhciBibG9ja3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdwcmUgY29kZScpO1xuICAgIEFycmF5UHJvdG8uZm9yRWFjaC5jYWxsKGJsb2NrcywgaGlnaGxpZ2h0QmxvY2spO1xuICB9XG5cbiAgLypcbiAgQXR0YWNoZXMgaGlnaGxpZ2h0aW5nIHRvIHRoZSBwYWdlIGxvYWQgZXZlbnQuXG4gICovXG4gIGZ1bmN0aW9uIGluaXRIaWdobGlnaHRpbmdPbkxvYWQoKSB7XG4gICAgYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGluaXRIaWdobGlnaHRpbmcsIGZhbHNlKTtcbiAgICBhZGRFdmVudExpc3RlbmVyKCdsb2FkJywgaW5pdEhpZ2hsaWdodGluZywgZmFsc2UpO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVnaXN0ZXJMYW5ndWFnZShuYW1lLCBsYW5ndWFnZSkge1xuICAgIHZhciBsYW5nID0gbGFuZ3VhZ2VzW25hbWVdID0gbGFuZ3VhZ2UoaGxqcyk7XG4gICAgaWYgKGxhbmcuYWxpYXNlcykge1xuICAgICAgbGFuZy5hbGlhc2VzLmZvckVhY2goZnVuY3Rpb24oYWxpYXMpIHthbGlhc2VzW2FsaWFzXSA9IG5hbWU7fSk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gbGlzdExhbmd1YWdlcygpIHtcbiAgICByZXR1cm4gb2JqZWN0S2V5cyhsYW5ndWFnZXMpO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0TGFuZ3VhZ2UobmFtZSkge1xuICAgIG5hbWUgPSAobmFtZSB8fCAnJykudG9Mb3dlckNhc2UoKTtcbiAgICByZXR1cm4gbGFuZ3VhZ2VzW25hbWVdIHx8IGxhbmd1YWdlc1thbGlhc2VzW25hbWVdXTtcbiAgfVxuXG4gIC8qIEludGVyZmFjZSBkZWZpbml0aW9uICovXG5cbiAgaGxqcy5oaWdobGlnaHQgPSBoaWdobGlnaHQ7XG4gIGhsanMuaGlnaGxpZ2h0QXV0byA9IGhpZ2hsaWdodEF1dG87XG4gIGhsanMuZml4TWFya3VwID0gZml4TWFya3VwO1xuICBobGpzLmhpZ2hsaWdodEJsb2NrID0gaGlnaGxpZ2h0QmxvY2s7XG4gIGhsanMuY29uZmlndXJlID0gY29uZmlndXJlO1xuICBobGpzLmluaXRIaWdobGlnaHRpbmcgPSBpbml0SGlnaGxpZ2h0aW5nO1xuICBobGpzLmluaXRIaWdobGlnaHRpbmdPbkxvYWQgPSBpbml0SGlnaGxpZ2h0aW5nT25Mb2FkO1xuICBobGpzLnJlZ2lzdGVyTGFuZ3VhZ2UgPSByZWdpc3Rlckxhbmd1YWdlO1xuICBobGpzLmxpc3RMYW5ndWFnZXMgPSBsaXN0TGFuZ3VhZ2VzO1xuICBobGpzLmdldExhbmd1YWdlID0gZ2V0TGFuZ3VhZ2U7XG4gIGhsanMuaW5oZXJpdCA9IGluaGVyaXQ7XG5cbiAgLy8gQ29tbW9uIHJlZ2V4cHNcbiAgaGxqcy5JREVOVF9SRSA9ICdbYS16QS1aXVxcXFx3Kic7XG4gIGhsanMuVU5ERVJTQ09SRV9JREVOVF9SRSA9ICdbYS16QS1aX11cXFxcdyonO1xuICBobGpzLk5VTUJFUl9SRSA9ICdcXFxcYlxcXFxkKyhcXFxcLlxcXFxkKyk/JztcbiAgaGxqcy5DX05VTUJFUl9SRSA9ICcoLT8pKFxcXFxiMFt4WF1bYS1mQS1GMC05XSt8KFxcXFxiXFxcXGQrKFxcXFwuXFxcXGQqKT98XFxcXC5cXFxcZCspKFtlRV1bLStdP1xcXFxkKyk/KSc7IC8vIDB4Li4uLCAwLi4uLCBkZWNpbWFsLCBmbG9hdFxuICBobGpzLkJJTkFSWV9OVU1CRVJfUkUgPSAnXFxcXGIoMGJbMDFdKyknOyAvLyAwYi4uLlxuICBobGpzLlJFX1NUQVJURVJTX1JFID0gJyF8IT18IT09fCV8JT18JnwmJnwmPXxcXFxcKnxcXFxcKj18XFxcXCt8XFxcXCs9fCx8LXwtPXwvPXwvfDp8O3w8PHw8PD18PD18PHw9PT18PT18PXw+Pj49fD4+PXw+PXw+Pj58Pj58PnxcXFxcP3xcXFxcW3xcXFxce3xcXFxcKHxcXFxcXnxcXFxcXj18XFxcXHx8XFxcXHw9fFxcXFx8XFxcXHx8fic7XG5cbiAgLy8gQ29tbW9uIG1vZGVzXG4gIGhsanMuQkFDS1NMQVNIX0VTQ0FQRSA9IHtcbiAgICBiZWdpbjogJ1xcXFxcXFxcW1xcXFxzXFxcXFNdJywgcmVsZXZhbmNlOiAwXG4gIH07XG4gIGhsanMuQVBPU19TVFJJTkdfTU9ERSA9IHtcbiAgICBjbGFzc05hbWU6ICdzdHJpbmcnLFxuICAgIGJlZ2luOiAnXFwnJywgZW5kOiAnXFwnJyxcbiAgICBpbGxlZ2FsOiAnXFxcXG4nLFxuICAgIGNvbnRhaW5zOiBbaGxqcy5CQUNLU0xBU0hfRVNDQVBFXVxuICB9O1xuICBobGpzLlFVT1RFX1NUUklOR19NT0RFID0ge1xuICAgIGNsYXNzTmFtZTogJ3N0cmluZycsXG4gICAgYmVnaW46ICdcIicsIGVuZDogJ1wiJyxcbiAgICBpbGxlZ2FsOiAnXFxcXG4nLFxuICAgIGNvbnRhaW5zOiBbaGxqcy5CQUNLU0xBU0hfRVNDQVBFXVxuICB9O1xuICBobGpzLlBIUkFTQUxfV09SRFNfTU9ERSA9IHtcbiAgICBiZWdpbjogL1xcYihhfGFufHRoZXxhcmV8SSdtfGlzbid0fGRvbid0fGRvZXNuJ3R8d29uJ3R8YnV0fGp1c3R8c2hvdWxkfHByZXR0eXxzaW1wbHl8ZW5vdWdofGdvbm5hfGdvaW5nfHd0Znxzb3xzdWNofHdpbGx8eW91fHlvdXJ8bGlrZSlcXGIvXG4gIH07XG4gIGhsanMuQ09NTUVOVCA9IGZ1bmN0aW9uIChiZWdpbiwgZW5kLCBpbmhlcml0cykge1xuICAgIHZhciBtb2RlID0gaGxqcy5pbmhlcml0KFxuICAgICAge1xuICAgICAgICBjbGFzc05hbWU6ICdjb21tZW50JyxcbiAgICAgICAgYmVnaW46IGJlZ2luLCBlbmQ6IGVuZCxcbiAgICAgICAgY29udGFpbnM6IFtdXG4gICAgICB9LFxuICAgICAgaW5oZXJpdHMgfHwge31cbiAgICApO1xuICAgIG1vZGUuY29udGFpbnMucHVzaChobGpzLlBIUkFTQUxfV09SRFNfTU9ERSk7XG4gICAgbW9kZS5jb250YWlucy5wdXNoKHtcbiAgICAgIGNsYXNzTmFtZTogJ2RvY3RhZycsXG4gICAgICBiZWdpbjogJyg/OlRPRE98RklYTUV8Tk9URXxCVUd8WFhYKTonLFxuICAgICAgcmVsZXZhbmNlOiAwXG4gICAgfSk7XG4gICAgcmV0dXJuIG1vZGU7XG4gIH07XG4gIGhsanMuQ19MSU5FX0NPTU1FTlRfTU9ERSA9IGhsanMuQ09NTUVOVCgnLy8nLCAnJCcpO1xuICBobGpzLkNfQkxPQ0tfQ09NTUVOVF9NT0RFID0gaGxqcy5DT01NRU5UKCcvXFxcXConLCAnXFxcXCovJyk7XG4gIGhsanMuSEFTSF9DT01NRU5UX01PREUgPSBobGpzLkNPTU1FTlQoJyMnLCAnJCcpO1xuICBobGpzLk5VTUJFUl9NT0RFID0ge1xuICAgIGNsYXNzTmFtZTogJ251bWJlcicsXG4gICAgYmVnaW46IGhsanMuTlVNQkVSX1JFLFxuICAgIHJlbGV2YW5jZTogMFxuICB9O1xuICBobGpzLkNfTlVNQkVSX01PREUgPSB7XG4gICAgY2xhc3NOYW1lOiAnbnVtYmVyJyxcbiAgICBiZWdpbjogaGxqcy5DX05VTUJFUl9SRSxcbiAgICByZWxldmFuY2U6IDBcbiAgfTtcbiAgaGxqcy5CSU5BUllfTlVNQkVSX01PREUgPSB7XG4gICAgY2xhc3NOYW1lOiAnbnVtYmVyJyxcbiAgICBiZWdpbjogaGxqcy5CSU5BUllfTlVNQkVSX1JFLFxuICAgIHJlbGV2YW5jZTogMFxuICB9O1xuICBobGpzLkNTU19OVU1CRVJfTU9ERSA9IHtcbiAgICBjbGFzc05hbWU6ICdudW1iZXInLFxuICAgIGJlZ2luOiBobGpzLk5VTUJFUl9SRSArICcoJyArXG4gICAgICAnJXxlbXxleHxjaHxyZW0nICArXG4gICAgICAnfHZ3fHZofHZtaW58dm1heCcgK1xuICAgICAgJ3xjbXxtbXxpbnxwdHxwY3xweCcgK1xuICAgICAgJ3xkZWd8Z3JhZHxyYWR8dHVybicgK1xuICAgICAgJ3xzfG1zJyArXG4gICAgICAnfEh6fGtIeicgK1xuICAgICAgJ3xkcGl8ZHBjbXxkcHB4JyArXG4gICAgICAnKT8nLFxuICAgIHJlbGV2YW5jZTogMFxuICB9O1xuICBobGpzLlJFR0VYUF9NT0RFID0ge1xuICAgIGNsYXNzTmFtZTogJ3JlZ2V4cCcsXG4gICAgYmVnaW46IC9cXC8vLCBlbmQ6IC9cXC9bZ2ltdXldKi8sXG4gICAgaWxsZWdhbDogL1xcbi8sXG4gICAgY29udGFpbnM6IFtcbiAgICAgIGhsanMuQkFDS1NMQVNIX0VTQ0FQRSxcbiAgICAgIHtcbiAgICAgICAgYmVnaW46IC9cXFsvLCBlbmQ6IC9cXF0vLFxuICAgICAgICByZWxldmFuY2U6IDAsXG4gICAgICAgIGNvbnRhaW5zOiBbaGxqcy5CQUNLU0xBU0hfRVNDQVBFXVxuICAgICAgfVxuICAgIF1cbiAgfTtcbiAgaGxqcy5USVRMRV9NT0RFID0ge1xuICAgIGNsYXNzTmFtZTogJ3RpdGxlJyxcbiAgICBiZWdpbjogaGxqcy5JREVOVF9SRSxcbiAgICByZWxldmFuY2U6IDBcbiAgfTtcbiAgaGxqcy5VTkRFUlNDT1JFX1RJVExFX01PREUgPSB7XG4gICAgY2xhc3NOYW1lOiAndGl0bGUnLFxuICAgIGJlZ2luOiBobGpzLlVOREVSU0NPUkVfSURFTlRfUkUsXG4gICAgcmVsZXZhbmNlOiAwXG4gIH07XG4gIGhsanMuTUVUSE9EX0dVQVJEID0ge1xuICAgIC8vIGV4Y2x1ZGVzIG1ldGhvZCBuYW1lcyBmcm9tIGtleXdvcmQgcHJvY2Vzc2luZ1xuICAgIGJlZ2luOiAnXFxcXC5cXFxccyonICsgaGxqcy5VTkRFUlNDT1JFX0lERU5UX1JFLFxuICAgIHJlbGV2YW5jZTogMFxuICB9O1xuXG4gIHJldHVybiBobGpzO1xufSkpO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2hpZ2hsaWdodC5qcy9saWIvaGlnaGxpZ2h0LmpzXG4vLyBtb2R1bGUgaWQgPSA1M1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGhsanMpIHtcbiAgdmFyIElERU5UX1JFID0gJ1tBLVphLXokX11bMC05QS1aYS16JF9dKic7XG4gIHZhciBLRVlXT1JEUyA9IHtcbiAgICBrZXl3b3JkOlxuICAgICAgJ2luIG9mIGlmIGZvciB3aGlsZSBmaW5hbGx5IHZhciBuZXcgZnVuY3Rpb24gZG8gcmV0dXJuIHZvaWQgZWxzZSBicmVhayBjYXRjaCAnICtcbiAgICAgICdpbnN0YW5jZW9mIHdpdGggdGhyb3cgY2FzZSBkZWZhdWx0IHRyeSB0aGlzIHN3aXRjaCBjb250aW51ZSB0eXBlb2YgZGVsZXRlICcgK1xuICAgICAgJ2xldCB5aWVsZCBjb25zdCBleHBvcnQgc3VwZXIgZGVidWdnZXIgYXMgYXN5bmMgYXdhaXQgc3RhdGljICcgK1xuICAgICAgLy8gRUNNQVNjcmlwdCA2IG1vZHVsZXMgaW1wb3J0XG4gICAgICAnaW1wb3J0IGZyb20gYXMnXG4gICAgLFxuICAgIGxpdGVyYWw6XG4gICAgICAndHJ1ZSBmYWxzZSBudWxsIHVuZGVmaW5lZCBOYU4gSW5maW5pdHknLFxuICAgIGJ1aWx0X2luOlxuICAgICAgJ2V2YWwgaXNGaW5pdGUgaXNOYU4gcGFyc2VGbG9hdCBwYXJzZUludCBkZWNvZGVVUkkgZGVjb2RlVVJJQ29tcG9uZW50ICcgK1xuICAgICAgJ2VuY29kZVVSSSBlbmNvZGVVUklDb21wb25lbnQgZXNjYXBlIHVuZXNjYXBlIE9iamVjdCBGdW5jdGlvbiBCb29sZWFuIEVycm9yICcgK1xuICAgICAgJ0V2YWxFcnJvciBJbnRlcm5hbEVycm9yIFJhbmdlRXJyb3IgUmVmZXJlbmNlRXJyb3IgU3RvcEl0ZXJhdGlvbiBTeW50YXhFcnJvciAnICtcbiAgICAgICdUeXBlRXJyb3IgVVJJRXJyb3IgTnVtYmVyIE1hdGggRGF0ZSBTdHJpbmcgUmVnRXhwIEFycmF5IEZsb2F0MzJBcnJheSAnICtcbiAgICAgICdGbG9hdDY0QXJyYXkgSW50MTZBcnJheSBJbnQzMkFycmF5IEludDhBcnJheSBVaW50MTZBcnJheSBVaW50MzJBcnJheSAnICtcbiAgICAgICdVaW50OEFycmF5IFVpbnQ4Q2xhbXBlZEFycmF5IEFycmF5QnVmZmVyIERhdGFWaWV3IEpTT04gSW50bCBhcmd1bWVudHMgcmVxdWlyZSAnICtcbiAgICAgICdtb2R1bGUgY29uc29sZSB3aW5kb3cgZG9jdW1lbnQgU3ltYm9sIFNldCBNYXAgV2Vha1NldCBXZWFrTWFwIFByb3h5IFJlZmxlY3QgJyArXG4gICAgICAnUHJvbWlzZSdcbiAgfTtcbiAgdmFyIEVYUFJFU1NJT05TO1xuICB2YXIgTlVNQkVSID0ge1xuICAgIGNsYXNzTmFtZTogJ251bWJlcicsXG4gICAgdmFyaWFudHM6IFtcbiAgICAgIHsgYmVnaW46ICdcXFxcYigwW2JCXVswMV0rKScgfSxcbiAgICAgIHsgYmVnaW46ICdcXFxcYigwW29PXVswLTddKyknIH0sXG4gICAgICB7IGJlZ2luOiBobGpzLkNfTlVNQkVSX1JFIH1cbiAgICBdLFxuICAgIHJlbGV2YW5jZTogMFxuICB9O1xuICB2YXIgU1VCU1QgPSB7XG4gICAgY2xhc3NOYW1lOiAnc3Vic3QnLFxuICAgIGJlZ2luOiAnXFxcXCRcXFxceycsIGVuZDogJ1xcXFx9JyxcbiAgICBrZXl3b3JkczogS0VZV09SRFMsXG4gICAgY29udGFpbnM6IFtdICAvLyBkZWZpbmVkIGxhdGVyXG4gIH07XG4gIHZhciBURU1QTEFURV9TVFJJTkcgPSB7XG4gICAgY2xhc3NOYW1lOiAnc3RyaW5nJyxcbiAgICBiZWdpbjogJ2AnLCBlbmQ6ICdgJyxcbiAgICBjb250YWluczogW1xuICAgICAgaGxqcy5CQUNLU0xBU0hfRVNDQVBFLFxuICAgICAgU1VCU1RcbiAgICBdXG4gIH07XG4gIFNVQlNULmNvbnRhaW5zID0gW1xuICAgIGhsanMuQVBPU19TVFJJTkdfTU9ERSxcbiAgICBobGpzLlFVT1RFX1NUUklOR19NT0RFLFxuICAgIFRFTVBMQVRFX1NUUklORyxcbiAgICBOVU1CRVIsXG4gICAgaGxqcy5SRUdFWFBfTU9ERVxuICBdXG4gIHZhciBQQVJBTVNfQ09OVEFJTlMgPSBTVUJTVC5jb250YWlucy5jb25jYXQoW1xuICAgIGhsanMuQ19CTE9DS19DT01NRU5UX01PREUsXG4gICAgaGxqcy5DX0xJTkVfQ09NTUVOVF9NT0RFXG4gIF0pO1xuXG4gIHJldHVybiB7XG4gICAgYWxpYXNlczogWydqcycsICdqc3gnXSxcbiAgICBrZXl3b3JkczogS0VZV09SRFMsXG4gICAgY29udGFpbnM6IFtcbiAgICAgIHtcbiAgICAgICAgY2xhc3NOYW1lOiAnbWV0YScsXG4gICAgICAgIHJlbGV2YW5jZTogMTAsXG4gICAgICAgIGJlZ2luOiAvXlxccypbJ1wiXXVzZSAoc3RyaWN0fGFzbSlbJ1wiXS9cbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGNsYXNzTmFtZTogJ21ldGEnLFxuICAgICAgICBiZWdpbjogL14jIS8sIGVuZDogLyQvXG4gICAgICB9LFxuICAgICAgaGxqcy5BUE9TX1NUUklOR19NT0RFLFxuICAgICAgaGxqcy5RVU9URV9TVFJJTkdfTU9ERSxcbiAgICAgIFRFTVBMQVRFX1NUUklORyxcbiAgICAgIGhsanMuQ19MSU5FX0NPTU1FTlRfTU9ERSxcbiAgICAgIGhsanMuQ19CTE9DS19DT01NRU5UX01PREUsXG4gICAgICBOVU1CRVIsXG4gICAgICB7IC8vIG9iamVjdCBhdHRyIGNvbnRhaW5lclxuICAgICAgICBiZWdpbjogL1t7LF1cXHMqLywgcmVsZXZhbmNlOiAwLFxuICAgICAgICBjb250YWluczogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGJlZ2luOiBJREVOVF9SRSArICdcXFxccyo6JywgcmV0dXJuQmVnaW46IHRydWUsXG4gICAgICAgICAgICByZWxldmFuY2U6IDAsXG4gICAgICAgICAgICBjb250YWluczogW3tjbGFzc05hbWU6ICdhdHRyJywgYmVnaW46IElERU5UX1JFLCByZWxldmFuY2U6IDB9XVxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSxcbiAgICAgIHsgLy8gXCJ2YWx1ZVwiIGNvbnRhaW5lclxuICAgICAgICBiZWdpbjogJygnICsgaGxqcy5SRV9TVEFSVEVSU19SRSArICd8XFxcXGIoY2FzZXxyZXR1cm58dGhyb3cpXFxcXGIpXFxcXHMqJyxcbiAgICAgICAga2V5d29yZHM6ICdyZXR1cm4gdGhyb3cgY2FzZScsXG4gICAgICAgIGNvbnRhaW5zOiBbXG4gICAgICAgICAgaGxqcy5DX0xJTkVfQ09NTUVOVF9NT0RFLFxuICAgICAgICAgIGhsanMuQ19CTE9DS19DT01NRU5UX01PREUsXG4gICAgICAgICAgaGxqcy5SRUdFWFBfTU9ERSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBjbGFzc05hbWU6ICdmdW5jdGlvbicsXG4gICAgICAgICAgICBiZWdpbjogJyhcXFxcKC4qP1xcXFwpfCcgKyBJREVOVF9SRSArICcpXFxcXHMqPT4nLCByZXR1cm5CZWdpbjogdHJ1ZSxcbiAgICAgICAgICAgIGVuZDogJ1xcXFxzKj0+JyxcbiAgICAgICAgICAgIGNvbnRhaW5zOiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdwYXJhbXMnLFxuICAgICAgICAgICAgICAgIHZhcmlhbnRzOiBbXG4gICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGJlZ2luOiBJREVOVF9SRVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgYmVnaW46IC9cXChcXHMqXFwpLyxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGJlZ2luOiAvXFwoLywgZW5kOiAvXFwpLyxcbiAgICAgICAgICAgICAgICAgICAgZXhjbHVkZUJlZ2luOiB0cnVlLCBleGNsdWRlRW5kOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBrZXl3b3JkczogS0VZV09SRFMsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5zOiBQQVJBTVNfQ09OVEFJTlNcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHsgLy8gRTRYIC8gSlNYXG4gICAgICAgICAgICBiZWdpbjogLzwvLCBlbmQ6IC8oXFwvXFx3K3xcXHcrXFwvKT4vLFxuICAgICAgICAgICAgc3ViTGFuZ3VhZ2U6ICd4bWwnLFxuICAgICAgICAgICAgY29udGFpbnM6IFtcbiAgICAgICAgICAgICAge2JlZ2luOiAvPFxcdytcXHMqXFwvPi8sIHNraXA6IHRydWV9LFxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgYmVnaW46IC88XFx3Ky8sIGVuZDogLyhcXC9cXHcrfFxcdytcXC8pPi8sIHNraXA6IHRydWUsXG4gICAgICAgICAgICAgICAgY29udGFpbnM6IFtcbiAgICAgICAgICAgICAgICAgIHtiZWdpbjogLzxcXHcrXFxzKlxcLz4vLCBza2lwOiB0cnVlfSxcbiAgICAgICAgICAgICAgICAgICdzZWxmJ1xuICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgcmVsZXZhbmNlOiAwXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBjbGFzc05hbWU6ICdmdW5jdGlvbicsXG4gICAgICAgIGJlZ2luS2V5d29yZHM6ICdmdW5jdGlvbicsIGVuZDogL1xcey8sIGV4Y2x1ZGVFbmQ6IHRydWUsXG4gICAgICAgIGNvbnRhaW5zOiBbXG4gICAgICAgICAgaGxqcy5pbmhlcml0KGhsanMuVElUTEVfTU9ERSwge2JlZ2luOiBJREVOVF9SRX0pLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGNsYXNzTmFtZTogJ3BhcmFtcycsXG4gICAgICAgICAgICBiZWdpbjogL1xcKC8sIGVuZDogL1xcKS8sXG4gICAgICAgICAgICBleGNsdWRlQmVnaW46IHRydWUsXG4gICAgICAgICAgICBleGNsdWRlRW5kOiB0cnVlLFxuICAgICAgICAgICAgY29udGFpbnM6IFBBUkFNU19DT05UQUlOU1xuICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgaWxsZWdhbDogL1xcW3wlL1xuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgYmVnaW46IC9cXCRbKC5dLyAvLyByZWxldmFuY2UgYm9vc3RlciBmb3IgYSBwYXR0ZXJuIGNvbW1vbiB0byBKUyBsaWJzOiBgJChzb21ldGhpbmcpYCBhbmQgYCQuc29tZXRoaW5nYFxuICAgICAgfSxcbiAgICAgIGhsanMuTUVUSE9EX0dVQVJELFxuICAgICAgeyAvLyBFUzYgY2xhc3NcbiAgICAgICAgY2xhc3NOYW1lOiAnY2xhc3MnLFxuICAgICAgICBiZWdpbktleXdvcmRzOiAnY2xhc3MnLCBlbmQ6IC9bezs9XS8sIGV4Y2x1ZGVFbmQ6IHRydWUsXG4gICAgICAgIGlsbGVnYWw6IC9bOlwiXFxbXFxdXS8sXG4gICAgICAgIGNvbnRhaW5zOiBbXG4gICAgICAgICAge2JlZ2luS2V5d29yZHM6ICdleHRlbmRzJ30sXG4gICAgICAgICAgaGxqcy5VTkRFUlNDT1JFX1RJVExFX01PREVcbiAgICAgICAgXVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgYmVnaW5LZXl3b3JkczogJ2NvbnN0cnVjdG9yJywgZW5kOiAvXFx7LywgZXhjbHVkZUVuZDogdHJ1ZVxuICAgICAgfVxuICAgIF0sXG4gICAgaWxsZWdhbDogLyMoPyEhKS9cbiAgfTtcbn07XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2hpZ2hsaWdodC5qcy9saWIvbGFuZ3VhZ2VzL2phdmFzY3JpcHQuanNcbi8vIG1vZHVsZSBpZCA9IDU0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIid1c2Ugc3RyaWN0JztcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbnZhciBjYW5Vc2VET00gPSBleHBvcnRzLmNhblVzZURPTSA9ICEhKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5kb2N1bWVudCAmJiB3aW5kb3cuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCk7XG5cbnZhciBhZGRFdmVudExpc3RlbmVyID0gZXhwb3J0cy5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gYWRkRXZlbnRMaXN0ZW5lcihub2RlLCBldmVudCwgbGlzdGVuZXIpIHtcbiAgcmV0dXJuIG5vZGUuYWRkRXZlbnRMaXN0ZW5lciA/IG5vZGUuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgbGlzdGVuZXIsIGZhbHNlKSA6IG5vZGUuYXR0YWNoRXZlbnQoJ29uJyArIGV2ZW50LCBsaXN0ZW5lcik7XG59O1xuXG52YXIgcmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGV4cG9ydHMucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIHJlbW92ZUV2ZW50TGlzdGVuZXIobm9kZSwgZXZlbnQsIGxpc3RlbmVyKSB7XG4gIHJldHVybiBub2RlLnJlbW92ZUV2ZW50TGlzdGVuZXIgPyBub2RlLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGxpc3RlbmVyLCBmYWxzZSkgOiBub2RlLmRldGFjaEV2ZW50KCdvbicgKyBldmVudCwgbGlzdGVuZXIpO1xufTtcblxudmFyIGdldENvbmZpcm1hdGlvbiA9IGV4cG9ydHMuZ2V0Q29uZmlybWF0aW9uID0gZnVuY3Rpb24gZ2V0Q29uZmlybWF0aW9uKG1lc3NhZ2UsIGNhbGxiYWNrKSB7XG4gIHJldHVybiBjYWxsYmFjayh3aW5kb3cuY29uZmlybShtZXNzYWdlKSk7XG59OyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWFsZXJ0XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoZSBIVE1MNSBoaXN0b3J5IEFQSSBpcyBzdXBwb3J0ZWQuIFRha2VuIGZyb20gTW9kZXJuaXpyLlxuICpcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9Nb2Rlcm5penIvTW9kZXJuaXpyL2Jsb2IvbWFzdGVyL0xJQ0VOU0VcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9Nb2Rlcm5penIvTW9kZXJuaXpyL2Jsb2IvbWFzdGVyL2ZlYXR1cmUtZGV0ZWN0cy9oaXN0b3J5LmpzXG4gKiBjaGFuZ2VkIHRvIGF2b2lkIGZhbHNlIG5lZ2F0aXZlcyBmb3IgV2luZG93cyBQaG9uZXM6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWFjdGpzL3JlYWN0LXJvdXRlci9pc3N1ZXMvNTg2XG4gKi9cbnZhciBzdXBwb3J0c0hpc3RvcnkgPSBleHBvcnRzLnN1cHBvcnRzSGlzdG9yeSA9IGZ1bmN0aW9uIHN1cHBvcnRzSGlzdG9yeSgpIHtcbiAgdmFyIHVhID0gd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQ7XG5cbiAgaWYgKCh1YS5pbmRleE9mKCdBbmRyb2lkIDIuJykgIT09IC0xIHx8IHVhLmluZGV4T2YoJ0FuZHJvaWQgNC4wJykgIT09IC0xKSAmJiB1YS5pbmRleE9mKCdNb2JpbGUgU2FmYXJpJykgIT09IC0xICYmIHVhLmluZGV4T2YoJ0Nocm9tZScpID09PSAtMSAmJiB1YS5pbmRleE9mKCdXaW5kb3dzIFBob25lJykgPT09IC0xKSByZXR1cm4gZmFsc2U7XG5cbiAgcmV0dXJuIHdpbmRvdy5oaXN0b3J5ICYmICdwdXNoU3RhdGUnIGluIHdpbmRvdy5oaXN0b3J5O1xufTtcblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgYnJvd3NlciBmaXJlcyBwb3BzdGF0ZSBvbiBoYXNoIGNoYW5nZS5cbiAqIElFMTAgYW5kIElFMTEgZG8gbm90LlxuICovXG52YXIgc3VwcG9ydHNQb3BTdGF0ZU9uSGFzaENoYW5nZSA9IGV4cG9ydHMuc3VwcG9ydHNQb3BTdGF0ZU9uSGFzaENoYW5nZSA9IGZ1bmN0aW9uIHN1cHBvcnRzUG9wU3RhdGVPbkhhc2hDaGFuZ2UoKSB7XG4gIHJldHVybiB3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCdUcmlkZW50JykgPT09IC0xO1xufTtcblxuLyoqXG4gKiBSZXR1cm5zIGZhbHNlIGlmIHVzaW5nIGdvKG4pIHdpdGggaGFzaCBoaXN0b3J5IGNhdXNlcyBhIGZ1bGwgcGFnZSByZWxvYWQuXG4gKi9cbnZhciBzdXBwb3J0c0dvV2l0aG91dFJlbG9hZFVzaW5nSGFzaCA9IGV4cG9ydHMuc3VwcG9ydHNHb1dpdGhvdXRSZWxvYWRVc2luZ0hhc2ggPSBmdW5jdGlvbiBzdXBwb3J0c0dvV2l0aG91dFJlbG9hZFVzaW5nSGFzaCgpIHtcbiAgcmV0dXJuIHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoJ0ZpcmVmb3gnKSA9PT0gLTE7XG59O1xuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiBhIGdpdmVuIHBvcHN0YXRlIGV2ZW50IGlzIGFuIGV4dHJhbmVvdXMgV2ViS2l0IGV2ZW50LlxuICogQWNjb3VudHMgZm9yIHRoZSBmYWN0IHRoYXQgQ2hyb21lIG9uIGlPUyBmaXJlcyByZWFsIHBvcHN0YXRlIGV2ZW50c1xuICogY29udGFpbmluZyB1bmRlZmluZWQgc3RhdGUgd2hlbiBwcmVzc2luZyB0aGUgYmFjayBidXR0b24uXG4gKi9cbnZhciBpc0V4dHJhbmVvdXNQb3BzdGF0ZUV2ZW50ID0gZXhwb3J0cy5pc0V4dHJhbmVvdXNQb3BzdGF0ZUV2ZW50ID0gZnVuY3Rpb24gaXNFeHRyYW5lb3VzUG9wc3RhdGVFdmVudChldmVudCkge1xuICByZXR1cm4gZXZlbnQuc3RhdGUgPT09IHVuZGVmaW5lZCAmJiBuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoJ0NyaU9TJykgPT09IC0xO1xufTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vaGlzdG9yeS9ET01VdGlscy5qc1xuLy8gbW9kdWxlIGlkID0gNTVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiJ3VzZSBzdHJpY3QnO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuZXhwb3J0cy5sb2NhdGlvbnNBcmVFcXVhbCA9IGV4cG9ydHMuY3JlYXRlTG9jYXRpb24gPSB1bmRlZmluZWQ7XG5cbnZhciBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldOyBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7IHRhcmdldFtrZXldID0gc291cmNlW2tleV07IH0gfSB9IHJldHVybiB0YXJnZXQ7IH07XG5cbnZhciBfcmVzb2x2ZVBhdGhuYW1lID0gcmVxdWlyZSgncmVzb2x2ZS1wYXRobmFtZScpO1xuXG52YXIgX3Jlc29sdmVQYXRobmFtZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZXNvbHZlUGF0aG5hbWUpO1xuXG52YXIgX3ZhbHVlRXF1YWwgPSByZXF1aXJlKCd2YWx1ZS1lcXVhbCcpO1xuXG52YXIgX3ZhbHVlRXF1YWwyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsdWVFcXVhbCk7XG5cbnZhciBfUGF0aFV0aWxzID0gcmVxdWlyZSgnLi9QYXRoVXRpbHMnKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxudmFyIGNyZWF0ZUxvY2F0aW9uID0gZXhwb3J0cy5jcmVhdGVMb2NhdGlvbiA9IGZ1bmN0aW9uIGNyZWF0ZUxvY2F0aW9uKHBhdGgsIHN0YXRlLCBrZXksIGN1cnJlbnRMb2NhdGlvbikge1xuICB2YXIgbG9jYXRpb24gPSB2b2lkIDA7XG4gIGlmICh0eXBlb2YgcGF0aCA9PT0gJ3N0cmluZycpIHtcbiAgICAvLyBUd28tYXJnIGZvcm06IHB1c2gocGF0aCwgc3RhdGUpXG4gICAgbG9jYXRpb24gPSAoMCwgX1BhdGhVdGlscy5wYXJzZVBhdGgpKHBhdGgpO1xuICAgIGxvY2F0aW9uLnN0YXRlID0gc3RhdGU7XG4gIH0gZWxzZSB7XG4gICAgLy8gT25lLWFyZyBmb3JtOiBwdXNoKGxvY2F0aW9uKVxuICAgIGxvY2F0aW9uID0gX2V4dGVuZHMoe30sIHBhdGgpO1xuXG4gICAgaWYgKGxvY2F0aW9uLnBhdGhuYW1lID09PSB1bmRlZmluZWQpIGxvY2F0aW9uLnBhdGhuYW1lID0gJyc7XG5cbiAgICBpZiAobG9jYXRpb24uc2VhcmNoKSB7XG4gICAgICBpZiAobG9jYXRpb24uc2VhcmNoLmNoYXJBdCgwKSAhPT0gJz8nKSBsb2NhdGlvbi5zZWFyY2ggPSAnPycgKyBsb2NhdGlvbi5zZWFyY2g7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxvY2F0aW9uLnNlYXJjaCA9ICcnO1xuICAgIH1cblxuICAgIGlmIChsb2NhdGlvbi5oYXNoKSB7XG4gICAgICBpZiAobG9jYXRpb24uaGFzaC5jaGFyQXQoMCkgIT09ICcjJykgbG9jYXRpb24uaGFzaCA9ICcjJyArIGxvY2F0aW9uLmhhc2g7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxvY2F0aW9uLmhhc2ggPSAnJztcbiAgICB9XG5cbiAgICBpZiAoc3RhdGUgIT09IHVuZGVmaW5lZCAmJiBsb2NhdGlvbi5zdGF0ZSA9PT0gdW5kZWZpbmVkKSBsb2NhdGlvbi5zdGF0ZSA9IHN0YXRlO1xuICB9XG5cbiAgbG9jYXRpb24ua2V5ID0ga2V5O1xuXG4gIGlmIChjdXJyZW50TG9jYXRpb24pIHtcbiAgICAvLyBSZXNvbHZlIGluY29tcGxldGUvcmVsYXRpdmUgcGF0aG5hbWUgcmVsYXRpdmUgdG8gY3VycmVudCBsb2NhdGlvbi5cbiAgICBpZiAoIWxvY2F0aW9uLnBhdGhuYW1lKSB7XG4gICAgICBsb2NhdGlvbi5wYXRobmFtZSA9IGN1cnJlbnRMb2NhdGlvbi5wYXRobmFtZTtcbiAgICB9IGVsc2UgaWYgKGxvY2F0aW9uLnBhdGhuYW1lLmNoYXJBdCgwKSAhPT0gJy8nKSB7XG4gICAgICBsb2NhdGlvbi5wYXRobmFtZSA9ICgwLCBfcmVzb2x2ZVBhdGhuYW1lMi5kZWZhdWx0KShsb2NhdGlvbi5wYXRobmFtZSwgY3VycmVudExvY2F0aW9uLnBhdGhuYW1lKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbG9jYXRpb247XG59O1xuXG52YXIgbG9jYXRpb25zQXJlRXF1YWwgPSBleHBvcnRzLmxvY2F0aW9uc0FyZUVxdWFsID0gZnVuY3Rpb24gbG9jYXRpb25zQXJlRXF1YWwoYSwgYikge1xuICByZXR1cm4gYS5wYXRobmFtZSA9PT0gYi5wYXRobmFtZSAmJiBhLnNlYXJjaCA9PT0gYi5zZWFyY2ggJiYgYS5oYXNoID09PSBiLmhhc2ggJiYgYS5rZXkgPT09IGIua2V5ICYmICgwLCBfdmFsdWVFcXVhbDIuZGVmYXVsdCkoYS5zdGF0ZSwgYi5zdGF0ZSk7XG59O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9oaXN0b3J5L0xvY2F0aW9uVXRpbHMuanNcbi8vIG1vZHVsZSBpZCA9IDU2XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIid1c2Ugc3RyaWN0JztcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblxudmFyIF93YXJuaW5nID0gcmVxdWlyZSgnd2FybmluZycpO1xuXG52YXIgX3dhcm5pbmcyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfd2FybmluZyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbnZhciBjcmVhdGVUcmFuc2l0aW9uTWFuYWdlciA9IGZ1bmN0aW9uIGNyZWF0ZVRyYW5zaXRpb25NYW5hZ2VyKCkge1xuICB2YXIgcHJvbXB0ID0gbnVsbDtcblxuICB2YXIgc2V0UHJvbXB0ID0gZnVuY3Rpb24gc2V0UHJvbXB0KG5leHRQcm9tcHQpIHtcbiAgICAoMCwgX3dhcm5pbmcyLmRlZmF1bHQpKHByb21wdCA9PSBudWxsLCAnQSBoaXN0b3J5IHN1cHBvcnRzIG9ubHkgb25lIHByb21wdCBhdCBhIHRpbWUnKTtcblxuICAgIHByb21wdCA9IG5leHRQcm9tcHQ7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHByb21wdCA9PT0gbmV4dFByb21wdCkgcHJvbXB0ID0gbnVsbDtcbiAgICB9O1xuICB9O1xuXG4gIHZhciBjb25maXJtVHJhbnNpdGlvblRvID0gZnVuY3Rpb24gY29uZmlybVRyYW5zaXRpb25Ubyhsb2NhdGlvbiwgYWN0aW9uLCBnZXRVc2VyQ29uZmlybWF0aW9uLCBjYWxsYmFjaykge1xuICAgIC8vIFRPRE86IElmIGFub3RoZXIgdHJhbnNpdGlvbiBzdGFydHMgd2hpbGUgd2UncmUgc3RpbGwgY29uZmlybWluZ1xuICAgIC8vIHRoZSBwcmV2aW91cyBvbmUsIHdlIG1heSBlbmQgdXAgaW4gYSB3ZWlyZCBzdGF0ZS4gRmlndXJlIG91dCB0aGVcbiAgICAvLyBiZXN0IHdheSB0byBoYW5kbGUgdGhpcy5cbiAgICBpZiAocHJvbXB0ICE9IG51bGwpIHtcbiAgICAgIHZhciByZXN1bHQgPSB0eXBlb2YgcHJvbXB0ID09PSAnZnVuY3Rpb24nID8gcHJvbXB0KGxvY2F0aW9uLCBhY3Rpb24pIDogcHJvbXB0O1xuXG4gICAgICBpZiAodHlwZW9mIHJlc3VsdCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBnZXRVc2VyQ29uZmlybWF0aW9uID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgZ2V0VXNlckNvbmZpcm1hdGlvbihyZXN1bHQsIGNhbGxiYWNrKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAoMCwgX3dhcm5pbmcyLmRlZmF1bHQpKGZhbHNlLCAnQSBoaXN0b3J5IG5lZWRzIGEgZ2V0VXNlckNvbmZpcm1hdGlvbiBmdW5jdGlvbiBpbiBvcmRlciB0byB1c2UgYSBwcm9tcHQgbWVzc2FnZScpO1xuXG4gICAgICAgICAgY2FsbGJhY2sodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFJldHVybiBmYWxzZSBmcm9tIGEgdHJhbnNpdGlvbiBob29rIHRvIGNhbmNlbCB0aGUgdHJhbnNpdGlvbi5cbiAgICAgICAgY2FsbGJhY2socmVzdWx0ICE9PSBmYWxzZSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNhbGxiYWNrKHRydWUpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgbGlzdGVuZXJzID0gW107XG5cbiAgdmFyIGFwcGVuZExpc3RlbmVyID0gZnVuY3Rpb24gYXBwZW5kTGlzdGVuZXIoZm4pIHtcbiAgICB2YXIgaXNBY3RpdmUgPSB0cnVlO1xuXG4gICAgdmFyIGxpc3RlbmVyID0gZnVuY3Rpb24gbGlzdGVuZXIoKSB7XG4gICAgICBpZiAoaXNBY3RpdmUpIGZuLmFwcGx5KHVuZGVmaW5lZCwgYXJndW1lbnRzKTtcbiAgICB9O1xuXG4gICAgbGlzdGVuZXJzLnB1c2gobGlzdGVuZXIpO1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIGlzQWN0aXZlID0gZmFsc2U7XG4gICAgICBsaXN0ZW5lcnMgPSBsaXN0ZW5lcnMuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIHJldHVybiBpdGVtICE9PSBsaXN0ZW5lcjtcbiAgICAgIH0pO1xuICAgIH07XG4gIH07XG5cbiAgdmFyIG5vdGlmeUxpc3RlbmVycyA9IGZ1bmN0aW9uIG5vdGlmeUxpc3RlbmVycygpIHtcbiAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgYXJnc1tfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgICB9XG5cbiAgICBsaXN0ZW5lcnMuZm9yRWFjaChmdW5jdGlvbiAobGlzdGVuZXIpIHtcbiAgICAgIHJldHVybiBsaXN0ZW5lci5hcHBseSh1bmRlZmluZWQsIGFyZ3MpO1xuICAgIH0pO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgc2V0UHJvbXB0OiBzZXRQcm9tcHQsXG4gICAgY29uZmlybVRyYW5zaXRpb25UbzogY29uZmlybVRyYW5zaXRpb25UbyxcbiAgICBhcHBlbmRMaXN0ZW5lcjogYXBwZW5kTGlzdGVuZXIsXG4gICAgbm90aWZ5TGlzdGVuZXJzOiBub3RpZnlMaXN0ZW5lcnNcbiAgfTtcbn07XG5cbmV4cG9ydHMuZGVmYXVsdCA9IGNyZWF0ZVRyYW5zaXRpb25NYW5hZ2VyO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9oaXN0b3J5L2NyZWF0ZVRyYW5zaXRpb25NYW5hZ2VyLmpzXG4vLyBtb2R1bGUgaWQgPSA1N1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJleHBvcnRzLnJlYWQgPSBmdW5jdGlvbiAoYnVmZmVyLCBvZmZzZXQsIGlzTEUsIG1MZW4sIG5CeXRlcykge1xuICB2YXIgZSwgbVxuICB2YXIgZUxlbiA9IG5CeXRlcyAqIDggLSBtTGVuIC0gMVxuICB2YXIgZU1heCA9ICgxIDw8IGVMZW4pIC0gMVxuICB2YXIgZUJpYXMgPSBlTWF4ID4+IDFcbiAgdmFyIG5CaXRzID0gLTdcbiAgdmFyIGkgPSBpc0xFID8gKG5CeXRlcyAtIDEpIDogMFxuICB2YXIgZCA9IGlzTEUgPyAtMSA6IDFcbiAgdmFyIHMgPSBidWZmZXJbb2Zmc2V0ICsgaV1cblxuICBpICs9IGRcblxuICBlID0gcyAmICgoMSA8PCAoLW5CaXRzKSkgLSAxKVxuICBzID4+PSAoLW5CaXRzKVxuICBuQml0cyArPSBlTGVuXG4gIGZvciAoOyBuQml0cyA+IDA7IGUgPSBlICogMjU2ICsgYnVmZmVyW29mZnNldCArIGldLCBpICs9IGQsIG5CaXRzIC09IDgpIHt9XG5cbiAgbSA9IGUgJiAoKDEgPDwgKC1uQml0cykpIC0gMSlcbiAgZSA+Pj0gKC1uQml0cylcbiAgbkJpdHMgKz0gbUxlblxuICBmb3IgKDsgbkJpdHMgPiAwOyBtID0gbSAqIDI1NiArIGJ1ZmZlcltvZmZzZXQgKyBpXSwgaSArPSBkLCBuQml0cyAtPSA4KSB7fVxuXG4gIGlmIChlID09PSAwKSB7XG4gICAgZSA9IDEgLSBlQmlhc1xuICB9IGVsc2UgaWYgKGUgPT09IGVNYXgpIHtcbiAgICByZXR1cm4gbSA/IE5hTiA6ICgocyA/IC0xIDogMSkgKiBJbmZpbml0eSlcbiAgfSBlbHNlIHtcbiAgICBtID0gbSArIE1hdGgucG93KDIsIG1MZW4pXG4gICAgZSA9IGUgLSBlQmlhc1xuICB9XG4gIHJldHVybiAocyA/IC0xIDogMSkgKiBtICogTWF0aC5wb3coMiwgZSAtIG1MZW4pXG59XG5cbmV4cG9ydHMud3JpdGUgPSBmdW5jdGlvbiAoYnVmZmVyLCB2YWx1ZSwgb2Zmc2V0LCBpc0xFLCBtTGVuLCBuQnl0ZXMpIHtcbiAgdmFyIGUsIG0sIGNcbiAgdmFyIGVMZW4gPSBuQnl0ZXMgKiA4IC0gbUxlbiAtIDFcbiAgdmFyIGVNYXggPSAoMSA8PCBlTGVuKSAtIDFcbiAgdmFyIGVCaWFzID0gZU1heCA+PiAxXG4gIHZhciBydCA9IChtTGVuID09PSAyMyA/IE1hdGgucG93KDIsIC0yNCkgLSBNYXRoLnBvdygyLCAtNzcpIDogMClcbiAgdmFyIGkgPSBpc0xFID8gMCA6IChuQnl0ZXMgLSAxKVxuICB2YXIgZCA9IGlzTEUgPyAxIDogLTFcbiAgdmFyIHMgPSB2YWx1ZSA8IDAgfHwgKHZhbHVlID09PSAwICYmIDEgLyB2YWx1ZSA8IDApID8gMSA6IDBcblxuICB2YWx1ZSA9IE1hdGguYWJzKHZhbHVlKVxuXG4gIGlmIChpc05hTih2YWx1ZSkgfHwgdmFsdWUgPT09IEluZmluaXR5KSB7XG4gICAgbSA9IGlzTmFOKHZhbHVlKSA/IDEgOiAwXG4gICAgZSA9IGVNYXhcbiAgfSBlbHNlIHtcbiAgICBlID0gTWF0aC5mbG9vcihNYXRoLmxvZyh2YWx1ZSkgLyBNYXRoLkxOMilcbiAgICBpZiAodmFsdWUgKiAoYyA9IE1hdGgucG93KDIsIC1lKSkgPCAxKSB7XG4gICAgICBlLS1cbiAgICAgIGMgKj0gMlxuICAgIH1cbiAgICBpZiAoZSArIGVCaWFzID49IDEpIHtcbiAgICAgIHZhbHVlICs9IHJ0IC8gY1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWx1ZSArPSBydCAqIE1hdGgucG93KDIsIDEgLSBlQmlhcylcbiAgICB9XG4gICAgaWYgKHZhbHVlICogYyA+PSAyKSB7XG4gICAgICBlKytcbiAgICAgIGMgLz0gMlxuICAgIH1cblxuICAgIGlmIChlICsgZUJpYXMgPj0gZU1heCkge1xuICAgICAgbSA9IDBcbiAgICAgIGUgPSBlTWF4XG4gICAgfSBlbHNlIGlmIChlICsgZUJpYXMgPj0gMSkge1xuICAgICAgbSA9ICh2YWx1ZSAqIGMgLSAxKSAqIE1hdGgucG93KDIsIG1MZW4pXG4gICAgICBlID0gZSArIGVCaWFzXG4gICAgfSBlbHNlIHtcbiAgICAgIG0gPSB2YWx1ZSAqIE1hdGgucG93KDIsIGVCaWFzIC0gMSkgKiBNYXRoLnBvdygyLCBtTGVuKVxuICAgICAgZSA9IDBcbiAgICB9XG4gIH1cblxuICBmb3IgKDsgbUxlbiA+PSA4OyBidWZmZXJbb2Zmc2V0ICsgaV0gPSBtICYgMHhmZiwgaSArPSBkLCBtIC89IDI1NiwgbUxlbiAtPSA4KSB7fVxuXG4gIGUgPSAoZSA8PCBtTGVuKSB8IG1cbiAgZUxlbiArPSBtTGVuXG4gIGZvciAoOyBlTGVuID4gMDsgYnVmZmVyW29mZnNldCArIGldID0gZSAmIDB4ZmYsIGkgKz0gZCwgZSAvPSAyNTYsIGVMZW4gLT0gOCkge31cblxuICBidWZmZXJbb2Zmc2V0ICsgaSAtIGRdIHw9IHMgKiAxMjhcbn1cblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9pZWVlNzU0L2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSA1OFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKiFcbiAqIGluZmVybm8tY29tcG9uZW50IHYxLjIuMlxuICogKGMpIDIwMTcgRG9taW5pYyBHYW5uYXdheVxuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxuICovXG4oZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuXHR0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgPyBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZSgnaW5mZXJubycpKSA6XG5cdHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShbJ2luZmVybm8nXSwgZmFjdG9yeSkgOlxuXHQoZ2xvYmFsLkluZmVybm8gPSBnbG9iYWwuSW5mZXJubyB8fCB7fSwgZ2xvYmFsLkluZmVybm8uQ29tcG9uZW50ID0gZmFjdG9yeShnbG9iYWwuSW5mZXJubykpO1xufSh0aGlzLCAoZnVuY3Rpb24gKGluZmVybm8pIHsgJ3VzZSBzdHJpY3QnO1xuXG52YXIgRVJST1JfTVNHID0gJ2EgcnVudGltZSBlcnJvciBvY2N1cmVkISBVc2UgSW5mZXJubyBpbiBkZXZlbG9wbWVudCBlbnZpcm9ubWVudCB0byBmaW5kIHRoZSBlcnJvci4nO1xudmFyIGlzQnJvd3NlciA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5kb2N1bWVudDtcblxuLy8gdGhpcyBpcyBNVUNIIGZhc3RlciB0aGFuIC5jb25zdHJ1Y3RvciA9PT0gQXJyYXkgYW5kIGluc3RhbmNlb2YgQXJyYXlcbi8vIGluIE5vZGUgNyBhbmQgdGhlIGxhdGVyIHZlcnNpb25zIG9mIFY4LCBzbG93ZXIgaW4gb2xkZXIgdmVyc2lvbnMgdGhvdWdoXG52YXIgaXNBcnJheSA9IEFycmF5LmlzQXJyYXk7XG5cbmZ1bmN0aW9uIGlzU3RyaW5nT3JOdW1iZXIob2JqKSB7XG4gICAgdmFyIHR5cGUgPSB0eXBlb2Ygb2JqO1xuICAgIHJldHVybiB0eXBlID09PSAnc3RyaW5nJyB8fCB0eXBlID09PSAnbnVtYmVyJztcbn1cbmZ1bmN0aW9uIGlzTnVsbE9yVW5kZWYob2JqKSB7XG4gICAgcmV0dXJuIGlzVW5kZWZpbmVkKG9iaikgfHwgaXNOdWxsKG9iaik7XG59XG5mdW5jdGlvbiBpc0ludmFsaWQob2JqKSB7XG4gICAgcmV0dXJuIGlzTnVsbChvYmopIHx8IG9iaiA9PT0gZmFsc2UgfHwgaXNUcnVlKG9iaikgfHwgaXNVbmRlZmluZWQob2JqKTtcbn1cbmZ1bmN0aW9uIGlzRnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBvYmogPT09ICdmdW5jdGlvbic7XG59XG5cblxuXG5mdW5jdGlvbiBpc051bGwob2JqKSB7XG4gICAgcmV0dXJuIG9iaiA9PT0gbnVsbDtcbn1cbmZ1bmN0aW9uIGlzVHJ1ZShvYmopIHtcbiAgICByZXR1cm4gb2JqID09PSB0cnVlO1xufVxuZnVuY3Rpb24gaXNVbmRlZmluZWQob2JqKSB7XG4gICAgcmV0dXJuIG9iaiA9PT0gdW5kZWZpbmVkO1xufVxuXG5mdW5jdGlvbiB0aHJvd0Vycm9yKG1lc3NhZ2UpIHtcbiAgICBpZiAoIW1lc3NhZ2UpIHtcbiAgICAgICAgbWVzc2FnZSA9IEVSUk9SX01TRztcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKChcIkluZmVybm8gRXJyb3I6IFwiICsgbWVzc2FnZSkpO1xufVxuXG52YXIgTGlmZWN5Y2xlID0gZnVuY3Rpb24gTGlmZWN5Y2xlKCkge1xuICAgIHRoaXMubGlzdGVuZXJzID0gW107XG4gICAgdGhpcy5mYXN0VW5tb3VudCA9IHRydWU7XG59O1xuTGlmZWN5Y2xlLnByb3RvdHlwZS5hZGRMaXN0ZW5lciA9IGZ1bmN0aW9uIGFkZExpc3RlbmVyIChjYWxsYmFjaykge1xuICAgIHRoaXMubGlzdGVuZXJzLnB1c2goY2FsbGJhY2spO1xufTtcbkxpZmVjeWNsZS5wcm90b3R5cGUudHJpZ2dlciA9IGZ1bmN0aW9uIHRyaWdnZXIgKCkge1xuICAgICAgICB2YXIgdGhpcyQxID0gdGhpcztcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5saXN0ZW5lcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdGhpcyQxLmxpc3RlbmVyc1tpXSgpO1xuICAgIH1cbn07XG5cbnZhciBub09wID0gRVJST1JfTVNHO1xuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICBub09wID0gJ0luZmVybm8gRXJyb3I6IENhbiBvbmx5IHVwZGF0ZSBhIG1vdW50ZWQgb3IgbW91bnRpbmcgY29tcG9uZW50LiBUaGlzIHVzdWFsbHkgbWVhbnMgeW91IGNhbGxlZCBzZXRTdGF0ZSgpIG9yIGZvcmNlVXBkYXRlKCkgb24gYW4gdW5tb3VudGVkIGNvbXBvbmVudC4gVGhpcyBpcyBhIG5vLW9wLic7XG59XG52YXIgY29tcG9uZW50Q2FsbGJhY2tRdWV1ZSA9IG5ldyBNYXAoKTtcbi8vIHdoZW4gYSBjb21wb25lbnRzIHJvb3QgVk5vZGUgaXMgYWxzbyBhIGNvbXBvbmVudCwgd2UgY2FuIHJ1biBpbnRvIGlzc3Vlc1xuLy8gdGhpcyB3aWxsIHJlY3Vyc2l2ZWx5IGxvb2sgZm9yIHZOb2RlLnBhcmVudE5vZGUgaWYgdGhlIFZOb2RlIGlzIGEgY29tcG9uZW50XG5mdW5jdGlvbiB1cGRhdGVQYXJlbnRDb21wb25lbnRWTm9kZXModk5vZGUsIGRvbSkge1xuICAgIGlmICh2Tm9kZS5mbGFncyAmIDI4IC8qIENvbXBvbmVudCAqLykge1xuICAgICAgICB2YXIgcGFyZW50Vk5vZGUgPSB2Tm9kZS5wYXJlbnRWTm9kZTtcbiAgICAgICAgaWYgKHBhcmVudFZOb2RlKSB7XG4gICAgICAgICAgICBwYXJlbnRWTm9kZS5kb20gPSBkb207XG4gICAgICAgICAgICB1cGRhdGVQYXJlbnRDb21wb25lbnRWTm9kZXMocGFyZW50Vk5vZGUsIGRvbSk7XG4gICAgICAgIH1cbiAgICB9XG59XG4vLyB0aGlzIGlzIGluIHNoYXBlcyB0b28sIGJ1dCB3ZSBkb24ndCB3YW50IHRvIGltcG9ydCBmcm9tIHNoYXBlcyBhcyBpdCB3aWxsIHB1bGwgaW4gYSBkdXBsaWNhdGUgb2YgY3JlYXRlVk5vZGVcbmZ1bmN0aW9uIGNyZWF0ZVZvaWRWTm9kZSgpIHtcbiAgICByZXR1cm4gaW5mZXJuby5jcmVhdGVWTm9kZSg0MDk2IC8qIFZvaWQgKi8pO1xufVxuZnVuY3Rpb24gY3JlYXRlVGV4dFZOb2RlKHRleHQpIHtcbiAgICByZXR1cm4gaW5mZXJuby5jcmVhdGVWTm9kZSgxIC8qIFRleHQgKi8sIG51bGwsIG51bGwsIHRleHQpO1xufVxuZnVuY3Rpb24gYWRkVG9RdWV1ZShjb21wb25lbnQsIGZvcmNlLCBjYWxsYmFjaykge1xuICAgIC8vIFRPRE8gdGhpcyBmdW5jdGlvbiBuZWVkcyB0byBiZSByZXZpc2VkIGFuZCBpbXByb3ZlZCBvblxuICAgIHZhciBxdWV1ZSA9IGNvbXBvbmVudENhbGxiYWNrUXVldWUuZ2V0KGNvbXBvbmVudCk7XG4gICAgaWYgKCFxdWV1ZSkge1xuICAgICAgICBxdWV1ZSA9IFtdO1xuICAgICAgICBjb21wb25lbnRDYWxsYmFja1F1ZXVlLnNldChjb21wb25lbnQsIHF1ZXVlKTtcbiAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjb21wb25lbnRDYWxsYmFja1F1ZXVlLmRlbGV0ZShjb21wb25lbnQpO1xuICAgICAgICAgICAgYXBwbHlTdGF0ZShjb21wb25lbnQsIGZvcmNlLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBxdWV1ZS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBxdWV1ZVtpXSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgIHF1ZXVlLnB1c2goY2FsbGJhY2spO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHF1ZXVlU3RhdGVDaGFuZ2VzKGNvbXBvbmVudCwgbmV3U3RhdGUsIGNhbGxiYWNrLCBzeW5jKSB7XG4gICAgaWYgKGlzRnVuY3Rpb24obmV3U3RhdGUpKSB7XG4gICAgICAgIG5ld1N0YXRlID0gbmV3U3RhdGUoY29tcG9uZW50LnN0YXRlLCBjb21wb25lbnQucHJvcHMsIGNvbXBvbmVudC5jb250ZXh0KTtcbiAgICB9XG4gICAgZm9yICh2YXIgc3RhdGVLZXkgaW4gbmV3U3RhdGUpIHtcbiAgICAgICAgY29tcG9uZW50Ll9wZW5kaW5nU3RhdGVbc3RhdGVLZXldID0gbmV3U3RhdGVbc3RhdGVLZXldO1xuICAgIH1cbiAgICBpZiAoIWNvbXBvbmVudC5fcGVuZGluZ1NldFN0YXRlICYmIGlzQnJvd3Nlcikge1xuICAgICAgICBpZiAoc3luYyB8fCBjb21wb25lbnQuX2Jsb2NrUmVuZGVyKSB7XG4gICAgICAgICAgICBjb21wb25lbnQuX3BlbmRpbmdTZXRTdGF0ZSA9IHRydWU7XG4gICAgICAgICAgICBhcHBseVN0YXRlKGNvbXBvbmVudCwgZmFsc2UsIGNhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGFkZFRvUXVldWUoY29tcG9uZW50LCBmYWxzZSwgY2FsbGJhY2spO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBjb21wb25lbnQuc3RhdGUgPSBPYmplY3QuYXNzaWduKHt9LCBjb21wb25lbnQuc3RhdGUsIGNvbXBvbmVudC5fcGVuZGluZ1N0YXRlKTtcbiAgICAgICAgY29tcG9uZW50Ll9wZW5kaW5nU3RhdGUgPSB7fTtcbiAgICB9XG59XG5mdW5jdGlvbiBhcHBseVN0YXRlKGNvbXBvbmVudCwgZm9yY2UsIGNhbGxiYWNrKSB7XG4gICAgaWYgKCghY29tcG9uZW50Ll9kZWZlclNldFN0YXRlIHx8IGZvcmNlKSAmJiAhY29tcG9uZW50Ll9ibG9ja1JlbmRlciAmJiAhY29tcG9uZW50Ll91bm1vdW50ZWQpIHtcbiAgICAgICAgY29tcG9uZW50Ll9wZW5kaW5nU2V0U3RhdGUgPSBmYWxzZTtcbiAgICAgICAgdmFyIHBlbmRpbmdTdGF0ZSA9IGNvbXBvbmVudC5fcGVuZGluZ1N0YXRlO1xuICAgICAgICB2YXIgcHJldlN0YXRlID0gY29tcG9uZW50LnN0YXRlO1xuICAgICAgICB2YXIgbmV4dFN0YXRlID0gT2JqZWN0LmFzc2lnbih7fSwgcHJldlN0YXRlLCBwZW5kaW5nU3RhdGUpO1xuICAgICAgICB2YXIgcHJvcHMgPSBjb21wb25lbnQucHJvcHM7XG4gICAgICAgIHZhciBjb250ZXh0ID0gY29tcG9uZW50LmNvbnRleHQ7XG4gICAgICAgIGNvbXBvbmVudC5fcGVuZGluZ1N0YXRlID0ge307XG4gICAgICAgIHZhciBuZXh0SW5wdXQgPSBjb21wb25lbnQuX3VwZGF0ZUNvbXBvbmVudChwcmV2U3RhdGUsIG5leHRTdGF0ZSwgcHJvcHMsIHByb3BzLCBjb250ZXh0LCBmb3JjZSwgdHJ1ZSk7XG4gICAgICAgIHZhciBkaWRVcGRhdGUgPSB0cnVlO1xuICAgICAgICBpZiAoaXNJbnZhbGlkKG5leHRJbnB1dCkpIHtcbiAgICAgICAgICAgIG5leHRJbnB1dCA9IGNyZWF0ZVZvaWRWTm9kZSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG5leHRJbnB1dCA9PT0gaW5mZXJuby5OT19PUCkge1xuICAgICAgICAgICAgbmV4dElucHV0ID0gY29tcG9uZW50Ll9sYXN0SW5wdXQ7XG4gICAgICAgICAgICBkaWRVcGRhdGUgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpc1N0cmluZ09yTnVtYmVyKG5leHRJbnB1dCkpIHtcbiAgICAgICAgICAgIG5leHRJbnB1dCA9IGNyZWF0ZVRleHRWTm9kZShuZXh0SW5wdXQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGlzQXJyYXkobmV4dElucHV0KSkge1xuICAgICAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgICAgICAgICB0aHJvd0Vycm9yKCdhIHZhbGlkIEluZmVybm8gVk5vZGUgKG9yIG51bGwpIG11c3QgYmUgcmV0dXJuZWQgZnJvbSBhIGNvbXBvbmVudCByZW5kZXIuIFlvdSBtYXkgaGF2ZSByZXR1cm5lZCBhbiBhcnJheSBvciBhbiBpbnZhbGlkIG9iamVjdC4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRocm93RXJyb3IoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbGFzdElucHV0ID0gY29tcG9uZW50Ll9sYXN0SW5wdXQ7XG4gICAgICAgIHZhciB2Tm9kZSA9IGNvbXBvbmVudC5fdk5vZGU7XG4gICAgICAgIHZhciBwYXJlbnREb20gPSAobGFzdElucHV0LmRvbSAmJiBsYXN0SW5wdXQuZG9tLnBhcmVudE5vZGUpIHx8IChsYXN0SW5wdXQuZG9tID0gdk5vZGUuZG9tKTtcbiAgICAgICAgY29tcG9uZW50Ll9sYXN0SW5wdXQgPSBuZXh0SW5wdXQ7XG4gICAgICAgIGlmIChkaWRVcGRhdGUpIHtcbiAgICAgICAgICAgIHZhciBzdWJMaWZlY3ljbGUgPSBjb21wb25lbnQuX2xpZmVjeWNsZTtcbiAgICAgICAgICAgIGlmICghc3ViTGlmZWN5Y2xlKSB7XG4gICAgICAgICAgICAgICAgc3ViTGlmZWN5Y2xlID0gbmV3IExpZmVjeWNsZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc3ViTGlmZWN5Y2xlLmxpc3RlbmVycyA9IFtdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29tcG9uZW50Ll9saWZlY3ljbGUgPSBzdWJMaWZlY3ljbGU7XG4gICAgICAgICAgICB2YXIgY2hpbGRDb250ZXh0ID0gY29tcG9uZW50LmdldENoaWxkQ29udGV4dCgpO1xuICAgICAgICAgICAgaWYgKCFpc051bGxPclVuZGVmKGNoaWxkQ29udGV4dCkpIHtcbiAgICAgICAgICAgICAgICBjaGlsZENvbnRleHQgPSBPYmplY3QuYXNzaWduKHt9LCBjb250ZXh0LCBjb21wb25lbnQuX2NoaWxkQ29udGV4dCwgY2hpbGRDb250ZXh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNoaWxkQ29udGV4dCA9IE9iamVjdC5hc3NpZ24oe30sIGNvbnRleHQsIGNvbXBvbmVudC5fY2hpbGRDb250ZXh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbXBvbmVudC5fcGF0Y2gobGFzdElucHV0LCBuZXh0SW5wdXQsIHBhcmVudERvbSwgc3ViTGlmZWN5Y2xlLCBjaGlsZENvbnRleHQsIGNvbXBvbmVudC5faXNTVkcsIGZhbHNlKTtcbiAgICAgICAgICAgIHN1YkxpZmVjeWNsZS50cmlnZ2VyKCk7XG4gICAgICAgICAgICBjb21wb25lbnQuY29tcG9uZW50RGlkVXBkYXRlKHByb3BzLCBwcmV2U3RhdGUpO1xuICAgICAgICAgICAgaW5mZXJuby5vcHRpb25zLmFmdGVyVXBkYXRlICYmIGluZmVybm8ub3B0aW9ucy5hZnRlclVwZGF0ZSh2Tm9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRvbSA9IHZOb2RlLmRvbSA9IG5leHRJbnB1dC5kb207XG4gICAgICAgIHZhciBjb21wb25lbnRUb0RPTU5vZGVNYXAgPSBjb21wb25lbnQuX2NvbXBvbmVudFRvRE9NTm9kZU1hcDtcbiAgICAgICAgY29tcG9uZW50VG9ET01Ob2RlTWFwICYmIGNvbXBvbmVudFRvRE9NTm9kZU1hcC5zZXQoY29tcG9uZW50LCBuZXh0SW5wdXQuZG9tKTtcbiAgICAgICAgdXBkYXRlUGFyZW50Q29tcG9uZW50Vk5vZGVzKHZOb2RlLCBkb20pO1xuICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWYoY2FsbGJhY2spKSB7XG4gICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKCFpc051bGxPclVuZGVmKGNhbGxiYWNrKSkge1xuICAgICAgICBjYWxsYmFjaygpO1xuICAgIH1cbn1cbnZhciBDb21wb25lbnQkMSA9IGZ1bmN0aW9uIENvbXBvbmVudChwcm9wcywgY29udGV4dCkge1xuICAgIHRoaXMuc3RhdGUgPSB7fTtcbiAgICB0aGlzLnJlZnMgPSB7fTtcbiAgICB0aGlzLl9ibG9ja1JlbmRlciA9IGZhbHNlO1xuICAgIHRoaXMuX2lnbm9yZVNldFN0YXRlID0gZmFsc2U7XG4gICAgdGhpcy5fYmxvY2tTZXRTdGF0ZSA9IGZhbHNlO1xuICAgIHRoaXMuX2RlZmVyU2V0U3RhdGUgPSBmYWxzZTtcbiAgICB0aGlzLl9wZW5kaW5nU2V0U3RhdGUgPSBmYWxzZTtcbiAgICB0aGlzLl9wZW5kaW5nU3RhdGUgPSB7fTtcbiAgICB0aGlzLl9sYXN0SW5wdXQgPSBudWxsO1xuICAgIHRoaXMuX3ZOb2RlID0gbnVsbDtcbiAgICB0aGlzLl91bm1vdW50ZWQgPSB0cnVlO1xuICAgIHRoaXMuX2xpZmVjeWNsZSA9IG51bGw7XG4gICAgdGhpcy5fY2hpbGRDb250ZXh0ID0gbnVsbDtcbiAgICB0aGlzLl9wYXRjaCA9IG51bGw7XG4gICAgdGhpcy5faXNTVkcgPSBmYWxzZTtcbiAgICB0aGlzLl9jb21wb25lbnRUb0RPTU5vZGVNYXAgPSBudWxsO1xuICAgIC8qKiBAdHlwZSB7b2JqZWN0fSAqL1xuICAgIHRoaXMucHJvcHMgPSBwcm9wcyB8fCBpbmZlcm5vLkVNUFRZX09CSjtcbiAgICAvKiogQHR5cGUge29iamVjdH0gKi9cbiAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0IHx8IHt9O1xufTtcbkNvbXBvbmVudCQxLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiByZW5kZXIgKG5leHRQcm9wcywgbmV4dFN0YXRlLCBuZXh0Q29udGV4dCkge1xufTtcbkNvbXBvbmVudCQxLnByb3RvdHlwZS5mb3JjZVVwZGF0ZSA9IGZ1bmN0aW9uIGZvcmNlVXBkYXRlIChjYWxsYmFjaykge1xuICAgIGlmICh0aGlzLl91bm1vdW50ZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpc0Jyb3dzZXIgJiYgYXBwbHlTdGF0ZSh0aGlzLCB0cnVlLCBjYWxsYmFjayk7XG59O1xuQ29tcG9uZW50JDEucHJvdG90eXBlLnNldFN0YXRlID0gZnVuY3Rpb24gc2V0U3RhdGUgKG5ld1N0YXRlLCBjYWxsYmFjaykge1xuICAgIGlmICh0aGlzLl91bm1vdW50ZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoIXRoaXMuX2Jsb2NrU2V0U3RhdGUpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9pZ25vcmVTZXRTdGF0ZSkge1xuICAgICAgICAgICAgcXVldWVTdGF0ZUNoYW5nZXModGhpcywgbmV3U3RhdGUsIGNhbGxiYWNrLCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgICAgICB0aHJvd0Vycm9yKCdjYW5ub3QgdXBkYXRlIHN0YXRlIHZpYSBzZXRTdGF0ZSgpIGluIGNvbXBvbmVudFdpbGxVcGRhdGUoKS4nKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvd0Vycm9yKCk7XG4gICAgfVxufTtcbkNvbXBvbmVudCQxLnByb3RvdHlwZS5zZXRTdGF0ZVN5bmMgPSBmdW5jdGlvbiBzZXRTdGF0ZVN5bmMgKG5ld1N0YXRlKSB7XG4gICAgaWYgKHRoaXMuX3VubW91bnRlZCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICghdGhpcy5fYmxvY2tTZXRTdGF0ZSkge1xuICAgICAgICBpZiAoIXRoaXMuX2lnbm9yZVNldFN0YXRlKSB7XG4gICAgICAgICAgICBxdWV1ZVN0YXRlQ2hhbmdlcyh0aGlzLCBuZXdTdGF0ZSwgbnVsbCwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgICAgICB0aHJvd0Vycm9yKCdjYW5ub3QgdXBkYXRlIHN0YXRlIHZpYSBzZXRTdGF0ZSgpIGluIGNvbXBvbmVudFdpbGxVcGRhdGUoKS4nKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvd0Vycm9yKCk7XG4gICAgfVxufTtcbkNvbXBvbmVudCQxLnByb3RvdHlwZS5jb21wb25lbnRXaWxsTW91bnQgPSBmdW5jdGlvbiBjb21wb25lbnRXaWxsTW91bnQgKCkge1xufTtcbkNvbXBvbmVudCQxLnByb3RvdHlwZS5jb21wb25lbnREaWRVcGRhdGUgPSBmdW5jdGlvbiBjb21wb25lbnREaWRVcGRhdGUgKHByZXZQcm9wcywgcHJldlN0YXRlLCBwcmV2Q29udGV4dCkge1xufTtcbkNvbXBvbmVudCQxLnByb3RvdHlwZS5zaG91bGRDb21wb25lbnRVcGRhdGUgPSBmdW5jdGlvbiBzaG91bGRDb21wb25lbnRVcGRhdGUgKG5leHRQcm9wcywgbmV4dFN0YXRlLCBjb250ZXh0KSB7XG4gICAgcmV0dXJuIHRydWU7XG59O1xuQ29tcG9uZW50JDEucHJvdG90eXBlLmNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMgPSBmdW5jdGlvbiBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzIChuZXh0UHJvcHMsIGNvbnRleHQpIHtcbn07XG5Db21wb25lbnQkMS5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVwZGF0ZSA9IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxVcGRhdGUgKG5leHRQcm9wcywgbmV4dFN0YXRlLCBuZXh0Q29udGV4dCkge1xufTtcbkNvbXBvbmVudCQxLnByb3RvdHlwZS5nZXRDaGlsZENvbnRleHQgPSBmdW5jdGlvbiBnZXRDaGlsZENvbnRleHQgKCkge1xufTtcbkNvbXBvbmVudCQxLnByb3RvdHlwZS5fdXBkYXRlQ29tcG9uZW50ID0gZnVuY3Rpb24gX3VwZGF0ZUNvbXBvbmVudCAocHJldlN0YXRlLCBuZXh0U3RhdGUsIHByZXZQcm9wcywgbmV4dFByb3BzLCBjb250ZXh0LCBmb3JjZSwgZnJvbVNldFN0YXRlKSB7XG4gICAgaWYgKHRoaXMuX3VubW91bnRlZCA9PT0gdHJ1ZSkge1xuICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICAgICAgdGhyb3dFcnJvcihub09wKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvd0Vycm9yKCk7XG4gICAgfVxuICAgIGlmICgocHJldlByb3BzICE9PSBuZXh0UHJvcHMgfHwgbmV4dFByb3BzID09PSBpbmZlcm5vLkVNUFRZX09CSikgfHwgcHJldlN0YXRlICE9PSBuZXh0U3RhdGUgfHwgZm9yY2UpIHtcbiAgICAgICAgaWYgKHByZXZQcm9wcyAhPT0gbmV4dFByb3BzIHx8IG5leHRQcm9wcyA9PT0gaW5mZXJuby5FTVBUWV9PQkopIHtcbiAgICAgICAgICAgIGlmICghZnJvbVNldFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYmxvY2tSZW5kZXIgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXh0UHJvcHMsIGNvbnRleHQpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2Jsb2NrUmVuZGVyID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5fcGVuZGluZ1NldFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgbmV4dFN0YXRlID0gT2JqZWN0LmFzc2lnbih7fSwgbmV4dFN0YXRlLCB0aGlzLl9wZW5kaW5nU3RhdGUpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdTZXRTdGF0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdTdGF0ZSA9IHt9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBzaG91bGRVcGRhdGUgPSB0aGlzLnNob3VsZENvbXBvbmVudFVwZGF0ZShuZXh0UHJvcHMsIG5leHRTdGF0ZSwgY29udGV4dCk7XG4gICAgICAgIGlmIChzaG91bGRVcGRhdGUgIT09IGZhbHNlIHx8IGZvcmNlKSB7XG4gICAgICAgICAgICB0aGlzLl9ibG9ja1NldFN0YXRlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuY29tcG9uZW50V2lsbFVwZGF0ZShuZXh0UHJvcHMsIG5leHRTdGF0ZSwgY29udGV4dCk7XG4gICAgICAgICAgICB0aGlzLl9ibG9ja1NldFN0YXRlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnByb3BzID0gbmV4dFByb3BzO1xuICAgICAgICAgICAgdmFyIHN0YXRlID0gdGhpcy5zdGF0ZSA9IG5leHRTdGF0ZTtcbiAgICAgICAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XG4gICAgICAgICAgICBpbmZlcm5vLm9wdGlvbnMuYmVmb3JlUmVuZGVyICYmIGluZmVybm8ub3B0aW9ucy5iZWZvcmVSZW5kZXIodGhpcyk7XG4gICAgICAgICAgICB2YXIgcmVuZGVyID0gdGhpcy5yZW5kZXIobmV4dFByb3BzLCBzdGF0ZSwgY29udGV4dCk7XG4gICAgICAgICAgICBpbmZlcm5vLm9wdGlvbnMuYWZ0ZXJSZW5kZXIgJiYgaW5mZXJuby5vcHRpb25zLmFmdGVyUmVuZGVyKHRoaXMpO1xuICAgICAgICAgICAgcmV0dXJuIHJlbmRlcjtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gaW5mZXJuby5OT19PUDtcbn07XG5cbnJldHVybiBDb21wb25lbnQkMTtcblxufSkpKTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9pbmZlcm5vL2Rpc3QvaW5mZXJuby1jb21wb25lbnQubm9kZS5qc1xuLy8gbW9kdWxlIGlkID0gNTlcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyohXG4gKiBpbmZlcm5vLWNyZWF0ZS1lbGVtZW50IHYxLjIuMlxuICogKGMpIDIwMTcgRG9taW5pYyBHYW5uYXdheVxuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxuICovXG4oZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuXHR0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgPyBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZSgnaW5mZXJubycpKSA6XG5cdHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShbJ2luZmVybm8nXSwgZmFjdG9yeSkgOlxuXHQoZ2xvYmFsLkluZmVybm8gPSBnbG9iYWwuSW5mZXJubyB8fCB7fSwgZ2xvYmFsLkluZmVybm8uY3JlYXRlRWxlbWVudCA9IGZhY3RvcnkoZ2xvYmFsLkluZmVybm8pKTtcbn0odGhpcywgKGZ1bmN0aW9uIChpbmZlcm5vKSB7ICd1c2Ugc3RyaWN0JztcblxuLy8gdGhpcyBpcyBNVUNIIGZhc3RlciB0aGFuIC5jb25zdHJ1Y3RvciA9PT0gQXJyYXkgYW5kIGluc3RhbmNlb2YgQXJyYXlcbi8vIGluIE5vZGUgNyBhbmQgdGhlIGxhdGVyIHZlcnNpb25zIG9mIFY4LCBzbG93ZXIgaW4gb2xkZXIgdmVyc2lvbnMgdGhvdWdoXG5cbmZ1bmN0aW9uIGlzU3RhdGVmdWxDb21wb25lbnQobykge1xuICAgIHJldHVybiAhaXNVbmRlZmluZWQoby5wcm90b3R5cGUpICYmICFpc1VuZGVmaW5lZChvLnByb3RvdHlwZS5yZW5kZXIpO1xufVxuXG5mdW5jdGlvbiBpc051bGxPclVuZGVmKG9iaikge1xuICAgIHJldHVybiBpc1VuZGVmaW5lZChvYmopIHx8IGlzTnVsbChvYmopO1xufVxuZnVuY3Rpb24gaXNJbnZhbGlkKG9iaikge1xuICAgIHJldHVybiBpc051bGwob2JqKSB8fCBvYmogPT09IGZhbHNlIHx8IGlzVHJ1ZShvYmopIHx8IGlzVW5kZWZpbmVkKG9iaik7XG59XG5cbmZ1bmN0aW9uIGlzQXR0ckFuRXZlbnQoYXR0cikge1xuICAgIHJldHVybiBhdHRyWzBdID09PSAnbycgJiYgYXR0clsxXSA9PT0gJ24nICYmIGF0dHIubGVuZ3RoID4gMztcbn1cbmZ1bmN0aW9uIGlzU3RyaW5nKG9iaikge1xuICAgIHJldHVybiB0eXBlb2Ygb2JqID09PSAnc3RyaW5nJztcbn1cblxuZnVuY3Rpb24gaXNOdWxsKG9iaikge1xuICAgIHJldHVybiBvYmogPT09IG51bGw7XG59XG5mdW5jdGlvbiBpc1RydWUob2JqKSB7XG4gICAgcmV0dXJuIG9iaiA9PT0gdHJ1ZTtcbn1cbmZ1bmN0aW9uIGlzVW5kZWZpbmVkKG9iaikge1xuICAgIHJldHVybiBvYmogPT09IHVuZGVmaW5lZDtcbn1cbmZ1bmN0aW9uIGlzT2JqZWN0KG8pIHtcbiAgICByZXR1cm4gdHlwZW9mIG8gPT09ICdvYmplY3QnO1xufVxuXG52YXIgY29tcG9uZW50SG9va3MgPSB7XG4gICAgb25Db21wb25lbnRXaWxsTW91bnQ6IHRydWUsXG4gICAgb25Db21wb25lbnREaWRNb3VudDogdHJ1ZSxcbiAgICBvbkNvbXBvbmVudFdpbGxVbm1vdW50OiB0cnVlLFxuICAgIG9uQ29tcG9uZW50U2hvdWxkVXBkYXRlOiB0cnVlLFxuICAgIG9uQ29tcG9uZW50V2lsbFVwZGF0ZTogdHJ1ZSxcbiAgICBvbkNvbXBvbmVudERpZFVwZGF0ZTogdHJ1ZVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUVsZW1lbnQkMShuYW1lLCBwcm9wcykge1xuICAgIHZhciBfY2hpbGRyZW4gPSBbXSwgbGVuID0gYXJndW1lbnRzLmxlbmd0aCAtIDI7XG4gICAgd2hpbGUgKCBsZW4tLSA+IDAgKSBfY2hpbGRyZW5bIGxlbiBdID0gYXJndW1lbnRzWyBsZW4gKyAyIF07XG5cbiAgICBpZiAoaXNJbnZhbGlkKG5hbWUpIHx8IGlzT2JqZWN0KG5hbWUpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW5mZXJubyBFcnJvcjogY3JlYXRlRWxlbWVudCgpIG5hbWUgcGFyYW1ldGVyIGNhbm5vdCBiZSB1bmRlZmluZWQsIG51bGwsIGZhbHNlIG9yIHRydWUsIEl0IG11c3QgYmUgYSBzdHJpbmcsIGNsYXNzIG9yIGZ1bmN0aW9uLicpO1xuICAgIH1cbiAgICB2YXIgY2hpbGRyZW4gPSBfY2hpbGRyZW47XG4gICAgdmFyIHJlZiA9IG51bGw7XG4gICAgdmFyIGtleSA9IG51bGw7XG4gICAgdmFyIGV2ZW50cyA9IG51bGw7XG4gICAgdmFyIGZsYWdzID0gMDtcbiAgICBpZiAoX2NoaWxkcmVuKSB7XG4gICAgICAgIGlmIChfY2hpbGRyZW4ubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICBjaGlsZHJlbiA9IF9jaGlsZHJlblswXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChfY2hpbGRyZW4ubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBjaGlsZHJlbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoaXNTdHJpbmcobmFtZSkpIHtcbiAgICAgICAgZmxhZ3MgPSAyIC8qIEh0bWxFbGVtZW50ICovO1xuICAgICAgICBzd2l0Y2ggKG5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgJ3N2Zyc6XG4gICAgICAgICAgICAgICAgZmxhZ3MgPSAxMjggLyogU3ZnRWxlbWVudCAqLztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2lucHV0JzpcbiAgICAgICAgICAgICAgICBmbGFncyA9IDUxMiAvKiBJbnB1dEVsZW1lbnQgKi87XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICd0ZXh0YXJlYSc6XG4gICAgICAgICAgICAgICAgZmxhZ3MgPSAxMDI0IC8qIFRleHRhcmVhRWxlbWVudCAqLztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdCc6XG4gICAgICAgICAgICAgICAgZmxhZ3MgPSAyMDQ4IC8qIFNlbGVjdEVsZW1lbnQgKi87XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICB9XG4gICAgICAgIC8qXG4gICAgICAgICBUaGlzIGZpeGVzIGRlLW9wdGltaXNhdGlvbjpcbiAgICAgICAgIHVzZXMgb2JqZWN0IEtleXMgZm9yIGxvb3BpbmcgcHJvcHMgdG8gYXZvaWQgZGVsZXRpbmcgcHJvcHMgb2YgbG9vcGVkIG9iamVjdFxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKCFpc051bGxPclVuZGVmKHByb3BzKSkge1xuICAgICAgICAgICAgdmFyIHByb3BLZXlzID0gT2JqZWN0LmtleXMocHJvcHMpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wS2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBwcm9wS2V5ID0gcHJvcEtleXNbaV07XG4gICAgICAgICAgICAgICAgaWYgKHByb3BLZXkgPT09ICdrZXknKSB7XG4gICAgICAgICAgICAgICAgICAgIGtleSA9IHByb3BzLmtleTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHByb3BzLmtleTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAocHJvcEtleSA9PT0gJ2NoaWxkcmVuJyAmJiBpc1VuZGVmaW5lZChjaGlsZHJlbikpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW4gPSBwcm9wcy5jaGlsZHJlbjsgLy8gYWx3YXlzIGZhdm91ciBjaGlsZHJlbiBhcmdzLCBkZWZhdWx0IHRvIHByb3BzXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHByb3BLZXkgPT09ICdyZWYnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlZiA9IHByb3BzLnJlZjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoaXNBdHRyQW5FdmVudChwcm9wS2V5KSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWV2ZW50cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRzID0ge307XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZXZlbnRzW3Byb3BLZXldID0gcHJvcHNbcHJvcEtleV07XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBwcm9wc1twcm9wS2V5XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGZsYWdzID0gaXNTdGF0ZWZ1bENvbXBvbmVudChuYW1lKSA/IDQgLyogQ29tcG9uZW50Q2xhc3MgKi8gOiA4IC8qIENvbXBvbmVudEZ1bmN0aW9uICovO1xuICAgICAgICBpZiAoIWlzVW5kZWZpbmVkKGNoaWxkcmVuKSkge1xuICAgICAgICAgICAgaWYgKCFwcm9wcykge1xuICAgICAgICAgICAgICAgIHByb3BzID0ge307XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwcm9wcy5jaGlsZHJlbiA9IGNoaWxkcmVuO1xuICAgICAgICAgICAgY2hpbGRyZW4gPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZihwcm9wcykpIHtcbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgVGhpcyBmaXhlcyBkZS1vcHRpbWlzYXRpb246XG4gICAgICAgICAgICAgdXNlcyBvYmplY3QgS2V5cyBmb3IgbG9vcGluZyBwcm9wcyB0byBhdm9pZCBkZWxldGluZyBwcm9wcyBvZiBsb29wZWQgb2JqZWN0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHZhciBwcm9wS2V5cyQxID0gT2JqZWN0LmtleXMocHJvcHMpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSQxID0gMDsgaSQxIDwgcHJvcEtleXMkMS5sZW5ndGg7IGkkMSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHByb3BLZXkkMSA9IHByb3BLZXlzJDFbaSQxXTtcbiAgICAgICAgICAgICAgICBpZiAoY29tcG9uZW50SG9va3NbcHJvcEtleSQxXSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXJlZikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVmID0ge307XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmVmW3Byb3BLZXkkMV0gPSBwcm9wc1twcm9wS2V5JDFdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChwcm9wS2V5JDEgPT09ICdrZXknKSB7XG4gICAgICAgICAgICAgICAgICAgIGtleSA9IHByb3BzLmtleTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHByb3BzLmtleTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGluZmVybm8uY3JlYXRlVk5vZGUoZmxhZ3MsIG5hbWUsIHByb3BzLCBjaGlsZHJlbiwgZXZlbnRzLCBrZXksIHJlZik7XG59XG5cbnJldHVybiBjcmVhdGVFbGVtZW50JDE7XG5cbn0pKSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vaW5mZXJuby9kaXN0L2luZmVybm8tY3JlYXRlLWVsZW1lbnQubm9kZS5qc1xuLy8gbW9kdWxlIGlkID0gNjBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyohXG4gKiBpbmZlcm5vLXJvdXRlciB2MS4yLjJcbiAqIChjKSAyMDE3IERvbWluaWMgR2FubmF3YXlcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cbiAqL1xuKGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHtcblx0dHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnID8gbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KHJlcXVpcmUoJ2luZmVybm8nKSwgcmVxdWlyZSgnaW5mZXJuby1jb21wb25lbnQnKSwgcmVxdWlyZSgnaW5mZXJuby1jcmVhdGUtZWxlbWVudCcpKSA6XG5cdHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShbJ2luZmVybm8nLCAnaW5mZXJuby1jb21wb25lbnQnLCAnaW5mZXJuby1jcmVhdGUtZWxlbWVudCddLCBmYWN0b3J5KSA6XG5cdChnbG9iYWwuSW5mZXJubyA9IGdsb2JhbC5JbmZlcm5vIHx8IHt9LCBnbG9iYWwuSW5mZXJuby5Sb3V0ZXIgPSBmYWN0b3J5KGdsb2JhbC5JbmZlcm5vLGdsb2JhbC5JbmZlcm5vLkNvbXBvbmVudCxnbG9iYWwuSW5mZXJuby5jcmVhdGVFbGVtZW50KSk7XG59KHRoaXMsIChmdW5jdGlvbiAoSW5mZXJubyxDb21wb25lbnQsY3JlYXRlRWxlbWVudCkgeyAndXNlIHN0cmljdCc7XG5cbnZhciBJbmZlcm5vX19kZWZhdWx0ID0gJ2RlZmF1bHQnIGluIEluZmVybm8gPyBJbmZlcm5vWydkZWZhdWx0J10gOiBJbmZlcm5vO1xuQ29tcG9uZW50ID0gJ2RlZmF1bHQnIGluIENvbXBvbmVudCA/IENvbXBvbmVudFsnZGVmYXVsdCddIDogQ29tcG9uZW50O1xuY3JlYXRlRWxlbWVudCA9ICdkZWZhdWx0JyBpbiBjcmVhdGVFbGVtZW50ID8gY3JlYXRlRWxlbWVudFsnZGVmYXVsdCddIDogY3JlYXRlRWxlbWVudDtcblxuZnVuY3Rpb24gTGluayhwcm9wcywgcmVmKSB7XG4gICAgdmFyIHJvdXRlciA9IHJlZi5yb3V0ZXI7XG5cbiAgICB2YXIgYWN0aXZlQ2xhc3NOYW1lID0gcHJvcHMuYWN0aXZlQ2xhc3NOYW1lO1xuICAgIHZhciBhY3RpdmVTdHlsZSA9IHByb3BzLmFjdGl2ZVN0eWxlO1xuICAgIHZhciBjbGFzc05hbWUgPSBwcm9wcy5jbGFzc05hbWU7XG4gICAgdmFyIG9uQ2xpY2sgPSBwcm9wcy5vbkNsaWNrO1xuICAgIHZhciB0byA9IHByb3BzLnRvO1xuICAgIHZhciBlbGVtUHJvcHMgPSB7XG4gICAgICAgIGhyZWY6IHRvXG4gICAgfTtcbiAgICBpZiAoY2xhc3NOYW1lKSB7XG4gICAgICAgIGVsZW1Qcm9wcy5jbGFzc05hbWUgPSBjbGFzc05hbWU7XG4gICAgfVxuICAgIGlmIChyb3V0ZXIubG9jYXRpb24ucGF0aG5hbWUgPT09IHRvKSB7XG4gICAgICAgIGlmIChhY3RpdmVDbGFzc05hbWUpIHtcbiAgICAgICAgICAgIGVsZW1Qcm9wcy5jbGFzc05hbWUgPSAoY2xhc3NOYW1lID8gY2xhc3NOYW1lICsgJyAnIDogJycpICsgYWN0aXZlQ2xhc3NOYW1lO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhY3RpdmVTdHlsZSkge1xuICAgICAgICAgICAgZWxlbVByb3BzLnN0eWxlID0gT2JqZWN0LmFzc2lnbih7fSwgcHJvcHMuc3R5bGUsIGFjdGl2ZVN0eWxlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbGVtUHJvcHMub25jbGljayA9IGZ1bmN0aW9uIG5hdmlnYXRlKGUpIHtcbiAgICAgICAgaWYgKGUuYnV0dG9uICE9PSAwIHx8IGUuY3RybEtleSB8fCBlLmFsdEtleSB8fCBlLm1ldGFLZXkgfHwgZS5zaGlmdEtleSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgaWYgKHR5cGVvZiBvbkNsaWNrID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBvbkNsaWNrKGUpO1xuICAgICAgICB9XG4gICAgICAgIHJvdXRlci5wdXNoKHRvLCBlLnRhcmdldC50ZXh0Q29udGVudCk7XG4gICAgfTtcbiAgICByZXR1cm4gSW5mZXJuby5jcmVhdGVWTm9kZSgyIC8qIEh0bWxFbGVtZW50ICovLCAnYScsIGVsZW1Qcm9wcywgcHJvcHMuY2hpbGRyZW4pO1xufVxuXG5mdW5jdGlvbiBJbmRleExpbmsocHJvcHMpIHtcbiAgICBwcm9wcy50byA9ICcvJztcbiAgICByZXR1cm4gSW5mZXJuby5jcmVhdGVWTm9kZSg4IC8qIENvbXBvbmVudEZ1bmN0aW9uICovLCBMaW5rLCBwcm9wcyk7XG59XG5cbmZ1bmN0aW9uIHRvQXJyYXkoY2hpbGRyZW4pIHtcbiAgICByZXR1cm4gaXNBcnJheShjaGlsZHJlbikgPyBjaGlsZHJlbiA6IChjaGlsZHJlbiA/IFtjaGlsZHJlbl0gOiBjaGlsZHJlbik7XG59XG4vLyB0aGlzIGlzIE1VQ0ggZmFzdGVyIHRoYW4gLmNvbnN0cnVjdG9yID09PSBBcnJheSBhbmQgaW5zdGFuY2VvZiBBcnJheVxuLy8gaW4gTm9kZSA3IGFuZCB0aGUgbGF0ZXIgdmVyc2lvbnMgb2YgVjgsIHNsb3dlciBpbiBvbGRlciB2ZXJzaW9ucyB0aG91Z2hcbnZhciBpc0FycmF5ID0gQXJyYXkuaXNBcnJheTtcblxuXG5cblxuXG5cbmZ1bmN0aW9uIGlzU3RyaW5nKG9iaikge1xuICAgIHJldHVybiB0eXBlb2Ygb2JqID09PSAnc3RyaW5nJztcbn1cblxudmFyIGVtcHR5T2JqZWN0ID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbmZ1bmN0aW9uIGRlY29kZSh2YWwpIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbCAhPT0gJ3N0cmluZycgPyB2YWwgOiBkZWNvZGVVUklDb21wb25lbnQodmFsKTtcbn1cbmZ1bmN0aW9uIGlzRW1wdHkoY2hpbGRyZW4pIHtcbiAgICByZXR1cm4gIWNoaWxkcmVuIHx8ICEoaXNBcnJheShjaGlsZHJlbikgPyBjaGlsZHJlbiA6IE9iamVjdC5rZXlzKGNoaWxkcmVuKSkubGVuZ3RoO1xufVxuZnVuY3Rpb24gZmxhdHRlbihvbGRBcnJheSkge1xuICAgIHZhciBuZXdBcnJheSA9IFtdO1xuICAgIGZsYXR0ZW5BcnJheShvbGRBcnJheSwgbmV3QXJyYXkpO1xuICAgIHJldHVybiBuZXdBcnJheTtcbn1cbmZ1bmN0aW9uIGdldFVSTFN0cmluZyhsb2NhdGlvbikge1xuICAgIHJldHVybiBpc1N0cmluZyhsb2NhdGlvbikgPyBsb2NhdGlvbiA6IChsb2NhdGlvbi5wYXRobmFtZSArIGxvY2F0aW9uLnNlYXJjaCk7XG59XG4vKipcbiAqIE1hcHMgYSBxdWVyeXN0cmluZyB0byBhbiBvYmplY3RcbiAqIFN1cHBvcnRzIGFycmF5cyBhbmQgdXRmLTggY2hhcmFjdGVyc1xuICogQHBhcmFtIHNlYXJjaFxuICogQHJldHVybnMge2FueX1cbiAqL1xuZnVuY3Rpb24gbWFwU2VhcmNoUGFyYW1zKHNlYXJjaCkge1xuICAgIGlmIChzZWFyY2ggPT09ICcnKSB7XG4gICAgICAgIHJldHVybiB7fTtcbiAgICB9XG4gICAgLy8gQ3JlYXRlIGFuIG9iamVjdCB3aXRoIG5vIHByb3RvdHlwZVxuICAgIHZhciBtYXAgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgIHZhciBmcmFnbWVudHMgPSBzZWFyY2guc3BsaXQoJyYnKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZyYWdtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgZnJhZ21lbnQgPSBmcmFnbWVudHNbaV07XG4gICAgICAgIHZhciByZWYgPSBmcmFnbWVudC5zcGxpdCgnPScpLm1hcChtYXBGcmFnbWVudCk7XG4gICAgICAgIHZhciBrID0gcmVmWzBdO1xuICAgICAgICB2YXIgdiA9IHJlZlsxXTtcbiAgICAgICAgaWYgKG1hcFtrXSkge1xuICAgICAgICAgICAgbWFwW2tdID0gaXNBcnJheShtYXBba10pID8gbWFwW2tdIDogW21hcFtrXV07XG4gICAgICAgICAgICBtYXBba10ucHVzaCh2KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG1hcFtrXSA9IHY7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG1hcDtcbn1cbi8qKlxuICogR2V0cyB0aGUgcmVsZXZhbnQgcGFydCBvZiB0aGUgVVJMIGZvciBtYXRjaGluZ1xuICogQHBhcmFtIGZ1bGxVUkxcbiAqIEBwYXJhbSBwYXJ0VVJMXG4gKiBAcmV0dXJucyB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiB0b1BhcnRpYWxVUkwoZnVsbFVSTCwgcGFydFVSTCkge1xuICAgIGlmIChmdWxsVVJMLmluZGV4T2YocGFydFVSTCkgPT09IDApIHtcbiAgICAgICAgcmV0dXJuIGZ1bGxVUkwuc3Vic3RyKHBhcnRVUkwubGVuZ3RoKTtcbiAgICB9XG4gICAgcmV0dXJuIGZ1bGxVUkw7XG59XG4vKipcbiAqIFNpbXVsYXRlcyAuLi4gb3BlcmF0b3IgYnkgcmV0dXJuaW5nIGZpcnN0IGFyZ3VtZW50XG4gKiB3aXRoIHRoZSBrZXlzIGluIHRoZSBzZWNvbmQgYXJndW1lbnQgZXhjbHVkZWRcbiAqIEBwYXJhbSBfYXJnc1xuICogQHBhcmFtIGV4Y2x1ZGVkXG4gKiBAcmV0dXJucyB7e319XG4gKi9cbmZ1bmN0aW9uIHJlc3QoX2FyZ3MsIGV4Y2x1ZGVkKSB7XG4gICAgdmFyIHQgPSB7fTtcbiAgICBmb3IgKHZhciBwIGluIF9hcmdzKSB7XG4gICAgICAgIGlmIChleGNsdWRlZC5pbmRleE9mKHApIDwgMCkge1xuICAgICAgICAgICAgdFtwXSA9IF9hcmdzW3BdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0O1xufVxuLyoqXG4gKiBTb3J0cyBhbiBhcnJheSBhY2NvcmRpbmcgdG8gaXRzIGBwYXRoYCBwcm9wIGxlbmd0aFxuICogQHBhcmFtIGFcbiAqIEBwYXJhbSBiXG4gKiBAcmV0dXJucyB7bnVtYmVyfVxuICovXG5mdW5jdGlvbiBwYXRoUmFua1NvcnQoYSwgYikge1xuICAgIHZhciBhQXR0ciA9IGEucHJvcHMgfHwgZW1wdHlPYmplY3Q7XG4gICAgdmFyIGJBdHRyID0gYi5wcm9wcyB8fCBlbXB0eU9iamVjdDtcbiAgICB2YXIgZGlmZiA9IHJhbmsoYkF0dHIucGF0aCkgLSByYW5rKGFBdHRyLnBhdGgpO1xuICAgIHJldHVybiBkaWZmIHx8ICgoYkF0dHIucGF0aCAmJiBhQXR0ci5wYXRoKSA/IChiQXR0ci5wYXRoLmxlbmd0aCAtIGFBdHRyLnBhdGgubGVuZ3RoKSA6IDApO1xufVxuLyoqXG4gKiBIZWxwZXIgZnVuY3Rpb24gZm9yIHBhcnNpbmcgcXVlcnlzdHJpbmcgYXJyYXlzXG4gKi9cbmZ1bmN0aW9uIG1hcEZyYWdtZW50KHAsIGlzVmFsKSB7XG4gICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChpc1ZhbCB8IDAgPyBwIDogcC5yZXBsYWNlKCdbXScsICcnKSk7XG59XG5mdW5jdGlvbiBzdHJpcCh1cmwpIHtcbiAgICByZXR1cm4gdXJsLnJlcGxhY2UoLyheXFwvK3xcXC8rJCkvZywgJycpO1xufVxuZnVuY3Rpb24gcmFuayh1cmwpIHtcbiAgICBpZiAoIHVybCA9PT0gdm9pZCAwICkgdXJsID0gJyc7XG5cbiAgICByZXR1cm4gKHN0cmlwKHVybCkubWF0Y2goL1xcLysvZykgfHwgJycpLmxlbmd0aDtcbn1cbmZ1bmN0aW9uIGZsYXR0ZW5BcnJheShvbGRBcnJheSwgbmV3QXJyYXkpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9sZEFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBpdGVtID0gb2xkQXJyYXlbaV07XG4gICAgICAgIGlmIChpc0FycmF5KGl0ZW0pKSB7XG4gICAgICAgICAgICBmbGF0dGVuQXJyYXkoaXRlbSwgbmV3QXJyYXkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmV3QXJyYXkucHVzaChpdGVtKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxudmFyIFJvdXRlID0gKGZ1bmN0aW9uIChDb21wb25lbnQkJDEpIHtcbiAgICBmdW5jdGlvbiBSb3V0ZShwcm9wcywgY29udGV4dCkge1xuICAgICAgICB2YXIgdGhpcyQxID0gdGhpcztcblxuICAgICAgICBDb21wb25lbnQkJDEuY2FsbCh0aGlzLCBwcm9wcywgY29udGV4dCk7XG4gICAgICAgIHRoaXMuX29uQ29tcG9uZW50UmVzb2x2ZWQgPSBmdW5jdGlvbiAoZXJyb3IsIGNvbXBvbmVudCkge1xuICAgICAgICAgICAgdGhpcyQxLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICBhc3luY0NvbXBvbmVudDogY29tcG9uZW50XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgICAgIGFzeW5jQ29tcG9uZW50OiBudWxsXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgaWYgKCBDb21wb25lbnQkJDEgKSBSb3V0ZS5fX3Byb3RvX18gPSBDb21wb25lbnQkJDE7XG4gICAgUm91dGUucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSggQ29tcG9uZW50JCQxICYmIENvbXBvbmVudCQkMS5wcm90b3R5cGUgKTtcbiAgICBSb3V0ZS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBSb3V0ZTtcbiAgICBSb3V0ZS5wcm90b3R5cGUuY29tcG9uZW50V2lsbE1vdW50ID0gZnVuY3Rpb24gY29tcG9uZW50V2lsbE1vdW50ICgpIHtcbiAgICAgICAgdmFyIHRoaXMkMSA9IHRoaXM7XG5cbiAgICAgICAgdmFyIHJlZiA9IHRoaXMucHJvcHM7XG4gICAgICAgIHZhciBvbkVudGVyID0gcmVmLm9uRW50ZXI7XG4gICAgICAgIHZhciByZWYkMSA9IHRoaXMuY29udGV4dDtcbiAgICAgICAgdmFyIHJvdXRlciA9IHJlZiQxLnJvdXRlcjtcbiAgICAgICAgaWYgKG9uRW50ZXIpIHtcbiAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIG9uRW50ZXIoeyBwcm9wczogdGhpcyQxLnByb3BzLCByb3V0ZXI6IHJvdXRlciB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHZhciByZWYkMiA9IHRoaXMucHJvcHM7XG4gICAgICAgIHZhciBnZXRDb21wb25lbnQgPSByZWYkMi5nZXRDb21wb25lbnQ7XG4gICAgICAgIGlmIChnZXRDb21wb25lbnQpIHtcbiAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdldENvbXBvbmVudCh7IHByb3BzOiB0aGlzJDEucHJvcHMsIHJvdXRlcjogcm91dGVyIH0sIHRoaXMkMS5fb25Db21wb25lbnRSZXNvbHZlZCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUm91dGUucHJvdG90eXBlLm9uTGVhdmUgPSBmdW5jdGlvbiBvbkxlYXZlICh0cmlnZ2VyKSB7XG4gICAgICAgIGlmICggdHJpZ2dlciA9PT0gdm9pZCAwICkgdHJpZ2dlciA9IGZhbHNlO1xuXG4gICAgICAgIHZhciByZWYgPSB0aGlzLnByb3BzO1xuICAgICAgICB2YXIgb25MZWF2ZSA9IHJlZi5vbkxlYXZlO1xuICAgICAgICB2YXIgcmVmJDEgPSB0aGlzLmNvbnRleHQ7XG4gICAgICAgIHZhciByb3V0ZXIgPSByZWYkMS5yb3V0ZXI7XG4gICAgICAgIGlmIChvbkxlYXZlICYmIHRyaWdnZXIpIHtcbiAgICAgICAgICAgIG9uTGVhdmUoeyBwcm9wczogdGhpcy5wcm9wcywgcm91dGVyOiByb3V0ZXIgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFJvdXRlLnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudCA9IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxVbm1vdW50ICgpIHtcbiAgICAgICAgdGhpcy5vbkxlYXZlKHRydWUpO1xuICAgIH07XG4gICAgUm91dGUucHJvdG90eXBlLmNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMgPSBmdW5jdGlvbiBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzIChuZXh0UHJvcHMpIHtcbiAgICAgICAgdGhpcy5vbkxlYXZlKHRoaXMucHJvcHMucGF0aCAhPT0gbmV4dFByb3BzLnBhdGgpO1xuICAgIH07XG4gICAgUm91dGUucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uIHJlbmRlciAoX2FyZ3MpIHtcbiAgICAgICAgdmFyIGNvbXBvbmVudCA9IF9hcmdzLmNvbXBvbmVudDtcbiAgICAgICAgdmFyIGNoaWxkcmVuID0gX2FyZ3MuY2hpbGRyZW47XG4gICAgICAgIHZhciBwcm9wcyA9IHJlc3QoX2FyZ3MsIFsnY29tcG9uZW50JywgJ2NoaWxkcmVuJywgJ3BhdGgnXSk7XG4gICAgICAgIHZhciByZWYgPSB0aGlzLnN0YXRlO1xuICAgICAgICB2YXIgYXN5bmNDb21wb25lbnQgPSByZWYuYXN5bmNDb21wb25lbnQ7XG4gICAgICAgIHZhciByZXNvbHZlZENvbXBvbmVudCA9IGNvbXBvbmVudCB8fCBhc3luY0NvbXBvbmVudDtcbiAgICAgICAgaWYgKCFyZXNvbHZlZENvbXBvbmVudCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNyZWF0ZUVsZW1lbnQocmVzb2x2ZWRDb21wb25lbnQsIHByb3BzLCBjaGlsZHJlbik7XG4gICAgfTtcblxuICAgIHJldHVybiBSb3V0ZTtcbn0oQ29tcG9uZW50KSk7XG5cbnZhciBJbmRleFJvdXRlID0gKGZ1bmN0aW9uIChSb3V0ZSQkMSkge1xuICAgIGZ1bmN0aW9uIEluZGV4Um91dGUocHJvcHMsIGNvbnRleHQpIHtcbiAgICAgICAgUm91dGUkJDEuY2FsbCh0aGlzLCBwcm9wcywgY29udGV4dCk7XG4gICAgICAgIHByb3BzLnBhdGggPSAnLyc7XG4gICAgfVxuXG4gICAgaWYgKCBSb3V0ZSQkMSApIEluZGV4Um91dGUuX19wcm90b19fID0gUm91dGUkJDE7XG4gICAgSW5kZXhSb3V0ZS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKCBSb3V0ZSQkMSAmJiBSb3V0ZSQkMS5wcm90b3R5cGUgKTtcbiAgICBJbmRleFJvdXRlLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEluZGV4Um91dGU7XG5cbiAgICByZXR1cm4gSW5kZXhSb3V0ZTtcbn0oUm91dGUpKTtcblxudmFyIFJlZGlyZWN0ID0gKGZ1bmN0aW9uIChSb3V0ZSQkMSkge1xuICAgIGZ1bmN0aW9uIFJlZGlyZWN0KHByb3BzLCBjb250ZXh0KSB7XG4gICAgICAgIFJvdXRlJCQxLmNhbGwodGhpcywgcHJvcHMsIGNvbnRleHQpO1xuICAgICAgICBpZiAoIXByb3BzLnRvKSB7XG4gICAgICAgICAgICBwcm9wcy50byA9ICcvJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmICggUm91dGUkJDEgKSBSZWRpcmVjdC5fX3Byb3RvX18gPSBSb3V0ZSQkMTtcbiAgICBSZWRpcmVjdC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKCBSb3V0ZSQkMSAmJiBSb3V0ZSQkMS5wcm90b3R5cGUgKTtcbiAgICBSZWRpcmVjdC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBSZWRpcmVjdDtcblxuICAgIHJldHVybiBSZWRpcmVjdDtcbn0oUm91dGUpKTtcblxuZnVuY3Rpb24gY3JlYXRlQ29tbW9uanNNb2R1bGUoZm4sIG1vZHVsZSkge1xuXHRyZXR1cm4gbW9kdWxlID0geyBleHBvcnRzOiB7fSB9LCBmbihtb2R1bGUsIG1vZHVsZS5leHBvcnRzKSwgbW9kdWxlLmV4cG9ydHM7XG59XG5cbnZhciBpbmRleCQ0ID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiAoYXJyKSB7XG4gIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYXJyKSA9PSAnW29iamVjdCBBcnJheV0nO1xufTtcblxudmFyIGlzYXJyYXkgPSBpbmRleCQ0O1xuXG4vKipcbiAqIEV4cG9zZSBgcGF0aFRvUmVnZXhwYC5cbiAqL1xudmFyIGluZGV4JDIgPSBwYXRoVG9SZWdleHA7XG52YXIgcGFyc2VfMSA9IHBhcnNlO1xudmFyIGNvbXBpbGVfMSA9IGNvbXBpbGU7XG52YXIgdG9rZW5zVG9GdW5jdGlvbl8xID0gdG9rZW5zVG9GdW5jdGlvbjtcbnZhciB0b2tlbnNUb1JlZ0V4cF8xID0gdG9rZW5zVG9SZWdFeHA7XG5cbi8qKlxuICogVGhlIG1haW4gcGF0aCBtYXRjaGluZyByZWdleHAgdXRpbGl0eS5cbiAqXG4gKiBAdHlwZSB7UmVnRXhwfVxuICovXG52YXIgUEFUSF9SRUdFWFAgPSBuZXcgUmVnRXhwKFtcbiAgLy8gTWF0Y2ggZXNjYXBlZCBjaGFyYWN0ZXJzIHRoYXQgd291bGQgb3RoZXJ3aXNlIGFwcGVhciBpbiBmdXR1cmUgbWF0Y2hlcy5cbiAgLy8gVGhpcyBhbGxvd3MgdGhlIHVzZXIgdG8gZXNjYXBlIHNwZWNpYWwgY2hhcmFjdGVycyB0aGF0IHdvbid0IHRyYW5zZm9ybS5cbiAgJyhcXFxcXFxcXC4pJyxcbiAgLy8gTWF0Y2ggRXhwcmVzcy1zdHlsZSBwYXJhbWV0ZXJzIGFuZCB1bi1uYW1lZCBwYXJhbWV0ZXJzIHdpdGggYSBwcmVmaXhcbiAgLy8gYW5kIG9wdGlvbmFsIHN1ZmZpeGVzLiBNYXRjaGVzIGFwcGVhciBhczpcbiAgLy9cbiAgLy8gXCIvOnRlc3QoXFxcXGQrKT9cIiA9PiBbXCIvXCIsIFwidGVzdFwiLCBcIlxcZCtcIiwgdW5kZWZpbmVkLCBcIj9cIiwgdW5kZWZpbmVkXVxuICAvLyBcIi9yb3V0ZShcXFxcZCspXCIgID0+IFt1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBcIlxcZCtcIiwgdW5kZWZpbmVkLCB1bmRlZmluZWRdXG4gIC8vIFwiLypcIiAgICAgICAgICAgID0+IFtcIi9cIiwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBcIipcIl1cbiAgJyhbXFxcXC8uXSk/KD86KD86XFxcXDooXFxcXHcrKSg/OlxcXFwoKCg/OlxcXFxcXFxcLnxbXlxcXFxcXFxcKCldKSspXFxcXCkpP3xcXFxcKCgoPzpcXFxcXFxcXC58W15cXFxcXFxcXCgpXSkrKVxcXFwpKShbKyo/XSk/fChcXFxcKikpJ1xuXS5qb2luKCd8JyksICdnJyk7XG5cbi8qKlxuICogUGFyc2UgYSBzdHJpbmcgZm9yIHRoZSByYXcgdG9rZW5zLlxuICpcbiAqIEBwYXJhbSAge3N0cmluZ30gIHN0clxuICogQHBhcmFtICB7T2JqZWN0PX0gb3B0aW9uc1xuICogQHJldHVybiB7IUFycmF5fVxuICovXG5mdW5jdGlvbiBwYXJzZSAoc3RyLCBvcHRpb25zKSB7XG4gIHZhciB0b2tlbnMgPSBbXTtcbiAgdmFyIGtleSA9IDA7XG4gIHZhciBpbmRleCA9IDA7XG4gIHZhciBwYXRoID0gJyc7XG4gIHZhciBkZWZhdWx0RGVsaW1pdGVyID0gb3B0aW9ucyAmJiBvcHRpb25zLmRlbGltaXRlciB8fCAnLyc7XG4gIHZhciByZXM7XG5cbiAgd2hpbGUgKChyZXMgPSBQQVRIX1JFR0VYUC5leGVjKHN0cikpICE9IG51bGwpIHtcbiAgICB2YXIgbSA9IHJlc1swXTtcbiAgICB2YXIgZXNjYXBlZCA9IHJlc1sxXTtcbiAgICB2YXIgb2Zmc2V0ID0gcmVzLmluZGV4O1xuICAgIHBhdGggKz0gc3RyLnNsaWNlKGluZGV4LCBvZmZzZXQpO1xuICAgIGluZGV4ID0gb2Zmc2V0ICsgbS5sZW5ndGg7XG5cbiAgICAvLyBJZ25vcmUgYWxyZWFkeSBlc2NhcGVkIHNlcXVlbmNlcy5cbiAgICBpZiAoZXNjYXBlZCkge1xuICAgICAgcGF0aCArPSBlc2NhcGVkWzFdO1xuICAgICAgY29udGludWVcbiAgICB9XG5cbiAgICB2YXIgbmV4dCA9IHN0cltpbmRleF07XG4gICAgdmFyIHByZWZpeCA9IHJlc1syXTtcbiAgICB2YXIgbmFtZSA9IHJlc1szXTtcbiAgICB2YXIgY2FwdHVyZSA9IHJlc1s0XTtcbiAgICB2YXIgZ3JvdXAgPSByZXNbNV07XG4gICAgdmFyIG1vZGlmaWVyID0gcmVzWzZdO1xuICAgIHZhciBhc3RlcmlzayA9IHJlc1s3XTtcblxuICAgIC8vIFB1c2ggdGhlIGN1cnJlbnQgcGF0aCBvbnRvIHRoZSB0b2tlbnMuXG4gICAgaWYgKHBhdGgpIHtcbiAgICAgIHRva2Vucy5wdXNoKHBhdGgpO1xuICAgICAgcGF0aCA9ICcnO1xuICAgIH1cblxuICAgIHZhciBwYXJ0aWFsID0gcHJlZml4ICE9IG51bGwgJiYgbmV4dCAhPSBudWxsICYmIG5leHQgIT09IHByZWZpeDtcbiAgICB2YXIgcmVwZWF0ID0gbW9kaWZpZXIgPT09ICcrJyB8fCBtb2RpZmllciA9PT0gJyonO1xuICAgIHZhciBvcHRpb25hbCA9IG1vZGlmaWVyID09PSAnPycgfHwgbW9kaWZpZXIgPT09ICcqJztcbiAgICB2YXIgZGVsaW1pdGVyID0gcmVzWzJdIHx8IGRlZmF1bHREZWxpbWl0ZXI7XG4gICAgdmFyIHBhdHRlcm4gPSBjYXB0dXJlIHx8IGdyb3VwO1xuXG4gICAgdG9rZW5zLnB1c2goe1xuICAgICAgbmFtZTogbmFtZSB8fCBrZXkrKyxcbiAgICAgIHByZWZpeDogcHJlZml4IHx8ICcnLFxuICAgICAgZGVsaW1pdGVyOiBkZWxpbWl0ZXIsXG4gICAgICBvcHRpb25hbDogb3B0aW9uYWwsXG4gICAgICByZXBlYXQ6IHJlcGVhdCxcbiAgICAgIHBhcnRpYWw6IHBhcnRpYWwsXG4gICAgICBhc3RlcmlzazogISFhc3RlcmlzayxcbiAgICAgIHBhdHRlcm46IHBhdHRlcm4gPyBlc2NhcGVHcm91cChwYXR0ZXJuKSA6IChhc3RlcmlzayA/ICcuKicgOiAnW14nICsgZXNjYXBlU3RyaW5nKGRlbGltaXRlcikgKyAnXSs/JylcbiAgICB9KTtcbiAgfVxuXG4gIC8vIE1hdGNoIGFueSBjaGFyYWN0ZXJzIHN0aWxsIHJlbWFpbmluZy5cbiAgaWYgKGluZGV4IDwgc3RyLmxlbmd0aCkge1xuICAgIHBhdGggKz0gc3RyLnN1YnN0cihpbmRleCk7XG4gIH1cblxuICAvLyBJZiB0aGUgcGF0aCBleGlzdHMsIHB1c2ggaXQgb250byB0aGUgZW5kLlxuICBpZiAocGF0aCkge1xuICAgIHRva2Vucy5wdXNoKHBhdGgpO1xuICB9XG5cbiAgcmV0dXJuIHRva2Vuc1xufVxuXG4vKipcbiAqIENvbXBpbGUgYSBzdHJpbmcgdG8gYSB0ZW1wbGF0ZSBmdW5jdGlvbiBmb3IgdGhlIHBhdGguXG4gKlxuICogQHBhcmFtICB7c3RyaW5nfSAgICAgICAgICAgICBzdHJcbiAqIEBwYXJhbSAge09iamVjdD19ICAgICAgICAgICAgb3B0aW9uc1xuICogQHJldHVybiB7IWZ1bmN0aW9uKE9iamVjdD0sIE9iamVjdD0pfVxuICovXG5mdW5jdGlvbiBjb21waWxlIChzdHIsIG9wdGlvbnMpIHtcbiAgcmV0dXJuIHRva2Vuc1RvRnVuY3Rpb24ocGFyc2Uoc3RyLCBvcHRpb25zKSlcbn1cblxuLyoqXG4gKiBQcmV0dGllciBlbmNvZGluZyBvZiBVUkkgcGF0aCBzZWdtZW50cy5cbiAqXG4gKiBAcGFyYW0gIHtzdHJpbmd9XG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIGVuY29kZVVSSUNvbXBvbmVudFByZXR0eSAoc3RyKSB7XG4gIHJldHVybiBlbmNvZGVVUkkoc3RyKS5yZXBsYWNlKC9bXFwvPyNdL2csIGZ1bmN0aW9uIChjKSB7XG4gICAgcmV0dXJuICclJyArIGMuY2hhckNvZGVBdCgwKS50b1N0cmluZygxNikudG9VcHBlckNhc2UoKVxuICB9KVxufVxuXG4vKipcbiAqIEVuY29kZSB0aGUgYXN0ZXJpc2sgcGFyYW1ldGVyLiBTaW1pbGFyIHRvIGBwcmV0dHlgLCBidXQgYWxsb3dzIHNsYXNoZXMuXG4gKlxuICogQHBhcmFtICB7c3RyaW5nfVxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiBlbmNvZGVBc3RlcmlzayAoc3RyKSB7XG4gIHJldHVybiBlbmNvZGVVUkkoc3RyKS5yZXBsYWNlKC9bPyNdL2csIGZ1bmN0aW9uIChjKSB7XG4gICAgcmV0dXJuICclJyArIGMuY2hhckNvZGVBdCgwKS50b1N0cmluZygxNikudG9VcHBlckNhc2UoKVxuICB9KVxufVxuXG4vKipcbiAqIEV4cG9zZSBhIG1ldGhvZCBmb3IgdHJhbnNmb3JtaW5nIHRva2VucyBpbnRvIHRoZSBwYXRoIGZ1bmN0aW9uLlxuICovXG5mdW5jdGlvbiB0b2tlbnNUb0Z1bmN0aW9uICh0b2tlbnMpIHtcbiAgLy8gQ29tcGlsZSBhbGwgdGhlIHRva2VucyBpbnRvIHJlZ2V4cHMuXG4gIHZhciBtYXRjaGVzID0gbmV3IEFycmF5KHRva2Vucy5sZW5ndGgpO1xuXG4gIC8vIENvbXBpbGUgYWxsIHRoZSBwYXR0ZXJucyBiZWZvcmUgY29tcGlsYXRpb24uXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgdG9rZW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKHR5cGVvZiB0b2tlbnNbaV0gPT09ICdvYmplY3QnKSB7XG4gICAgICBtYXRjaGVzW2ldID0gbmV3IFJlZ0V4cCgnXig/OicgKyB0b2tlbnNbaV0ucGF0dGVybiArICcpJCcpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBmdW5jdGlvbiAob2JqLCBvcHRzKSB7XG4gICAgdmFyIHBhdGggPSAnJztcbiAgICB2YXIgZGF0YSA9IG9iaiB8fCB7fTtcbiAgICB2YXIgb3B0aW9ucyA9IG9wdHMgfHwge307XG4gICAgdmFyIGVuY29kZSA9IG9wdGlvbnMucHJldHR5ID8gZW5jb2RlVVJJQ29tcG9uZW50UHJldHR5IDogZW5jb2RlVVJJQ29tcG9uZW50O1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b2tlbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciB0b2tlbiA9IHRva2Vuc1tpXTtcblxuICAgICAgaWYgKHR5cGVvZiB0b2tlbiA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgcGF0aCArPSB0b2tlbjtcblxuICAgICAgICBjb250aW51ZVxuICAgICAgfVxuXG4gICAgICB2YXIgdmFsdWUgPSBkYXRhW3Rva2VuLm5hbWVdO1xuICAgICAgdmFyIHNlZ21lbnQ7XG5cbiAgICAgIGlmICh2YWx1ZSA9PSBudWxsKSB7XG4gICAgICAgIGlmICh0b2tlbi5vcHRpb25hbCkge1xuICAgICAgICAgIC8vIFByZXBlbmQgcGFydGlhbCBzZWdtZW50IHByZWZpeGVzLlxuICAgICAgICAgIGlmICh0b2tlbi5wYXJ0aWFsKSB7XG4gICAgICAgICAgICBwYXRoICs9IHRva2VuLnByZWZpeDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb250aW51ZVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0V4cGVjdGVkIFwiJyArIHRva2VuLm5hbWUgKyAnXCIgdG8gYmUgZGVmaW5lZCcpXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGlzYXJyYXkodmFsdWUpKSB7XG4gICAgICAgIGlmICghdG9rZW4ucmVwZWF0KSB7XG4gICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignRXhwZWN0ZWQgXCInICsgdG9rZW4ubmFtZSArICdcIiB0byBub3QgcmVwZWF0LCBidXQgcmVjZWl2ZWQgYCcgKyBKU09OLnN0cmluZ2lmeSh2YWx1ZSkgKyAnYCcpXG4gICAgICAgIH1cblxuICAgICAgICBpZiAodmFsdWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgaWYgKHRva2VuLm9wdGlvbmFsKSB7XG4gICAgICAgICAgICBjb250aW51ZVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdFeHBlY3RlZCBcIicgKyB0b2tlbi5uYW1lICsgJ1wiIHRvIG5vdCBiZSBlbXB0eScpXG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB2YWx1ZS5sZW5ndGg7IGorKykge1xuICAgICAgICAgIHNlZ21lbnQgPSBlbmNvZGUodmFsdWVbal0pO1xuXG4gICAgICAgICAgaWYgKCFtYXRjaGVzW2ldLnRlc3Qoc2VnbWVudCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0V4cGVjdGVkIGFsbCBcIicgKyB0b2tlbi5uYW1lICsgJ1wiIHRvIG1hdGNoIFwiJyArIHRva2VuLnBhdHRlcm4gKyAnXCIsIGJ1dCByZWNlaXZlZCBgJyArIEpTT04uc3RyaW5naWZ5KHNlZ21lbnQpICsgJ2AnKVxuICAgICAgICAgIH1cblxuICAgICAgICAgIHBhdGggKz0gKGogPT09IDAgPyB0b2tlbi5wcmVmaXggOiB0b2tlbi5kZWxpbWl0ZXIpICsgc2VnbWVudDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnRpbnVlXG4gICAgICB9XG5cbiAgICAgIHNlZ21lbnQgPSB0b2tlbi5hc3RlcmlzayA/IGVuY29kZUFzdGVyaXNrKHZhbHVlKSA6IGVuY29kZSh2YWx1ZSk7XG5cbiAgICAgIGlmICghbWF0Y2hlc1tpXS50ZXN0KHNlZ21lbnQpKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0V4cGVjdGVkIFwiJyArIHRva2VuLm5hbWUgKyAnXCIgdG8gbWF0Y2ggXCInICsgdG9rZW4ucGF0dGVybiArICdcIiwgYnV0IHJlY2VpdmVkIFwiJyArIHNlZ21lbnQgKyAnXCInKVxuICAgICAgfVxuXG4gICAgICBwYXRoICs9IHRva2VuLnByZWZpeCArIHNlZ21lbnQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHBhdGhcbiAgfVxufVxuXG4vKipcbiAqIEVzY2FwZSBhIHJlZ3VsYXIgZXhwcmVzc2lvbiBzdHJpbmcuXG4gKlxuICogQHBhcmFtICB7c3RyaW5nfSBzdHJcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZnVuY3Rpb24gZXNjYXBlU3RyaW5nIChzdHIpIHtcbiAgcmV0dXJuIHN0ci5yZXBsYWNlKC8oWy4rKj89XiE6JHt9KClbXFxdfFxcL1xcXFxdKS9nLCAnXFxcXCQxJylcbn1cblxuLyoqXG4gKiBFc2NhcGUgdGhlIGNhcHR1cmluZyBncm91cCBieSBlc2NhcGluZyBzcGVjaWFsIGNoYXJhY3RlcnMgYW5kIG1lYW5pbmcuXG4gKlxuICogQHBhcmFtICB7c3RyaW5nfSBncm91cFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiBlc2NhcGVHcm91cCAoZ3JvdXApIHtcbiAgcmV0dXJuIGdyb3VwLnJlcGxhY2UoLyhbPSE6JFxcLygpXSkvZywgJ1xcXFwkMScpXG59XG5cbi8qKlxuICogQXR0YWNoIHRoZSBrZXlzIGFzIGEgcHJvcGVydHkgb2YgdGhlIHJlZ2V4cC5cbiAqXG4gKiBAcGFyYW0gIHshUmVnRXhwfSByZVxuICogQHBhcmFtICB7QXJyYXl9ICAga2V5c1xuICogQHJldHVybiB7IVJlZ0V4cH1cbiAqL1xuZnVuY3Rpb24gYXR0YWNoS2V5cyAocmUsIGtleXMpIHtcbiAgcmUua2V5cyA9IGtleXM7XG4gIHJldHVybiByZVxufVxuXG4vKipcbiAqIEdldCB0aGUgZmxhZ3MgZm9yIGEgcmVnZXhwIGZyb20gdGhlIG9wdGlvbnMuXG4gKlxuICogQHBhcmFtICB7T2JqZWN0fSBvcHRpb25zXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIGZsYWdzIChvcHRpb25zKSB7XG4gIHJldHVybiBvcHRpb25zLnNlbnNpdGl2ZSA/ICcnIDogJ2knXG59XG5cbi8qKlxuICogUHVsbCBvdXQga2V5cyBmcm9tIGEgcmVnZXhwLlxuICpcbiAqIEBwYXJhbSAgeyFSZWdFeHB9IHBhdGhcbiAqIEBwYXJhbSAgeyFBcnJheX0gIGtleXNcbiAqIEByZXR1cm4geyFSZWdFeHB9XG4gKi9cbmZ1bmN0aW9uIHJlZ2V4cFRvUmVnZXhwIChwYXRoLCBrZXlzKSB7XG4gIC8vIFVzZSBhIG5lZ2F0aXZlIGxvb2thaGVhZCB0byBtYXRjaCBvbmx5IGNhcHR1cmluZyBncm91cHMuXG4gIHZhciBncm91cHMgPSBwYXRoLnNvdXJjZS5tYXRjaCgvXFwoKD8hXFw/KS9nKTtcblxuICBpZiAoZ3JvdXBzKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBncm91cHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGtleXMucHVzaCh7XG4gICAgICAgIG5hbWU6IGksXG4gICAgICAgIHByZWZpeDogbnVsbCxcbiAgICAgICAgZGVsaW1pdGVyOiBudWxsLFxuICAgICAgICBvcHRpb25hbDogZmFsc2UsXG4gICAgICAgIHJlcGVhdDogZmFsc2UsXG4gICAgICAgIHBhcnRpYWw6IGZhbHNlLFxuICAgICAgICBhc3RlcmlzazogZmFsc2UsXG4gICAgICAgIHBhdHRlcm46IG51bGxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBhdHRhY2hLZXlzKHBhdGgsIGtleXMpXG59XG5cbi8qKlxuICogVHJhbnNmb3JtIGFuIGFycmF5IGludG8gYSByZWdleHAuXG4gKlxuICogQHBhcmFtICB7IUFycmF5fSAgcGF0aFxuICogQHBhcmFtICB7QXJyYXl9ICAga2V5c1xuICogQHBhcmFtICB7IU9iamVjdH0gb3B0aW9uc1xuICogQHJldHVybiB7IVJlZ0V4cH1cbiAqL1xuZnVuY3Rpb24gYXJyYXlUb1JlZ2V4cCAocGF0aCwga2V5cywgb3B0aW9ucykge1xuICB2YXIgcGFydHMgPSBbXTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IHBhdGgubGVuZ3RoOyBpKyspIHtcbiAgICBwYXJ0cy5wdXNoKHBhdGhUb1JlZ2V4cChwYXRoW2ldLCBrZXlzLCBvcHRpb25zKS5zb3VyY2UpO1xuICB9XG5cbiAgdmFyIHJlZ2V4cCA9IG5ldyBSZWdFeHAoJyg/OicgKyBwYXJ0cy5qb2luKCd8JykgKyAnKScsIGZsYWdzKG9wdGlvbnMpKTtcblxuICByZXR1cm4gYXR0YWNoS2V5cyhyZWdleHAsIGtleXMpXG59XG5cbi8qKlxuICogQ3JlYXRlIGEgcGF0aCByZWdleHAgZnJvbSBzdHJpbmcgaW5wdXQuXG4gKlxuICogQHBhcmFtICB7c3RyaW5nfSAgcGF0aFxuICogQHBhcmFtICB7IUFycmF5fSAga2V5c1xuICogQHBhcmFtICB7IU9iamVjdH0gb3B0aW9uc1xuICogQHJldHVybiB7IVJlZ0V4cH1cbiAqL1xuZnVuY3Rpb24gc3RyaW5nVG9SZWdleHAgKHBhdGgsIGtleXMsIG9wdGlvbnMpIHtcbiAgcmV0dXJuIHRva2Vuc1RvUmVnRXhwKHBhcnNlKHBhdGgsIG9wdGlvbnMpLCBrZXlzLCBvcHRpb25zKVxufVxuXG4vKipcbiAqIEV4cG9zZSBhIGZ1bmN0aW9uIGZvciB0YWtpbmcgdG9rZW5zIGFuZCByZXR1cm5pbmcgYSBSZWdFeHAuXG4gKlxuICogQHBhcmFtICB7IUFycmF5fSAgICAgICAgICB0b2tlbnNcbiAqIEBwYXJhbSAgeyhBcnJheXxPYmplY3QpPX0ga2V5c1xuICogQHBhcmFtICB7T2JqZWN0PX0gICAgICAgICBvcHRpb25zXG4gKiBAcmV0dXJuIHshUmVnRXhwfVxuICovXG5mdW5jdGlvbiB0b2tlbnNUb1JlZ0V4cCAodG9rZW5zLCBrZXlzLCBvcHRpb25zKSB7XG4gIGlmICghaXNhcnJheShrZXlzKSkge1xuICAgIG9wdGlvbnMgPSAvKiogQHR5cGUgeyFPYmplY3R9ICovIChrZXlzIHx8IG9wdGlvbnMpO1xuICAgIGtleXMgPSBbXTtcbiAgfVxuXG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG4gIHZhciBzdHJpY3QgPSBvcHRpb25zLnN0cmljdDtcbiAgdmFyIGVuZCA9IG9wdGlvbnMuZW5kICE9PSBmYWxzZTtcbiAgdmFyIHJvdXRlID0gJyc7XG5cbiAgLy8gSXRlcmF0ZSBvdmVyIHRoZSB0b2tlbnMgYW5kIGNyZWF0ZSBvdXIgcmVnZXhwIHN0cmluZy5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b2tlbnMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgdG9rZW4gPSB0b2tlbnNbaV07XG5cbiAgICBpZiAodHlwZW9mIHRva2VuID09PSAnc3RyaW5nJykge1xuICAgICAgcm91dGUgKz0gZXNjYXBlU3RyaW5nKHRva2VuKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIHByZWZpeCA9IGVzY2FwZVN0cmluZyh0b2tlbi5wcmVmaXgpO1xuICAgICAgdmFyIGNhcHR1cmUgPSAnKD86JyArIHRva2VuLnBhdHRlcm4gKyAnKSc7XG5cbiAgICAgIGtleXMucHVzaCh0b2tlbik7XG5cbiAgICAgIGlmICh0b2tlbi5yZXBlYXQpIHtcbiAgICAgICAgY2FwdHVyZSArPSAnKD86JyArIHByZWZpeCArIGNhcHR1cmUgKyAnKSonO1xuICAgICAgfVxuXG4gICAgICBpZiAodG9rZW4ub3B0aW9uYWwpIHtcbiAgICAgICAgaWYgKCF0b2tlbi5wYXJ0aWFsKSB7XG4gICAgICAgICAgY2FwdHVyZSA9ICcoPzonICsgcHJlZml4ICsgJygnICsgY2FwdHVyZSArICcpKT8nO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNhcHR1cmUgPSBwcmVmaXggKyAnKCcgKyBjYXB0dXJlICsgJyk/JztcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2FwdHVyZSA9IHByZWZpeCArICcoJyArIGNhcHR1cmUgKyAnKSc7XG4gICAgICB9XG5cbiAgICAgIHJvdXRlICs9IGNhcHR1cmU7XG4gICAgfVxuICB9XG5cbiAgdmFyIGRlbGltaXRlciA9IGVzY2FwZVN0cmluZyhvcHRpb25zLmRlbGltaXRlciB8fCAnLycpO1xuICB2YXIgZW5kc1dpdGhEZWxpbWl0ZXIgPSByb3V0ZS5zbGljZSgtZGVsaW1pdGVyLmxlbmd0aCkgPT09IGRlbGltaXRlcjtcblxuICAvLyBJbiBub24tc3RyaWN0IG1vZGUgd2UgYWxsb3cgYSBzbGFzaCBhdCB0aGUgZW5kIG9mIG1hdGNoLiBJZiB0aGUgcGF0aCB0b1xuICAvLyBtYXRjaCBhbHJlYWR5IGVuZHMgd2l0aCBhIHNsYXNoLCB3ZSByZW1vdmUgaXQgZm9yIGNvbnNpc3RlbmN5LiBUaGUgc2xhc2hcbiAgLy8gaXMgdmFsaWQgYXQgdGhlIGVuZCBvZiBhIHBhdGggbWF0Y2gsIG5vdCBpbiB0aGUgbWlkZGxlLiBUaGlzIGlzIGltcG9ydGFudFxuICAvLyBpbiBub24tZW5kaW5nIG1vZGUsIHdoZXJlIFwiL3Rlc3QvXCIgc2hvdWxkbid0IG1hdGNoIFwiL3Rlc3QvL3JvdXRlXCIuXG4gIGlmICghc3RyaWN0KSB7XG4gICAgcm91dGUgPSAoZW5kc1dpdGhEZWxpbWl0ZXIgPyByb3V0ZS5zbGljZSgwLCAtZGVsaW1pdGVyLmxlbmd0aCkgOiByb3V0ZSkgKyAnKD86JyArIGRlbGltaXRlciArICcoPz0kKSk/JztcbiAgfVxuXG4gIGlmIChlbmQpIHtcbiAgICByb3V0ZSArPSAnJCc7XG4gIH0gZWxzZSB7XG4gICAgLy8gSW4gbm9uLWVuZGluZyBtb2RlLCB3ZSBuZWVkIHRoZSBjYXB0dXJpbmcgZ3JvdXBzIHRvIG1hdGNoIGFzIG11Y2ggYXNcbiAgICAvLyBwb3NzaWJsZSBieSB1c2luZyBhIHBvc2l0aXZlIGxvb2thaGVhZCB0byB0aGUgZW5kIG9yIG5leHQgcGF0aCBzZWdtZW50LlxuICAgIHJvdXRlICs9IHN0cmljdCAmJiBlbmRzV2l0aERlbGltaXRlciA/ICcnIDogJyg/PScgKyBkZWxpbWl0ZXIgKyAnfCQpJztcbiAgfVxuXG4gIHJldHVybiBhdHRhY2hLZXlzKG5ldyBSZWdFeHAoJ14nICsgcm91dGUsIGZsYWdzKG9wdGlvbnMpKSwga2V5cylcbn1cblxuLyoqXG4gKiBOb3JtYWxpemUgdGhlIGdpdmVuIHBhdGggc3RyaW5nLCByZXR1cm5pbmcgYSByZWd1bGFyIGV4cHJlc3Npb24uXG4gKlxuICogQW4gZW1wdHkgYXJyYXkgY2FuIGJlIHBhc3NlZCBpbiBmb3IgdGhlIGtleXMsIHdoaWNoIHdpbGwgaG9sZCB0aGVcbiAqIHBsYWNlaG9sZGVyIGtleSBkZXNjcmlwdGlvbnMuIEZvciBleGFtcGxlLCB1c2luZyBgL3VzZXIvOmlkYCwgYGtleXNgIHdpbGxcbiAqIGNvbnRhaW4gYFt7IG5hbWU6ICdpZCcsIGRlbGltaXRlcjogJy8nLCBvcHRpb25hbDogZmFsc2UsIHJlcGVhdDogZmFsc2UgfV1gLlxuICpcbiAqIEBwYXJhbSAgeyhzdHJpbmd8UmVnRXhwfEFycmF5KX0gcGF0aFxuICogQHBhcmFtICB7KEFycmF5fE9iamVjdCk9fSAgICAgICBrZXlzXG4gKiBAcGFyYW0gIHtPYmplY3Q9fSAgICAgICAgICAgICAgIG9wdGlvbnNcbiAqIEByZXR1cm4geyFSZWdFeHB9XG4gKi9cbmZ1bmN0aW9uIHBhdGhUb1JlZ2V4cCAocGF0aCwga2V5cywgb3B0aW9ucykge1xuICBpZiAoIWlzYXJyYXkoa2V5cykpIHtcbiAgICBvcHRpb25zID0gLyoqIEB0eXBlIHshT2JqZWN0fSAqLyAoa2V5cyB8fCBvcHRpb25zKTtcbiAgICBrZXlzID0gW107XG4gIH1cblxuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuICBpZiAocGF0aCBpbnN0YW5jZW9mIFJlZ0V4cCkge1xuICAgIHJldHVybiByZWdleHBUb1JlZ2V4cChwYXRoLCAvKiogQHR5cGUgeyFBcnJheX0gKi8gKGtleXMpKVxuICB9XG5cbiAgaWYgKGlzYXJyYXkocGF0aCkpIHtcbiAgICByZXR1cm4gYXJyYXlUb1JlZ2V4cCgvKiogQHR5cGUgeyFBcnJheX0gKi8gKHBhdGgpLCAvKiogQHR5cGUgeyFBcnJheX0gKi8gKGtleXMpLCBvcHRpb25zKVxuICB9XG5cbiAgcmV0dXJuIHN0cmluZ1RvUmVnZXhwKC8qKiBAdHlwZSB7c3RyaW5nfSAqLyAocGF0aCksIC8qKiBAdHlwZSB7IUFycmF5fSAqLyAoa2V5cyksIG9wdGlvbnMpXG59XG5cbmluZGV4JDIucGFyc2UgPSBwYXJzZV8xO1xuaW5kZXgkMi5jb21waWxlID0gY29tcGlsZV8xO1xuaW5kZXgkMi50b2tlbnNUb0Z1bmN0aW9uID0gdG9rZW5zVG9GdW5jdGlvbl8xO1xuaW5kZXgkMi50b2tlbnNUb1JlZ0V4cCA9IHRva2Vuc1RvUmVnRXhwXzE7XG5cbnZhciBpbmRleCQxID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSkge1xudmFyIHBhdGhUb1JlZ0V4cCA9IGluZGV4JDI7XG5cbi8qKlxuICogRXhwb3NlIGBwYXRoVG9SZWdleHBgIGFzIEVTNiBtb2R1bGVcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBwYXRoVG9SZWdFeHA7XG5tb2R1bGUuZXhwb3J0cy5wYXJzZSA9IHBhdGhUb1JlZ0V4cC5wYXJzZTtcbm1vZHVsZS5leHBvcnRzLmNvbXBpbGUgPSBwYXRoVG9SZWdFeHAuY29tcGlsZTtcbm1vZHVsZS5leHBvcnRzLnRva2Vuc1RvRnVuY3Rpb24gPSBwYXRoVG9SZWdFeHAudG9rZW5zVG9GdW5jdGlvbjtcbm1vZHVsZS5leHBvcnRzLnRva2Vuc1RvUmVnRXhwID0gcGF0aFRvUmVnRXhwLnRva2Vuc1RvUmVnRXhwO1xubW9kdWxlLmV4cG9ydHNbJ2RlZmF1bHQnXSA9IG1vZHVsZS5leHBvcnRzO1xufSk7XG5cbnZhciBjYWNoZSA9IG5ldyBNYXAoKTtcbi8qKlxuICogUmV0dXJucyBhIG5vZGUgY29udGFpbmluZyBvbmx5IHRoZSBtYXRjaGVkIGNvbXBvbmVudHNcbiAqIEBwYXJhbSByb3V0ZXNcbiAqIEBwYXJhbSBjdXJyZW50VVJMXG4gKiBAcmV0dXJucyB7YW55fFZDb21wb25lbnR9XG4gKi9cbmZ1bmN0aW9uIG1hdGNoKHJvdXRlcywgY3VycmVudFVSTCkge1xuICAgIHZhciBsb2NhdGlvbiA9IGdldFVSTFN0cmluZyhjdXJyZW50VVJMKTtcbiAgICB2YXIgcmVuZGVyUHJvcHMgPSBtYXRjaFJvdXRlcyh0b0FycmF5KHJvdXRlcyksIGxvY2F0aW9uLCAnLycpO1xuICAgIHJldHVybiByZW5kZXJQcm9wcztcbn1cbi8qKlxuICogR28gdGhyb3VnaCBldmVyeSByb3V0ZSBhbmQgY3JlYXRlIGEgbmV3IG5vZGVcbiAqIHdpdGggdGhlIG1hdGNoZWQgY29tcG9uZW50c1xuICogQHBhcmFtIF9yb3V0ZXNcbiAqIEBwYXJhbSBjdXJyZW50VVJMXG4gKiBAcGFyYW0gcGFyZW50UGF0aFxuICogQHBhcmFtIHJlZGlyZWN0XG4gKiBAcmV0dXJucyB7b2JqZWN0fVxuICovXG5mdW5jdGlvbiBtYXRjaFJvdXRlcyhfcm91dGVzLCBjdXJyZW50VVJMLCBwYXJlbnRQYXRoLCByZWRpcmVjdCkge1xuICAgIGlmICggY3VycmVudFVSTCA9PT0gdm9pZCAwICkgY3VycmVudFVSTCA9ICcvJztcbiAgICBpZiAoIHBhcmVudFBhdGggPT09IHZvaWQgMCApIHBhcmVudFBhdGggPSAnLyc7XG4gICAgaWYgKCByZWRpcmVjdCA9PT0gdm9pZCAwICkgcmVkaXJlY3QgPSBmYWxzZTtcblxuICAgIHZhciByb3V0ZXMgPSBpc0FycmF5KF9yb3V0ZXMpID8gZmxhdHRlbihfcm91dGVzKSA6IHRvQXJyYXkoX3JvdXRlcyk7XG4gICAgdmFyIHJlZiA9IGN1cnJlbnRVUkwuc3BsaXQoJz8nKTtcbiAgICB2YXIgcGF0aFRvTWF0Y2ggPSByZWZbMF07IGlmICggcGF0aFRvTWF0Y2ggPT09IHZvaWQgMCApIHBhdGhUb01hdGNoID0gJy8nO1xuICAgIHZhciBzZWFyY2ggPSByZWZbMV07IGlmICggc2VhcmNoID09PSB2b2lkIDAgKSBzZWFyY2ggPSAnJztcbiAgICB2YXIgcGFyYW1zID0gbWFwU2VhcmNoUGFyYW1zKHNlYXJjaCk7XG4gICAgcm91dGVzLnNvcnQocGF0aFJhbmtTb3J0KTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJvdXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgcm91dGUgPSByb3V0ZXNbaV07XG4gICAgICAgIHZhciByb3V0ZVBhdGggPSByb3V0ZS5wcm9wcy5mcm9tIHx8IHJvdXRlLnByb3BzLnBhdGggfHwgJy8nO1xuICAgICAgICB2YXIgbG9jYXRpb24gPSBwYXJlbnRQYXRoICsgdG9QYXJ0aWFsVVJMKHJvdXRlUGF0aCwgcGFyZW50UGF0aCkucmVwbGFjZSgvXFwvXFwvL2csICcvJyk7XG4gICAgICAgIHZhciBpc0xhc3QgPSAhcm91dGUucHJvcHMgfHwgaXNFbXB0eShyb3V0ZS5wcm9wcy5jaGlsZHJlbik7XG4gICAgICAgIHZhciBtYXRjaEJhc2UgPSBtYXRjaFBhdGgoaXNMYXN0LCBsb2NhdGlvbiwgcGF0aFRvTWF0Y2gpO1xuICAgICAgICBpZiAobWF0Y2hCYXNlKSB7XG4gICAgICAgICAgICB2YXIgY2hpbGRyZW4gPSByb3V0ZS5wcm9wcy5jaGlsZHJlbjtcbiAgICAgICAgICAgIGlmIChyb3V0ZS5wcm9wcy5mcm9tKSB7XG4gICAgICAgICAgICAgICAgcmVkaXJlY3QgPSByb3V0ZS5wcm9wcy50bztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjaGlsZHJlbikge1xuICAgICAgICAgICAgICAgIHZhciBtYXRjaENoaWxkID0gbWF0Y2hSb3V0ZXMoY2hpbGRyZW4sIGN1cnJlbnRVUkwsIGxvY2F0aW9uLCByZWRpcmVjdCk7XG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoQ2hpbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1hdGNoQ2hpbGQucmVkaXJlY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb246IGxvY2F0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZGlyZWN0OiBtYXRjaENoaWxkLnJlZGlyZWN0XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuID0gbWF0Y2hDaGlsZC5tYXRjaGVkO1xuICAgICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKHBhcmFtcywgY2hpbGRyZW4ucHJvcHMucGFyYW1zKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgbWF0Y2hlZCA9IEluZmVybm9fX2RlZmF1bHQuY2xvbmVWTm9kZShyb3V0ZSwge1xuICAgICAgICAgICAgICAgIHBhcmFtczogT2JqZWN0LmFzc2lnbihwYXJhbXMsIG1hdGNoQmFzZS5wYXJhbXMpLFxuICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBjaGlsZHJlblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGxvY2F0aW9uOiBsb2NhdGlvbixcbiAgICAgICAgICAgICAgICByZWRpcmVjdDogcmVkaXJlY3QsXG4gICAgICAgICAgICAgICAgbWF0Y2hlZDogbWF0Y2hlZFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbn1cbi8qKlxuICogQ29udmVydHMgcGF0aCB0byBhIHJlZ2V4LCBpZiBhIG1hdGNoIGlzIGZvdW5kIHRoZW4gd2UgZXh0cmFjdCBwYXJhbXMgZnJvbSBpdFxuICogQHBhcmFtIGVuZFxuICogQHBhcmFtIHJvdXRlUGF0aFxuICogQHBhcmFtIHBhdGhUb01hdGNoXG4gKiBAcmV0dXJucyB7YW55fVxuICovXG5mdW5jdGlvbiBtYXRjaFBhdGgoZW5kLCByb3V0ZVBhdGgsIHBhdGhUb01hdGNoKSB7XG4gICAgdmFyIGtleSA9IHJvdXRlUGF0aCArIFwifFwiICsgZW5kO1xuICAgIHZhciByZWdleHAgPSBjYWNoZS5nZXQoa2V5KTtcbiAgICBpZiAoIXJlZ2V4cCkge1xuICAgICAgICB2YXIga2V5cyA9IFtdO1xuICAgICAgICByZWdleHAgPSB7IHBhdHRlcm46IGluZGV4JDEocm91dGVQYXRoLCBrZXlzLCB7IGVuZDogZW5kIH0pLCBrZXlzOiBrZXlzIH07XG4gICAgICAgIGNhY2hlLnNldChrZXksIHJlZ2V4cCk7XG4gICAgfVxuICAgIHZhciBtID0gcmVnZXhwLnBhdHRlcm4uZXhlYyhwYXRoVG9NYXRjaCk7XG4gICAgaWYgKCFtKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgcGF0aCA9IG1bMF07XG4gICAgdmFyIHBhcmFtcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBtLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIHBhcmFtc1tyZWdleHAua2V5c1tpIC0gMV0ubmFtZV0gPSBkZWNvZGUobVtpXSk7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIHBhdGg6IHBhdGggPT09ICcnID8gJy8nIDogcGF0aCxcbiAgICAgICAgcGFyYW1zOiBwYXJhbXNcbiAgICB9O1xufVxuXG52YXIgUm91dGVyQ29udGV4dCA9IChmdW5jdGlvbiAoQ29tcG9uZW50JCQxKSB7XG4gICAgZnVuY3Rpb24gUm91dGVyQ29udGV4dChwcm9wcywgY29udGV4dCkge1xuICAgICAgICBDb21wb25lbnQkJDEuY2FsbCh0aGlzLCBwcm9wcywgY29udGV4dCk7XG4gICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgICAgICBpZiAoIXByb3BzLmxvY2F0aW9uIHx8ICFwcm9wcy5tYXRjaGVkKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJpbmZlcm5vLXJvdXRlclwiIHJlcXVpcmVzIGEgXCJsb2NhdGlvblwiIGFuZCBcIm1hdGNoZWRcIiBwcm9wcyBwYXNzZWQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmICggQ29tcG9uZW50JCQxICkgUm91dGVyQ29udGV4dC5fX3Byb3RvX18gPSBDb21wb25lbnQkJDE7XG4gICAgUm91dGVyQ29udGV4dC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKCBDb21wb25lbnQkJDEgJiYgQ29tcG9uZW50JCQxLnByb3RvdHlwZSApO1xuICAgIFJvdXRlckNvbnRleHQucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gUm91dGVyQ29udGV4dDtcbiAgICBSb3V0ZXJDb250ZXh0LnByb3RvdHlwZS5nZXRDaGlsZENvbnRleHQgPSBmdW5jdGlvbiBnZXRDaGlsZENvbnRleHQgKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcm91dGVyOiB0aGlzLnByb3BzLnJvdXRlciB8fCB7XG4gICAgICAgICAgICAgICAgbG9jYXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgcGF0aG5hbWU6IHRoaXMucHJvcHMubG9jYXRpb25cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBSb3V0ZXJDb250ZXh0LnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiByZW5kZXIgKHByb3BzKSB7XG4gICAgICAgIHJldHVybiBwcm9wcy5tYXRjaGVkO1xuICAgIH07XG5cbiAgICByZXR1cm4gUm91dGVyQ29udGV4dDtcbn0oQ29tcG9uZW50KSk7XG5cbmZ1bmN0aW9uIGNyZWF0ZXJSb3V0ZXIoaGlzdG9yeSkge1xuICAgIGlmICghaGlzdG9yeSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbmZlcm5vOiBFcnJvciBcImluZmVybm8tcm91dGVyXCIgcmVxdWlyZXMgYSBoaXN0b3J5IHByb3AgcGFzc2VkJyk7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIHB1c2g6IGhpc3RvcnkucHVzaCxcbiAgICAgICAgcmVwbGFjZTogaGlzdG9yeS5yZXBsYWNlLFxuICAgICAgICBsaXN0ZW46IGhpc3RvcnkubGlzdGVuLFxuICAgICAgICBpc0FjdGl2ZTogZnVuY3Rpb24gaXNBY3RpdmUodXJsKSB7XG4gICAgICAgICAgICByZXR1cm4gbWF0Y2hQYXRoKHRydWUsIHVybCwgdGhpcy51cmwpO1xuICAgICAgICB9LFxuICAgICAgICBnZXQgbG9jYXRpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gaGlzdG9yeS5sb2NhdGlvbi5wYXRobmFtZSAhPT0gJ2JsYW5rJyA/IGhpc3RvcnkubG9jYXRpb24gOiB7XG4gICAgICAgICAgICAgICAgcGF0aG5hbWU6ICcvJyxcbiAgICAgICAgICAgICAgICBzZWFyY2g6ICcnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICBnZXQgdXJsKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubG9jYXRpb24ucGF0aG5hbWUgKyB0aGlzLmxvY2F0aW9uLnNlYXJjaDtcbiAgICAgICAgfVxuICAgIH07XG59XG52YXIgUm91dGVyID0gKGZ1bmN0aW9uIChDb21wb25lbnQkJDEpIHtcbiAgICBmdW5jdGlvbiBSb3V0ZXIocHJvcHMsIGNvbnRleHQpIHtcbiAgICAgICAgQ29tcG9uZW50JCQxLmNhbGwodGhpcywgcHJvcHMsIGNvbnRleHQpO1xuICAgICAgICB0aGlzLnJvdXRlciA9IGNyZWF0ZXJSb3V0ZXIocHJvcHMuaGlzdG9yeSk7XG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICB1cmw6IHByb3BzLnVybCB8fCB0aGlzLnJvdXRlci51cmxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBpZiAoIENvbXBvbmVudCQkMSApIFJvdXRlci5fX3Byb3RvX18gPSBDb21wb25lbnQkJDE7XG4gICAgUm91dGVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoIENvbXBvbmVudCQkMSAmJiBDb21wb25lbnQkJDEucHJvdG90eXBlICk7XG4gICAgUm91dGVyLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFJvdXRlcjtcbiAgICBSb3V0ZXIucHJvdG90eXBlLmNvbXBvbmVudFdpbGxNb3VudCA9IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxNb3VudCAoKSB7XG4gICAgICAgIHZhciB0aGlzJDEgPSB0aGlzO1xuXG4gICAgICAgIGlmICh0aGlzLnJvdXRlcikge1xuICAgICAgICAgICAgdGhpcy51bmxpc3RlbiA9IHRoaXMucm91dGVyLmxpc3RlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhpcyQxLnJvdXRlVG8odGhpcyQxLnJvdXRlci51cmwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFJvdXRlci5wcm90b3R5cGUuY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyA9IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMgKG5leHRQcm9wcykge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIHVybDogbmV4dFByb3BzLnVybFxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFJvdXRlci5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVubW91bnQgPSBmdW5jdGlvbiBjb21wb25lbnRXaWxsVW5tb3VudCAoKSB7XG4gICAgICAgIGlmICh0aGlzLnVubGlzdGVuKSB7XG4gICAgICAgICAgICB0aGlzLnVubGlzdGVuKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFJvdXRlci5wcm90b3R5cGUucm91dGVUbyA9IGZ1bmN0aW9uIHJvdXRlVG8gKHVybCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgdXJsOiB1cmwgfSk7XG4gICAgfTtcbiAgICBSb3V0ZXIucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uIHJlbmRlciAocHJvcHMpIHtcbiAgICAgICAgdmFyIHRoaXMkMSA9IHRoaXM7XG5cbiAgICAgICAgdmFyIGhpdCA9IG1hdGNoKHByb3BzLmNoaWxkcmVuLCB0aGlzLnN0YXRlLnVybCk7XG4gICAgICAgIGlmIChoaXQucmVkaXJlY3QpIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHRoaXMkMS5yb3V0ZXIucmVwbGFjZShoaXQucmVkaXJlY3QpO1xuICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gSW5mZXJuby5jcmVhdGVWTm9kZSg0IC8qIENvbXBvbmVudENsYXNzICovLCBSb3V0ZXJDb250ZXh0LCB7XG4gICAgICAgICAgICBsb2NhdGlvbjogdGhpcy5zdGF0ZS51cmwsXG4gICAgICAgICAgICByb3V0ZXI6IHRoaXMucm91dGVyLFxuICAgICAgICAgICAgbWF0Y2hlZDogaGl0Lm1hdGNoZWRcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHJldHVybiBSb3V0ZXI7XG59KENvbXBvbmVudCkpO1xuXG52YXIgaW5kZXggPSB7XG5cdFJvdXRlOiBSb3V0ZSxcblx0SW5kZXhSb3V0ZTogSW5kZXhSb3V0ZSxcblx0UmVkaXJlY3Q6IFJlZGlyZWN0LFxuXHRJbmRleFJlZGlyZWN0OiBSZWRpcmVjdCxcblx0Um91dGVyOiBSb3V0ZXIsXG5cdFJvdXRlckNvbnRleHQ6IFJvdXRlckNvbnRleHQsXG5cdExpbms6IExpbmssXG5cdEluZGV4TGluazogSW5kZXhMaW5rLFxuXHRtYXRjaDogbWF0Y2hcbn07XG5cbnJldHVybiBpbmRleDtcblxufSkpKTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9pbmZlcm5vL2Rpc3QvaW5mZXJuby1yb3V0ZXIubm9kZS5qc1xuLy8gbW9kdWxlIGlkID0gNjFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyohXG4gKiBpbmZlcm5vIHYxLjIuMlxuICogKGMpIDIwMTcgRG9taW5pYyBHYW5uYXdheVxuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxuICovXG4oZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuXHR0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgPyBmYWN0b3J5KGV4cG9ydHMpIDpcblx0dHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kID8gZGVmaW5lKFsnZXhwb3J0cyddLCBmYWN0b3J5KSA6XG5cdChmYWN0b3J5KChnbG9iYWwuSW5mZXJubyA9IGdsb2JhbC5JbmZlcm5vIHx8IHt9KSkpO1xufSh0aGlzLCAoZnVuY3Rpb24gKGV4cG9ydHMpIHsgJ3VzZSBzdHJpY3QnO1xuXG52YXIgTk9fT1AgPSAnJE5PX09QJztcbnZhciBFUlJPUl9NU0cgPSAnYSBydW50aW1lIGVycm9yIG9jY3VyZWQhIFVzZSBJbmZlcm5vIGluIGRldmVsb3BtZW50IGVudmlyb25tZW50IHRvIGZpbmQgdGhlIGVycm9yLic7XG52YXIgaXNCcm93c2VyID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93LmRvY3VtZW50O1xuXG4vLyB0aGlzIGlzIE1VQ0ggZmFzdGVyIHRoYW4gLmNvbnN0cnVjdG9yID09PSBBcnJheSBhbmQgaW5zdGFuY2VvZiBBcnJheVxuLy8gaW4gTm9kZSA3IGFuZCB0aGUgbGF0ZXIgdmVyc2lvbnMgb2YgVjgsIHNsb3dlciBpbiBvbGRlciB2ZXJzaW9ucyB0aG91Z2hcbnZhciBpc0FycmF5ID0gQXJyYXkuaXNBcnJheTtcbmZ1bmN0aW9uIGlzU3RhdGVmdWxDb21wb25lbnQobykge1xuICAgIHJldHVybiAhaXNVbmRlZmluZWQoby5wcm90b3R5cGUpICYmICFpc1VuZGVmaW5lZChvLnByb3RvdHlwZS5yZW5kZXIpO1xufVxuZnVuY3Rpb24gaXNTdHJpbmdPck51bWJlcihvYmopIHtcbiAgICB2YXIgdHlwZSA9IHR5cGVvZiBvYmo7XG4gICAgcmV0dXJuIHR5cGUgPT09ICdzdHJpbmcnIHx8IHR5cGUgPT09ICdudW1iZXInO1xufVxuZnVuY3Rpb24gaXNOdWxsT3JVbmRlZihvYmopIHtcbiAgICByZXR1cm4gaXNVbmRlZmluZWQob2JqKSB8fCBpc051bGwob2JqKTtcbn1cbmZ1bmN0aW9uIGlzSW52YWxpZChvYmopIHtcbiAgICByZXR1cm4gaXNOdWxsKG9iaikgfHwgb2JqID09PSBmYWxzZSB8fCBpc1RydWUob2JqKSB8fCBpc1VuZGVmaW5lZChvYmopO1xufVxuZnVuY3Rpb24gaXNGdW5jdGlvbihvYmopIHtcbiAgICByZXR1cm4gdHlwZW9mIG9iaiA9PT0gJ2Z1bmN0aW9uJztcbn1cbmZ1bmN0aW9uIGlzQXR0ckFuRXZlbnQoYXR0cikge1xuICAgIHJldHVybiBhdHRyWzBdID09PSAnbycgJiYgYXR0clsxXSA9PT0gJ24nICYmIGF0dHIubGVuZ3RoID4gMztcbn1cbmZ1bmN0aW9uIGlzU3RyaW5nKG9iaikge1xuICAgIHJldHVybiB0eXBlb2Ygb2JqID09PSAnc3RyaW5nJztcbn1cbmZ1bmN0aW9uIGlzTnVtYmVyKG9iaikge1xuICAgIHJldHVybiB0eXBlb2Ygb2JqID09PSAnbnVtYmVyJztcbn1cbmZ1bmN0aW9uIGlzTnVsbChvYmopIHtcbiAgICByZXR1cm4gb2JqID09PSBudWxsO1xufVxuZnVuY3Rpb24gaXNUcnVlKG9iaikge1xuICAgIHJldHVybiBvYmogPT09IHRydWU7XG59XG5mdW5jdGlvbiBpc1VuZGVmaW5lZChvYmopIHtcbiAgICByZXR1cm4gb2JqID09PSB1bmRlZmluZWQ7XG59XG5mdW5jdGlvbiBpc09iamVjdChvKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBvID09PSAnb2JqZWN0Jztcbn1cbmZ1bmN0aW9uIHRocm93RXJyb3IobWVzc2FnZSkge1xuICAgIGlmICghbWVzc2FnZSkge1xuICAgICAgICBtZXNzYWdlID0gRVJST1JfTVNHO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoKFwiSW5mZXJubyBFcnJvcjogXCIgKyBtZXNzYWdlKSk7XG59XG5mdW5jdGlvbiB3YXJuaW5nKG1lc3NhZ2UpIHtcbiAgICBjb25zb2xlLndhcm4obWVzc2FnZSk7XG59XG52YXIgRU1QVFlfT0JKID0ge307XG5cbmZ1bmN0aW9uIGFwcGx5S2V5KGtleSwgdk5vZGUpIHtcbiAgICB2Tm9kZS5rZXkgPSBrZXk7XG4gICAgcmV0dXJuIHZOb2RlO1xufVxuZnVuY3Rpb24gYXBwbHlLZXlJZk1pc3Npbmcoa2V5LCB2Tm9kZSkge1xuICAgIGlmIChpc051bWJlcihrZXkpKSB7XG4gICAgICAgIGtleSA9IFwiLlwiICsga2V5O1xuICAgIH1cbiAgICBpZiAoaXNOdWxsKHZOb2RlLmtleSkgfHwgdk5vZGUua2V5WzBdID09PSAnLicpIHtcbiAgICAgICAgcmV0dXJuIGFwcGx5S2V5KGtleSwgdk5vZGUpO1xuICAgIH1cbiAgICByZXR1cm4gdk5vZGU7XG59XG5mdW5jdGlvbiBhcHBseUtleVByZWZpeChrZXksIHZOb2RlKSB7XG4gICAgdk5vZGUua2V5ID0ga2V5ICsgdk5vZGUua2V5O1xuICAgIHJldHVybiB2Tm9kZTtcbn1cbmZ1bmN0aW9uIF9ub3JtYWxpemVWTm9kZXMobm9kZXMsIHJlc3VsdCwgaW5kZXgsIGN1cnJlbnRLZXkpIHtcbiAgICBmb3IgKDsgaW5kZXggPCBub2Rlcy5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgdmFyIG4gPSBub2Rlc1tpbmRleF07XG4gICAgICAgIHZhciBrZXkgPSBjdXJyZW50S2V5ICsgXCIuXCIgKyBpbmRleDtcbiAgICAgICAgaWYgKCFpc0ludmFsaWQobikpIHtcbiAgICAgICAgICAgIGlmIChpc0FycmF5KG4pKSB7XG4gICAgICAgICAgICAgICAgX25vcm1hbGl6ZVZOb2RlcyhuLCByZXN1bHQsIDAsIGtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNTdHJpbmdPck51bWJlcihuKSkge1xuICAgICAgICAgICAgICAgICAgICBuID0gY3JlYXRlVGV4dFZOb2RlKG4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChpc1ZOb2RlKG4pICYmIG4uZG9tIHx8IChuLmtleSAmJiBuLmtleVswXSA9PT0gJy4nKSkge1xuICAgICAgICAgICAgICAgICAgICBuID0gY2xvbmVWTm9kZShuKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGlzTnVsbChuLmtleSkgfHwgbi5rZXlbMF0gPT09ICcuJykge1xuICAgICAgICAgICAgICAgICAgICBuID0gYXBwbHlLZXkoa2V5LCBuKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG4gPSBhcHBseUtleVByZWZpeChjdXJyZW50S2V5LCBuKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gobik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBub3JtYWxpemVWTm9kZXMobm9kZXMpIHtcbiAgICB2YXIgbmV3Tm9kZXM7XG4gICAgLy8gd2UgYXNzaWduICQgd2hpY2ggYmFzaWNhbGx5IG1lYW5zIHdlJ3ZlIGZsYWdnZWQgdGhpcyBhcnJheSBmb3IgZnV0dXJlIG5vdGVcbiAgICAvLyBpZiBpdCBjb21lcyBiYWNrIGFnYWluLCB3ZSBuZWVkIHRvIGNsb25lIGl0LCBhcyBwZW9wbGUgYXJlIHVzaW5nIGl0XG4gICAgLy8gaW4gYW4gaW1tdXRhYmxlIHdheVxuICAgIC8vIHRzbGludDpkaXNhYmxlXG4gICAgaWYgKG5vZGVzWyckJ10pIHtcbiAgICAgICAgbm9kZXMgPSBub2Rlcy5zbGljZSgpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgbm9kZXNbJyQnXSA9IHRydWU7XG4gICAgfVxuICAgIC8vIHRzbGludDplbmFibGVcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBuID0gbm9kZXNbaV07XG4gICAgICAgIGlmIChpc0ludmFsaWQobikgfHwgaXNBcnJheShuKSkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IChuZXdOb2RlcyB8fCBub2Rlcykuc2xpY2UoMCwgaSk7XG4gICAgICAgICAgICBfbm9ybWFsaXplVk5vZGVzKG5vZGVzLCByZXN1bHQsIGksIFwiXCIpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpc1N0cmluZ09yTnVtYmVyKG4pKSB7XG4gICAgICAgICAgICBpZiAoIW5ld05vZGVzKSB7XG4gICAgICAgICAgICAgICAgbmV3Tm9kZXMgPSBub2Rlcy5zbGljZSgwLCBpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5ld05vZGVzLnB1c2goYXBwbHlLZXlJZk1pc3NpbmcoaSwgY3JlYXRlVGV4dFZOb2RlKG4pKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoKGlzVk5vZGUobikgJiYgbi5kb20pIHx8IChpc051bGwobi5rZXkpICYmICEobi5mbGFncyAmIDY0IC8qIEhhc05vbktleWVkQ2hpbGRyZW4gKi8pKSkge1xuICAgICAgICAgICAgaWYgKCFuZXdOb2Rlcykge1xuICAgICAgICAgICAgICAgIG5ld05vZGVzID0gbm9kZXMuc2xpY2UoMCwgaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuZXdOb2Rlcy5wdXNoKGFwcGx5S2V5SWZNaXNzaW5nKGksIGNsb25lVk5vZGUobikpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChuZXdOb2Rlcykge1xuICAgICAgICAgICAgbmV3Tm9kZXMucHVzaChhcHBseUtleUlmTWlzc2luZyhpLCBjbG9uZVZOb2RlKG4pKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ld05vZGVzIHx8IG5vZGVzO1xufVxuZnVuY3Rpb24gbm9ybWFsaXplQ2hpbGRyZW4oY2hpbGRyZW4pIHtcbiAgICBpZiAoaXNBcnJheShjaGlsZHJlbikpIHtcbiAgICAgICAgcmV0dXJuIG5vcm1hbGl6ZVZOb2RlcyhjaGlsZHJlbik7XG4gICAgfVxuICAgIGVsc2UgaWYgKGlzVk5vZGUoY2hpbGRyZW4pICYmIGNoaWxkcmVuLmRvbSkge1xuICAgICAgICByZXR1cm4gY2xvbmVWTm9kZShjaGlsZHJlbik7XG4gICAgfVxuICAgIHJldHVybiBjaGlsZHJlbjtcbn1cbmZ1bmN0aW9uIG5vcm1hbGl6ZVByb3BzKHZOb2RlLCBwcm9wcywgY2hpbGRyZW4pIHtcbiAgICBpZiAoISh2Tm9kZS5mbGFncyAmIDI4IC8qIENvbXBvbmVudCAqLykgJiYgaXNOdWxsT3JVbmRlZihjaGlsZHJlbikgJiYgIWlzTnVsbE9yVW5kZWYocHJvcHMuY2hpbGRyZW4pKSB7XG4gICAgICAgIHZOb2RlLmNoaWxkcmVuID0gcHJvcHMuY2hpbGRyZW47XG4gICAgfVxuICAgIGlmIChwcm9wcy5yZWYpIHtcbiAgICAgICAgdk5vZGUucmVmID0gcHJvcHMucmVmO1xuICAgICAgICBkZWxldGUgcHJvcHMucmVmO1xuICAgIH1cbiAgICBpZiAocHJvcHMuZXZlbnRzKSB7XG4gICAgICAgIHZOb2RlLmV2ZW50cyA9IHByb3BzLmV2ZW50cztcbiAgICB9XG4gICAgaWYgKCFpc051bGxPclVuZGVmKHByb3BzLmtleSkpIHtcbiAgICAgICAgdk5vZGUua2V5ID0gcHJvcHMua2V5O1xuICAgICAgICBkZWxldGUgcHJvcHMua2V5O1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNvcHlQcm9wc1RvKGNvcHlGcm9tLCBjb3B5VG8pIHtcbiAgICBmb3IgKHZhciBwcm9wIGluIGNvcHlGcm9tKSB7XG4gICAgICAgIGlmIChpc1VuZGVmaW5lZChjb3B5VG9bcHJvcF0pKSB7XG4gICAgICAgICAgICBjb3B5VG9bcHJvcF0gPSBjb3B5RnJvbVtwcm9wXTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIG5vcm1hbGl6ZUVsZW1lbnQodHlwZSwgdk5vZGUpIHtcbiAgICBpZiAodHlwZSA9PT0gJ3N2ZycpIHtcbiAgICAgICAgdk5vZGUuZmxhZ3MgPSAxMjggLyogU3ZnRWxlbWVudCAqLztcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZSA9PT0gJ2lucHV0Jykge1xuICAgICAgICB2Tm9kZS5mbGFncyA9IDUxMiAvKiBJbnB1dEVsZW1lbnQgKi87XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGUgPT09ICdzZWxlY3QnKSB7XG4gICAgICAgIHZOb2RlLmZsYWdzID0gMjA0OCAvKiBTZWxlY3RFbGVtZW50ICovO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlID09PSAndGV4dGFyZWEnKSB7XG4gICAgICAgIHZOb2RlLmZsYWdzID0gMTAyNCAvKiBUZXh0YXJlYUVsZW1lbnQgKi87XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGUgPT09ICdtZWRpYScpIHtcbiAgICAgICAgdk5vZGUuZmxhZ3MgPSAyNTYgLyogTWVkaWFFbGVtZW50ICovO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdk5vZGUuZmxhZ3MgPSAyIC8qIEh0bWxFbGVtZW50ICovO1xuICAgIH1cbn1cbmZ1bmN0aW9uIG5vcm1hbGl6ZSh2Tm9kZSkge1xuICAgIHZhciBwcm9wcyA9IHZOb2RlLnByb3BzO1xuICAgIHZhciBoYXNQcm9wcyA9ICFpc051bGwocHJvcHMpO1xuICAgIHZhciB0eXBlID0gdk5vZGUudHlwZTtcbiAgICB2YXIgY2hpbGRyZW4gPSB2Tm9kZS5jaGlsZHJlbjtcbiAgICAvLyBjb252ZXJ0IGEgd3JvbmdseSBjcmVhdGVkIHR5cGUgYmFjayB0byBlbGVtZW50XG4gICAgaWYgKGlzU3RyaW5nKHR5cGUpICYmICh2Tm9kZS5mbGFncyAmIDI4IC8qIENvbXBvbmVudCAqLykpIHtcbiAgICAgICAgbm9ybWFsaXplRWxlbWVudCh0eXBlLCB2Tm9kZSk7XG4gICAgICAgIGlmIChoYXNQcm9wcyAmJiBwcm9wcy5jaGlsZHJlbikge1xuICAgICAgICAgICAgdk5vZGUuY2hpbGRyZW4gPSBwcm9wcy5jaGlsZHJlbjtcbiAgICAgICAgICAgIGNoaWxkcmVuID0gcHJvcHMuY2hpbGRyZW47XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKGhhc1Byb3BzKSB7XG4gICAgICAgIG5vcm1hbGl6ZVByb3BzKHZOb2RlLCBwcm9wcywgY2hpbGRyZW4pO1xuICAgIH1cbiAgICBpZiAoIWlzSW52YWxpZChjaGlsZHJlbikpIHtcbiAgICAgICAgdk5vZGUuY2hpbGRyZW4gPSBub3JtYWxpemVDaGlsZHJlbihjaGlsZHJlbik7XG4gICAgfVxuICAgIGlmIChoYXNQcm9wcyAmJiAhaXNJbnZhbGlkKHByb3BzLmNoaWxkcmVuKSkge1xuICAgICAgICBwcm9wcy5jaGlsZHJlbiA9IG5vcm1hbGl6ZUNoaWxkcmVuKHByb3BzLmNoaWxkcmVuKTtcbiAgICB9XG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgLy8gVGhpcyBjb2RlIHdpbGwgYmUgc3RyaXBwZWQgb3V0IGZyb20gcHJvZHVjdGlvbiBDT0RFXG4gICAgICAgIC8vIEl0IHdpbGwgaGVscCB1c2VycyB0byB0cmFjayBlcnJvcnMgaW4gdGhlaXIgYXBwbGljYXRpb25zLlxuICAgICAgICB2YXIgdmVyaWZ5S2V5cyA9IGZ1bmN0aW9uICh2Tm9kZXMpIHtcbiAgICAgICAgICAgIHZhciBrZXlWYWx1ZXMgPSB2Tm9kZXMubWFwKGZ1bmN0aW9uICh2bm9kZSkgeyByZXR1cm4gdm5vZGUua2V5OyB9KTtcbiAgICAgICAgICAgIGtleVZhbHVlcy5zb21lKGZ1bmN0aW9uIChpdGVtLCBpZHgpIHtcbiAgICAgICAgICAgICAgICB2YXIgaGFzRHVwbGljYXRlID0ga2V5VmFsdWVzLmluZGV4T2YoaXRlbSkgIT09IGlkeDtcbiAgICAgICAgICAgICAgICBpZiAoaGFzRHVwbGljYXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHdhcm5pbmcoJ0luZmVybm8gbm9ybWFsaXNhdGlvbiguLi4pOiBFbmNvdW50ZXJlZCB0d28gY2hpbGRyZW4gd2l0aCBzYW1lIGtleSwgYWxsIGtleXMgbXVzdCBiZSB1bmlxdWUgd2l0aGluIGl0cyBzaWJsaW5ncy4gRHVwbGljYXRlZCBrZXkgaXM6JyArIGl0ZW0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gaGFzRHVwbGljYXRlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIGlmICh2Tm9kZS5jaGlsZHJlbiAmJiBBcnJheS5pc0FycmF5KHZOb2RlLmNoaWxkcmVuKSkge1xuICAgICAgICAgICAgdmVyaWZ5S2V5cyh2Tm9kZS5jaGlsZHJlbik7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbnZhciBvcHRpb25zID0ge1xuICAgIHJlY3ljbGluZ0VuYWJsZWQ6IHRydWUsXG4gICAgZmluZERPTU5vZGVFbmFibGVkOiBmYWxzZSxcbiAgICByb290czogbnVsbCxcbiAgICBjcmVhdGVWTm9kZTogbnVsbCxcbiAgICBiZWZvcmVSZW5kZXI6IG51bGwsXG4gICAgYWZ0ZXJSZW5kZXI6IG51bGwsXG4gICAgYWZ0ZXJNb3VudDogbnVsbCxcbiAgICBhZnRlclVwZGF0ZTogbnVsbCxcbiAgICBiZWZvcmVVbm1vdW50OiBudWxsXG59O1xuXG5mdW5jdGlvbiBjcmVhdGVWTm9kZShmbGFncywgdHlwZSwgcHJvcHMsIGNoaWxkcmVuLCBldmVudHMsIGtleSwgcmVmLCBub05vcm1hbGlzZSkge1xuICAgIGlmIChmbGFncyAmIDE2IC8qIENvbXBvbmVudFVua25vd24gKi8pIHtcbiAgICAgICAgZmxhZ3MgPSBpc1N0YXRlZnVsQ29tcG9uZW50KHR5cGUpID8gNCAvKiBDb21wb25lbnRDbGFzcyAqLyA6IDggLyogQ29tcG9uZW50RnVuY3Rpb24gKi87XG4gICAgfVxuICAgIHZhciB2Tm9kZSA9IHtcbiAgICAgICAgY2hpbGRyZW46IGlzVW5kZWZpbmVkKGNoaWxkcmVuKSA/IG51bGwgOiBjaGlsZHJlbixcbiAgICAgICAgZG9tOiBudWxsLFxuICAgICAgICBldmVudHM6IGV2ZW50cyB8fCBudWxsLFxuICAgICAgICBmbGFnczogZmxhZ3MsXG4gICAgICAgIGtleTogaXNVbmRlZmluZWQoa2V5KSA/IG51bGwgOiBrZXksXG4gICAgICAgIHByb3BzOiBwcm9wcyB8fCBudWxsLFxuICAgICAgICByZWY6IHJlZiB8fCBudWxsLFxuICAgICAgICB0eXBlOiB0eXBlXG4gICAgfTtcbiAgICBpZiAoIW5vTm9ybWFsaXNlKSB7XG4gICAgICAgIG5vcm1hbGl6ZSh2Tm9kZSk7XG4gICAgfVxuICAgIGlmIChvcHRpb25zLmNyZWF0ZVZOb2RlKSB7XG4gICAgICAgIG9wdGlvbnMuY3JlYXRlVk5vZGUodk5vZGUpO1xuICAgIH1cbiAgICByZXR1cm4gdk5vZGU7XG59XG5mdW5jdGlvbiBjbG9uZVZOb2RlKHZOb2RlVG9DbG9uZSwgcHJvcHMpIHtcbiAgICB2YXIgX2NoaWxkcmVuID0gW10sIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGggLSAyO1xuICAgIHdoaWxlICggbGVuLS0gPiAwICkgX2NoaWxkcmVuWyBsZW4gXSA9IGFyZ3VtZW50c1sgbGVuICsgMiBdO1xuXG4gICAgdmFyIGNoaWxkcmVuID0gX2NoaWxkcmVuO1xuICAgIGlmIChfY2hpbGRyZW4ubGVuZ3RoID4gMCAmJiAhaXNOdWxsKF9jaGlsZHJlblswXSkpIHtcbiAgICAgICAgaWYgKCFwcm9wcykge1xuICAgICAgICAgICAgcHJvcHMgPSB7fTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoX2NoaWxkcmVuLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgY2hpbGRyZW4gPSBfY2hpbGRyZW5bMF07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzVW5kZWZpbmVkKHByb3BzLmNoaWxkcmVuKSkge1xuICAgICAgICAgICAgcHJvcHMuY2hpbGRyZW4gPSBjaGlsZHJlbjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChpc0FycmF5KGNoaWxkcmVuKSkge1xuICAgICAgICAgICAgICAgIGlmIChpc0FycmF5KHByb3BzLmNoaWxkcmVuKSkge1xuICAgICAgICAgICAgICAgICAgICBwcm9wcy5jaGlsZHJlbiA9IHByb3BzLmNoaWxkcmVuLmNvbmNhdChjaGlsZHJlbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwcm9wcy5jaGlsZHJlbiA9IFtwcm9wcy5jaGlsZHJlbl0uY29uY2F0KGNoaWxkcmVuKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNBcnJheShwcm9wcy5jaGlsZHJlbikpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcHMuY2hpbGRyZW4ucHVzaChjaGlsZHJlbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwcm9wcy5jaGlsZHJlbiA9IFtwcm9wcy5jaGlsZHJlbl07XG4gICAgICAgICAgICAgICAgICAgIHByb3BzLmNoaWxkcmVuLnB1c2goY2hpbGRyZW4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBjaGlsZHJlbiA9IG51bGw7XG4gICAgdmFyIG5ld1ZOb2RlO1xuICAgIGlmIChpc0FycmF5KHZOb2RlVG9DbG9uZSkpIHtcbiAgICAgICAgdmFyIHRtcEFycmF5ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdk5vZGVUb0Nsb25lLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB0bXBBcnJheS5wdXNoKGNsb25lVk5vZGUodk5vZGVUb0Nsb25lW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgbmV3Vk5vZGUgPSB0bXBBcnJheTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHZhciBmbGFncyA9IHZOb2RlVG9DbG9uZS5mbGFncztcbiAgICAgICAgdmFyIGV2ZW50cyA9IHZOb2RlVG9DbG9uZS5ldmVudHMgfHwgKHByb3BzICYmIHByb3BzLmV2ZW50cykgfHwgbnVsbDtcbiAgICAgICAgdmFyIGtleSA9ICFpc051bGxPclVuZGVmKHZOb2RlVG9DbG9uZS5rZXkpID8gdk5vZGVUb0Nsb25lLmtleSA6IChwcm9wcyA/IHByb3BzLmtleSA6IG51bGwpO1xuICAgICAgICB2YXIgcmVmID0gdk5vZGVUb0Nsb25lLnJlZiB8fCAocHJvcHMgPyBwcm9wcy5yZWYgOiBudWxsKTtcbiAgICAgICAgaWYgKGZsYWdzICYgMjggLyogQ29tcG9uZW50ICovKSB7XG4gICAgICAgICAgICBuZXdWTm9kZSA9IGNyZWF0ZVZOb2RlKGZsYWdzLCB2Tm9kZVRvQ2xvbmUudHlwZSwgT2JqZWN0LmFzc2lnbih7fSwgdk5vZGVUb0Nsb25lLnByb3BzLCBwcm9wcyksIG51bGwsIGV2ZW50cywga2V5LCByZWYsIHRydWUpO1xuICAgICAgICAgICAgdmFyIG5ld1Byb3BzID0gbmV3Vk5vZGUucHJvcHM7XG4gICAgICAgICAgICBpZiAobmV3UHJvcHMpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3Q2hpbGRyZW4gPSBuZXdQcm9wcy5jaGlsZHJlbjtcbiAgICAgICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIGFsc28gY2xvbmUgY29tcG9uZW50IGNoaWxkcmVuIHRoYXQgYXJlIGluIHByb3BzXG4gICAgICAgICAgICAgICAgLy8gYXMgdGhlIGNoaWxkcmVuIG1heSBhbHNvIGhhdmUgYmVlbiBob2lzdGVkXG4gICAgICAgICAgICAgICAgaWYgKG5ld0NoaWxkcmVuKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0FycmF5KG5ld0NoaWxkcmVuKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSQxID0gMDsgaSQxIDwgbmV3Q2hpbGRyZW4ubGVuZ3RoOyBpJDErKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZCA9IG5ld0NoaWxkcmVuW2kkMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0ludmFsaWQoY2hpbGQpICYmIGlzVk5vZGUoY2hpbGQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1Byb3BzLmNoaWxkcmVuW2kkMV0gPSBjbG9uZVZOb2RlKGNoaWxkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoaXNWTm9kZShuZXdDaGlsZHJlbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1Byb3BzLmNoaWxkcmVuID0gY2xvbmVWTm9kZShuZXdDaGlsZHJlbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuZXdWTm9kZS5jaGlsZHJlbiA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZmxhZ3MgJiAzOTcwIC8qIEVsZW1lbnQgKi8pIHtcbiAgICAgICAgICAgIGNoaWxkcmVuID0gKHByb3BzICYmIHByb3BzLmNoaWxkcmVuKSB8fCB2Tm9kZVRvQ2xvbmUuY2hpbGRyZW47XG4gICAgICAgICAgICBuZXdWTm9kZSA9IGNyZWF0ZVZOb2RlKGZsYWdzLCB2Tm9kZVRvQ2xvbmUudHlwZSwgT2JqZWN0LmFzc2lnbih7fSwgdk5vZGVUb0Nsb25lLnByb3BzLCBwcm9wcyksIGNoaWxkcmVuLCBldmVudHMsIGtleSwgcmVmLCAhY2hpbGRyZW4pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGZsYWdzICYgMSAvKiBUZXh0ICovKSB7XG4gICAgICAgICAgICBuZXdWTm9kZSA9IGNyZWF0ZVRleHRWTm9kZSh2Tm9kZVRvQ2xvbmUuY2hpbGRyZW4pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuZXdWTm9kZTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZVZvaWRWTm9kZSgpIHtcbiAgICByZXR1cm4gY3JlYXRlVk5vZGUoNDA5NiAvKiBWb2lkICovKTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZVRleHRWTm9kZSh0ZXh0KSB7XG4gICAgcmV0dXJuIGNyZWF0ZVZOb2RlKDEgLyogVGV4dCAqLywgbnVsbCwgbnVsbCwgdGV4dCwgbnVsbCwgbnVsbCwgbnVsbCwgdHJ1ZSk7XG59XG5mdW5jdGlvbiBpc1ZOb2RlKG8pIHtcbiAgICByZXR1cm4gISFvLmZsYWdzO1xufVxuXG5mdW5jdGlvbiBjb25zdHJ1Y3REZWZhdWx0cyhzdHJpbmcsIG9iamVjdCwgdmFsdWUpIHtcbiAgICAvKiBlc2xpbnQgbm8tcmV0dXJuLWFzc2lnbjogMCAqL1xuICAgIHN0cmluZy5zcGxpdCgnLCcpLmZvckVhY2goZnVuY3Rpb24gKGkpIHsgcmV0dXJuIG9iamVjdFtpXSA9IHZhbHVlOyB9KTtcbn1cbnZhciB4bGlua05TID0gJ2h0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsnO1xudmFyIHhtbE5TID0gJ2h0dHA6Ly93d3cudzMub3JnL1hNTC8xOTk4L25hbWVzcGFjZSc7XG52YXIgc3ZnTlMgPSAnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnO1xudmFyIHN0cmljdFByb3BzID0ge307XG52YXIgYm9vbGVhblByb3BzID0ge307XG52YXIgbmFtZXNwYWNlcyA9IHt9O1xudmFyIGlzVW5pdGxlc3NOdW1iZXIgPSB7fTtcbnZhciBza2lwUHJvcHMgPSB7fTtcbnZhciBkZWh5cGhlblByb3BzID0ge1xuICAgIGh0dHBFcXVpdjogJ2h0dHAtZXF1aXYnLFxuICAgIGFjY2VwdENoYXJzZXQ6ICdhY2NlcHQtY2hhcnNldCdcbn07XG52YXIgcHJvYmFibHlLZWJhYlByb3BzID0gL14oYWNjZW50SHxhcmFiaWNGfGNhcEh8Zm9udFtGU1ZXXXxnbHlwaFtOT118aG9yaXpbQU9dfHBhbm9zZTF8cmVuZGVyaW5nSXxzdHJpa2V0aHJvdWdoW1BUXXx1bmRlcmxpbmVbUFRdfHZbQUhJTV18dmVydFtBT118eEh8YWxpZ25tZW50QnxiYXNlbGluZVN8Y2xpcFtQUl18Y29sb3JbSVBSXXxkb21pbmFudEJ8ZW5hYmxlQnxmaWxsW09SXXxmbG9vZFtDT0ZdfGltYWdlUnxsZXR0ZXJTfGxpZ2h0aW5nQ3xtYXJrZXJbRU1TXXxwb2ludGVyRXxzaGFwZVJ8c3RvcFtDT118c3Ryb2tlW0RMTU9XXXx0ZXh0W0FEUl18dW5pY29kZUJ8d29yZFN8d3JpdGluZ00pLiovO1xuZnVuY3Rpb24ga2ViYWJpemUoc3RyLCBzbWFsbExldHRlciwgbGFyZ2VMZXR0ZXIpIHtcbiAgICByZXR1cm4gKHNtYWxsTGV0dGVyICsgXCItXCIgKyAobGFyZ2VMZXR0ZXIudG9Mb3dlckNhc2UoKSkpO1xufVxudmFyIGRlbGVnYXRlZFByb3BzID0ge307XG5jb25zdHJ1Y3REZWZhdWx0cygneGxpbms6aHJlZix4bGluazphcmNyb2xlLHhsaW5rOmFjdHVhdGUseGxpbms6cm9sZSx4bGluazp0aXRsZWYseGxpbms6dHlwZScsIG5hbWVzcGFjZXMsIHhsaW5rTlMpO1xuY29uc3RydWN0RGVmYXVsdHMoJ3htbDpiYXNlLHhtbDpsYW5nLHhtbDpzcGFjZScsIG5hbWVzcGFjZXMsIHhtbE5TKTtcbmNvbnN0cnVjdERlZmF1bHRzKCd2b2x1bWUsZGVmYXVsdFZhbHVlLGRlZmF1bHRDaGVja2VkJywgc3RyaWN0UHJvcHMsIHRydWUpO1xuY29uc3RydWN0RGVmYXVsdHMoJ2NoaWxkcmVuLGNoaWxkcmVuVHlwZSxyZWYsa2V5LHNlbGVjdGVkLGNoZWNrZWQsbXVsdGlwbGUnLCBza2lwUHJvcHMsIHRydWUpO1xuY29uc3RydWN0RGVmYXVsdHMoJ29uQ2xpY2ssb25Nb3VzZURvd24sb25Nb3VzZVVwLG9uTW91c2VNb3ZlLG9uU3VibWl0LG9uRGJsQ2xpY2ssb25LZXlEb3duLG9uS2V5VXAsb25LZXlQcmVzcycsIGRlbGVnYXRlZFByb3BzLCB0cnVlKTtcbmNvbnN0cnVjdERlZmF1bHRzKCdtdXRlZCxzY29wZWQsbG9vcCxvcGVuLGNoZWNrZWQsZGVmYXVsdCxjYXB0dXJlLGRpc2FibGVkLHJlYWRPbmx5LHJlcXVpcmVkLGF1dG9wbGF5LGNvbnRyb2xzLHNlYW1sZXNzLHJldmVyc2VkLGFsbG93ZnVsbHNjcmVlbixub3ZhbGlkYXRlLGhpZGRlbicsIGJvb2xlYW5Qcm9wcywgdHJ1ZSk7XG5jb25zdHJ1Y3REZWZhdWx0cygnYW5pbWF0aW9uSXRlcmF0aW9uQ291bnQsYm9yZGVySW1hZ2VPdXRzZXQsYm9yZGVySW1hZ2VTbGljZSxib3JkZXJJbWFnZVdpZHRoLGJveEZsZXgsYm94RmxleEdyb3VwLGJveE9yZGluYWxHcm91cCxjb2x1bW5Db3VudCxmbGV4LGZsZXhHcm93LGZsZXhQb3NpdGl2ZSxmbGV4U2hyaW5rLGZsZXhOZWdhdGl2ZSxmbGV4T3JkZXIsZ3JpZFJvdyxncmlkQ29sdW1uLGZvbnRXZWlnaHQsbGluZUNsYW1wLGxpbmVIZWlnaHQsb3BhY2l0eSxvcmRlcixvcnBoYW5zLHRhYlNpemUsd2lkb3dzLHpJbmRleCx6b29tLGZpbGxPcGFjaXR5LGZsb29kT3BhY2l0eSxzdG9wT3BhY2l0eSxzdHJva2VEYXNoYXJyYXksc3Ryb2tlRGFzaG9mZnNldCxzdHJva2VNaXRlcmxpbWl0LHN0cm9rZU9wYWNpdHksc3Ryb2tlV2lkdGgsJywgaXNVbml0bGVzc051bWJlciwgdHJ1ZSk7XG5cbnZhciBMaWZlY3ljbGUgPSBmdW5jdGlvbiBMaWZlY3ljbGUoKSB7XG4gICAgdGhpcy5saXN0ZW5lcnMgPSBbXTtcbiAgICB0aGlzLmZhc3RVbm1vdW50ID0gdHJ1ZTtcbn07XG5MaWZlY3ljbGUucHJvdG90eXBlLmFkZExpc3RlbmVyID0gZnVuY3Rpb24gYWRkTGlzdGVuZXIgKGNhbGxiYWNrKSB7XG4gICAgdGhpcy5saXN0ZW5lcnMucHVzaChjYWxsYmFjayk7XG59O1xuTGlmZWN5Y2xlLnByb3RvdHlwZS50cmlnZ2VyID0gZnVuY3Rpb24gdHJpZ2dlciAoKSB7XG4gICAgICAgIHZhciB0aGlzJDEgPSB0aGlzO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxpc3RlbmVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzJDEubGlzdGVuZXJzW2ldKCk7XG4gICAgfVxufTtcblxudmFyIGlzaU9TID0gaXNCcm93c2VyICYmICEhbmF2aWdhdG9yLnBsYXRmb3JtICYmIC9pUGFkfGlQaG9uZXxpUG9kLy50ZXN0KG5hdmlnYXRvci5wbGF0Zm9ybSk7XG52YXIgZGVsZWdhdGVkRXZlbnRzID0gbmV3IE1hcCgpO1xuZnVuY3Rpb24gaGFuZGxlRXZlbnQobmFtZSwgbGFzdEV2ZW50LCBuZXh0RXZlbnQsIGRvbSkge1xuICAgIHZhciBkZWxlZ2F0ZWRSb290cyA9IGRlbGVnYXRlZEV2ZW50cy5nZXQobmFtZSk7XG4gICAgaWYgKG5leHRFdmVudCkge1xuICAgICAgICBpZiAoIWRlbGVnYXRlZFJvb3RzKSB7XG4gICAgICAgICAgICBkZWxlZ2F0ZWRSb290cyA9IHsgaXRlbXM6IG5ldyBNYXAoKSwgY291bnQ6IDAsIGRvY0V2ZW50OiBudWxsIH07XG4gICAgICAgICAgICB2YXIgZG9jRXZlbnQgPSBhdHRhY2hFdmVudFRvRG9jdW1lbnQobmFtZSwgZGVsZWdhdGVkUm9vdHMpO1xuICAgICAgICAgICAgZGVsZWdhdGVkUm9vdHMuZG9jRXZlbnQgPSBkb2NFdmVudDtcbiAgICAgICAgICAgIGRlbGVnYXRlZEV2ZW50cy5zZXQobmFtZSwgZGVsZWdhdGVkUm9vdHMpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghbGFzdEV2ZW50KSB7XG4gICAgICAgICAgICBkZWxlZ2F0ZWRSb290cy5jb3VudCsrO1xuICAgICAgICAgICAgaWYgKGlzaU9TICYmIG5hbWUgPT09ICdvbkNsaWNrJykge1xuICAgICAgICAgICAgICAgIHRyYXBDbGlja09uTm9uSW50ZXJhY3RpdmVFbGVtZW50KGRvbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZGVsZWdhdGVkUm9vdHMuaXRlbXMuc2V0KGRvbSwgbmV4dEV2ZW50KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZGVsZWdhdGVkUm9vdHMpIHtcbiAgICAgICAgaWYgKGRlbGVnYXRlZFJvb3RzLml0ZW1zLmhhcyhkb20pKSB7XG4gICAgICAgICAgICBkZWxlZ2F0ZWRSb290cy5jb3VudC0tO1xuICAgICAgICAgICAgZGVsZWdhdGVkUm9vdHMuaXRlbXMuZGVsZXRlKGRvbSk7XG4gICAgICAgICAgICBpZiAoZGVsZWdhdGVkUm9vdHMuY291bnQgPT09IDApIHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKG5vcm1hbGl6ZUV2ZW50TmFtZShuYW1lKSwgZGVsZWdhdGVkUm9vdHMuZG9jRXZlbnQpO1xuICAgICAgICAgICAgICAgIGRlbGVnYXRlZEV2ZW50cy5kZWxldGUobmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBkaXNwYXRjaEV2ZW50KGV2ZW50LCBkb20sIGl0ZW1zLCBjb3VudCwgZXZlbnREYXRhKSB7XG4gICAgdmFyIGV2ZW50c1RvVHJpZ2dlciA9IGl0ZW1zLmdldChkb20pO1xuICAgIGlmIChldmVudHNUb1RyaWdnZXIpIHtcbiAgICAgICAgY291bnQtLTtcbiAgICAgICAgLy8gbGlua0V2ZW50IG9iamVjdFxuICAgICAgICBldmVudERhdGEuZG9tID0gZG9tO1xuICAgICAgICBpZiAoZXZlbnRzVG9UcmlnZ2VyLmV2ZW50KSB7XG4gICAgICAgICAgICBldmVudHNUb1RyaWdnZXIuZXZlbnQoZXZlbnRzVG9UcmlnZ2VyLmRhdGEsIGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGV2ZW50c1RvVHJpZ2dlcihldmVudCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV2ZW50RGF0YS5zdG9wUHJvcGFnYXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoY291bnQgPiAwKSB7XG4gICAgICAgIHZhciBwYXJlbnREb20gPSBkb20ucGFyZW50Tm9kZTtcbiAgICAgICAgaWYgKHBhcmVudERvbSB8fCBwYXJlbnREb20gPT09IGRvY3VtZW50LmJvZHkpIHtcbiAgICAgICAgICAgIGRpc3BhdGNoRXZlbnQoZXZlbnQsIHBhcmVudERvbSwgaXRlbXMsIGNvdW50LCBldmVudERhdGEpO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gbm9ybWFsaXplRXZlbnROYW1lKG5hbWUpIHtcbiAgICByZXR1cm4gbmFtZS5zdWJzdHIoMikudG9Mb3dlckNhc2UoKTtcbn1cbmZ1bmN0aW9uIGF0dGFjaEV2ZW50VG9Eb2N1bWVudChuYW1lLCBkZWxlZ2F0ZWRSb290cykge1xuICAgIHZhciBkb2NFdmVudCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB2YXIgZXZlbnREYXRhID0ge1xuICAgICAgICAgICAgc3RvcFByb3BhZ2F0aW9uOiBmYWxzZSxcbiAgICAgICAgICAgIGRvbTogZG9jdW1lbnRcbiAgICAgICAgfTtcbiAgICAgICAgLy8gd2UgaGF2ZSB0byBkbyB0aGlzIGFzIHNvbWUgYnJvd3NlcnMgcmVjeWNsZSB0aGUgc2FtZSBFdmVudCBiZXR3ZWVuIGNhbGxzXG4gICAgICAgIC8vIHNvIHdlIG5lZWQgdG8gbWFrZSB0aGUgcHJvcGVydHkgY29uZmlndXJhYmxlXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShldmVudCwgJ2N1cnJlbnRUYXJnZXQnLCB7XG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXZlbnREYXRhLmRvbTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGV2ZW50RGF0YS5zdG9wUHJvcGFnYXRpb24gPSB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgY291bnQgPSBkZWxlZ2F0ZWRSb290cy5jb3VudDtcbiAgICAgICAgaWYgKGNvdW50ID4gMCkge1xuICAgICAgICAgICAgZGlzcGF0Y2hFdmVudChldmVudCwgZXZlbnQudGFyZ2V0LCBkZWxlZ2F0ZWRSb290cy5pdGVtcywgY291bnQsIGV2ZW50RGF0YSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIobm9ybWFsaXplRXZlbnROYW1lKG5hbWUpLCBkb2NFdmVudCk7XG4gICAgcmV0dXJuIGRvY0V2ZW50O1xufVxuZnVuY3Rpb24gZW1wdHlGbigpIHsgfVxuZnVuY3Rpb24gdHJhcENsaWNrT25Ob25JbnRlcmFjdGl2ZUVsZW1lbnQoZG9tKSB7XG4gICAgLy8gTW9iaWxlIFNhZmFyaSBkb2VzIG5vdCBmaXJlIHByb3Blcmx5IGJ1YmJsZSBjbGljayBldmVudHMgb25cbiAgICAvLyBub24taW50ZXJhY3RpdmUgZWxlbWVudHMsIHdoaWNoIG1lYW5zIGRlbGVnYXRlZCBjbGljayBsaXN0ZW5lcnMgZG8gbm90XG4gICAgLy8gZmlyZS4gVGhlIHdvcmthcm91bmQgZm9yIHRoaXMgYnVnIGludm9sdmVzIGF0dGFjaGluZyBhbiBlbXB0eSBjbGlja1xuICAgIC8vIGxpc3RlbmVyIG9uIHRoZSB0YXJnZXQgbm9kZS5cbiAgICAvLyBodHRwOi8vd3d3LnF1aXJrc21vZGUub3JnL2Jsb2cvYXJjaGl2ZXMvMjAxMC8wOS9jbGlja19ldmVudF9kZWwuaHRtbFxuICAgIC8vIEp1c3Qgc2V0IGl0IHVzaW5nIHRoZSBvbmNsaWNrIHByb3BlcnR5IHNvIHRoYXQgd2UgZG9uJ3QgaGF2ZSB0byBtYW5hZ2UgYW55XG4gICAgLy8gYm9va2tlZXBpbmcgZm9yIGl0LiBOb3Qgc3VyZSBpZiB3ZSBuZWVkIHRvIGNsZWFyIGl0IHdoZW4gdGhlIGxpc3RlbmVyIGlzXG4gICAgLy8gcmVtb3ZlZC5cbiAgICAvLyBUT0RPOiBPbmx5IGRvIHRoaXMgZm9yIHRoZSByZWxldmFudCBTYWZhcmlzIG1heWJlP1xuICAgIGRvbS5vbmNsaWNrID0gZW1wdHlGbjtcbn1cblxudmFyIGNvbXBvbmVudFBvb2xzID0gbmV3IE1hcCgpO1xudmFyIGVsZW1lbnRQb29scyA9IG5ldyBNYXAoKTtcbmZ1bmN0aW9uIHJlY3ljbGVFbGVtZW50KHZOb2RlLCBsaWZlY3ljbGUsIGNvbnRleHQsIGlzU1ZHKSB7XG4gICAgdmFyIHRhZyA9IHZOb2RlLnR5cGU7XG4gICAgdmFyIGtleSA9IHZOb2RlLmtleTtcbiAgICB2YXIgcG9vbHMgPSBlbGVtZW50UG9vbHMuZ2V0KHRhZyk7XG4gICAgaWYgKCFpc1VuZGVmaW5lZChwb29scykpIHtcbiAgICAgICAgdmFyIHBvb2wgPSBrZXkgPT09IG51bGwgPyBwb29scy5ub25LZXllZCA6IHBvb2xzLmtleWVkLmdldChrZXkpO1xuICAgICAgICBpZiAoIWlzVW5kZWZpbmVkKHBvb2wpKSB7XG4gICAgICAgICAgICB2YXIgcmVjeWNsZWRWTm9kZSA9IHBvb2wucG9wKCk7XG4gICAgICAgICAgICBpZiAoIWlzVW5kZWZpbmVkKHJlY3ljbGVkVk5vZGUpKSB7XG4gICAgICAgICAgICAgICAgcGF0Y2hFbGVtZW50KHJlY3ljbGVkVk5vZGUsIHZOb2RlLCBudWxsLCBsaWZlY3ljbGUsIGNvbnRleHQsIGlzU1ZHLCB0cnVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdk5vZGUuZG9tO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xufVxuZnVuY3Rpb24gcG9vbEVsZW1lbnQodk5vZGUpIHtcbiAgICB2YXIgdGFnID0gdk5vZGUudHlwZTtcbiAgICB2YXIga2V5ID0gdk5vZGUua2V5O1xuICAgIHZhciBwb29scyA9IGVsZW1lbnRQb29scy5nZXQodGFnKTtcbiAgICBpZiAoaXNVbmRlZmluZWQocG9vbHMpKSB7XG4gICAgICAgIHBvb2xzID0ge1xuICAgICAgICAgICAgbm9uS2V5ZWQ6IFtdLFxuICAgICAgICAgICAga2V5ZWQ6IG5ldyBNYXAoKVxuICAgICAgICB9O1xuICAgICAgICBlbGVtZW50UG9vbHMuc2V0KHRhZywgcG9vbHMpO1xuICAgIH1cbiAgICBpZiAoaXNOdWxsKGtleSkpIHtcbiAgICAgICAgcG9vbHMubm9uS2V5ZWQucHVzaCh2Tm9kZSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB2YXIgcG9vbCA9IHBvb2xzLmtleWVkLmdldChrZXkpO1xuICAgICAgICBpZiAoaXNVbmRlZmluZWQocG9vbCkpIHtcbiAgICAgICAgICAgIHBvb2wgPSBbXTtcbiAgICAgICAgICAgIHBvb2xzLmtleWVkLnNldChrZXksIHBvb2wpO1xuICAgICAgICB9XG4gICAgICAgIHBvb2wucHVzaCh2Tm9kZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gcmVjeWNsZUNvbXBvbmVudCh2Tm9kZSwgbGlmZWN5Y2xlLCBjb250ZXh0LCBpc1NWRykge1xuICAgIHZhciB0eXBlID0gdk5vZGUudHlwZTtcbiAgICB2YXIga2V5ID0gdk5vZGUua2V5O1xuICAgIHZhciBwb29scyA9IGNvbXBvbmVudFBvb2xzLmdldCh0eXBlKTtcbiAgICBpZiAoIWlzVW5kZWZpbmVkKHBvb2xzKSkge1xuICAgICAgICB2YXIgcG9vbCA9IGtleSA9PT0gbnVsbCA/IHBvb2xzLm5vbktleWVkIDogcG9vbHMua2V5ZWQuZ2V0KGtleSk7XG4gICAgICAgIGlmICghaXNVbmRlZmluZWQocG9vbCkpIHtcbiAgICAgICAgICAgIHZhciByZWN5Y2xlZFZOb2RlID0gcG9vbC5wb3AoKTtcbiAgICAgICAgICAgIGlmICghaXNVbmRlZmluZWQocmVjeWNsZWRWTm9kZSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZmxhZ3MgPSB2Tm9kZS5mbGFncztcbiAgICAgICAgICAgICAgICB2YXIgZmFpbGVkID0gcGF0Y2hDb21wb25lbnQocmVjeWNsZWRWTm9kZSwgdk5vZGUsIG51bGwsIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcsIGZsYWdzICYgNCAvKiBDb21wb25lbnRDbGFzcyAqLywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgaWYgKCFmYWlsZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZOb2RlLmRvbTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5mdW5jdGlvbiBwb29sQ29tcG9uZW50KHZOb2RlKSB7XG4gICAgdmFyIHR5cGUgPSB2Tm9kZS50eXBlO1xuICAgIHZhciBrZXkgPSB2Tm9kZS5rZXk7XG4gICAgdmFyIGhvb2tzID0gdk5vZGUucmVmO1xuICAgIHZhciBub25SZWN5Y2xlSG9va3MgPSBob29rcyAmJiAoaG9va3Mub25Db21wb25lbnRXaWxsTW91bnQgfHxcbiAgICAgICAgaG9va3Mub25Db21wb25lbnRXaWxsVW5tb3VudCB8fFxuICAgICAgICBob29rcy5vbkNvbXBvbmVudERpZE1vdW50IHx8XG4gICAgICAgIGhvb2tzLm9uQ29tcG9uZW50V2lsbFVwZGF0ZSB8fFxuICAgICAgICBob29rcy5vbkNvbXBvbmVudERpZFVwZGF0ZSk7XG4gICAgaWYgKG5vblJlY3ljbGVIb29rcykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBwb29scyA9IGNvbXBvbmVudFBvb2xzLmdldCh0eXBlKTtcbiAgICBpZiAoaXNVbmRlZmluZWQocG9vbHMpKSB7XG4gICAgICAgIHBvb2xzID0ge1xuICAgICAgICAgICAgbm9uS2V5ZWQ6IFtdLFxuICAgICAgICAgICAga2V5ZWQ6IG5ldyBNYXAoKVxuICAgICAgICB9O1xuICAgICAgICBjb21wb25lbnRQb29scy5zZXQodHlwZSwgcG9vbHMpO1xuICAgIH1cbiAgICBpZiAoaXNOdWxsKGtleSkpIHtcbiAgICAgICAgcG9vbHMubm9uS2V5ZWQucHVzaCh2Tm9kZSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB2YXIgcG9vbCA9IHBvb2xzLmtleWVkLmdldChrZXkpO1xuICAgICAgICBpZiAoaXNVbmRlZmluZWQocG9vbCkpIHtcbiAgICAgICAgICAgIHBvb2wgPSBbXTtcbiAgICAgICAgICAgIHBvb2xzLmtleWVkLnNldChrZXksIHBvb2wpO1xuICAgICAgICB9XG4gICAgICAgIHBvb2wucHVzaCh2Tm9kZSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB1bm1vdW50KHZOb2RlLCBwYXJlbnREb20sIGxpZmVjeWNsZSwgY2FuUmVjeWNsZSwgaXNSZWN5Y2xpbmcpIHtcbiAgICB2YXIgZmxhZ3MgPSB2Tm9kZS5mbGFncztcbiAgICBpZiAoZmxhZ3MgJiAyOCAvKiBDb21wb25lbnQgKi8pIHtcbiAgICAgICAgdW5tb3VudENvbXBvbmVudCh2Tm9kZSwgcGFyZW50RG9tLCBsaWZlY3ljbGUsIGNhblJlY3ljbGUsIGlzUmVjeWNsaW5nKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZmxhZ3MgJiAzOTcwIC8qIEVsZW1lbnQgKi8pIHtcbiAgICAgICAgdW5tb3VudEVsZW1lbnQodk5vZGUsIHBhcmVudERvbSwgbGlmZWN5Y2xlLCBjYW5SZWN5Y2xlLCBpc1JlY3ljbGluZyk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGZsYWdzICYgKDEgLyogVGV4dCAqLyB8IDQwOTYgLyogVm9pZCAqLykpIHtcbiAgICAgICAgdW5tb3VudFZvaWRPclRleHQodk5vZGUsIHBhcmVudERvbSk7XG4gICAgfVxufVxuZnVuY3Rpb24gdW5tb3VudFZvaWRPclRleHQodk5vZGUsIHBhcmVudERvbSkge1xuICAgIGlmIChwYXJlbnREb20pIHtcbiAgICAgICAgcmVtb3ZlQ2hpbGQocGFyZW50RG9tLCB2Tm9kZS5kb20pO1xuICAgIH1cbn1cbnZhciBhbHJlYWR5VW5tb3VudGVkID0gbmV3IFdlYWtNYXAoKTtcbmZ1bmN0aW9uIHVubW91bnRDb21wb25lbnQodk5vZGUsIHBhcmVudERvbSwgbGlmZWN5Y2xlLCBjYW5SZWN5Y2xlLCBpc1JlY3ljbGluZykge1xuICAgIHZhciBpbnN0YW5jZSA9IHZOb2RlLmNoaWxkcmVuO1xuICAgIHZhciBmbGFncyA9IHZOb2RlLmZsYWdzO1xuICAgIHZhciBpc1N0YXRlZnVsQ29tcG9uZW50JCQxID0gZmxhZ3MgJiA0O1xuICAgIHZhciByZWYgPSB2Tm9kZS5yZWY7XG4gICAgdmFyIGRvbSA9IHZOb2RlLmRvbTtcbiAgICBpZiAoYWxyZWFkeVVubW91bnRlZC5oYXModk5vZGUpICYmICFpc1JlY3ljbGluZyAmJiAhcGFyZW50RG9tKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgYWxyZWFkeVVubW91bnRlZC5zZXQodk5vZGUpO1xuICAgIGlmICghaXNSZWN5Y2xpbmcpIHtcbiAgICAgICAgaWYgKGlzU3RhdGVmdWxDb21wb25lbnQkJDEpIHtcbiAgICAgICAgICAgIGlmICghaW5zdGFuY2UuX3VubW91bnRlZCkge1xuICAgICAgICAgICAgICAgIGluc3RhbmNlLl9pZ25vcmVTZXRTdGF0ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgb3B0aW9ucy5iZWZvcmVVbm1vdW50ICYmIG9wdGlvbnMuYmVmb3JlVW5tb3VudCh2Tm9kZSk7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2UuY29tcG9uZW50V2lsbFVubW91bnQgJiYgaW5zdGFuY2UuY29tcG9uZW50V2lsbFVubW91bnQoKTtcbiAgICAgICAgICAgICAgICBpZiAocmVmICYmICFpc1JlY3ljbGluZykge1xuICAgICAgICAgICAgICAgICAgICByZWYobnVsbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGluc3RhbmNlLl91bm1vdW50ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIG9wdGlvbnMuZmluZERPTU5vZGVFbmFibGVkICYmIGNvbXBvbmVudFRvRE9NTm9kZU1hcC5kZWxldGUoaW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgIHZhciBzdWJMaWZlY3ljbGUgPSBpbnN0YW5jZS5fbGlmZWN5Y2xlO1xuICAgICAgICAgICAgICAgIGlmICghc3ViTGlmZWN5Y2xlLmZhc3RVbm1vdW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHVubW91bnQoaW5zdGFuY2UuX2xhc3RJbnB1dCwgbnVsbCwgc3ViTGlmZWN5Y2xlLCBmYWxzZSwgaXNSZWN5Y2xpbmcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZihyZWYpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpc051bGxPclVuZGVmKHJlZi5vbkNvbXBvbmVudFdpbGxVbm1vdW50KSkge1xuICAgICAgICAgICAgICAgICAgICByZWYub25Db21wb25lbnRXaWxsVW5tb3VudChkb20pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghbGlmZWN5Y2xlLmZhc3RVbm1vdW50KSB7XG4gICAgICAgICAgICAgICAgdW5tb3VudChpbnN0YW5jZSwgbnVsbCwgbGlmZWN5Y2xlLCBmYWxzZSwgaXNSZWN5Y2xpbmcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChwYXJlbnREb20pIHtcbiAgICAgICAgdmFyIGxhc3RJbnB1dCA9IGluc3RhbmNlLl9sYXN0SW5wdXQ7XG4gICAgICAgIGlmIChpc051bGxPclVuZGVmKGxhc3RJbnB1dCkpIHtcbiAgICAgICAgICAgIGxhc3RJbnB1dCA9IGluc3RhbmNlO1xuICAgICAgICB9XG4gICAgICAgIHJlbW92ZUNoaWxkKHBhcmVudERvbSwgZG9tKTtcbiAgICB9XG4gICAgaWYgKG9wdGlvbnMucmVjeWNsaW5nRW5hYmxlZCAmJiAhaXNTdGF0ZWZ1bENvbXBvbmVudCQkMSAmJiAocGFyZW50RG9tIHx8IGNhblJlY3ljbGUpKSB7XG4gICAgICAgIHBvb2xDb21wb25lbnQodk5vZGUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHVubW91bnRFbGVtZW50KHZOb2RlLCBwYXJlbnREb20sIGxpZmVjeWNsZSwgY2FuUmVjeWNsZSwgaXNSZWN5Y2xpbmcpIHtcbiAgICB2YXIgZG9tID0gdk5vZGUuZG9tO1xuICAgIHZhciByZWYgPSB2Tm9kZS5yZWY7XG4gICAgdmFyIGV2ZW50cyA9IHZOb2RlLmV2ZW50cztcbiAgICBpZiAoYWxyZWFkeVVubW91bnRlZC5oYXModk5vZGUpICYmICFpc1JlY3ljbGluZyAmJiAhcGFyZW50RG9tKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgYWxyZWFkeVVubW91bnRlZC5zZXQodk5vZGUpO1xuICAgIGlmICghbGlmZWN5Y2xlLmZhc3RVbm1vdW50KSB7XG4gICAgICAgIGlmIChyZWYgJiYgIWlzUmVjeWNsaW5nKSB7XG4gICAgICAgICAgICB1bm1vdW50UmVmKHJlZik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNoaWxkcmVuID0gdk5vZGUuY2hpbGRyZW47XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZihjaGlsZHJlbikpIHtcbiAgICAgICAgICAgIHVubW91bnRDaGlsZHJlbiQxKGNoaWxkcmVuLCBsaWZlY3ljbGUsIGlzUmVjeWNsaW5nKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoIWlzTnVsbChldmVudHMpKSB7XG4gICAgICAgIGZvciAodmFyIG5hbWUgaW4gZXZlbnRzKSB7XG4gICAgICAgICAgICAvLyBkbyBub3QgYWRkIGEgaGFzT3duUHJvcGVydHkgY2hlY2sgaGVyZSwgaXQgYWZmZWN0cyBwZXJmb3JtYW5jZVxuICAgICAgICAgICAgcGF0Y2hFdmVudChuYW1lLCBldmVudHNbbmFtZV0sIG51bGwsIGRvbSk7XG4gICAgICAgICAgICBldmVudHNbbmFtZV0gPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChwYXJlbnREb20pIHtcbiAgICAgICAgcmVtb3ZlQ2hpbGQocGFyZW50RG9tLCBkb20pO1xuICAgIH1cbiAgICBpZiAob3B0aW9ucy5yZWN5Y2xpbmdFbmFibGVkICYmIChwYXJlbnREb20gfHwgY2FuUmVjeWNsZSkpIHtcbiAgICAgICAgcG9vbEVsZW1lbnQodk5vZGUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHVubW91bnRDaGlsZHJlbiQxKGNoaWxkcmVuLCBsaWZlY3ljbGUsIGlzUmVjeWNsaW5nKSB7XG4gICAgaWYgKGlzQXJyYXkoY2hpbGRyZW4pKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBjaGlsZCA9IGNoaWxkcmVuW2ldO1xuICAgICAgICAgICAgaWYgKCFpc0ludmFsaWQoY2hpbGQpICYmIGlzT2JqZWN0KGNoaWxkKSkge1xuICAgICAgICAgICAgICAgIHVubW91bnQoY2hpbGQsIG51bGwsIGxpZmVjeWNsZSwgZmFsc2UsIGlzUmVjeWNsaW5nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChpc09iamVjdChjaGlsZHJlbikpIHtcbiAgICAgICAgdW5tb3VudChjaGlsZHJlbiwgbnVsbCwgbGlmZWN5Y2xlLCBmYWxzZSwgaXNSZWN5Y2xpbmcpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHVubW91bnRSZWYocmVmKSB7XG4gICAgaWYgKGlzRnVuY3Rpb24ocmVmKSkge1xuICAgICAgICByZWYobnVsbCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZiAoaXNJbnZhbGlkKHJlZikpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICAgICAgdGhyb3dFcnJvcignc3RyaW5nIFwicmVmc1wiIGFyZSBub3Qgc3VwcG9ydGVkIGluIEluZmVybm8gMS4wLiBVc2UgY2FsbGJhY2sgXCJyZWZzXCIgaW5zdGVhZC4nKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvd0Vycm9yKCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBjcmVhdGVDbGFzc0NvbXBvbmVudEluc3RhbmNlKHZOb2RlLCBDb21wb25lbnQsIHByb3BzLCBjb250ZXh0LCBpc1NWRykge1xuICAgIGlmIChpc1VuZGVmaW5lZChjb250ZXh0KSkge1xuICAgICAgICBjb250ZXh0ID0ge307XG4gICAgfVxuICAgIHZhciBpbnN0YW5jZSA9IG5ldyBDb21wb25lbnQocHJvcHMsIGNvbnRleHQpO1xuICAgIGluc3RhbmNlLmNvbnRleHQgPSBjb250ZXh0O1xuICAgIGlmIChpbnN0YW5jZS5wcm9wcyA9PT0gRU1QVFlfT0JKKSB7XG4gICAgICAgIGluc3RhbmNlLnByb3BzID0gcHJvcHM7XG4gICAgfVxuICAgIGluc3RhbmNlLl9wYXRjaCA9IHBhdGNoO1xuICAgIGlmIChvcHRpb25zLmZpbmRET01Ob2RlRW5hYmxlZCkge1xuICAgICAgICBpbnN0YW5jZS5fY29tcG9uZW50VG9ET01Ob2RlTWFwID0gY29tcG9uZW50VG9ET01Ob2RlTWFwO1xuICAgIH1cbiAgICBpbnN0YW5jZS5fdW5tb3VudGVkID0gZmFsc2U7XG4gICAgaW5zdGFuY2UuX3BlbmRpbmdTZXRTdGF0ZSA9IHRydWU7XG4gICAgaW5zdGFuY2UuX2lzU1ZHID0gaXNTVkc7XG4gICAgaWYgKGlzRnVuY3Rpb24oaW5zdGFuY2UuY29tcG9uZW50V2lsbE1vdW50KSkge1xuICAgICAgICBpbnN0YW5jZS5jb21wb25lbnRXaWxsTW91bnQoKTtcbiAgICB9XG4gICAgdmFyIGNoaWxkQ29udGV4dCA9IGluc3RhbmNlLmdldENoaWxkQ29udGV4dCgpO1xuICAgIGlmICghaXNOdWxsT3JVbmRlZihjaGlsZENvbnRleHQpKSB7XG4gICAgICAgIGluc3RhbmNlLl9jaGlsZENvbnRleHQgPSBPYmplY3QuYXNzaWduKHt9LCBjb250ZXh0LCBjaGlsZENvbnRleHQpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaW5zdGFuY2UuX2NoaWxkQ29udGV4dCA9IGNvbnRleHQ7XG4gICAgfVxuICAgIG9wdGlvbnMuYmVmb3JlUmVuZGVyICYmIG9wdGlvbnMuYmVmb3JlUmVuZGVyKGluc3RhbmNlKTtcbiAgICB2YXIgaW5wdXQgPSBpbnN0YW5jZS5yZW5kZXIocHJvcHMsIGluc3RhbmNlLnN0YXRlLCBjb250ZXh0KTtcbiAgICBvcHRpb25zLmFmdGVyUmVuZGVyICYmIG9wdGlvbnMuYWZ0ZXJSZW5kZXIoaW5zdGFuY2UpO1xuICAgIGlmIChpc0FycmF5KGlucHV0KSkge1xuICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICAgICAgdGhyb3dFcnJvcignYSB2YWxpZCBJbmZlcm5vIFZOb2RlIChvciBudWxsKSBtdXN0IGJlIHJldHVybmVkIGZyb20gYSBjb21wb25lbnQgcmVuZGVyLiBZb3UgbWF5IGhhdmUgcmV0dXJuZWQgYW4gYXJyYXkgb3IgYW4gaW52YWxpZCBvYmplY3QuJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3dFcnJvcigpO1xuICAgIH1cbiAgICBlbHNlIGlmIChpc0ludmFsaWQoaW5wdXQpKSB7XG4gICAgICAgIGlucHV0ID0gY3JlYXRlVm9pZFZOb2RlKCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGlzU3RyaW5nT3JOdW1iZXIoaW5wdXQpKSB7XG4gICAgICAgIGlucHV0ID0gY3JlYXRlVGV4dFZOb2RlKGlucHV0KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmIChpbnB1dC5kb20pIHtcbiAgICAgICAgICAgIGlucHV0ID0gY2xvbmVWTm9kZShpbnB1dCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlucHV0LmZsYWdzICYgMjggLyogQ29tcG9uZW50ICovKSB7XG4gICAgICAgICAgICAvLyBpZiB3ZSBoYXZlIGFuIGlucHV0IHRoYXQgaXMgYWxzbyBhIGNvbXBvbmVudCwgd2UgcnVuIGludG8gYSB0cmlja3kgc2l0dWF0aW9uXG4gICAgICAgICAgICAvLyB3aGVyZSB0aGUgcm9vdCB2Tm9kZSBuZWVkcyB0byBhbHdheXMgaGF2ZSB0aGUgY29ycmVjdCBET00gZW50cnlcbiAgICAgICAgICAgIC8vIHNvIHdlIGJyZWFrIG1vbm9tb3JwaGlzbSBvbiBvdXIgaW5wdXQgYW5kIHN1cHBseSBpdCBvdXIgdk5vZGUgYXMgcGFyZW50Vk5vZGVcbiAgICAgICAgICAgIC8vIHdlIGNhbiBvcHRpbWlzZSB0aGlzIGluIHRoZSBmdXR1cmUsIGJ1dCB0aGlzIGdldHMgdXMgb3V0IG9mIGEgbG90IG9mIGlzc3Vlc1xuICAgICAgICAgICAgaW5wdXQucGFyZW50Vk5vZGUgPSB2Tm9kZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpbnN0YW5jZS5fcGVuZGluZ1NldFN0YXRlID0gZmFsc2U7XG4gICAgaW5zdGFuY2UuX2xhc3RJbnB1dCA9IGlucHV0O1xuICAgIHJldHVybiBpbnN0YW5jZTtcbn1cbmZ1bmN0aW9uIHJlcGxhY2VMYXN0Q2hpbGRBbmRVbm1vdW50KGxhc3RJbnB1dCwgbmV4dElucHV0LCBwYXJlbnREb20sIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcsIGlzUmVjeWNsaW5nKSB7XG4gICAgcmVwbGFjZVZOb2RlKHBhcmVudERvbSwgbW91bnQobmV4dElucHV0LCBudWxsLCBsaWZlY3ljbGUsIGNvbnRleHQsIGlzU1ZHKSwgbGFzdElucHV0LCBsaWZlY3ljbGUsIGlzUmVjeWNsaW5nKTtcbn1cbmZ1bmN0aW9uIHJlcGxhY2VWTm9kZShwYXJlbnREb20sIGRvbSwgdk5vZGUsIGxpZmVjeWNsZSwgaXNSZWN5Y2xpbmcpIHtcbiAgICB2YXIgc2hhbGxvd1VubW91bnQgPSBmYWxzZTtcbiAgICAvLyB3ZSBjYW5ub3QgY2FjaGUgbm9kZVR5cGUgaGVyZSBhcyB2Tm9kZSBtaWdodCBiZSByZS1hc3NpZ25lZCBiZWxvd1xuICAgIGlmICh2Tm9kZS5mbGFncyAmIDI4IC8qIENvbXBvbmVudCAqLykge1xuICAgICAgICAvLyBpZiB3ZSBhcmUgYWNjZXNzaW5nIGEgc3RhdGVmdWwgb3Igc3RhdGVsZXNzIGNvbXBvbmVudCwgd2Ugd2FudCB0byBhY2Nlc3MgdGhlaXIgbGFzdCByZW5kZXJlZCBpbnB1dFxuICAgICAgICAvLyBhY2Nlc3NpbmcgdGhlaXIgRE9NIG5vZGUgaXMgbm90IHVzZWZ1bCB0byB1cyBoZXJlXG4gICAgICAgIHVubW91bnQodk5vZGUsIG51bGwsIGxpZmVjeWNsZSwgZmFsc2UsIGlzUmVjeWNsaW5nKTtcbiAgICAgICAgdk5vZGUgPSB2Tm9kZS5jaGlsZHJlbi5fbGFzdElucHV0IHx8IHZOb2RlLmNoaWxkcmVuO1xuICAgICAgICBzaGFsbG93VW5tb3VudCA9IHRydWU7XG4gICAgfVxuICAgIHJlcGxhY2VDaGlsZChwYXJlbnREb20sIGRvbSwgdk5vZGUuZG9tKTtcbiAgICB1bm1vdW50KHZOb2RlLCBudWxsLCBsaWZlY3ljbGUsIGZhbHNlLCBpc1JlY3ljbGluZyk7XG59XG5mdW5jdGlvbiBjcmVhdGVGdW5jdGlvbmFsQ29tcG9uZW50SW5wdXQodk5vZGUsIGNvbXBvbmVudCwgcHJvcHMsIGNvbnRleHQpIHtcbiAgICB2YXIgaW5wdXQgPSBjb21wb25lbnQocHJvcHMsIGNvbnRleHQpO1xuICAgIGlmIChpc0FycmF5KGlucHV0KSkge1xuICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICAgICAgdGhyb3dFcnJvcignYSB2YWxpZCBJbmZlcm5vIFZOb2RlIChvciBudWxsKSBtdXN0IGJlIHJldHVybmVkIGZyb20gYSBjb21wb25lbnQgcmVuZGVyLiBZb3UgbWF5IGhhdmUgcmV0dXJuZWQgYW4gYXJyYXkgb3IgYW4gaW52YWxpZCBvYmplY3QuJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3dFcnJvcigpO1xuICAgIH1cbiAgICBlbHNlIGlmIChpc0ludmFsaWQoaW5wdXQpKSB7XG4gICAgICAgIGlucHV0ID0gY3JlYXRlVm9pZFZOb2RlKCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGlzU3RyaW5nT3JOdW1iZXIoaW5wdXQpKSB7XG4gICAgICAgIGlucHV0ID0gY3JlYXRlVGV4dFZOb2RlKGlucHV0KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmIChpbnB1dC5kb20pIHtcbiAgICAgICAgICAgIGlucHV0ID0gY2xvbmVWTm9kZShpbnB1dCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlucHV0LmZsYWdzICYgMjggLyogQ29tcG9uZW50ICovKSB7XG4gICAgICAgICAgICAvLyBpZiB3ZSBoYXZlIGFuIGlucHV0IHRoYXQgaXMgYWxzbyBhIGNvbXBvbmVudCwgd2UgcnVuIGludG8gYSB0cmlja3kgc2l0dWF0aW9uXG4gICAgICAgICAgICAvLyB3aGVyZSB0aGUgcm9vdCB2Tm9kZSBuZWVkcyB0byBhbHdheXMgaGF2ZSB0aGUgY29ycmVjdCBET00gZW50cnlcbiAgICAgICAgICAgIC8vIHNvIHdlIGJyZWFrIG1vbm9tb3JwaGlzbSBvbiBvdXIgaW5wdXQgYW5kIHN1cHBseSBpdCBvdXIgdk5vZGUgYXMgcGFyZW50Vk5vZGVcbiAgICAgICAgICAgIC8vIHdlIGNhbiBvcHRpbWlzZSB0aGlzIGluIHRoZSBmdXR1cmUsIGJ1dCB0aGlzIGdldHMgdXMgb3V0IG9mIGEgbG90IG9mIGlzc3Vlc1xuICAgICAgICAgICAgaW5wdXQucGFyZW50Vk5vZGUgPSB2Tm9kZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gaW5wdXQ7XG59XG5mdW5jdGlvbiBzZXRUZXh0Q29udGVudChkb20sIHRleHQpIHtcbiAgICBpZiAodGV4dCAhPT0gJycpIHtcbiAgICAgICAgZG9tLnRleHRDb250ZW50ID0gdGV4dDtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGRvbS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnJykpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHVwZGF0ZVRleHRDb250ZW50KGRvbSwgdGV4dCkge1xuICAgIGRvbS5maXJzdENoaWxkLm5vZGVWYWx1ZSA9IHRleHQ7XG59XG5mdW5jdGlvbiBhcHBlbmRDaGlsZChwYXJlbnREb20sIGRvbSkge1xuICAgIHBhcmVudERvbS5hcHBlbmRDaGlsZChkb20pO1xufVxuZnVuY3Rpb24gaW5zZXJ0T3JBcHBlbmQocGFyZW50RG9tLCBuZXdOb2RlLCBuZXh0Tm9kZSkge1xuICAgIGlmIChpc051bGxPclVuZGVmKG5leHROb2RlKSkge1xuICAgICAgICBhcHBlbmRDaGlsZChwYXJlbnREb20sIG5ld05vZGUpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcGFyZW50RG9tLmluc2VydEJlZm9yZShuZXdOb2RlLCBuZXh0Tm9kZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gZG9jdW1lbnRDcmVhdGVFbGVtZW50KHRhZywgaXNTVkcpIHtcbiAgICBpZiAoaXNTVkcgPT09IHRydWUpIHtcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhzdmdOUywgdGFnKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRhZyk7XG4gICAgfVxufVxuZnVuY3Rpb24gcmVwbGFjZVdpdGhOZXdOb2RlKGxhc3ROb2RlLCBuZXh0Tm9kZSwgcGFyZW50RG9tLCBsaWZlY3ljbGUsIGNvbnRleHQsIGlzU1ZHLCBpc1JlY3ljbGluZykge1xuICAgIHVubW91bnQobGFzdE5vZGUsIG51bGwsIGxpZmVjeWNsZSwgZmFsc2UsIGlzUmVjeWNsaW5nKTtcbiAgICB2YXIgZG9tID0gbW91bnQobmV4dE5vZGUsIG51bGwsIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcpO1xuICAgIG5leHROb2RlLmRvbSA9IGRvbTtcbiAgICByZXBsYWNlQ2hpbGQocGFyZW50RG9tLCBkb20sIGxhc3ROb2RlLmRvbSk7XG59XG5mdW5jdGlvbiByZXBsYWNlQ2hpbGQocGFyZW50RG9tLCBuZXh0RG9tLCBsYXN0RG9tKSB7XG4gICAgaWYgKCFwYXJlbnREb20pIHtcbiAgICAgICAgcGFyZW50RG9tID0gbGFzdERvbS5wYXJlbnROb2RlO1xuICAgIH1cbiAgICBwYXJlbnREb20ucmVwbGFjZUNoaWxkKG5leHREb20sIGxhc3REb20pO1xufVxuZnVuY3Rpb24gcmVtb3ZlQ2hpbGQocGFyZW50RG9tLCBkb20pIHtcbiAgICBwYXJlbnREb20ucmVtb3ZlQ2hpbGQoZG9tKTtcbn1cbmZ1bmN0aW9uIHJlbW92ZUFsbENoaWxkcmVuKGRvbSwgY2hpbGRyZW4sIGxpZmVjeWNsZSwgaXNSZWN5Y2xpbmcpIHtcbiAgICBkb20udGV4dENvbnRlbnQgPSAnJztcbiAgICBpZiAoIWxpZmVjeWNsZS5mYXN0VW5tb3VudCB8fCAobGlmZWN5Y2xlLmZhc3RVbm1vdW50ICYmIG9wdGlvbnMucmVjeWNsaW5nRW5hYmxlZCAmJiAhaXNSZWN5Y2xpbmcpKSB7XG4gICAgICAgIHJlbW92ZUNoaWxkcmVuKG51bGwsIGNoaWxkcmVuLCBsaWZlY3ljbGUsIGlzUmVjeWNsaW5nKTtcbiAgICB9XG59XG5mdW5jdGlvbiByZW1vdmVDaGlsZHJlbihkb20sIGNoaWxkcmVuLCBsaWZlY3ljbGUsIGlzUmVjeWNsaW5nKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgY2hpbGQgPSBjaGlsZHJlbltpXTtcbiAgICAgICAgaWYgKCFpc0ludmFsaWQoY2hpbGQpKSB7XG4gICAgICAgICAgICB1bm1vdW50KGNoaWxkLCBkb20sIGxpZmVjeWNsZSwgdHJ1ZSwgaXNSZWN5Y2xpbmcpO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gaXNLZXllZChsYXN0Q2hpbGRyZW4sIG5leHRDaGlsZHJlbikge1xuICAgIHJldHVybiBuZXh0Q2hpbGRyZW4ubGVuZ3RoICYmICFpc051bGxPclVuZGVmKG5leHRDaGlsZHJlblswXSkgJiYgIWlzTnVsbE9yVW5kZWYobmV4dENoaWxkcmVuWzBdLmtleSlcbiAgICAgICAgJiYgbGFzdENoaWxkcmVuLmxlbmd0aCAmJiAhaXNOdWxsT3JVbmRlZihsYXN0Q2hpbGRyZW5bMF0pICYmICFpc051bGxPclVuZGVmKGxhc3RDaGlsZHJlblswXS5rZXkpO1xufVxuXG5mdW5jdGlvbiBpc0NoZWNrZWRUeXBlKHR5cGUpIHtcbiAgICByZXR1cm4gdHlwZSA9PT0gJ2NoZWNrYm94JyB8fCB0eXBlID09PSAncmFkaW8nO1xufVxuZnVuY3Rpb24gaXNDb250cm9sbGVkKHByb3BzKSB7XG4gICAgdmFyIHVzZXNDaGVja2VkID0gaXNDaGVja2VkVHlwZShwcm9wcy50eXBlKTtcbiAgICByZXR1cm4gdXNlc0NoZWNrZWQgPyAhaXNOdWxsT3JVbmRlZihwcm9wcy5jaGVja2VkKSA6ICFpc051bGxPclVuZGVmKHByb3BzLnZhbHVlKTtcbn1cbmZ1bmN0aW9uIG9uVGV4dElucHV0Q2hhbmdlKGUpIHtcbiAgICB2YXIgdk5vZGUgPSB0aGlzLnZOb2RlO1xuICAgIHZhciBldmVudHMgPSB2Tm9kZS5ldmVudHMgfHwgRU1QVFlfT0JKO1xuICAgIHZhciBkb20gPSB2Tm9kZS5kb207XG4gICAgaWYgKGV2ZW50cy5vbklucHV0KSB7XG4gICAgICAgIHZhciBldmVudCA9IGV2ZW50cy5vbklucHV0O1xuICAgICAgICBpZiAoZXZlbnQuZXZlbnQpIHtcbiAgICAgICAgICAgIGV2ZW50LmV2ZW50KGV2ZW50LmRhdGEsIGUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZXZlbnQoZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoZXZlbnRzLm9uaW5wdXQpIHtcbiAgICAgICAgZXZlbnRzLm9uaW5wdXQoZSk7XG4gICAgfVxuICAgIC8vIHRoZSB1c2VyIG1heSBoYXZlIHVwZGF0ZWQgdGhlIHZOb2RlIGZyb20gdGhlIGFib3ZlIG9uSW5wdXQgZXZlbnRzXG4gICAgLy8gc28gd2UgbmVlZCB0byBnZXQgaXQgZnJvbSB0aGUgY29udGV4dCBvZiBgdGhpc2AgYWdhaW5cbiAgICBhcHBseVZhbHVlKHRoaXMudk5vZGUsIGRvbSk7XG59XG5mdW5jdGlvbiB3cmFwcGVkT25DaGFuZ2UoZSkge1xuICAgIHZhciB2Tm9kZSA9IHRoaXMudk5vZGU7XG4gICAgdmFyIGV2ZW50cyA9IHZOb2RlLmV2ZW50cyB8fCBFTVBUWV9PQko7XG4gICAgdmFyIGV2ZW50ID0gZXZlbnRzLm9uQ2hhbmdlO1xuICAgIGlmIChldmVudC5ldmVudCkge1xuICAgICAgICBldmVudC5ldmVudChldmVudC5kYXRhLCBlKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGV2ZW50KGUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIG9uQ2hlY2tib3hDaGFuZ2UoZSkge1xuICAgIHZhciB2Tm9kZSA9IHRoaXMudk5vZGU7XG4gICAgdmFyIGV2ZW50cyA9IHZOb2RlLmV2ZW50cyB8fCBFTVBUWV9PQko7XG4gICAgdmFyIGRvbSA9IHZOb2RlLmRvbTtcbiAgICBpZiAoZXZlbnRzLm9uQ2xpY2spIHtcbiAgICAgICAgdmFyIGV2ZW50ID0gZXZlbnRzLm9uQ2xpY2s7XG4gICAgICAgIGlmIChldmVudC5ldmVudCkge1xuICAgICAgICAgICAgZXZlbnQuZXZlbnQoZXZlbnQuZGF0YSwgZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBldmVudChlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChldmVudHMub25jbGljaykge1xuICAgICAgICBldmVudHMub25jbGljayhlKTtcbiAgICB9XG4gICAgLy8gdGhlIHVzZXIgbWF5IGhhdmUgdXBkYXRlZCB0aGUgdk5vZGUgZnJvbSB0aGUgYWJvdmUgb25DbGljayBldmVudHNcbiAgICAvLyBzbyB3ZSBuZWVkIHRvIGdldCBpdCBmcm9tIHRoZSBjb250ZXh0IG9mIGB0aGlzYCBhZ2FpblxuICAgIGFwcGx5VmFsdWUodGhpcy52Tm9kZSwgZG9tKTtcbn1cbmZ1bmN0aW9uIGhhbmRsZUFzc29jaWF0ZWRSYWRpb0lucHV0cyhuYW1lKSB7XG4gICAgdmFyIGlucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoKFwiaW5wdXRbdHlwZT1cXFwicmFkaW9cXFwiXVtuYW1lPVxcXCJcIiArIG5hbWUgKyBcIlxcXCJdXCIpKTtcbiAgICBbXS5mb3JFYWNoLmNhbGwoaW5wdXRzLCBmdW5jdGlvbiAoZG9tKSB7XG4gICAgICAgIHZhciBpbnB1dFdyYXBwZXIgPSB3cmFwcGVycy5nZXQoZG9tKTtcbiAgICAgICAgaWYgKGlucHV0V3JhcHBlcikge1xuICAgICAgICAgICAgdmFyIHByb3BzID0gaW5wdXRXcmFwcGVyLnZOb2RlLnByb3BzO1xuICAgICAgICAgICAgaWYgKHByb3BzKSB7XG4gICAgICAgICAgICAgICAgZG9tLmNoZWNrZWQgPSBpbnB1dFdyYXBwZXIudk5vZGUucHJvcHMuY2hlY2tlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xufVxuZnVuY3Rpb24gcHJvY2Vzc0lucHV0KHZOb2RlLCBkb20pIHtcbiAgICB2YXIgcHJvcHMgPSB2Tm9kZS5wcm9wcyB8fCBFTVBUWV9PQko7XG4gICAgYXBwbHlWYWx1ZSh2Tm9kZSwgZG9tKTtcbiAgICBpZiAoaXNDb250cm9sbGVkKHByb3BzKSkge1xuICAgICAgICB2YXIgaW5wdXRXcmFwcGVyID0gd3JhcHBlcnMuZ2V0KGRvbSk7XG4gICAgICAgIGlmICghaW5wdXRXcmFwcGVyKSB7XG4gICAgICAgICAgICBpbnB1dFdyYXBwZXIgPSB7XG4gICAgICAgICAgICAgICAgdk5vZGU6IHZOb2RlXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKGlzQ2hlY2tlZFR5cGUocHJvcHMudHlwZSkpIHtcbiAgICAgICAgICAgICAgICBkb20ub25jbGljayA9IG9uQ2hlY2tib3hDaGFuZ2UuYmluZChpbnB1dFdyYXBwZXIpO1xuICAgICAgICAgICAgICAgIGRvbS5vbmNsaWNrLndyYXBwZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZG9tLm9uaW5wdXQgPSBvblRleHRJbnB1dENoYW5nZS5iaW5kKGlucHV0V3JhcHBlcik7XG4gICAgICAgICAgICAgICAgZG9tLm9uaW5wdXQud3JhcHBlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocHJvcHMub25DaGFuZ2UpIHtcbiAgICAgICAgICAgICAgICBkb20ub25jaGFuZ2UgPSB3cmFwcGVkT25DaGFuZ2UuYmluZChpbnB1dFdyYXBwZXIpO1xuICAgICAgICAgICAgICAgIGRvbS5vbmNoYW5nZS53cmFwcGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdyYXBwZXJzLnNldChkb20sIGlucHV0V3JhcHBlcik7XG4gICAgICAgIH1cbiAgICAgICAgaW5wdXRXcmFwcGVyLnZOb2RlID0gdk5vZGU7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5mdW5jdGlvbiBhcHBseVZhbHVlKHZOb2RlLCBkb20pIHtcbiAgICB2YXIgcHJvcHMgPSB2Tm9kZS5wcm9wcyB8fCBFTVBUWV9PQko7XG4gICAgdmFyIHR5cGUgPSBwcm9wcy50eXBlO1xuICAgIHZhciB2YWx1ZSA9IHByb3BzLnZhbHVlO1xuICAgIHZhciBjaGVja2VkID0gcHJvcHMuY2hlY2tlZDtcbiAgICB2YXIgbXVsdGlwbGUgPSBwcm9wcy5tdWx0aXBsZTtcbiAgICBpZiAodHlwZSAmJiB0eXBlICE9PSBkb20udHlwZSkge1xuICAgICAgICBkb20udHlwZSA9IHR5cGU7XG4gICAgfVxuICAgIGlmIChtdWx0aXBsZSAmJiBtdWx0aXBsZSAhPT0gZG9tLm11bHRpcGxlKSB7XG4gICAgICAgIGRvbS5tdWx0aXBsZSA9IG11bHRpcGxlO1xuICAgIH1cbiAgICBpZiAoaXNDaGVja2VkVHlwZSh0eXBlKSkge1xuICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWYodmFsdWUpKSB7XG4gICAgICAgICAgICBkb20udmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBkb20uY2hlY2tlZCA9IGNoZWNrZWQ7XG4gICAgICAgIGlmICh0eXBlID09PSAncmFkaW8nICYmIHByb3BzLm5hbWUpIHtcbiAgICAgICAgICAgIGhhbmRsZUFzc29jaWF0ZWRSYWRpb0lucHV0cyhwcm9wcy5uYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaWYgKCFpc051bGxPclVuZGVmKHZhbHVlKSAmJiBkb20udmFsdWUgIT09IHZhbHVlKSB7XG4gICAgICAgICAgICBkb20udmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghaXNOdWxsT3JVbmRlZihjaGVja2VkKSkge1xuICAgICAgICAgICAgZG9tLmNoZWNrZWQgPSBjaGVja2VkO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiBpc0NvbnRyb2xsZWQkMShwcm9wcykge1xuICAgIHJldHVybiAhaXNOdWxsT3JVbmRlZihwcm9wcy52YWx1ZSk7XG59XG5mdW5jdGlvbiB1cGRhdGVDaGlsZE9wdGlvbkdyb3VwKHZOb2RlLCB2YWx1ZSkge1xuICAgIHZhciB0eXBlID0gdk5vZGUudHlwZTtcbiAgICBpZiAodHlwZSA9PT0gJ29wdGdyb3VwJykge1xuICAgICAgICB2YXIgY2hpbGRyZW4gPSB2Tm9kZS5jaGlsZHJlbjtcbiAgICAgICAgaWYgKGlzQXJyYXkoY2hpbGRyZW4pKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdXBkYXRlQ2hpbGRPcHRpb24oY2hpbGRyZW5baV0sIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpc1ZOb2RlKGNoaWxkcmVuKSkge1xuICAgICAgICAgICAgdXBkYXRlQ2hpbGRPcHRpb24oY2hpbGRyZW4sIHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdXBkYXRlQ2hpbGRPcHRpb24odk5vZGUsIHZhbHVlKTtcbiAgICB9XG59XG5mdW5jdGlvbiB1cGRhdGVDaGlsZE9wdGlvbih2Tm9kZSwgdmFsdWUpIHtcbiAgICB2YXIgcHJvcHMgPSB2Tm9kZS5wcm9wcyB8fCBFTVBUWV9PQko7XG4gICAgdmFyIGRvbSA9IHZOb2RlLmRvbTtcbiAgICAvLyB3ZSBkbyB0aGlzIGFzIG11bHRpcGxlIG1heSBoYXZlIGNoYW5nZWRcbiAgICBkb20udmFsdWUgPSBwcm9wcy52YWx1ZTtcbiAgICBpZiAoKGlzQXJyYXkodmFsdWUpICYmIHZhbHVlLmluZGV4T2YocHJvcHMudmFsdWUpICE9PSAtMSkgfHwgcHJvcHMudmFsdWUgPT09IHZhbHVlKSB7XG4gICAgICAgIGRvbS5zZWxlY3RlZCA9IHRydWU7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBkb20uc2VsZWN0ZWQgPSBwcm9wcy5zZWxlY3RlZCB8fCBmYWxzZTtcbiAgICB9XG59XG5mdW5jdGlvbiBvblNlbGVjdENoYW5nZShlKSB7XG4gICAgdmFyIHZOb2RlID0gdGhpcy52Tm9kZTtcbiAgICB2YXIgZXZlbnRzID0gdk5vZGUuZXZlbnRzIHx8IEVNUFRZX09CSjtcbiAgICB2YXIgZG9tID0gdk5vZGUuZG9tO1xuICAgIGlmIChldmVudHMub25DaGFuZ2UpIHtcbiAgICAgICAgdmFyIGV2ZW50ID0gZXZlbnRzLm9uQ2hhbmdlO1xuICAgICAgICBpZiAoZXZlbnQuZXZlbnQpIHtcbiAgICAgICAgICAgIGV2ZW50LmV2ZW50KGV2ZW50LmRhdGEsIGUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZXZlbnQoZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoZXZlbnRzLm9uY2hhbmdlKSB7XG4gICAgICAgIGV2ZW50cy5vbmNoYW5nZShlKTtcbiAgICB9XG4gICAgLy8gdGhlIHVzZXIgbWF5IGhhdmUgdXBkYXRlZCB0aGUgdk5vZGUgZnJvbSB0aGUgYWJvdmUgb25DaGFuZ2UgZXZlbnRzXG4gICAgLy8gc28gd2UgbmVlZCB0byBnZXQgaXQgZnJvbSB0aGUgY29udGV4dCBvZiBgdGhpc2AgYWdhaW5cbiAgICBhcHBseVZhbHVlJDEodGhpcy52Tm9kZSwgZG9tKTtcbn1cbmZ1bmN0aW9uIHByb2Nlc3NTZWxlY3Qodk5vZGUsIGRvbSkge1xuICAgIHZhciBwcm9wcyA9IHZOb2RlLnByb3BzIHx8IEVNUFRZX09CSjtcbiAgICBhcHBseVZhbHVlJDEodk5vZGUsIGRvbSk7XG4gICAgaWYgKGlzQ29udHJvbGxlZCQxKHByb3BzKSkge1xuICAgICAgICB2YXIgc2VsZWN0V3JhcHBlciA9IHdyYXBwZXJzLmdldChkb20pO1xuICAgICAgICBpZiAoIXNlbGVjdFdyYXBwZXIpIHtcbiAgICAgICAgICAgIHNlbGVjdFdyYXBwZXIgPSB7XG4gICAgICAgICAgICAgICAgdk5vZGU6IHZOb2RlXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZG9tLm9uY2hhbmdlID0gb25TZWxlY3RDaGFuZ2UuYmluZChzZWxlY3RXcmFwcGVyKTtcbiAgICAgICAgICAgIGRvbS5vbmNoYW5nZS53cmFwcGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHdyYXBwZXJzLnNldChkb20sIHNlbGVjdFdyYXBwZXIpO1xuICAgICAgICB9XG4gICAgICAgIHNlbGVjdFdyYXBwZXIudk5vZGUgPSB2Tm9kZTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cbmZ1bmN0aW9uIGFwcGx5VmFsdWUkMSh2Tm9kZSwgZG9tKSB7XG4gICAgdmFyIHByb3BzID0gdk5vZGUucHJvcHMgfHwgRU1QVFlfT0JKO1xuICAgIGlmIChwcm9wcy5tdWx0aXBsZSAhPT0gZG9tLm11bHRpcGxlKSB7XG4gICAgICAgIGRvbS5tdWx0aXBsZSA9IHByb3BzLm11bHRpcGxlO1xuICAgIH1cbiAgICB2YXIgY2hpbGRyZW4gPSB2Tm9kZS5jaGlsZHJlbjtcbiAgICBpZiAoIWlzSW52YWxpZChjaGlsZHJlbikpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gcHJvcHMudmFsdWU7XG4gICAgICAgIGlmIChpc0FycmF5KGNoaWxkcmVuKSkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHVwZGF0ZUNoaWxkT3B0aW9uR3JvdXAoY2hpbGRyZW5baV0sIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpc1ZOb2RlKGNoaWxkcmVuKSkge1xuICAgICAgICAgICAgdXBkYXRlQ2hpbGRPcHRpb25Hcm91cChjaGlsZHJlbiwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiBpc0NvbnRyb2xsZWQkMihwcm9wcykge1xuICAgIHJldHVybiAhaXNOdWxsT3JVbmRlZihwcm9wcy52YWx1ZSk7XG59XG5mdW5jdGlvbiB3cmFwcGVkT25DaGFuZ2UkMShlKSB7XG4gICAgdmFyIHZOb2RlID0gdGhpcy52Tm9kZTtcbiAgICB2YXIgZXZlbnRzID0gdk5vZGUuZXZlbnRzIHx8IEVNUFRZX09CSjtcbiAgICB2YXIgZXZlbnQgPSBldmVudHMub25DaGFuZ2U7XG4gICAgaWYgKGV2ZW50LmV2ZW50KSB7XG4gICAgICAgIGV2ZW50LmV2ZW50KGV2ZW50LmRhdGEsIGUpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZXZlbnQoZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gb25UZXh0YXJlYUlucHV0Q2hhbmdlKGUpIHtcbiAgICB2YXIgdk5vZGUgPSB0aGlzLnZOb2RlO1xuICAgIHZhciBldmVudHMgPSB2Tm9kZS5ldmVudHMgfHwgRU1QVFlfT0JKO1xuICAgIHZhciBkb20gPSB2Tm9kZS5kb207XG4gICAgaWYgKGV2ZW50cy5vbklucHV0KSB7XG4gICAgICAgIHZhciBldmVudCA9IGV2ZW50cy5vbklucHV0O1xuICAgICAgICBpZiAoZXZlbnQuZXZlbnQpIHtcbiAgICAgICAgICAgIGV2ZW50LmV2ZW50KGV2ZW50LmRhdGEsIGUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZXZlbnQoZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoZXZlbnRzLm9uaW5wdXQpIHtcbiAgICAgICAgZXZlbnRzLm9uaW5wdXQoZSk7XG4gICAgfVxuICAgIC8vIHRoZSB1c2VyIG1heSBoYXZlIHVwZGF0ZWQgdGhlIHZOb2RlIGZyb20gdGhlIGFib3ZlIG9uSW5wdXQgZXZlbnRzXG4gICAgLy8gc28gd2UgbmVlZCB0byBnZXQgaXQgZnJvbSB0aGUgY29udGV4dCBvZiBgdGhpc2AgYWdhaW5cbiAgICBhcHBseVZhbHVlJDIodGhpcy52Tm9kZSwgZG9tKTtcbn1cbmZ1bmN0aW9uIHByb2Nlc3NUZXh0YXJlYSh2Tm9kZSwgZG9tKSB7XG4gICAgdmFyIHByb3BzID0gdk5vZGUucHJvcHMgfHwgRU1QVFlfT0JKO1xuICAgIGFwcGx5VmFsdWUkMih2Tm9kZSwgZG9tKTtcbiAgICB2YXIgdGV4dGFyZWFXcmFwcGVyID0gd3JhcHBlcnMuZ2V0KGRvbSk7XG4gICAgaWYgKGlzQ29udHJvbGxlZCQyKHByb3BzKSkge1xuICAgICAgICBpZiAoIXRleHRhcmVhV3JhcHBlcikge1xuICAgICAgICAgICAgdGV4dGFyZWFXcmFwcGVyID0ge1xuICAgICAgICAgICAgICAgIHZOb2RlOiB2Tm9kZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGRvbS5vbmlucHV0ID0gb25UZXh0YXJlYUlucHV0Q2hhbmdlLmJpbmQodGV4dGFyZWFXcmFwcGVyKTtcbiAgICAgICAgICAgIGRvbS5vbmlucHV0LndyYXBwZWQgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKHByb3BzLm9uQ2hhbmdlKSB7XG4gICAgICAgICAgICAgICAgZG9tLm9uY2hhbmdlID0gd3JhcHBlZE9uQ2hhbmdlJDEuYmluZCh0ZXh0YXJlYVdyYXBwZXIpO1xuICAgICAgICAgICAgICAgIGRvbS5vbmNoYW5nZS53cmFwcGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdyYXBwZXJzLnNldChkb20sIHRleHRhcmVhV3JhcHBlcik7XG4gICAgICAgIH1cbiAgICAgICAgdGV4dGFyZWFXcmFwcGVyLnZOb2RlID0gdk5vZGU7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5mdW5jdGlvbiBhcHBseVZhbHVlJDIodk5vZGUsIGRvbSkge1xuICAgIHZhciBwcm9wcyA9IHZOb2RlLnByb3BzIHx8IEVNUFRZX09CSjtcbiAgICB2YXIgdmFsdWUgPSBwcm9wcy52YWx1ZTtcbiAgICB2YXIgZG9tVmFsdWUgPSBkb20udmFsdWU7XG4gICAgaWYgKGRvbVZhbHVlICE9PSB2YWx1ZSkge1xuICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWYodmFsdWUpKSB7XG4gICAgICAgICAgICBkb20udmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkb21WYWx1ZSAhPT0gJycpIHtcbiAgICAgICAgICAgIGRvbS52YWx1ZSA9ICcnO1xuICAgICAgICB9XG4gICAgfVxufVxuXG52YXIgd3JhcHBlcnMgPSBuZXcgTWFwKCk7XG5mdW5jdGlvbiBwcm9jZXNzRWxlbWVudChmbGFncywgdk5vZGUsIGRvbSkge1xuICAgIGlmIChmbGFncyAmIDUxMiAvKiBJbnB1dEVsZW1lbnQgKi8pIHtcbiAgICAgICAgcmV0dXJuIHByb2Nlc3NJbnB1dCh2Tm9kZSwgZG9tKTtcbiAgICB9XG4gICAgaWYgKGZsYWdzICYgMjA0OCAvKiBTZWxlY3RFbGVtZW50ICovKSB7XG4gICAgICAgIHJldHVybiBwcm9jZXNzU2VsZWN0KHZOb2RlLCBkb20pO1xuICAgIH1cbiAgICBpZiAoZmxhZ3MgJiAxMDI0IC8qIFRleHRhcmVhRWxlbWVudCAqLykge1xuICAgICAgICByZXR1cm4gcHJvY2Vzc1RleHRhcmVhKHZOb2RlLCBkb20pO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbmZ1bmN0aW9uIHBhdGNoKGxhc3RWTm9kZSwgbmV4dFZOb2RlLCBwYXJlbnREb20sIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcsIGlzUmVjeWNsaW5nKSB7XG4gICAgaWYgKGxhc3RWTm9kZSAhPT0gbmV4dFZOb2RlKSB7XG4gICAgICAgIHZhciBsYXN0RmxhZ3MgPSBsYXN0Vk5vZGUuZmxhZ3M7XG4gICAgICAgIHZhciBuZXh0RmxhZ3MgPSBuZXh0Vk5vZGUuZmxhZ3M7XG4gICAgICAgIGlmIChuZXh0RmxhZ3MgJiAyOCAvKiBDb21wb25lbnQgKi8pIHtcbiAgICAgICAgICAgIGlmIChsYXN0RmxhZ3MgJiAyOCAvKiBDb21wb25lbnQgKi8pIHtcbiAgICAgICAgICAgICAgICBwYXRjaENvbXBvbmVudChsYXN0Vk5vZGUsIG5leHRWTm9kZSwgcGFyZW50RG9tLCBsaWZlY3ljbGUsIGNvbnRleHQsIGlzU1ZHLCBuZXh0RmxhZ3MgJiA0IC8qIENvbXBvbmVudENsYXNzICovLCBpc1JlY3ljbGluZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXBsYWNlVk5vZGUocGFyZW50RG9tLCBtb3VudENvbXBvbmVudChuZXh0Vk5vZGUsIG51bGwsIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcsIG5leHRGbGFncyAmIDQgLyogQ29tcG9uZW50Q2xhc3MgKi8pLCBsYXN0Vk5vZGUsIGxpZmVjeWNsZSwgaXNSZWN5Y2xpbmcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG5leHRGbGFncyAmIDM5NzAgLyogRWxlbWVudCAqLykge1xuICAgICAgICAgICAgaWYgKGxhc3RGbGFncyAmIDM5NzAgLyogRWxlbWVudCAqLykge1xuICAgICAgICAgICAgICAgIHBhdGNoRWxlbWVudChsYXN0Vk5vZGUsIG5leHRWTm9kZSwgcGFyZW50RG9tLCBsaWZlY3ljbGUsIGNvbnRleHQsIGlzU1ZHLCBpc1JlY3ljbGluZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXBsYWNlVk5vZGUocGFyZW50RG9tLCBtb3VudEVsZW1lbnQobmV4dFZOb2RlLCBudWxsLCBsaWZlY3ljbGUsIGNvbnRleHQsIGlzU1ZHKSwgbGFzdFZOb2RlLCBsaWZlY3ljbGUsIGlzUmVjeWNsaW5nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChuZXh0RmxhZ3MgJiAxIC8qIFRleHQgKi8pIHtcbiAgICAgICAgICAgIGlmIChsYXN0RmxhZ3MgJiAxIC8qIFRleHQgKi8pIHtcbiAgICAgICAgICAgICAgICBwYXRjaFRleHQobGFzdFZOb2RlLCBuZXh0Vk5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVwbGFjZVZOb2RlKHBhcmVudERvbSwgbW91bnRUZXh0KG5leHRWTm9kZSwgbnVsbCksIGxhc3RWTm9kZSwgbGlmZWN5Y2xlLCBpc1JlY3ljbGluZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAobmV4dEZsYWdzICYgNDA5NiAvKiBWb2lkICovKSB7XG4gICAgICAgICAgICBpZiAobGFzdEZsYWdzICYgNDA5NiAvKiBWb2lkICovKSB7XG4gICAgICAgICAgICAgICAgcGF0Y2hWb2lkKGxhc3RWTm9kZSwgbmV4dFZOb2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlcGxhY2VWTm9kZShwYXJlbnREb20sIG1vdW50Vm9pZChuZXh0Vk5vZGUsIG51bGwpLCBsYXN0Vk5vZGUsIGxpZmVjeWNsZSwgaXNSZWN5Y2xpbmcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gRXJyb3IgY2FzZTogbW91bnQgbmV3IG9uZSByZXBsYWNpbmcgb2xkIG9uZVxuICAgICAgICAgICAgcmVwbGFjZUxhc3RDaGlsZEFuZFVubW91bnQobGFzdFZOb2RlLCBuZXh0Vk5vZGUsIHBhcmVudERvbSwgbGlmZWN5Y2xlLCBjb250ZXh0LCBpc1NWRywgaXNSZWN5Y2xpbmcpO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gdW5tb3VudENoaWxkcmVuKGNoaWxkcmVuLCBkb20sIGxpZmVjeWNsZSwgaXNSZWN5Y2xpbmcpIHtcbiAgICBpZiAoaXNWTm9kZShjaGlsZHJlbikpIHtcbiAgICAgICAgdW5tb3VudChjaGlsZHJlbiwgZG9tLCBsaWZlY3ljbGUsIHRydWUsIGlzUmVjeWNsaW5nKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoaXNBcnJheShjaGlsZHJlbikpIHtcbiAgICAgICAgcmVtb3ZlQWxsQ2hpbGRyZW4oZG9tLCBjaGlsZHJlbiwgbGlmZWN5Y2xlLCBpc1JlY3ljbGluZyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBkb20udGV4dENvbnRlbnQgPSAnJztcbiAgICB9XG59XG5mdW5jdGlvbiBwYXRjaEVsZW1lbnQobGFzdFZOb2RlLCBuZXh0Vk5vZGUsIHBhcmVudERvbSwgbGlmZWN5Y2xlLCBjb250ZXh0LCBpc1NWRywgaXNSZWN5Y2xpbmcpIHtcbiAgICB2YXIgbmV4dFRhZyA9IG5leHRWTm9kZS50eXBlO1xuICAgIHZhciBsYXN0VGFnID0gbGFzdFZOb2RlLnR5cGU7XG4gICAgaWYgKGxhc3RUYWcgIT09IG5leHRUYWcpIHtcbiAgICAgICAgcmVwbGFjZVdpdGhOZXdOb2RlKGxhc3RWTm9kZSwgbmV4dFZOb2RlLCBwYXJlbnREb20sIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcsIGlzUmVjeWNsaW5nKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHZhciBkb20gPSBsYXN0Vk5vZGUuZG9tO1xuICAgICAgICB2YXIgbGFzdFByb3BzID0gbGFzdFZOb2RlLnByb3BzO1xuICAgICAgICB2YXIgbmV4dFByb3BzID0gbmV4dFZOb2RlLnByb3BzO1xuICAgICAgICB2YXIgbGFzdENoaWxkcmVuID0gbGFzdFZOb2RlLmNoaWxkcmVuO1xuICAgICAgICB2YXIgbmV4dENoaWxkcmVuID0gbmV4dFZOb2RlLmNoaWxkcmVuO1xuICAgICAgICB2YXIgbGFzdEZsYWdzID0gbGFzdFZOb2RlLmZsYWdzO1xuICAgICAgICB2YXIgbmV4dEZsYWdzID0gbmV4dFZOb2RlLmZsYWdzO1xuICAgICAgICB2YXIgbGFzdFJlZiA9IGxhc3RWTm9kZS5yZWY7XG4gICAgICAgIHZhciBuZXh0UmVmID0gbmV4dFZOb2RlLnJlZjtcbiAgICAgICAgdmFyIGxhc3RFdmVudHMgPSBsYXN0Vk5vZGUuZXZlbnRzO1xuICAgICAgICB2YXIgbmV4dEV2ZW50cyA9IG5leHRWTm9kZS5ldmVudHM7XG4gICAgICAgIG5leHRWTm9kZS5kb20gPSBkb207XG4gICAgICAgIGlmIChpc1NWRyB8fCAobmV4dEZsYWdzICYgMTI4IC8qIFN2Z0VsZW1lbnQgKi8pKSB7XG4gICAgICAgICAgICBpc1NWRyA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxhc3RDaGlsZHJlbiAhPT0gbmV4dENoaWxkcmVuKSB7XG4gICAgICAgICAgICBwYXRjaENoaWxkcmVuKGxhc3RGbGFncywgbmV4dEZsYWdzLCBsYXN0Q2hpbGRyZW4sIG5leHRDaGlsZHJlbiwgZG9tLCBsaWZlY3ljbGUsIGNvbnRleHQsIGlzU1ZHLCBpc1JlY3ljbGluZyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGhhc0NvbnRyb2xsZWRWYWx1ZSA9IGZhbHNlO1xuICAgICAgICBpZiAoIShuZXh0RmxhZ3MgJiAyIC8qIEh0bWxFbGVtZW50ICovKSkge1xuICAgICAgICAgICAgaGFzQ29udHJvbGxlZFZhbHVlID0gcHJvY2Vzc0VsZW1lbnQobmV4dEZsYWdzLCBuZXh0Vk5vZGUsIGRvbSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gaW5saW5lZCBwYXRjaFByb3BzICAtLSBzdGFydHMgLS1cbiAgICAgICAgaWYgKGxhc3RQcm9wcyAhPT0gbmV4dFByb3BzKSB7XG4gICAgICAgICAgICB2YXIgbGFzdFByb3BzT3JFbXB0eSA9IGxhc3RQcm9wcyB8fCBFTVBUWV9PQko7XG4gICAgICAgICAgICB2YXIgbmV4dFByb3BzT3JFbXB0eSA9IG5leHRQcm9wcyB8fCBFTVBUWV9PQko7XG4gICAgICAgICAgICBpZiAobmV4dFByb3BzT3JFbXB0eSAhPT0gRU1QVFlfT0JKKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgcHJvcCBpbiBuZXh0UHJvcHNPckVtcHR5KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGRvIG5vdCBhZGQgYSBoYXNPd25Qcm9wZXJ0eSBjaGVjayBoZXJlLCBpdCBhZmZlY3RzIHBlcmZvcm1hbmNlXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXh0VmFsdWUgPSBuZXh0UHJvcHNPckVtcHR5W3Byb3BdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGFzdFZhbHVlID0gbGFzdFByb3BzT3JFbXB0eVtwcm9wXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzTnVsbE9yVW5kZWYobmV4dFZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlUHJvcChwcm9wLCBuZXh0VmFsdWUsIGRvbSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXRjaFByb3AocHJvcCwgbGFzdFZhbHVlLCBuZXh0VmFsdWUsIGRvbSwgaXNTVkcsIGhhc0NvbnRyb2xsZWRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobGFzdFByb3BzT3JFbXB0eSAhPT0gRU1QVFlfT0JKKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgcHJvcCQxIGluIGxhc3RQcm9wc09yRW1wdHkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZG8gbm90IGFkZCBhIGhhc093blByb3BlcnR5IGNoZWNrIGhlcmUsIGl0IGFmZmVjdHMgcGVyZm9ybWFuY2VcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzTnVsbE9yVW5kZWYobmV4dFByb3BzT3JFbXB0eVtwcm9wJDFdKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlUHJvcChwcm9wJDEsIGxhc3RQcm9wc09yRW1wdHlbcHJvcCQxXSwgZG9tKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBpbmxpbmVkIHBhdGNoUHJvcHMgIC0tIGVuZHMgLS1cbiAgICAgICAgaWYgKGxhc3RFdmVudHMgIT09IG5leHRFdmVudHMpIHtcbiAgICAgICAgICAgIHBhdGNoRXZlbnRzKGxhc3RFdmVudHMsIG5leHRFdmVudHMsIGRvbSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5leHRSZWYpIHtcbiAgICAgICAgICAgIGlmIChsYXN0UmVmICE9PSBuZXh0UmVmIHx8IGlzUmVjeWNsaW5nKSB7XG4gICAgICAgICAgICAgICAgbW91bnRSZWYoZG9tLCBuZXh0UmVmLCBsaWZlY3ljbGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gcGF0Y2hDaGlsZHJlbihsYXN0RmxhZ3MsIG5leHRGbGFncywgbGFzdENoaWxkcmVuLCBuZXh0Q2hpbGRyZW4sIGRvbSwgbGlmZWN5Y2xlLCBjb250ZXh0LCBpc1NWRywgaXNSZWN5Y2xpbmcpIHtcbiAgICB2YXIgcGF0Y2hBcnJheSA9IGZhbHNlO1xuICAgIHZhciBwYXRjaEtleWVkID0gZmFsc2U7XG4gICAgaWYgKG5leHRGbGFncyAmIDY0IC8qIEhhc05vbktleWVkQ2hpbGRyZW4gKi8pIHtcbiAgICAgICAgcGF0Y2hBcnJheSA9IHRydWU7XG4gICAgfVxuICAgIGVsc2UgaWYgKChsYXN0RmxhZ3MgJiAzMiAvKiBIYXNLZXllZENoaWxkcmVuICovKSAmJiAobmV4dEZsYWdzICYgMzIgLyogSGFzS2V5ZWRDaGlsZHJlbiAqLykpIHtcbiAgICAgICAgcGF0Y2hLZXllZCA9IHRydWU7XG4gICAgICAgIHBhdGNoQXJyYXkgPSB0cnVlO1xuICAgIH1cbiAgICBlbHNlIGlmIChpc0ludmFsaWQobmV4dENoaWxkcmVuKSkge1xuICAgICAgICB1bm1vdW50Q2hpbGRyZW4obGFzdENoaWxkcmVuLCBkb20sIGxpZmVjeWNsZSwgaXNSZWN5Y2xpbmcpO1xuICAgIH1cbiAgICBlbHNlIGlmIChpc0ludmFsaWQobGFzdENoaWxkcmVuKSkge1xuICAgICAgICBpZiAoaXNTdHJpbmdPck51bWJlcihuZXh0Q2hpbGRyZW4pKSB7XG4gICAgICAgICAgICBzZXRUZXh0Q29udGVudChkb20sIG5leHRDaGlsZHJlbik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoaXNBcnJheShuZXh0Q2hpbGRyZW4pKSB7XG4gICAgICAgICAgICAgICAgbW91bnRBcnJheUNoaWxkcmVuKG5leHRDaGlsZHJlbiwgZG9tLCBsaWZlY3ljbGUsIGNvbnRleHQsIGlzU1ZHKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG1vdW50KG5leHRDaGlsZHJlbiwgZG9tLCBsaWZlY3ljbGUsIGNvbnRleHQsIGlzU1ZHKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChpc1N0cmluZ09yTnVtYmVyKG5leHRDaGlsZHJlbikpIHtcbiAgICAgICAgaWYgKGlzU3RyaW5nT3JOdW1iZXIobGFzdENoaWxkcmVuKSkge1xuICAgICAgICAgICAgdXBkYXRlVGV4dENvbnRlbnQoZG9tLCBuZXh0Q2hpbGRyZW4pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdW5tb3VudENoaWxkcmVuKGxhc3RDaGlsZHJlbiwgZG9tLCBsaWZlY3ljbGUsIGlzUmVjeWNsaW5nKTtcbiAgICAgICAgICAgIHNldFRleHRDb250ZW50KGRvbSwgbmV4dENoaWxkcmVuKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChpc0FycmF5KG5leHRDaGlsZHJlbikpIHtcbiAgICAgICAgaWYgKGlzQXJyYXkobGFzdENoaWxkcmVuKSkge1xuICAgICAgICAgICAgcGF0Y2hBcnJheSA9IHRydWU7XG4gICAgICAgICAgICBpZiAoaXNLZXllZChsYXN0Q2hpbGRyZW4sIG5leHRDaGlsZHJlbikpIHtcbiAgICAgICAgICAgICAgICBwYXRjaEtleWVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHVubW91bnRDaGlsZHJlbihsYXN0Q2hpbGRyZW4sIGRvbSwgbGlmZWN5Y2xlLCBpc1JlY3ljbGluZyk7XG4gICAgICAgICAgICBtb3VudEFycmF5Q2hpbGRyZW4obmV4dENoaWxkcmVuLCBkb20sIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGlzQXJyYXkobGFzdENoaWxkcmVuKSkge1xuICAgICAgICByZW1vdmVBbGxDaGlsZHJlbihkb20sIGxhc3RDaGlsZHJlbiwgbGlmZWN5Y2xlLCBpc1JlY3ljbGluZyk7XG4gICAgICAgIG1vdW50KG5leHRDaGlsZHJlbiwgZG9tLCBsaWZlY3ljbGUsIGNvbnRleHQsIGlzU1ZHKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoaXNWTm9kZShuZXh0Q2hpbGRyZW4pKSB7XG4gICAgICAgIGlmIChpc1ZOb2RlKGxhc3RDaGlsZHJlbikpIHtcbiAgICAgICAgICAgIHBhdGNoKGxhc3RDaGlsZHJlbiwgbmV4dENoaWxkcmVuLCBkb20sIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcsIGlzUmVjeWNsaW5nKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHVubW91bnRDaGlsZHJlbihsYXN0Q2hpbGRyZW4sIGRvbSwgbGlmZWN5Y2xlLCBpc1JlY3ljbGluZyk7XG4gICAgICAgICAgICBtb3VudChuZXh0Q2hpbGRyZW4sIGRvbSwgbGlmZWN5Y2xlLCBjb250ZXh0LCBpc1NWRyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKHBhdGNoQXJyYXkpIHtcbiAgICAgICAgaWYgKHBhdGNoS2V5ZWQpIHtcbiAgICAgICAgICAgIHBhdGNoS2V5ZWRDaGlsZHJlbihsYXN0Q2hpbGRyZW4sIG5leHRDaGlsZHJlbiwgZG9tLCBsaWZlY3ljbGUsIGNvbnRleHQsIGlzU1ZHLCBpc1JlY3ljbGluZyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwYXRjaE5vbktleWVkQ2hpbGRyZW4obGFzdENoaWxkcmVuLCBuZXh0Q2hpbGRyZW4sIGRvbSwgbGlmZWN5Y2xlLCBjb250ZXh0LCBpc1NWRywgaXNSZWN5Y2xpbmcpO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gcGF0Y2hDb21wb25lbnQobGFzdFZOb2RlLCBuZXh0Vk5vZGUsIHBhcmVudERvbSwgbGlmZWN5Y2xlLCBjb250ZXh0LCBpc1NWRywgaXNDbGFzcywgaXNSZWN5Y2xpbmcpIHtcbiAgICB2YXIgbGFzdFR5cGUgPSBsYXN0Vk5vZGUudHlwZTtcbiAgICB2YXIgbmV4dFR5cGUgPSBuZXh0Vk5vZGUudHlwZTtcbiAgICB2YXIgbmV4dFByb3BzID0gbmV4dFZOb2RlLnByb3BzIHx8IEVNUFRZX09CSjtcbiAgICB2YXIgbGFzdEtleSA9IGxhc3RWTm9kZS5rZXk7XG4gICAgdmFyIG5leHRLZXkgPSBuZXh0Vk5vZGUua2V5O1xuICAgIHZhciBkZWZhdWx0UHJvcHMgPSBuZXh0VHlwZS5kZWZhdWx0UHJvcHM7XG4gICAgaWYgKCFpc1VuZGVmaW5lZChkZWZhdWx0UHJvcHMpKSB7XG4gICAgICAgIGNvcHlQcm9wc1RvKGRlZmF1bHRQcm9wcywgbmV4dFByb3BzKTtcbiAgICAgICAgbmV4dFZOb2RlLnByb3BzID0gbmV4dFByb3BzO1xuICAgIH1cbiAgICBpZiAobGFzdFR5cGUgIT09IG5leHRUeXBlKSB7XG4gICAgICAgIGlmIChpc0NsYXNzKSB7XG4gICAgICAgICAgICByZXBsYWNlV2l0aE5ld05vZGUobGFzdFZOb2RlLCBuZXh0Vk5vZGUsIHBhcmVudERvbSwgbGlmZWN5Y2xlLCBjb250ZXh0LCBpc1NWRywgaXNSZWN5Y2xpbmcpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGxhc3RJbnB1dCA9IGxhc3RWTm9kZS5jaGlsZHJlbi5fbGFzdElucHV0IHx8IGxhc3RWTm9kZS5jaGlsZHJlbjtcbiAgICAgICAgICAgIHZhciBuZXh0SW5wdXQgPSBjcmVhdGVGdW5jdGlvbmFsQ29tcG9uZW50SW5wdXQobmV4dFZOb2RlLCBuZXh0VHlwZSwgbmV4dFByb3BzLCBjb250ZXh0KTtcbiAgICAgICAgICAgIHVubW91bnQobGFzdFZOb2RlLCBudWxsLCBsaWZlY3ljbGUsIGZhbHNlLCBpc1JlY3ljbGluZyk7XG4gICAgICAgICAgICBwYXRjaChsYXN0SW5wdXQsIG5leHRJbnB1dCwgcGFyZW50RG9tLCBsaWZlY3ljbGUsIGNvbnRleHQsIGlzU1ZHLCBpc1JlY3ljbGluZyk7XG4gICAgICAgICAgICB2YXIgZG9tID0gbmV4dFZOb2RlLmRvbSA9IG5leHRJbnB1dC5kb207XG4gICAgICAgICAgICBuZXh0Vk5vZGUuY2hpbGRyZW4gPSBuZXh0SW5wdXQ7XG4gICAgICAgICAgICBtb3VudEZ1bmN0aW9uYWxDb21wb25lbnRDYWxsYmFja3MobmV4dFZOb2RlLnJlZiwgZG9tLCBsaWZlY3ljbGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZiAoaXNDbGFzcykge1xuICAgICAgICAgICAgaWYgKGxhc3RLZXkgIT09IG5leHRLZXkpIHtcbiAgICAgICAgICAgICAgICByZXBsYWNlV2l0aE5ld05vZGUobGFzdFZOb2RlLCBuZXh0Vk5vZGUsIHBhcmVudERvbSwgbGlmZWN5Y2xlLCBjb250ZXh0LCBpc1NWRywgaXNSZWN5Y2xpbmcpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBpbnN0YW5jZSA9IGxhc3RWTm9kZS5jaGlsZHJlbjtcbiAgICAgICAgICAgIGlmIChpbnN0YW5jZS5fdW5tb3VudGVkKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzTnVsbChwYXJlbnREb20pKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXBsYWNlQ2hpbGQocGFyZW50RG9tLCBtb3VudENvbXBvbmVudChuZXh0Vk5vZGUsIG51bGwsIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcsIG5leHRWTm9kZS5mbGFncyAmIDQgLyogQ29tcG9uZW50Q2xhc3MgKi8pLCBsYXN0Vk5vZGUuZG9tKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBsYXN0U3RhdGUgPSBpbnN0YW5jZS5zdGF0ZTtcbiAgICAgICAgICAgICAgICB2YXIgbmV4dFN0YXRlID0gaW5zdGFuY2Uuc3RhdGU7XG4gICAgICAgICAgICAgICAgdmFyIGxhc3RQcm9wcyA9IGluc3RhbmNlLnByb3BzO1xuICAgICAgICAgICAgICAgIHZhciBjaGlsZENvbnRleHQgPSBpbnN0YW5jZS5nZXRDaGlsZENvbnRleHQoKTtcbiAgICAgICAgICAgICAgICBuZXh0Vk5vZGUuY2hpbGRyZW4gPSBpbnN0YW5jZTtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZS5faXNTVkcgPSBpc1NWRztcbiAgICAgICAgICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWYoY2hpbGRDb250ZXh0KSkge1xuICAgICAgICAgICAgICAgICAgICBjaGlsZENvbnRleHQgPSBPYmplY3QuYXNzaWduKHt9LCBjb250ZXh0LCBjaGlsZENvbnRleHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRDb250ZXh0ID0gY29udGV4dDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGxhc3RJbnB1dCQxID0gaW5zdGFuY2UuX2xhc3RJbnB1dDtcbiAgICAgICAgICAgICAgICB2YXIgbmV4dElucHV0JDEgPSBpbnN0YW5jZS5fdXBkYXRlQ29tcG9uZW50KGxhc3RTdGF0ZSwgbmV4dFN0YXRlLCBsYXN0UHJvcHMsIG5leHRQcm9wcywgY29udGV4dCwgZmFsc2UsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB2YXIgZGlkVXBkYXRlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZS5fY2hpbGRDb250ZXh0ID0gY2hpbGRDb250ZXh0O1xuICAgICAgICAgICAgICAgIGlmIChpc0ludmFsaWQobmV4dElucHV0JDEpKSB7XG4gICAgICAgICAgICAgICAgICAgIG5leHRJbnB1dCQxID0gY3JlYXRlVm9pZFZOb2RlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKG5leHRJbnB1dCQxID09PSBOT19PUCkge1xuICAgICAgICAgICAgICAgICAgICBuZXh0SW5wdXQkMSA9IGxhc3RJbnB1dCQxO1xuICAgICAgICAgICAgICAgICAgICBkaWRVcGRhdGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoaXNTdHJpbmdPck51bWJlcihuZXh0SW5wdXQkMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV4dElucHV0JDEgPSBjcmVhdGVUZXh0Vk5vZGUobmV4dElucHV0JDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChpc0FycmF5KG5leHRJbnB1dCQxKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3dFcnJvcignYSB2YWxpZCBJbmZlcm5vIFZOb2RlIChvciBudWxsKSBtdXN0IGJlIHJldHVybmVkIGZyb20gYSBjb21wb25lbnQgcmVuZGVyLiBZb3UgbWF5IGhhdmUgcmV0dXJuZWQgYW4gYXJyYXkgb3IgYW4gaW52YWxpZCBvYmplY3QuJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhyb3dFcnJvcigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChpc09iamVjdChuZXh0SW5wdXQkMSkgJiYgbmV4dElucHV0JDEuZG9tKSB7XG4gICAgICAgICAgICAgICAgICAgIG5leHRJbnB1dCQxID0gY2xvbmVWTm9kZShuZXh0SW5wdXQkMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChuZXh0SW5wdXQkMS5mbGFncyAmIDI4IC8qIENvbXBvbmVudCAqLykge1xuICAgICAgICAgICAgICAgICAgICBuZXh0SW5wdXQkMS5wYXJlbnRWTm9kZSA9IG5leHRWTm9kZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAobGFzdElucHV0JDEuZmxhZ3MgJiAyOCAvKiBDb21wb25lbnQgKi8pIHtcbiAgICAgICAgICAgICAgICAgICAgbGFzdElucHV0JDEucGFyZW50Vk5vZGUgPSBuZXh0Vk5vZGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGluc3RhbmNlLl9sYXN0SW5wdXQgPSBuZXh0SW5wdXQkMTtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZS5fdk5vZGUgPSBuZXh0Vk5vZGU7XG4gICAgICAgICAgICAgICAgaWYgKGRpZFVwZGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZmFzdFVubW91bnQgPSBsaWZlY3ljbGUuZmFzdFVubW91bnQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWJMaWZlY3ljbGUgPSBpbnN0YW5jZS5fbGlmZWN5Y2xlO1xuICAgICAgICAgICAgICAgICAgICBsaWZlY3ljbGUuZmFzdFVubW91bnQgPSBzdWJMaWZlY3ljbGUuZmFzdFVubW91bnQ7XG4gICAgICAgICAgICAgICAgICAgIHBhdGNoKGxhc3RJbnB1dCQxLCBuZXh0SW5wdXQkMSwgcGFyZW50RG9tLCBsaWZlY3ljbGUsIGNoaWxkQ29udGV4dCwgaXNTVkcsIGlzUmVjeWNsaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgc3ViTGlmZWN5Y2xlLmZhc3RVbm1vdW50ID0gbGlmZWN5Y2xlLmZhc3RVbm1vdW50O1xuICAgICAgICAgICAgICAgICAgICBsaWZlY3ljbGUuZmFzdFVubW91bnQgPSBmYXN0VW5tb3VudDtcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UuY29tcG9uZW50RGlkVXBkYXRlKGxhc3RQcm9wcywgbGFzdFN0YXRlKTtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5hZnRlclVwZGF0ZSAmJiBvcHRpb25zLmFmdGVyVXBkYXRlKG5leHRWTm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZmluZERPTU5vZGVFbmFibGVkICYmIGNvbXBvbmVudFRvRE9NTm9kZU1hcC5zZXQoaW5zdGFuY2UsIG5leHRJbnB1dCQxLmRvbSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5leHRWTm9kZS5kb20gPSBuZXh0SW5wdXQkMS5kb207XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgc2hvdWxkVXBkYXRlID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBsYXN0UHJvcHMkMSA9IGxhc3RWTm9kZS5wcm9wcztcbiAgICAgICAgICAgIHZhciBuZXh0SG9va3MgPSBuZXh0Vk5vZGUucmVmO1xuICAgICAgICAgICAgdmFyIG5leHRIb29rc0RlZmluZWQgPSAhaXNOdWxsT3JVbmRlZihuZXh0SG9va3MpO1xuICAgICAgICAgICAgdmFyIGxhc3RJbnB1dCQyID0gbGFzdFZOb2RlLmNoaWxkcmVuO1xuICAgICAgICAgICAgdmFyIG5leHRJbnB1dCQyID0gbGFzdElucHV0JDI7XG4gICAgICAgICAgICBuZXh0Vk5vZGUuZG9tID0gbGFzdFZOb2RlLmRvbTtcbiAgICAgICAgICAgIG5leHRWTm9kZS5jaGlsZHJlbiA9IGxhc3RJbnB1dCQyO1xuICAgICAgICAgICAgaWYgKGxhc3RLZXkgIT09IG5leHRLZXkpIHtcbiAgICAgICAgICAgICAgICBzaG91bGRVcGRhdGUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKG5leHRIb29rc0RlZmluZWQgJiYgIWlzTnVsbE9yVW5kZWYobmV4dEhvb2tzLm9uQ29tcG9uZW50U2hvdWxkVXBkYXRlKSkge1xuICAgICAgICAgICAgICAgICAgICBzaG91bGRVcGRhdGUgPSBuZXh0SG9va3Mub25Db21wb25lbnRTaG91bGRVcGRhdGUobGFzdFByb3BzJDEsIG5leHRQcm9wcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNob3VsZFVwZGF0ZSAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBpZiAobmV4dEhvb2tzRGVmaW5lZCAmJiAhaXNOdWxsT3JVbmRlZihuZXh0SG9va3Mub25Db21wb25lbnRXaWxsVXBkYXRlKSkge1xuICAgICAgICAgICAgICAgICAgICBuZXh0SG9va3Mub25Db21wb25lbnRXaWxsVXBkYXRlKGxhc3RQcm9wcyQxLCBuZXh0UHJvcHMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBuZXh0SW5wdXQkMiA9IG5leHRUeXBlKG5leHRQcm9wcywgY29udGV4dCk7XG4gICAgICAgICAgICAgICAgaWYgKGlzSW52YWxpZChuZXh0SW5wdXQkMikpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV4dElucHV0JDIgPSBjcmVhdGVWb2lkVk5vZGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoaXNTdHJpbmdPck51bWJlcihuZXh0SW5wdXQkMikgJiYgbmV4dElucHV0JDIgIT09IE5PX09QKSB7XG4gICAgICAgICAgICAgICAgICAgIG5leHRJbnB1dCQyID0gY3JlYXRlVGV4dFZOb2RlKG5leHRJbnB1dCQyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoaXNBcnJheShuZXh0SW5wdXQkMikpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93RXJyb3IoJ2EgdmFsaWQgSW5mZXJubyBWTm9kZSAob3IgbnVsbCkgbXVzdCBiZSByZXR1cm5lZCBmcm9tIGEgY29tcG9uZW50IHJlbmRlci4gWW91IG1heSBoYXZlIHJldHVybmVkIGFuIGFycmF5IG9yIGFuIGludmFsaWQgb2JqZWN0LicpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRocm93RXJyb3IoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoaXNPYmplY3QobmV4dElucHV0JDIpICYmIG5leHRJbnB1dCQyLmRvbSkge1xuICAgICAgICAgICAgICAgICAgICBuZXh0SW5wdXQkMiA9IGNsb25lVk5vZGUobmV4dElucHV0JDIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobmV4dElucHV0JDIgIT09IE5PX09QKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhdGNoKGxhc3RJbnB1dCQyLCBuZXh0SW5wdXQkMiwgcGFyZW50RG9tLCBsaWZlY3ljbGUsIGNvbnRleHQsIGlzU1ZHLCBpc1JlY3ljbGluZyk7XG4gICAgICAgICAgICAgICAgICAgIG5leHRWTm9kZS5jaGlsZHJlbiA9IG5leHRJbnB1dCQyO1xuICAgICAgICAgICAgICAgICAgICBpZiAobmV4dEhvb2tzRGVmaW5lZCAmJiAhaXNOdWxsT3JVbmRlZihuZXh0SG9va3Mub25Db21wb25lbnREaWRVcGRhdGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0SG9va3Mub25Db21wb25lbnREaWRVcGRhdGUobGFzdFByb3BzJDEsIG5leHRQcm9wcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbmV4dFZOb2RlLmRvbSA9IG5leHRJbnB1dCQyLmRvbTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobmV4dElucHV0JDIuZmxhZ3MgJiAyOCAvKiBDb21wb25lbnQgKi8pIHtcbiAgICAgICAgICAgICAgICBuZXh0SW5wdXQkMi5wYXJlbnRWTm9kZSA9IG5leHRWTm9kZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGxhc3RJbnB1dCQyLmZsYWdzICYgMjggLyogQ29tcG9uZW50ICovKSB7XG4gICAgICAgICAgICAgICAgbGFzdElucHV0JDIucGFyZW50Vk5vZGUgPSBuZXh0Vk5vZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufVxuZnVuY3Rpb24gcGF0Y2hUZXh0KGxhc3RWTm9kZSwgbmV4dFZOb2RlKSB7XG4gICAgdmFyIG5leHRUZXh0ID0gbmV4dFZOb2RlLmNoaWxkcmVuO1xuICAgIHZhciBkb20gPSBsYXN0Vk5vZGUuZG9tO1xuICAgIG5leHRWTm9kZS5kb20gPSBkb207XG4gICAgaWYgKGxhc3RWTm9kZS5jaGlsZHJlbiAhPT0gbmV4dFRleHQpIHtcbiAgICAgICAgZG9tLm5vZGVWYWx1ZSA9IG5leHRUZXh0O1xuICAgIH1cbn1cbmZ1bmN0aW9uIHBhdGNoVm9pZChsYXN0Vk5vZGUsIG5leHRWTm9kZSkge1xuICAgIG5leHRWTm9kZS5kb20gPSBsYXN0Vk5vZGUuZG9tO1xufVxuZnVuY3Rpb24gcGF0Y2hOb25LZXllZENoaWxkcmVuKGxhc3RDaGlsZHJlbiwgbmV4dENoaWxkcmVuLCBkb20sIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcsIGlzUmVjeWNsaW5nKSB7XG4gICAgdmFyIGxhc3RDaGlsZHJlbkxlbmd0aCA9IGxhc3RDaGlsZHJlbi5sZW5ndGg7XG4gICAgdmFyIG5leHRDaGlsZHJlbkxlbmd0aCA9IG5leHRDaGlsZHJlbi5sZW5ndGg7XG4gICAgdmFyIGNvbW1vbkxlbmd0aCA9IGxhc3RDaGlsZHJlbkxlbmd0aCA+IG5leHRDaGlsZHJlbkxlbmd0aCA/IG5leHRDaGlsZHJlbkxlbmd0aCA6IGxhc3RDaGlsZHJlbkxlbmd0aDtcbiAgICB2YXIgaSA9IDA7XG4gICAgZm9yICg7IGkgPCBjb21tb25MZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgbmV4dENoaWxkID0gbmV4dENoaWxkcmVuW2ldO1xuICAgICAgICBpZiAobmV4dENoaWxkLmRvbSkge1xuICAgICAgICAgICAgbmV4dENoaWxkID0gbmV4dENoaWxkcmVuW2ldID0gY2xvbmVWTm9kZShuZXh0Q2hpbGQpO1xuICAgICAgICB9XG4gICAgICAgIHBhdGNoKGxhc3RDaGlsZHJlbltpXSwgbmV4dENoaWxkLCBkb20sIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcsIGlzUmVjeWNsaW5nKTtcbiAgICB9XG4gICAgaWYgKGxhc3RDaGlsZHJlbkxlbmd0aCA8IG5leHRDaGlsZHJlbkxlbmd0aCkge1xuICAgICAgICBmb3IgKGkgPSBjb21tb25MZW5ndGg7IGkgPCBuZXh0Q2hpbGRyZW5MZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIG5leHRDaGlsZCQxID0gbmV4dENoaWxkcmVuW2ldO1xuICAgICAgICAgICAgaWYgKG5leHRDaGlsZCQxLmRvbSkge1xuICAgICAgICAgICAgICAgIG5leHRDaGlsZCQxID0gbmV4dENoaWxkcmVuW2ldID0gY2xvbmVWTm9kZShuZXh0Q2hpbGQkMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhcHBlbmRDaGlsZChkb20sIG1vdW50KG5leHRDaGlsZCQxLCBudWxsLCBsaWZlY3ljbGUsIGNvbnRleHQsIGlzU1ZHKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAobmV4dENoaWxkcmVuTGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJlbW92ZUFsbENoaWxkcmVuKGRvbSwgbGFzdENoaWxkcmVuLCBsaWZlY3ljbGUsIGlzUmVjeWNsaW5nKTtcbiAgICB9XG4gICAgZWxzZSBpZiAobGFzdENoaWxkcmVuTGVuZ3RoID4gbmV4dENoaWxkcmVuTGVuZ3RoKSB7XG4gICAgICAgIGZvciAoaSA9IGNvbW1vbkxlbmd0aDsgaSA8IGxhc3RDaGlsZHJlbkxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB1bm1vdW50KGxhc3RDaGlsZHJlbltpXSwgZG9tLCBsaWZlY3ljbGUsIGZhbHNlLCBpc1JlY3ljbGluZyk7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBwYXRjaEtleWVkQ2hpbGRyZW4oYSwgYiwgZG9tLCBsaWZlY3ljbGUsIGNvbnRleHQsIGlzU1ZHLCBpc1JlY3ljbGluZykge1xuICAgIHZhciBhTGVuZ3RoID0gYS5sZW5ndGg7XG4gICAgdmFyIGJMZW5ndGggPSBiLmxlbmd0aDtcbiAgICB2YXIgYUVuZCA9IGFMZW5ndGggLSAxO1xuICAgIHZhciBiRW5kID0gYkxlbmd0aCAtIDE7XG4gICAgdmFyIGFTdGFydCA9IDA7XG4gICAgdmFyIGJTdGFydCA9IDA7XG4gICAgdmFyIGk7XG4gICAgdmFyIGo7XG4gICAgdmFyIGFOb2RlO1xuICAgIHZhciBiTm9kZTtcbiAgICB2YXIgbmV4dE5vZGU7XG4gICAgdmFyIG5leHRQb3M7XG4gICAgdmFyIG5vZGU7XG4gICAgaWYgKGFMZW5ndGggPT09IDApIHtcbiAgICAgICAgaWYgKGJMZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgIG1vdW50QXJyYXlDaGlsZHJlbihiLCBkb20sIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZWxzZSBpZiAoYkxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZW1vdmVBbGxDaGlsZHJlbihkb20sIGEsIGxpZmVjeWNsZSwgaXNSZWN5Y2xpbmcpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBhU3RhcnROb2RlID0gYVthU3RhcnRdO1xuICAgIHZhciBiU3RhcnROb2RlID0gYltiU3RhcnRdO1xuICAgIHZhciBhRW5kTm9kZSA9IGFbYUVuZF07XG4gICAgdmFyIGJFbmROb2RlID0gYltiRW5kXTtcbiAgICBpZiAoYlN0YXJ0Tm9kZS5kb20pIHtcbiAgICAgICAgYltiU3RhcnRdID0gYlN0YXJ0Tm9kZSA9IGNsb25lVk5vZGUoYlN0YXJ0Tm9kZSk7XG4gICAgfVxuICAgIGlmIChiRW5kTm9kZS5kb20pIHtcbiAgICAgICAgYltiRW5kXSA9IGJFbmROb2RlID0gY2xvbmVWTm9kZShiRW5kTm9kZSk7XG4gICAgfVxuICAgIC8vIFN0ZXAgMVxuICAgIC8qIGVzbGludCBuby1jb25zdGFudC1jb25kaXRpb246IDAgKi9cbiAgICBvdXRlcjogd2hpbGUgKHRydWUpIHtcbiAgICAgICAgLy8gU3luYyBub2RlcyB3aXRoIHRoZSBzYW1lIGtleSBhdCB0aGUgYmVnaW5uaW5nLlxuICAgICAgICB3aGlsZSAoYVN0YXJ0Tm9kZS5rZXkgPT09IGJTdGFydE5vZGUua2V5KSB7XG4gICAgICAgICAgICBwYXRjaChhU3RhcnROb2RlLCBiU3RhcnROb2RlLCBkb20sIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcsIGlzUmVjeWNsaW5nKTtcbiAgICAgICAgICAgIGFTdGFydCsrO1xuICAgICAgICAgICAgYlN0YXJ0Kys7XG4gICAgICAgICAgICBpZiAoYVN0YXJ0ID4gYUVuZCB8fCBiU3RhcnQgPiBiRW5kKSB7XG4gICAgICAgICAgICAgICAgYnJlYWsgb3V0ZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhU3RhcnROb2RlID0gYVthU3RhcnRdO1xuICAgICAgICAgICAgYlN0YXJ0Tm9kZSA9IGJbYlN0YXJ0XTtcbiAgICAgICAgICAgIGlmIChiU3RhcnROb2RlLmRvbSkge1xuICAgICAgICAgICAgICAgIGJbYlN0YXJ0XSA9IGJTdGFydE5vZGUgPSBjbG9uZVZOb2RlKGJTdGFydE5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIFN5bmMgbm9kZXMgd2l0aCB0aGUgc2FtZSBrZXkgYXQgdGhlIGVuZC5cbiAgICAgICAgd2hpbGUgKGFFbmROb2RlLmtleSA9PT0gYkVuZE5vZGUua2V5KSB7XG4gICAgICAgICAgICBwYXRjaChhRW5kTm9kZSwgYkVuZE5vZGUsIGRvbSwgbGlmZWN5Y2xlLCBjb250ZXh0LCBpc1NWRywgaXNSZWN5Y2xpbmcpO1xuICAgICAgICAgICAgYUVuZC0tO1xuICAgICAgICAgICAgYkVuZC0tO1xuICAgICAgICAgICAgaWYgKGFTdGFydCA+IGFFbmQgfHwgYlN0YXJ0ID4gYkVuZCkge1xuICAgICAgICAgICAgICAgIGJyZWFrIG91dGVyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYUVuZE5vZGUgPSBhW2FFbmRdO1xuICAgICAgICAgICAgYkVuZE5vZGUgPSBiW2JFbmRdO1xuICAgICAgICAgICAgaWYgKGJFbmROb2RlLmRvbSkge1xuICAgICAgICAgICAgICAgIGJbYkVuZF0gPSBiRW5kTm9kZSA9IGNsb25lVk5vZGUoYkVuZE5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIE1vdmUgYW5kIHN5bmMgbm9kZXMgZnJvbSByaWdodCB0byBsZWZ0LlxuICAgICAgICBpZiAoYUVuZE5vZGUua2V5ID09PSBiU3RhcnROb2RlLmtleSkge1xuICAgICAgICAgICAgcGF0Y2goYUVuZE5vZGUsIGJTdGFydE5vZGUsIGRvbSwgbGlmZWN5Y2xlLCBjb250ZXh0LCBpc1NWRywgaXNSZWN5Y2xpbmcpO1xuICAgICAgICAgICAgaW5zZXJ0T3JBcHBlbmQoZG9tLCBiU3RhcnROb2RlLmRvbSwgYVN0YXJ0Tm9kZS5kb20pO1xuICAgICAgICAgICAgYUVuZC0tO1xuICAgICAgICAgICAgYlN0YXJ0Kys7XG4gICAgICAgICAgICBhRW5kTm9kZSA9IGFbYUVuZF07XG4gICAgICAgICAgICBiU3RhcnROb2RlID0gYltiU3RhcnRdO1xuICAgICAgICAgICAgaWYgKGJTdGFydE5vZGUuZG9tKSB7XG4gICAgICAgICAgICAgICAgYltiU3RhcnRdID0gYlN0YXJ0Tm9kZSA9IGNsb25lVk5vZGUoYlN0YXJ0Tm9kZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICAvLyBNb3ZlIGFuZCBzeW5jIG5vZGVzIGZyb20gbGVmdCB0byByaWdodC5cbiAgICAgICAgaWYgKGFTdGFydE5vZGUua2V5ID09PSBiRW5kTm9kZS5rZXkpIHtcbiAgICAgICAgICAgIHBhdGNoKGFTdGFydE5vZGUsIGJFbmROb2RlLCBkb20sIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcsIGlzUmVjeWNsaW5nKTtcbiAgICAgICAgICAgIG5leHRQb3MgPSBiRW5kICsgMTtcbiAgICAgICAgICAgIG5leHROb2RlID0gbmV4dFBvcyA8IGIubGVuZ3RoID8gYltuZXh0UG9zXS5kb20gOiBudWxsO1xuICAgICAgICAgICAgaW5zZXJ0T3JBcHBlbmQoZG9tLCBiRW5kTm9kZS5kb20sIG5leHROb2RlKTtcbiAgICAgICAgICAgIGFTdGFydCsrO1xuICAgICAgICAgICAgYkVuZC0tO1xuICAgICAgICAgICAgYVN0YXJ0Tm9kZSA9IGFbYVN0YXJ0XTtcbiAgICAgICAgICAgIGJFbmROb2RlID0gYltiRW5kXTtcbiAgICAgICAgICAgIGlmIChiRW5kTm9kZS5kb20pIHtcbiAgICAgICAgICAgICAgICBiW2JFbmRdID0gYkVuZE5vZGUgPSBjbG9uZVZOb2RlKGJFbmROb2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBpZiAoYVN0YXJ0ID4gYUVuZCkge1xuICAgICAgICBpZiAoYlN0YXJ0IDw9IGJFbmQpIHtcbiAgICAgICAgICAgIG5leHRQb3MgPSBiRW5kICsgMTtcbiAgICAgICAgICAgIG5leHROb2RlID0gbmV4dFBvcyA8IGIubGVuZ3RoID8gYltuZXh0UG9zXS5kb20gOiBudWxsO1xuICAgICAgICAgICAgd2hpbGUgKGJTdGFydCA8PSBiRW5kKSB7XG4gICAgICAgICAgICAgICAgbm9kZSA9IGJbYlN0YXJ0XTtcbiAgICAgICAgICAgICAgICBpZiAobm9kZS5kb20pIHtcbiAgICAgICAgICAgICAgICAgICAgYltiU3RhcnRdID0gbm9kZSA9IGNsb25lVk5vZGUobm9kZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJTdGFydCsrO1xuICAgICAgICAgICAgICAgIGluc2VydE9yQXBwZW5kKGRvbSwgbW91bnQobm9kZSwgbnVsbCwgbGlmZWN5Y2xlLCBjb250ZXh0LCBpc1NWRyksIG5leHROb2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChiU3RhcnQgPiBiRW5kKSB7XG4gICAgICAgIHdoaWxlIChhU3RhcnQgPD0gYUVuZCkge1xuICAgICAgICAgICAgdW5tb3VudChhW2FTdGFydCsrXSwgZG9tLCBsaWZlY3ljbGUsIGZhbHNlLCBpc1JlY3ljbGluZyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGFMZW5ndGggPSBhRW5kIC0gYVN0YXJ0ICsgMTtcbiAgICAgICAgYkxlbmd0aCA9IGJFbmQgLSBiU3RhcnQgKyAxO1xuICAgICAgICB2YXIgYU51bGxhYmxlID0gYTtcbiAgICAgICAgdmFyIHNvdXJjZXMgPSBuZXcgQXJyYXkoYkxlbmd0aCk7XG4gICAgICAgIC8vIE1hcmsgYWxsIG5vZGVzIGFzIGluc2VydGVkLlxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgYkxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBzb3VyY2VzW2ldID0gLTE7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1vdmVkID0gZmFsc2U7XG4gICAgICAgIHZhciBwb3MgPSAwO1xuICAgICAgICB2YXIgcGF0Y2hlZCA9IDA7XG4gICAgICAgIGlmICgoYkxlbmd0aCA8PSA0KSB8fCAoYUxlbmd0aCAqIGJMZW5ndGggPD0gMTYpKSB7XG4gICAgICAgICAgICBmb3IgKGkgPSBhU3RhcnQ7IGkgPD0gYUVuZDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgYU5vZGUgPSBhW2ldO1xuICAgICAgICAgICAgICAgIGlmIChwYXRjaGVkIDwgYkxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGogPSBiU3RhcnQ7IGogPD0gYkVuZDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBiTm9kZSA9IGJbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYU5vZGUua2V5ID09PSBiTm9kZS5rZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2ogLSBiU3RhcnRdID0gaTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocG9zID4gaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb3ZlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3MgPSBqO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYk5vZGUuZG9tKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJbal0gPSBiTm9kZSA9IGNsb25lVk5vZGUoYk5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRjaChhTm9kZSwgYk5vZGUsIGRvbSwgbGlmZWN5Y2xlLCBjb250ZXh0LCBpc1NWRywgaXNSZWN5Y2xpbmcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGNoZWQrKztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTnVsbGFibGVbaV0gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGtleUluZGV4ID0gbmV3IE1hcCgpO1xuICAgICAgICAgICAgZm9yIChpID0gYlN0YXJ0OyBpIDw9IGJFbmQ7IGkrKykge1xuICAgICAgICAgICAgICAgIG5vZGUgPSBiW2ldO1xuICAgICAgICAgICAgICAgIGtleUluZGV4LnNldChub2RlLmtleSwgaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGkgPSBhU3RhcnQ7IGkgPD0gYUVuZDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgYU5vZGUgPSBhW2ldO1xuICAgICAgICAgICAgICAgIGlmIChwYXRjaGVkIDwgYkxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBqID0ga2V5SW5kZXguZ2V0KGFOb2RlLmtleSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNVbmRlZmluZWQoaikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJOb2RlID0gYltqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbaiAtIGJTdGFydF0gPSBpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvcyA+IGopIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb3ZlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3MgPSBqO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJOb2RlLmRvbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJbal0gPSBiTm9kZSA9IGNsb25lVk5vZGUoYk5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcGF0Y2goYU5vZGUsIGJOb2RlLCBkb20sIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcsIGlzUmVjeWNsaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGNoZWQrKztcbiAgICAgICAgICAgICAgICAgICAgICAgIGFOdWxsYWJsZVtpXSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFMZW5ndGggPT09IGEubGVuZ3RoICYmIHBhdGNoZWQgPT09IDApIHtcbiAgICAgICAgICAgIHJlbW92ZUFsbENoaWxkcmVuKGRvbSwgYSwgbGlmZWN5Y2xlLCBpc1JlY3ljbGluZyk7XG4gICAgICAgICAgICB3aGlsZSAoYlN0YXJ0IDwgYkxlbmd0aCkge1xuICAgICAgICAgICAgICAgIG5vZGUgPSBiW2JTdGFydF07XG4gICAgICAgICAgICAgICAgaWYgKG5vZGUuZG9tKSB7XG4gICAgICAgICAgICAgICAgICAgIGJbYlN0YXJ0XSA9IG5vZGUgPSBjbG9uZVZOb2RlKG5vZGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBiU3RhcnQrKztcbiAgICAgICAgICAgICAgICBpbnNlcnRPckFwcGVuZChkb20sIG1vdW50KG5vZGUsIG51bGwsIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcpLCBudWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGkgPSBhTGVuZ3RoIC0gcGF0Y2hlZDtcbiAgICAgICAgICAgIHdoaWxlIChpID4gMCkge1xuICAgICAgICAgICAgICAgIGFOb2RlID0gYU51bGxhYmxlW2FTdGFydCsrXTtcbiAgICAgICAgICAgICAgICBpZiAoIWlzTnVsbChhTm9kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdW5tb3VudChhTm9kZSwgZG9tLCBsaWZlY3ljbGUsIHRydWUsIGlzUmVjeWNsaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgaS0tO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChtb3ZlZCkge1xuICAgICAgICAgICAgICAgIHZhciBzZXEgPSBsaXNfYWxnb3JpdGhtKHNvdXJjZXMpO1xuICAgICAgICAgICAgICAgIGogPSBzZXEubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSBiTGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZXNbaV0gPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb3MgPSBpICsgYlN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IGJbcG9zXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmRvbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJbcG9zXSA9IG5vZGUgPSBjbG9uZVZOb2RlKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dFBvcyA9IHBvcyArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0Tm9kZSA9IG5leHRQb3MgPCBiLmxlbmd0aCA/IGJbbmV4dFBvc10uZG9tIDogbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluc2VydE9yQXBwZW5kKGRvbSwgbW91bnQobm9kZSwgZG9tLCBsaWZlY3ljbGUsIGNvbnRleHQsIGlzU1ZHKSwgbmV4dE5vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGogPCAwIHx8IGkgIT09IHNlcVtqXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvcyA9IGkgKyBiU3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IGJbcG9zXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0UG9zID0gcG9zICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0Tm9kZSA9IG5leHRQb3MgPCBiLmxlbmd0aCA/IGJbbmV4dFBvc10uZG9tIDogbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnNlcnRPckFwcGVuZChkb20sIG5vZGUuZG9tLCBuZXh0Tm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqLS07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwYXRjaGVkICE9PSBiTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZm9yIChpID0gYkxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2ldID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9zID0gaSArIGJTdGFydDtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPSBiW3Bvc107XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5kb20pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiW3Bvc10gPSBub2RlID0gY2xvbmVWTm9kZShub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHRQb3MgPSBwb3MgKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dE5vZGUgPSBuZXh0UG9zIDwgYi5sZW5ndGggPyBiW25leHRQb3NdLmRvbSA6IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnNlcnRPckFwcGVuZChkb20sIG1vdW50KG5vZGUsIG51bGwsIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcpLCBuZXh0Tm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG4vLyAvLyBodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Mb25nZXN0X2luY3JlYXNpbmdfc3Vic2VxdWVuY2VcbmZ1bmN0aW9uIGxpc19hbGdvcml0aG0oYSkge1xuICAgIHZhciBwID0gYS5zbGljZSgwKTtcbiAgICB2YXIgcmVzdWx0ID0gWzBdO1xuICAgIHZhciBpO1xuICAgIHZhciBqO1xuICAgIHZhciB1O1xuICAgIHZhciB2O1xuICAgIHZhciBjO1xuICAgIGZvciAoaSA9IDA7IGkgPCBhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChhW2ldID09PSAtMSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgaiA9IHJlc3VsdFtyZXN1bHQubGVuZ3RoIC0gMV07XG4gICAgICAgIGlmIChhW2pdIDwgYVtpXSkge1xuICAgICAgICAgICAgcFtpXSA9IGo7XG4gICAgICAgICAgICByZXN1bHQucHVzaChpKTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHUgPSAwO1xuICAgICAgICB2ID0gcmVzdWx0Lmxlbmd0aCAtIDE7XG4gICAgICAgIHdoaWxlICh1IDwgdikge1xuICAgICAgICAgICAgYyA9ICgodSArIHYpIC8gMikgfCAwO1xuICAgICAgICAgICAgaWYgKGFbcmVzdWx0W2NdXSA8IGFbaV0pIHtcbiAgICAgICAgICAgICAgICB1ID0gYyArIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2ID0gYztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoYVtpXSA8IGFbcmVzdWx0W3VdXSkge1xuICAgICAgICAgICAgaWYgKHUgPiAwKSB7XG4gICAgICAgICAgICAgICAgcFtpXSA9IHJlc3VsdFt1IC0gMV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXN1bHRbdV0gPSBpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHUgPSByZXN1bHQubGVuZ3RoO1xuICAgIHYgPSByZXN1bHRbdSAtIDFdO1xuICAgIHdoaWxlICh1LS0gPiAwKSB7XG4gICAgICAgIHJlc3VsdFt1XSA9IHY7XG4gICAgICAgIHYgPSBwW3ZdO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gcGF0Y2hQcm9wKHByb3AsIGxhc3RWYWx1ZSwgbmV4dFZhbHVlLCBkb20sIGlzU1ZHLCBoYXNDb250cm9sbGVkVmFsdWUpIHtcbiAgICBpZiAoc2tpcFByb3BzW3Byb3BdIHx8IGhhc0NvbnRyb2xsZWRWYWx1ZSAmJiBwcm9wID09PSAndmFsdWUnKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGJvb2xlYW5Qcm9wc1twcm9wXSkge1xuICAgICAgICBkb21bcHJvcF0gPSAhIW5leHRWYWx1ZTtcbiAgICB9XG4gICAgZWxzZSBpZiAoc3RyaWN0UHJvcHNbcHJvcF0pIHtcbiAgICAgICAgdmFyIHZhbHVlID0gaXNOdWxsT3JVbmRlZihuZXh0VmFsdWUpID8gJycgOiBuZXh0VmFsdWU7XG4gICAgICAgIGlmIChkb21bcHJvcF0gIT09IHZhbHVlKSB7XG4gICAgICAgICAgICBkb21bcHJvcF0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChsYXN0VmFsdWUgIT09IG5leHRWYWx1ZSkge1xuICAgICAgICBpZiAoaXNBdHRyQW5FdmVudChwcm9wKSkge1xuICAgICAgICAgICAgcGF0Y2hFdmVudChwcm9wLCBsYXN0VmFsdWUsIG5leHRWYWx1ZSwgZG9tKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpc051bGxPclVuZGVmKG5leHRWYWx1ZSkpIHtcbiAgICAgICAgICAgIGRvbS5yZW1vdmVBdHRyaWJ1dGUocHJvcCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocHJvcCA9PT0gJ2NsYXNzTmFtZScpIHtcbiAgICAgICAgICAgIGlmIChpc1NWRykge1xuICAgICAgICAgICAgICAgIGRvbS5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgbmV4dFZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGRvbS5jbGFzc05hbWUgPSBuZXh0VmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocHJvcCA9PT0gJ3N0eWxlJykge1xuICAgICAgICAgICAgcGF0Y2hTdHlsZShsYXN0VmFsdWUsIG5leHRWYWx1ZSwgZG9tKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChwcm9wID09PSAnZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUwnKSB7XG4gICAgICAgICAgICB2YXIgbGFzdEh0bWwgPSBsYXN0VmFsdWUgJiYgbGFzdFZhbHVlLl9faHRtbDtcbiAgICAgICAgICAgIHZhciBuZXh0SHRtbCA9IG5leHRWYWx1ZSAmJiBuZXh0VmFsdWUuX19odG1sO1xuICAgICAgICAgICAgaWYgKGxhc3RIdG1sICE9PSBuZXh0SHRtbCkge1xuICAgICAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZihuZXh0SHRtbCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZG9tLmlubmVySFRNTCA9IG5leHRIdG1sO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBkZWh5cGhlblByb3A7XG4gICAgICAgICAgICBpZiAoZGVoeXBoZW5Qcm9wc1twcm9wXSkge1xuICAgICAgICAgICAgICAgIGRlaHlwaGVuUHJvcCA9IGRlaHlwaGVuUHJvcHNbcHJvcF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpc1NWRyAmJiBwcm9wLm1hdGNoKHByb2JhYmx5S2ViYWJQcm9wcykpIHtcbiAgICAgICAgICAgICAgICBkZWh5cGhlblByb3AgPSBwcm9wLnJlcGxhY2UoLyhbYS16XSkoW0EtWl18MSkvZywga2ViYWJpemUpO1xuICAgICAgICAgICAgICAgIGRlaHlwaGVuUHJvcHNbcHJvcF0gPSBkZWh5cGhlblByb3A7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBkZWh5cGhlblByb3AgPSBwcm9wO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG5zID0gbmFtZXNwYWNlc1twcm9wXTtcbiAgICAgICAgICAgIGlmIChucykge1xuICAgICAgICAgICAgICAgIGRvbS5zZXRBdHRyaWJ1dGVOUyhucywgZGVoeXBoZW5Qcm9wLCBuZXh0VmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZG9tLnNldEF0dHJpYnV0ZShkZWh5cGhlblByb3AsIG5leHRWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBwYXRjaEV2ZW50cyhsYXN0RXZlbnRzLCBuZXh0RXZlbnRzLCBkb20pIHtcbiAgICBsYXN0RXZlbnRzID0gbGFzdEV2ZW50cyB8fCBFTVBUWV9PQko7XG4gICAgbmV4dEV2ZW50cyA9IG5leHRFdmVudHMgfHwgRU1QVFlfT0JKO1xuICAgIGlmIChuZXh0RXZlbnRzICE9PSBFTVBUWV9PQkopIHtcbiAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBuZXh0RXZlbnRzKSB7XG4gICAgICAgICAgICAvLyBkbyBub3QgYWRkIGEgaGFzT3duUHJvcGVydHkgY2hlY2sgaGVyZSwgaXQgYWZmZWN0cyBwZXJmb3JtYW5jZVxuICAgICAgICAgICAgcGF0Y2hFdmVudChuYW1lLCBsYXN0RXZlbnRzW25hbWVdLCBuZXh0RXZlbnRzW25hbWVdLCBkb20pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChsYXN0RXZlbnRzICE9PSBFTVBUWV9PQkopIHtcbiAgICAgICAgZm9yICh2YXIgbmFtZSQxIGluIGxhc3RFdmVudHMpIHtcbiAgICAgICAgICAgIC8vIGRvIG5vdCBhZGQgYSBoYXNPd25Qcm9wZXJ0eSBjaGVjayBoZXJlLCBpdCBhZmZlY3RzIHBlcmZvcm1hbmNlXG4gICAgICAgICAgICBpZiAoaXNOdWxsT3JVbmRlZihuZXh0RXZlbnRzW25hbWUkMV0pKSB7XG4gICAgICAgICAgICAgICAgcGF0Y2hFdmVudChuYW1lJDEsIGxhc3RFdmVudHNbbmFtZSQxXSwgbnVsbCwgZG9tKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIHBhdGNoRXZlbnQobmFtZSwgbGFzdFZhbHVlLCBuZXh0VmFsdWUsIGRvbSkge1xuICAgIGlmIChsYXN0VmFsdWUgIT09IG5leHRWYWx1ZSkge1xuICAgICAgICB2YXIgbmFtZUxvd2VyQ2FzZSA9IG5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgdmFyIGRvbUV2ZW50ID0gZG9tW25hbWVMb3dlckNhc2VdO1xuICAgICAgICAvLyBpZiB0aGUgZnVuY3Rpb24gaXMgd3JhcHBlZCwgdGhhdCBtZWFucyBpdCdzIGJlZW4gY29udHJvbGxlZCBieSBhIHdyYXBwZXJcbiAgICAgICAgaWYgKGRvbUV2ZW50ICYmIGRvbUV2ZW50LndyYXBwZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGVsZWdhdGVkUHJvcHNbbmFtZV0pIHtcbiAgICAgICAgICAgIGhhbmRsZUV2ZW50KG5hbWUsIGxhc3RWYWx1ZSwgbmV4dFZhbHVlLCBkb20pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKGxhc3RWYWx1ZSAhPT0gbmV4dFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpc0Z1bmN0aW9uKG5leHRWYWx1ZSkgJiYgIWlzTnVsbE9yVW5kZWYobmV4dFZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGlua0V2ZW50ID0gbmV4dFZhbHVlLmV2ZW50O1xuICAgICAgICAgICAgICAgICAgICBpZiAobGlua0V2ZW50ICYmIGlzRnVuY3Rpb24obGlua0V2ZW50KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkb20uX2RhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21bbmFtZUxvd2VyQ2FzZV0gPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rRXZlbnQoZS5jdXJyZW50VGFyZ2V0Ll9kYXRhLCBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZG9tLl9kYXRhID0gbmV4dFZhbHVlLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93RXJyb3IoKFwiYW4gZXZlbnQgb24gYSBWTm9kZSBcXFwiXCIgKyBuYW1lICsgXCJcXFwiLiB3YXMgbm90IGEgZnVuY3Rpb24gb3IgYSB2YWxpZCBsaW5rRXZlbnQuXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93RXJyb3IoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZG9tW25hbWVMb3dlckNhc2VdID0gbmV4dFZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbi8vIFdlIGFyZSBhc3N1bWluZyBoZXJlIHRoYXQgd2UgY29tZSBmcm9tIHBhdGNoUHJvcCByb3V0aW5lXG4vLyAtbmV4dEF0dHJWYWx1ZSBjYW5ub3QgYmUgbnVsbCBvciB1bmRlZmluZWRcbmZ1bmN0aW9uIHBhdGNoU3R5bGUobGFzdEF0dHJWYWx1ZSwgbmV4dEF0dHJWYWx1ZSwgZG9tKSB7XG4gICAgaWYgKGlzU3RyaW5nKG5leHRBdHRyVmFsdWUpKSB7XG4gICAgICAgIGRvbS5zdHlsZS5jc3NUZXh0ID0gbmV4dEF0dHJWYWx1ZTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBmb3IgKHZhciBzdHlsZSBpbiBuZXh0QXR0clZhbHVlKSB7XG4gICAgICAgIC8vIGRvIG5vdCBhZGQgYSBoYXNPd25Qcm9wZXJ0eSBjaGVjayBoZXJlLCBpdCBhZmZlY3RzIHBlcmZvcm1hbmNlXG4gICAgICAgIHZhciB2YWx1ZSA9IG5leHRBdHRyVmFsdWVbc3R5bGVdO1xuICAgICAgICBpZiAoaXNOdW1iZXIodmFsdWUpICYmICFpc1VuaXRsZXNzTnVtYmVyW3N0eWxlXSkge1xuICAgICAgICAgICAgZG9tLnN0eWxlW3N0eWxlXSA9IHZhbHVlICsgJ3B4JztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGRvbS5zdHlsZVtzdHlsZV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoIWlzTnVsbE9yVW5kZWYobGFzdEF0dHJWYWx1ZSkpIHtcbiAgICAgICAgZm9yICh2YXIgc3R5bGUkMSBpbiBsYXN0QXR0clZhbHVlKSB7XG4gICAgICAgICAgICBpZiAoaXNOdWxsT3JVbmRlZihuZXh0QXR0clZhbHVlW3N0eWxlJDFdKSkge1xuICAgICAgICAgICAgICAgIGRvbS5zdHlsZVtzdHlsZSQxXSA9ICcnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gcmVtb3ZlUHJvcChwcm9wLCBsYXN0VmFsdWUsIGRvbSkge1xuICAgIGlmIChwcm9wID09PSAnY2xhc3NOYW1lJykge1xuICAgICAgICBkb20ucmVtb3ZlQXR0cmlidXRlKCdjbGFzcycpO1xuICAgIH1cbiAgICBlbHNlIGlmIChwcm9wID09PSAndmFsdWUnKSB7XG4gICAgICAgIGRvbS52YWx1ZSA9ICcnO1xuICAgIH1cbiAgICBlbHNlIGlmIChwcm9wID09PSAnc3R5bGUnKSB7XG4gICAgICAgIGRvbS5yZW1vdmVBdHRyaWJ1dGUoJ3N0eWxlJyk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGlzQXR0ckFuRXZlbnQocHJvcCkpIHtcbiAgICAgICAgaGFuZGxlRXZlbnQobmFtZSwgbGFzdFZhbHVlLCBudWxsLCBkb20pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZG9tLnJlbW92ZUF0dHJpYnV0ZShwcm9wKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIG1vdW50KHZOb2RlLCBwYXJlbnREb20sIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcpIHtcbiAgICB2YXIgZmxhZ3MgPSB2Tm9kZS5mbGFncztcbiAgICBpZiAoZmxhZ3MgJiAzOTcwIC8qIEVsZW1lbnQgKi8pIHtcbiAgICAgICAgcmV0dXJuIG1vdW50RWxlbWVudCh2Tm9kZSwgcGFyZW50RG9tLCBsaWZlY3ljbGUsIGNvbnRleHQsIGlzU1ZHKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZmxhZ3MgJiAyOCAvKiBDb21wb25lbnQgKi8pIHtcbiAgICAgICAgcmV0dXJuIG1vdW50Q29tcG9uZW50KHZOb2RlLCBwYXJlbnREb20sIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcsIGZsYWdzICYgNCAvKiBDb21wb25lbnRDbGFzcyAqLyk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGZsYWdzICYgNDA5NiAvKiBWb2lkICovKSB7XG4gICAgICAgIHJldHVybiBtb3VudFZvaWQodk5vZGUsIHBhcmVudERvbSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGZsYWdzICYgMSAvKiBUZXh0ICovKSB7XG4gICAgICAgIHJldHVybiBtb3VudFRleHQodk5vZGUsIHBhcmVudERvbSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB2Tm9kZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICB0aHJvd0Vycm9yKChcIm1vdW50KCkgcmVjZWl2ZWQgYW4gb2JqZWN0IHRoYXQncyBub3QgYSB2YWxpZCBWTm9kZSwgeW91IHNob3VsZCBzdHJpbmdpZnkgaXQgZmlyc3QuIE9iamVjdDogXFxcIlwiICsgKEpTT04uc3RyaW5naWZ5KHZOb2RlKSkgKyBcIlxcXCIuXCIpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93RXJyb3IoKFwibW91bnQoKSBleHBlY3RzIGEgdmFsaWQgVk5vZGUsIGluc3RlYWQgaXQgcmVjZWl2ZWQgYW4gb2JqZWN0IHdpdGggdGhlIHR5cGUgXFxcIlwiICsgKHR5cGVvZiB2Tm9kZSkgKyBcIlxcXCIuXCIpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aHJvd0Vycm9yKCk7XG4gICAgfVxufVxuZnVuY3Rpb24gbW91bnRUZXh0KHZOb2RlLCBwYXJlbnREb20pIHtcbiAgICB2YXIgZG9tID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodk5vZGUuY2hpbGRyZW4pO1xuICAgIHZOb2RlLmRvbSA9IGRvbTtcbiAgICBpZiAocGFyZW50RG9tKSB7XG4gICAgICAgIGFwcGVuZENoaWxkKHBhcmVudERvbSwgZG9tKTtcbiAgICB9XG4gICAgcmV0dXJuIGRvbTtcbn1cbmZ1bmN0aW9uIG1vdW50Vm9pZCh2Tm9kZSwgcGFyZW50RG9tKSB7XG4gICAgdmFyIGRvbSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCcnKTtcbiAgICB2Tm9kZS5kb20gPSBkb207XG4gICAgaWYgKHBhcmVudERvbSkge1xuICAgICAgICBhcHBlbmRDaGlsZChwYXJlbnREb20sIGRvbSk7XG4gICAgfVxuICAgIHJldHVybiBkb207XG59XG5mdW5jdGlvbiBtb3VudEVsZW1lbnQodk5vZGUsIHBhcmVudERvbSwgbGlmZWN5Y2xlLCBjb250ZXh0LCBpc1NWRykge1xuICAgIGlmIChvcHRpb25zLnJlY3ljbGluZ0VuYWJsZWQpIHtcbiAgICAgICAgdmFyIGRvbSQxID0gcmVjeWNsZUVsZW1lbnQodk5vZGUsIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcpO1xuICAgICAgICBpZiAoIWlzTnVsbChkb20kMSkpIHtcbiAgICAgICAgICAgIGlmICghaXNOdWxsKHBhcmVudERvbSkpIHtcbiAgICAgICAgICAgICAgICBhcHBlbmRDaGlsZChwYXJlbnREb20sIGRvbSQxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBkb20kMTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgdGFnID0gdk5vZGUudHlwZTtcbiAgICB2YXIgZmxhZ3MgPSB2Tm9kZS5mbGFncztcbiAgICBpZiAoaXNTVkcgfHwgKGZsYWdzICYgMTI4IC8qIFN2Z0VsZW1lbnQgKi8pKSB7XG4gICAgICAgIGlzU1ZHID0gdHJ1ZTtcbiAgICB9XG4gICAgdmFyIGRvbSA9IGRvY3VtZW50Q3JlYXRlRWxlbWVudCh0YWcsIGlzU1ZHKTtcbiAgICB2YXIgY2hpbGRyZW4gPSB2Tm9kZS5jaGlsZHJlbjtcbiAgICB2YXIgcHJvcHMgPSB2Tm9kZS5wcm9wcztcbiAgICB2YXIgZXZlbnRzID0gdk5vZGUuZXZlbnRzO1xuICAgIHZhciByZWYgPSB2Tm9kZS5yZWY7XG4gICAgdk5vZGUuZG9tID0gZG9tO1xuICAgIGlmICghaXNOdWxsKGNoaWxkcmVuKSkge1xuICAgICAgICBpZiAoaXNTdHJpbmdPck51bWJlcihjaGlsZHJlbikpIHtcbiAgICAgICAgICAgIHNldFRleHRDb250ZW50KGRvbSwgY2hpbGRyZW4pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGlzQXJyYXkoY2hpbGRyZW4pKSB7XG4gICAgICAgICAgICBtb3VudEFycmF5Q2hpbGRyZW4oY2hpbGRyZW4sIGRvbSwgbGlmZWN5Y2xlLCBjb250ZXh0LCBpc1NWRyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaXNWTm9kZShjaGlsZHJlbikpIHtcbiAgICAgICAgICAgIG1vdW50KGNoaWxkcmVuLCBkb20sIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciBoYXNDb250cm9sbGVkVmFsdWUgPSBmYWxzZTtcbiAgICBpZiAoIShmbGFncyAmIDIgLyogSHRtbEVsZW1lbnQgKi8pKSB7XG4gICAgICAgIGhhc0NvbnRyb2xsZWRWYWx1ZSA9IHByb2Nlc3NFbGVtZW50KGZsYWdzLCB2Tm9kZSwgZG9tKTtcbiAgICB9XG4gICAgaWYgKCFpc051bGwocHJvcHMpKSB7XG4gICAgICAgIGZvciAodmFyIHByb3AgaW4gcHJvcHMpIHtcbiAgICAgICAgICAgIC8vIGRvIG5vdCBhZGQgYSBoYXNPd25Qcm9wZXJ0eSBjaGVjayBoZXJlLCBpdCBhZmZlY3RzIHBlcmZvcm1hbmNlXG4gICAgICAgICAgICBwYXRjaFByb3AocHJvcCwgbnVsbCwgcHJvcHNbcHJvcF0sIGRvbSwgaXNTVkcsIGhhc0NvbnRyb2xsZWRWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFpc051bGwoZXZlbnRzKSkge1xuICAgICAgICBmb3IgKHZhciBuYW1lIGluIGV2ZW50cykge1xuICAgICAgICAgICAgLy8gZG8gbm90IGFkZCBhIGhhc093blByb3BlcnR5IGNoZWNrIGhlcmUsIGl0IGFmZmVjdHMgcGVyZm9ybWFuY2VcbiAgICAgICAgICAgIHBhdGNoRXZlbnQobmFtZSwgbnVsbCwgZXZlbnRzW25hbWVdLCBkb20pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmICghaXNOdWxsKHJlZikpIHtcbiAgICAgICAgbW91bnRSZWYoZG9tLCByZWYsIGxpZmVjeWNsZSk7XG4gICAgfVxuICAgIGlmICghaXNOdWxsKHBhcmVudERvbSkpIHtcbiAgICAgICAgYXBwZW5kQ2hpbGQocGFyZW50RG9tLCBkb20pO1xuICAgIH1cbiAgICByZXR1cm4gZG9tO1xufVxuZnVuY3Rpb24gbW91bnRBcnJheUNoaWxkcmVuKGNoaWxkcmVuLCBkb20sIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBjaGlsZCA9IGNoaWxkcmVuW2ldO1xuICAgICAgICAvLyBUT0RPOiBWZXJpZnkgY2FuIHN0cmluZy9udW1iZXIgYmUgaGVyZS4gbWlnaHQgY2F1c2UgZGUtb3B0XG4gICAgICAgIGlmICghaXNJbnZhbGlkKGNoaWxkKSkge1xuICAgICAgICAgICAgaWYgKGNoaWxkLmRvbSkge1xuICAgICAgICAgICAgICAgIGNoaWxkcmVuW2ldID0gY2hpbGQgPSBjbG9uZVZOb2RlKGNoaWxkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1vdW50KGNoaWxkcmVuW2ldLCBkb20sIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcpO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gbW91bnRDb21wb25lbnQodk5vZGUsIHBhcmVudERvbSwgbGlmZWN5Y2xlLCBjb250ZXh0LCBpc1NWRywgaXNDbGFzcykge1xuICAgIGlmIChvcHRpb25zLnJlY3ljbGluZ0VuYWJsZWQpIHtcbiAgICAgICAgdmFyIGRvbSQxID0gcmVjeWNsZUNvbXBvbmVudCh2Tm9kZSwgbGlmZWN5Y2xlLCBjb250ZXh0LCBpc1NWRyk7XG4gICAgICAgIGlmICghaXNOdWxsKGRvbSQxKSkge1xuICAgICAgICAgICAgaWYgKCFpc051bGwocGFyZW50RG9tKSkge1xuICAgICAgICAgICAgICAgIGFwcGVuZENoaWxkKHBhcmVudERvbSwgZG9tJDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGRvbSQxO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciB0eXBlID0gdk5vZGUudHlwZTtcbiAgICB2YXIgcHJvcHMgPSB2Tm9kZS5wcm9wcyB8fCBFTVBUWV9PQko7XG4gICAgdmFyIGRlZmF1bHRQcm9wcyA9IHR5cGUuZGVmYXVsdFByb3BzO1xuICAgIHZhciByZWYgPSB2Tm9kZS5yZWY7XG4gICAgdmFyIGRvbTtcbiAgICBpZiAoIWlzVW5kZWZpbmVkKGRlZmF1bHRQcm9wcykpIHtcbiAgICAgICAgY29weVByb3BzVG8oZGVmYXVsdFByb3BzLCBwcm9wcyk7XG4gICAgICAgIHZOb2RlLnByb3BzID0gcHJvcHM7XG4gICAgfVxuICAgIGlmIChpc0NsYXNzKSB7XG4gICAgICAgIHZhciBpbnN0YW5jZSA9IGNyZWF0ZUNsYXNzQ29tcG9uZW50SW5zdGFuY2Uodk5vZGUsIHR5cGUsIHByb3BzLCBjb250ZXh0LCBpc1NWRyk7XG4gICAgICAgIC8vIElmIGluc3RhbmNlIGRvZXMgbm90IGhhdmUgY29tcG9uZW50V2lsbFVubW91bnQgc3BlY2lmaWVkIHdlIGNhbiBlbmFibGUgZmFzdFVubW91bnRcbiAgICAgICAgdmFyIGlucHV0ID0gaW5zdGFuY2UuX2xhc3RJbnB1dDtcbiAgICAgICAgdmFyIHByZXZGYXN0VW5tb3VudCA9IGxpZmVjeWNsZS5mYXN0VW5tb3VudDtcbiAgICAgICAgLy8gd2Ugc3RvcmUgdGhlIGZhc3RVbm1vdW50IHZhbHVlLCBidXQgd2Ugc2V0IGl0IGJhY2sgdG8gdHJ1ZSBvbiB0aGUgbGlmZWN5Y2xlXG4gICAgICAgIC8vIHdlIGRvIHRoaXMgc28gd2UgY2FuIGRldGVybWluZSBpZiB0aGUgY29tcG9uZW50IHJlbmRlciBoYXMgYSBmYXN0VW5tb3VudCBvciBub3RcbiAgICAgICAgbGlmZWN5Y2xlLmZhc3RVbm1vdW50ID0gdHJ1ZTtcbiAgICAgICAgaW5zdGFuY2UuX3ZOb2RlID0gdk5vZGU7XG4gICAgICAgIHZOb2RlLmRvbSA9IGRvbSA9IG1vdW50KGlucHV0LCBudWxsLCBsaWZlY3ljbGUsIGluc3RhbmNlLl9jaGlsZENvbnRleHQsIGlzU1ZHKTtcbiAgICAgICAgLy8gd2Ugbm93IGNyZWF0ZSBhIGxpZmVjeWNsZSBmb3IgdGhpcyBjb21wb25lbnQgYW5kIHN0b3JlIHRoZSBmYXN0VW5tb3VudCB2YWx1ZVxuICAgICAgICB2YXIgc3ViTGlmZWN5Y2xlID0gaW5zdGFuY2UuX2xpZmVjeWNsZSA9IG5ldyBMaWZlY3ljbGUoKTtcbiAgICAgICAgLy8gY2hpbGRyZW4gbGlmZWN5Y2xlIGNhbiBmYXN0VW5tb3VudCBpZiBpdHNlbGYgZG9lcyBuZWVkIHVubW91bnQgY2FsbGJhY2sgYW5kIHdpdGhpbiBpdHMgY3ljbGUgdGhlcmUgd2FzIG5vbmVcbiAgICAgICAgc3ViTGlmZWN5Y2xlLmZhc3RVbm1vdW50ID0gaXNVbmRlZmluZWQoaW5zdGFuY2UuY29tcG9uZW50V2lsbFVubW91bnQpICYmIGxpZmVjeWNsZS5mYXN0VW5tb3VudDtcbiAgICAgICAgLy8gaGlnaGVyIGxpZmVjeWNsZSBjYW4gZmFzdFVubW91bnQgb25seSBpZiBwcmV2aW91c2x5IGl0IHdhcyBhYmxlIHRvIGFuZCB0aGlzIGNoaWxkcmVuIGRvZXNudCBoYXZlIGFueVxuICAgICAgICBsaWZlY3ljbGUuZmFzdFVubW91bnQgPSBwcmV2RmFzdFVubW91bnQgJiYgc3ViTGlmZWN5Y2xlLmZhc3RVbm1vdW50O1xuICAgICAgICBpZiAoIWlzTnVsbChwYXJlbnREb20pKSB7XG4gICAgICAgICAgICBhcHBlbmRDaGlsZChwYXJlbnREb20sIGRvbSk7XG4gICAgICAgIH1cbiAgICAgICAgbW91bnRDbGFzc0NvbXBvbmVudENhbGxiYWNrcyh2Tm9kZSwgcmVmLCBpbnN0YW5jZSwgbGlmZWN5Y2xlKTtcbiAgICAgICAgb3B0aW9ucy5maW5kRE9NTm9kZUVuYWJsZWQgJiYgY29tcG9uZW50VG9ET01Ob2RlTWFwLnNldChpbnN0YW5jZSwgZG9tKTtcbiAgICAgICAgdk5vZGUuY2hpbGRyZW4gPSBpbnN0YW5jZTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHZhciBpbnB1dCQxID0gY3JlYXRlRnVuY3Rpb25hbENvbXBvbmVudElucHV0KHZOb2RlLCB0eXBlLCBwcm9wcywgY29udGV4dCk7XG4gICAgICAgIHZOb2RlLmRvbSA9IGRvbSA9IG1vdW50KGlucHV0JDEsIG51bGwsIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcpO1xuICAgICAgICB2Tm9kZS5jaGlsZHJlbiA9IGlucHV0JDE7XG4gICAgICAgIG1vdW50RnVuY3Rpb25hbENvbXBvbmVudENhbGxiYWNrcyhyZWYsIGRvbSwgbGlmZWN5Y2xlKTtcbiAgICAgICAgaWYgKCFpc051bGwocGFyZW50RG9tKSkge1xuICAgICAgICAgICAgYXBwZW5kQ2hpbGQocGFyZW50RG9tLCBkb20pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBkb207XG59XG5mdW5jdGlvbiBtb3VudENsYXNzQ29tcG9uZW50Q2FsbGJhY2tzKHZOb2RlLCByZWYsIGluc3RhbmNlLCBsaWZlY3ljbGUpIHtcbiAgICBpZiAocmVmKSB7XG4gICAgICAgIGlmIChpc0Z1bmN0aW9uKHJlZikpIHtcbiAgICAgICAgICAgIHJlZihpbnN0YW5jZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICAgICAgICAgIGlmIChpc1N0cmluZ09yTnVtYmVyKHJlZikpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3dFcnJvcignc3RyaW5nIFwicmVmc1wiIGFyZSBub3Qgc3VwcG9ydGVkIGluIEluZmVybm8gMS4wLiBVc2UgY2FsbGJhY2sgXCJyZWZzXCIgaW5zdGVhZC4nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoaXNPYmplY3QocmVmKSAmJiAodk5vZGUuZmxhZ3MgJiA0IC8qIENvbXBvbmVudENsYXNzICovKSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvd0Vycm9yKCdmdW5jdGlvbmFsIGNvbXBvbmVudCBsaWZlY3ljbGUgZXZlbnRzIGFyZSBub3Qgc3VwcG9ydGVkIG9uIEVTMjAxNSBjbGFzcyBjb21wb25lbnRzLicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3dFcnJvcigoXCJhIGJhZCB2YWx1ZSBmb3IgXFxcInJlZlxcXCIgd2FzIHVzZWQgb24gY29tcG9uZW50OiBcXFwiXCIgKyAoSlNPTi5zdHJpbmdpZnkocmVmKSkgKyBcIlxcXCJcIikpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRocm93RXJyb3IoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgY0RNID0gaW5zdGFuY2UuY29tcG9uZW50RGlkTW91bnQ7XG4gICAgdmFyIGFmdGVyTW91bnQgPSBvcHRpb25zLmFmdGVyTW91bnQ7XG4gICAgaWYgKCFpc1VuZGVmaW5lZChjRE0pIHx8ICFpc051bGwoYWZ0ZXJNb3VudCkpIHtcbiAgICAgICAgbGlmZWN5Y2xlLmFkZExpc3RlbmVyKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGFmdGVyTW91bnQgJiYgYWZ0ZXJNb3VudCh2Tm9kZSk7XG4gICAgICAgICAgICBjRE0gJiYgaW5zdGFuY2UuY29tcG9uZW50RGlkTW91bnQoKTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuZnVuY3Rpb24gbW91bnRGdW5jdGlvbmFsQ29tcG9uZW50Q2FsbGJhY2tzKHJlZiwgZG9tLCBsaWZlY3ljbGUpIHtcbiAgICBpZiAocmVmKSB7XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZihyZWYub25Db21wb25lbnRXaWxsTW91bnQpKSB7XG4gICAgICAgICAgICByZWYub25Db21wb25lbnRXaWxsTW91bnQoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWYocmVmLm9uQ29tcG9uZW50RGlkTW91bnQpKSB7XG4gICAgICAgICAgICBsaWZlY3ljbGUuYWRkTGlzdGVuZXIoZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVmLm9uQ29tcG9uZW50RGlkTW91bnQoZG9tKTsgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFpc051bGxPclVuZGVmKHJlZi5vbkNvbXBvbmVudFdpbGxVbm1vdW50KSkge1xuICAgICAgICAgICAgbGlmZWN5Y2xlLmZhc3RVbm1vdW50ID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBtb3VudFJlZihkb20sIHZhbHVlLCBsaWZlY3ljbGUpIHtcbiAgICBpZiAoaXNGdW5jdGlvbih2YWx1ZSkpIHtcbiAgICAgICAgbGlmZWN5Y2xlLmZhc3RVbm1vdW50ID0gZmFsc2U7XG4gICAgICAgIGxpZmVjeWNsZS5hZGRMaXN0ZW5lcihmdW5jdGlvbiAoKSB7IHJldHVybiB2YWx1ZShkb20pOyB9KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmIChpc0ludmFsaWQodmFsdWUpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgICAgIHRocm93RXJyb3IoJ3N0cmluZyBcInJlZnNcIiBhcmUgbm90IHN1cHBvcnRlZCBpbiBJbmZlcm5vIDEuMC4gVXNlIGNhbGxiYWNrIFwicmVmc1wiIGluc3RlYWQuJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3dFcnJvcigpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gbm9ybWFsaXplQ2hpbGROb2RlcyhwYXJlbnREb20pIHtcbiAgICB2YXIgZG9tID0gcGFyZW50RG9tLmZpcnN0Q2hpbGQ7XG4gICAgd2hpbGUgKGRvbSkge1xuICAgICAgICBpZiAoZG9tLm5vZGVUeXBlID09PSA4KSB7XG4gICAgICAgICAgICBpZiAoZG9tLmRhdGEgPT09ICchJykge1xuICAgICAgICAgICAgICAgIHZhciBwbGFjZWhvbGRlciA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCcnKTtcbiAgICAgICAgICAgICAgICBwYXJlbnREb20ucmVwbGFjZUNoaWxkKHBsYWNlaG9sZGVyLCBkb20pO1xuICAgICAgICAgICAgICAgIGRvbSA9IGRvbS5uZXh0U2libGluZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBsYXN0RG9tID0gZG9tLnByZXZpb3VzU2libGluZztcbiAgICAgICAgICAgICAgICBwYXJlbnREb20ucmVtb3ZlQ2hpbGQoZG9tKTtcbiAgICAgICAgICAgICAgICBkb20gPSBsYXN0RG9tIHx8IHBhcmVudERvbS5maXJzdENoaWxkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZG9tID0gZG9tLm5leHRTaWJsaW5nO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gaHlkcmF0ZUNvbXBvbmVudCh2Tm9kZSwgZG9tLCBsaWZlY3ljbGUsIGNvbnRleHQsIGlzU1ZHLCBpc0NsYXNzKSB7XG4gICAgdmFyIHR5cGUgPSB2Tm9kZS50eXBlO1xuICAgIHZhciBwcm9wcyA9IHZOb2RlLnByb3BzIHx8IEVNUFRZX09CSjtcbiAgICB2YXIgcmVmID0gdk5vZGUucmVmO1xuICAgIHZOb2RlLmRvbSA9IGRvbTtcbiAgICBpZiAoaXNDbGFzcykge1xuICAgICAgICB2YXIgX2lzU1ZHID0gZG9tLm5hbWVzcGFjZVVSSSA9PT0gc3ZnTlM7XG4gICAgICAgIHZhciBkZWZhdWx0UHJvcHMgPSB0eXBlLmRlZmF1bHRQcm9wcztcbiAgICAgICAgaWYgKCFpc1VuZGVmaW5lZChkZWZhdWx0UHJvcHMpKSB7XG4gICAgICAgICAgICBjb3B5UHJvcHNUbyhkZWZhdWx0UHJvcHMsIHByb3BzKTtcbiAgICAgICAgICAgIHZOb2RlLnByb3BzID0gcHJvcHM7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGluc3RhbmNlID0gY3JlYXRlQ2xhc3NDb21wb25lbnRJbnN0YW5jZSh2Tm9kZSwgdHlwZSwgcHJvcHMsIGNvbnRleHQsIF9pc1NWRyk7XG4gICAgICAgIC8vIElmIGluc3RhbmNlIGRvZXMgbm90IGhhdmUgY29tcG9uZW50V2lsbFVubW91bnQgc3BlY2lmaWVkIHdlIGNhbiBlbmFibGUgZmFzdFVubW91bnRcbiAgICAgICAgdmFyIHByZXZGYXN0VW5tb3VudCA9IGxpZmVjeWNsZS5mYXN0VW5tb3VudDtcbiAgICAgICAgdmFyIGlucHV0ID0gaW5zdGFuY2UuX2xhc3RJbnB1dDtcbiAgICAgICAgLy8gd2Ugc3RvcmUgdGhlIGZhc3RVbm1vdW50IHZhbHVlLCBidXQgd2Ugc2V0IGl0IGJhY2sgdG8gdHJ1ZSBvbiB0aGUgbGlmZWN5Y2xlXG4gICAgICAgIC8vIHdlIGRvIHRoaXMgc28gd2UgY2FuIGRldGVybWluZSBpZiB0aGUgY29tcG9uZW50IHJlbmRlciBoYXMgYSBmYXN0VW5tb3VudCBvciBub3RcbiAgICAgICAgbGlmZWN5Y2xlLmZhc3RVbm1vdW50ID0gdHJ1ZTtcbiAgICAgICAgaW5zdGFuY2UuX3ZDb21wb25lbnQgPSB2Tm9kZTtcbiAgICAgICAgaW5zdGFuY2UuX3ZOb2RlID0gdk5vZGU7XG4gICAgICAgIGh5ZHJhdGUoaW5wdXQsIGRvbSwgbGlmZWN5Y2xlLCBpbnN0YW5jZS5fY2hpbGRDb250ZXh0LCBfaXNTVkcpO1xuICAgICAgICAvLyB3ZSBub3cgY3JlYXRlIGEgbGlmZWN5Y2xlIGZvciB0aGlzIGNvbXBvbmVudCBhbmQgc3RvcmUgdGhlIGZhc3RVbm1vdW50IHZhbHVlXG4gICAgICAgIHZhciBzdWJMaWZlY3ljbGUgPSBpbnN0YW5jZS5fbGlmZWN5Y2xlID0gbmV3IExpZmVjeWNsZSgpO1xuICAgICAgICAvLyBjaGlsZHJlbiBsaWZlY3ljbGUgY2FuIGZhc3RVbm1vdW50IGlmIGl0c2VsZiBkb2VzIG5lZWQgdW5tb3VudCBjYWxsYmFjayBhbmQgd2l0aGluIGl0cyBjeWNsZSB0aGVyZSB3YXMgbm9uZVxuICAgICAgICBzdWJMaWZlY3ljbGUuZmFzdFVubW91bnQgPSBpc1VuZGVmaW5lZChpbnN0YW5jZS5jb21wb25lbnRXaWxsVW5tb3VudCkgJiYgbGlmZWN5Y2xlLmZhc3RVbm1vdW50O1xuICAgICAgICAvLyBoaWdoZXIgbGlmZWN5Y2xlIGNhbiBmYXN0VW5tb3VudCBvbmx5IGlmIHByZXZpb3VzbHkgaXQgd2FzIGFibGUgdG8gYW5kIHRoaXMgY2hpbGRyZW4gZG9lc250IGhhdmUgYW55XG4gICAgICAgIGxpZmVjeWNsZS5mYXN0VW5tb3VudCA9IHByZXZGYXN0VW5tb3VudCAmJiBzdWJMaWZlY3ljbGUuZmFzdFVubW91bnQ7XG4gICAgICAgIG1vdW50Q2xhc3NDb21wb25lbnRDYWxsYmFja3Modk5vZGUsIHJlZiwgaW5zdGFuY2UsIGxpZmVjeWNsZSk7XG4gICAgICAgIG9wdGlvbnMuZmluZERPTU5vZGVFbmFibGVkICYmIGNvbXBvbmVudFRvRE9NTm9kZU1hcC5zZXQoaW5zdGFuY2UsIGRvbSk7XG4gICAgICAgIHZOb2RlLmNoaWxkcmVuID0gaW5zdGFuY2U7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB2YXIgaW5wdXQkMSA9IGNyZWF0ZUZ1bmN0aW9uYWxDb21wb25lbnRJbnB1dCh2Tm9kZSwgdHlwZSwgcHJvcHMsIGNvbnRleHQpO1xuICAgICAgICBoeWRyYXRlKGlucHV0JDEsIGRvbSwgbGlmZWN5Y2xlLCBjb250ZXh0LCBpc1NWRyk7XG4gICAgICAgIHZOb2RlLmNoaWxkcmVuID0gaW5wdXQkMTtcbiAgICAgICAgdk5vZGUuZG9tID0gaW5wdXQkMS5kb207XG4gICAgICAgIG1vdW50RnVuY3Rpb25hbENvbXBvbmVudENhbGxiYWNrcyhyZWYsIGRvbSwgbGlmZWN5Y2xlKTtcbiAgICB9XG4gICAgcmV0dXJuIGRvbTtcbn1cbmZ1bmN0aW9uIGh5ZHJhdGVFbGVtZW50KHZOb2RlLCBkb20sIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcpIHtcbiAgICB2YXIgdGFnID0gdk5vZGUudHlwZTtcbiAgICB2YXIgY2hpbGRyZW4gPSB2Tm9kZS5jaGlsZHJlbjtcbiAgICB2YXIgcHJvcHMgPSB2Tm9kZS5wcm9wcztcbiAgICB2YXIgZXZlbnRzID0gdk5vZGUuZXZlbnRzO1xuICAgIHZhciBmbGFncyA9IHZOb2RlLmZsYWdzO1xuICAgIHZhciByZWYgPSB2Tm9kZS5yZWY7XG4gICAgaWYgKGlzU1ZHIHx8IChmbGFncyAmIDEyOCAvKiBTdmdFbGVtZW50ICovKSkge1xuICAgICAgICBpc1NWRyA9IHRydWU7XG4gICAgfVxuICAgIGlmIChkb20ubm9kZVR5cGUgIT09IDEgfHwgZG9tLnRhZ05hbWUudG9Mb3dlckNhc2UoKSAhPT0gdGFnKSB7XG4gICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgICAgICB3YXJuaW5nKCdJbmZlcm5vIGh5ZHJhdGlvbjogU2VydmVyLXNpZGUgbWFya3VwIGRvZXNuXFwndCBtYXRjaCBjbGllbnQtc2lkZSBtYXJrdXAgb3IgSW5pdGlhbCByZW5kZXIgdGFyZ2V0IGlzIG5vdCBlbXB0eScpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuZXdEb20gPSBtb3VudEVsZW1lbnQodk5vZGUsIG51bGwsIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcpO1xuICAgICAgICB2Tm9kZS5kb20gPSBuZXdEb207XG4gICAgICAgIHJlcGxhY2VDaGlsZChkb20ucGFyZW50Tm9kZSwgbmV3RG9tLCBkb20pO1xuICAgICAgICByZXR1cm4gbmV3RG9tO1xuICAgIH1cbiAgICB2Tm9kZS5kb20gPSBkb207XG4gICAgaWYgKGNoaWxkcmVuKSB7XG4gICAgICAgIGh5ZHJhdGVDaGlsZHJlbihjaGlsZHJlbiwgZG9tLCBsaWZlY3ljbGUsIGNvbnRleHQsIGlzU1ZHKTtcbiAgICB9XG4gICAgdmFyIGhhc0NvbnRyb2xsZWRWYWx1ZSA9IGZhbHNlO1xuICAgIGlmICghKGZsYWdzICYgMiAvKiBIdG1sRWxlbWVudCAqLykpIHtcbiAgICAgICAgaGFzQ29udHJvbGxlZFZhbHVlID0gcHJvY2Vzc0VsZW1lbnQoZmxhZ3MsIHZOb2RlLCBkb20pO1xuICAgIH1cbiAgICBpZiAocHJvcHMpIHtcbiAgICAgICAgZm9yICh2YXIgcHJvcCBpbiBwcm9wcykge1xuICAgICAgICAgICAgcGF0Y2hQcm9wKHByb3AsIG51bGwsIHByb3BzW3Byb3BdLCBkb20sIGlzU1ZHLCBoYXNDb250cm9sbGVkVmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChldmVudHMpIHtcbiAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBldmVudHMpIHtcbiAgICAgICAgICAgIHBhdGNoRXZlbnQobmFtZSwgbnVsbCwgZXZlbnRzW25hbWVdLCBkb20pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChyZWYpIHtcbiAgICAgICAgbW91bnRSZWYoZG9tLCByZWYsIGxpZmVjeWNsZSk7XG4gICAgfVxuICAgIHJldHVybiBkb207XG59XG5mdW5jdGlvbiBoeWRyYXRlQ2hpbGRyZW4oY2hpbGRyZW4sIHBhcmVudERvbSwgbGlmZWN5Y2xlLCBjb250ZXh0LCBpc1NWRykge1xuICAgIG5vcm1hbGl6ZUNoaWxkTm9kZXMocGFyZW50RG9tKTtcbiAgICB2YXIgZG9tID0gcGFyZW50RG9tLmZpcnN0Q2hpbGQ7XG4gICAgaWYgKGlzQXJyYXkoY2hpbGRyZW4pKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBjaGlsZCA9IGNoaWxkcmVuW2ldO1xuICAgICAgICAgICAgaWYgKCFpc051bGwoY2hpbGQpICYmIGlzT2JqZWN0KGNoaWxkKSkge1xuICAgICAgICAgICAgICAgIGlmIChkb20pIHtcbiAgICAgICAgICAgICAgICAgICAgZG9tID0gaHlkcmF0ZShjaGlsZCwgZG9tLCBsaWZlY3ljbGUsIGNvbnRleHQsIGlzU1ZHKTtcbiAgICAgICAgICAgICAgICAgICAgZG9tID0gZG9tLm5leHRTaWJsaW5nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbW91bnQoY2hpbGQsIHBhcmVudERvbSwgbGlmZWN5Y2xlLCBjb250ZXh0LCBpc1NWRyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGlzU3RyaW5nT3JOdW1iZXIoY2hpbGRyZW4pKSB7XG4gICAgICAgIGlmIChkb20gJiYgZG9tLm5vZGVUeXBlID09PSAzKSB7XG4gICAgICAgICAgICBpZiAoZG9tLm5vZGVWYWx1ZSAhPT0gY2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICBkb20ubm9kZVZhbHVlID0gY2hpbGRyZW47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY2hpbGRyZW4pIHtcbiAgICAgICAgICAgIHBhcmVudERvbS50ZXh0Q29udGVudCA9IGNoaWxkcmVuO1xuICAgICAgICB9XG4gICAgICAgIGRvbSA9IGRvbS5uZXh0U2libGluZztcbiAgICB9XG4gICAgZWxzZSBpZiAoaXNPYmplY3QoY2hpbGRyZW4pKSB7XG4gICAgICAgIGh5ZHJhdGUoY2hpbGRyZW4sIGRvbSwgbGlmZWN5Y2xlLCBjb250ZXh0LCBpc1NWRyk7XG4gICAgICAgIGRvbSA9IGRvbS5uZXh0U2libGluZztcbiAgICB9XG4gICAgLy8gY2xlYXIgYW55IG90aGVyIERPTSBub2RlcywgdGhlcmUgc2hvdWxkIGJlIG9ubHkgYSBzaW5nbGUgZW50cnkgZm9yIHRoZSByb290XG4gICAgd2hpbGUgKGRvbSkge1xuICAgICAgICB2YXIgbmV4dFNpYmxpbmcgPSBkb20ubmV4dFNpYmxpbmc7XG4gICAgICAgIHBhcmVudERvbS5yZW1vdmVDaGlsZChkb20pO1xuICAgICAgICBkb20gPSBuZXh0U2libGluZztcbiAgICB9XG59XG5mdW5jdGlvbiBoeWRyYXRlVGV4dCh2Tm9kZSwgZG9tKSB7XG4gICAgaWYgKGRvbS5ub2RlVHlwZSAhPT0gMykge1xuICAgICAgICB2YXIgbmV3RG9tID0gbW91bnRUZXh0KHZOb2RlLCBudWxsKTtcbiAgICAgICAgdk5vZGUuZG9tID0gbmV3RG9tO1xuICAgICAgICByZXBsYWNlQ2hpbGQoZG9tLnBhcmVudE5vZGUsIG5ld0RvbSwgZG9tKTtcbiAgICAgICAgcmV0dXJuIG5ld0RvbTtcbiAgICB9XG4gICAgdmFyIHRleHQgPSB2Tm9kZS5jaGlsZHJlbjtcbiAgICBpZiAoZG9tLm5vZGVWYWx1ZSAhPT0gdGV4dCkge1xuICAgICAgICBkb20ubm9kZVZhbHVlID0gdGV4dDtcbiAgICB9XG4gICAgdk5vZGUuZG9tID0gZG9tO1xuICAgIHJldHVybiBkb207XG59XG5mdW5jdGlvbiBoeWRyYXRlVm9pZCh2Tm9kZSwgZG9tKSB7XG4gICAgdk5vZGUuZG9tID0gZG9tO1xuICAgIHJldHVybiBkb207XG59XG5mdW5jdGlvbiBoeWRyYXRlKHZOb2RlLCBkb20sIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcpIHtcbiAgICB2YXIgZmxhZ3MgPSB2Tm9kZS5mbGFncztcbiAgICBpZiAoZmxhZ3MgJiAyOCAvKiBDb21wb25lbnQgKi8pIHtcbiAgICAgICAgcmV0dXJuIGh5ZHJhdGVDb21wb25lbnQodk5vZGUsIGRvbSwgbGlmZWN5Y2xlLCBjb250ZXh0LCBpc1NWRywgZmxhZ3MgJiA0IC8qIENvbXBvbmVudENsYXNzICovKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZmxhZ3MgJiAzOTcwIC8qIEVsZW1lbnQgKi8pIHtcbiAgICAgICAgcmV0dXJuIGh5ZHJhdGVFbGVtZW50KHZOb2RlLCBkb20sIGxpZmVjeWNsZSwgY29udGV4dCwgaXNTVkcpO1xuICAgIH1cbiAgICBlbHNlIGlmIChmbGFncyAmIDEgLyogVGV4dCAqLykge1xuICAgICAgICByZXR1cm4gaHlkcmF0ZVRleHQodk5vZGUsIGRvbSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGZsYWdzICYgNDA5NiAvKiBWb2lkICovKSB7XG4gICAgICAgIHJldHVybiBoeWRyYXRlVm9pZCh2Tm9kZSwgZG9tKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgICAgICB0aHJvd0Vycm9yKChcImh5ZHJhdGUoKSBleHBlY3RzIGEgdmFsaWQgVk5vZGUsIGluc3RlYWQgaXQgcmVjZWl2ZWQgYW4gb2JqZWN0IHdpdGggdGhlIHR5cGUgXFxcIlwiICsgKHR5cGVvZiB2Tm9kZSkgKyBcIlxcXCIuXCIpKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvd0Vycm9yKCk7XG4gICAgfVxufVxuZnVuY3Rpb24gaHlkcmF0ZVJvb3QoaW5wdXQsIHBhcmVudERvbSwgbGlmZWN5Y2xlKSB7XG4gICAgdmFyIGRvbSA9IHBhcmVudERvbSAmJiBwYXJlbnREb20uZmlyc3RDaGlsZDtcbiAgICBpZiAoZG9tKSB7XG4gICAgICAgIGh5ZHJhdGUoaW5wdXQsIGRvbSwgbGlmZWN5Y2xlLCB7fSwgZmFsc2UpO1xuICAgICAgICBkb20gPSBwYXJlbnREb20uZmlyc3RDaGlsZDtcbiAgICAgICAgLy8gY2xlYXIgYW55IG90aGVyIERPTSBub2RlcywgdGhlcmUgc2hvdWxkIGJlIG9ubHkgYSBzaW5nbGUgZW50cnkgZm9yIHRoZSByb290XG4gICAgICAgIHdoaWxlIChkb20gPSBkb20ubmV4dFNpYmxpbmcpIHtcbiAgICAgICAgICAgIHBhcmVudERvbS5yZW1vdmVDaGlsZChkb20pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbi8vIHJhdGhlciB0aGFuIHVzZSBhIE1hcCwgbGlrZSB3ZSBkaWQgYmVmb3JlLCB3ZSBjYW4gdXNlIGFuIGFycmF5IGhlcmVcbi8vIGdpdmVuIHRoZXJlIHNob3VsZG4ndCBiZSBUSEFUIG1hbnkgcm9vdHMgb24gdGhlIHBhZ2UsIHRoZSBkaWZmZXJlbmNlXG4vLyBpbiBwZXJmb3JtYW5jZSBpcyBodWdlOiBodHRwczovL2VzYmVuY2guY29tL2JlbmNoLzU4MDJhNjkxMzMwYWIwOTkwMGExYTJkYVxudmFyIHJvb3RzID0gW107XG52YXIgY29tcG9uZW50VG9ET01Ob2RlTWFwID0gbmV3IE1hcCgpO1xub3B0aW9ucy5yb290cyA9IHJvb3RzO1xuZnVuY3Rpb24gZmluZERPTU5vZGUocmVmKSB7XG4gICAgaWYgKCFvcHRpb25zLmZpbmRET01Ob2RlRW5hYmxlZCkge1xuICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICAgICAgdGhyb3dFcnJvcignZmluZERPTU5vZGUoKSBoYXMgYmVlbiBkaXNhYmxlZCwgdXNlIEluZmVybm8ub3B0aW9ucy5maW5kRE9NTm9kZUVuYWJsZWQgPSB0cnVlOyBlbmFibGVkIGZpbmRET01Ob2RlKCkuIFdhcm5pbmcgdGhpcyBjYW4gc2lnbmlmaWNhbnRseSBpbXBhY3QgcGVyZm9ybWFuY2UhJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3dFcnJvcigpO1xuICAgIH1cbiAgICB2YXIgZG9tID0gcmVmICYmIHJlZi5ub2RlVHlwZSA/IHJlZiA6IG51bGw7XG4gICAgcmV0dXJuIGNvbXBvbmVudFRvRE9NTm9kZU1hcC5nZXQocmVmKSB8fCBkb207XG59XG5mdW5jdGlvbiBnZXRSb290KGRvbSkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcm9vdHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIHJvb3QgPSByb290c1tpXTtcbiAgICAgICAgaWYgKHJvb3QuZG9tID09PSBkb20pIHtcbiAgICAgICAgICAgIHJldHVybiByb290O1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xufVxuZnVuY3Rpb24gc2V0Um9vdChkb20sIGlucHV0LCBsaWZlY3ljbGUpIHtcbiAgICB2YXIgcm9vdCA9IHtcbiAgICAgICAgZG9tOiBkb20sXG4gICAgICAgIGlucHV0OiBpbnB1dCxcbiAgICAgICAgbGlmZWN5Y2xlOiBsaWZlY3ljbGVcbiAgICB9O1xuICAgIHJvb3RzLnB1c2gocm9vdCk7XG4gICAgcmV0dXJuIHJvb3Q7XG59XG5mdW5jdGlvbiByZW1vdmVSb290KHJvb3QpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJvb3RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChyb290c1tpXSA9PT0gcm9vdCkge1xuICAgICAgICAgICAgcm9vdHMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfVxufVxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICBpZiAoaXNCcm93c2VyICYmIGRvY3VtZW50LmJvZHkgPT09IG51bGwpIHtcbiAgICAgICAgd2FybmluZygnSW5mZXJubyB3YXJuaW5nOiB5b3UgY2Fubm90IGluaXRpYWxpemUgaW5mZXJubyB3aXRob3V0IFwiZG9jdW1lbnQuYm9keVwiLiBXYWl0IG9uIFwiRE9NQ29udGVudExvYWRlZFwiIGV2ZW50LCBhZGQgc2NyaXB0IHRvIGJvdHRvbSBvZiBib2R5LCBvciB1c2UgYXN5bmMvZGVmZXIgYXR0cmlidXRlcyBvbiBzY3JpcHQgdGFnLicpO1xuICAgIH1cbn1cbnZhciBkb2N1bWVudEJvZHkgPSBpc0Jyb3dzZXIgPyBkb2N1bWVudC5ib2R5IDogbnVsbDtcbmZ1bmN0aW9uIHJlbmRlcihpbnB1dCwgcGFyZW50RG9tKSB7XG4gICAgaWYgKGRvY3VtZW50Qm9keSA9PT0gcGFyZW50RG9tKSB7XG4gICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgICAgICB0aHJvd0Vycm9yKCd5b3UgY2Fubm90IHJlbmRlcigpIHRvIHRoZSBcImRvY3VtZW50LmJvZHlcIi4gVXNlIGFuIGVtcHR5IGVsZW1lbnQgYXMgYSBjb250YWluZXIgaW5zdGVhZC4nKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvd0Vycm9yKCk7XG4gICAgfVxuICAgIGlmIChpbnB1dCA9PT0gTk9fT1ApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgcm9vdCA9IGdldFJvb3QocGFyZW50RG9tKTtcbiAgICBpZiAoaXNOdWxsKHJvb3QpKSB7XG4gICAgICAgIHZhciBsaWZlY3ljbGUgPSBuZXcgTGlmZWN5Y2xlKCk7XG4gICAgICAgIGlmICghaXNJbnZhbGlkKGlucHV0KSkge1xuICAgICAgICAgICAgaWYgKGlucHV0LmRvbSkge1xuICAgICAgICAgICAgICAgIGlucHV0ID0gY2xvbmVWTm9kZShpbnB1dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWh5ZHJhdGVSb290KGlucHV0LCBwYXJlbnREb20sIGxpZmVjeWNsZSkpIHtcbiAgICAgICAgICAgICAgICBtb3VudChpbnB1dCwgcGFyZW50RG9tLCBsaWZlY3ljbGUsIHt9LCBmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByb290ID0gc2V0Um9vdChwYXJlbnREb20sIGlucHV0LCBsaWZlY3ljbGUpO1xuICAgICAgICAgICAgbGlmZWN5Y2xlLnRyaWdnZXIoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIGxpZmVjeWNsZSQxID0gcm9vdC5saWZlY3ljbGU7XG4gICAgICAgIGxpZmVjeWNsZSQxLmxpc3RlbmVycyA9IFtdO1xuICAgICAgICBpZiAoaXNOdWxsT3JVbmRlZihpbnB1dCkpIHtcbiAgICAgICAgICAgIHVubW91bnQocm9vdC5pbnB1dCwgcGFyZW50RG9tLCBsaWZlY3ljbGUkMSwgZmFsc2UsIGZhbHNlKTtcbiAgICAgICAgICAgIHJlbW92ZVJvb3Qocm9vdCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoaW5wdXQuZG9tKSB7XG4gICAgICAgICAgICAgICAgaW5wdXQgPSBjbG9uZVZOb2RlKGlucHV0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHBhdGNoKHJvb3QuaW5wdXQsIGlucHV0LCBwYXJlbnREb20sIGxpZmVjeWNsZSQxLCB7fSwgZmFsc2UsIGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgICBsaWZlY3ljbGUkMS50cmlnZ2VyKCk7XG4gICAgICAgIHJvb3QuaW5wdXQgPSBpbnB1dDtcbiAgICB9XG4gICAgaWYgKHJvb3QpIHtcbiAgICAgICAgdmFyIHJvb3RJbnB1dCA9IHJvb3QuaW5wdXQ7XG4gICAgICAgIGlmIChyb290SW5wdXQgJiYgKHJvb3RJbnB1dC5mbGFncyAmIDI4IC8qIENvbXBvbmVudCAqLykpIHtcbiAgICAgICAgICAgIHJldHVybiByb290SW5wdXQuY2hpbGRyZW47XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBjcmVhdGVSZW5kZXJlcihfcGFyZW50RG9tKSB7XG4gICAgdmFyIHBhcmVudERvbSA9IF9wYXJlbnREb20gfHwgbnVsbDtcbiAgICByZXR1cm4gZnVuY3Rpb24gcmVuZGVyZXIobGFzdElucHV0LCBuZXh0SW5wdXQpIHtcbiAgICAgICAgaWYgKCFwYXJlbnREb20pIHtcbiAgICAgICAgICAgIHBhcmVudERvbSA9IGxhc3RJbnB1dDtcbiAgICAgICAgfVxuICAgICAgICByZW5kZXIobmV4dElucHV0LCBwYXJlbnREb20pO1xuICAgIH07XG59XG5cbmZ1bmN0aW9uIGxpbmtFdmVudChkYXRhLCBldmVudCkge1xuICAgIHJldHVybiB7IGRhdGE6IGRhdGEsIGV2ZW50OiBldmVudCB9O1xufVxuXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuXHRPYmplY3QuZnJlZXplKEVNUFRZX09CSik7XG5cdHZhciB0ZXN0RnVuYyA9IGZ1bmN0aW9uIHRlc3RGbigpIHt9O1xuXHRpZiAoKHRlc3RGdW5jLm5hbWUgfHwgdGVzdEZ1bmMudG9TdHJpbmcoKSkuaW5kZXhPZigndGVzdEZuJykgPT09IC0xKSB7XG5cdFx0d2FybmluZygoJ0l0IGxvb2tzIGxpa2UgeW91XFwncmUgdXNpbmcgYSBtaW5pZmllZCBjb3B5IG9mIHRoZSBkZXZlbG9wbWVudCBidWlsZCAnICtcblx0XHRcdFx0J29mIEluZmVybm8uIFdoZW4gZGVwbG95aW5nIEluZmVybm8gYXBwcyB0byBwcm9kdWN0aW9uLCBtYWtlIHN1cmUgdG8gdXNlICcgK1xuXHRcdFx0XHQndGhlIHByb2R1Y3Rpb24gYnVpbGQgd2hpY2ggc2tpcHMgZGV2ZWxvcG1lbnQgd2FybmluZ3MgYW5kIGlzIGZhc3Rlci4gJyArXG5cdFx0XHRcdCdTZWUgaHR0cDovL2luZmVybm9qcy5vcmcgZm9yIG1vcmUgZGV0YWlscy4nXG5cdFx0KSk7XG5cdH1cbn1cblxuLy8gVGhpcyB3aWxsIGJlIHJlcGxhY2VkIGJ5IHJvbGx1cFxudmFyIHZlcnNpb24gPSAnMS4yLjInO1xuXG4vLyB3ZSBkdXBsaWNhdGUgaXQgc28gaXQgcGxheXMgbmljZWx5IHdpdGggZGlmZmVyZW50IG1vZHVsZSBsb2FkaW5nIHN5c3RlbXNcbnZhciBpbmRleCA9IHtcblx0bGlua0V2ZW50OiBsaW5rRXZlbnQsXG5cdC8vIGNvcmUgc2hhcGVzXG5cdGNyZWF0ZVZOb2RlOiBjcmVhdGVWTm9kZSxcblxuXHQvLyBjbG9uaW5nXG5cdGNsb25lVk5vZGU6IGNsb25lVk5vZGUsXG5cblx0Ly8gdXNlZCB0byBzaGFyZWQgY29tbW9uIGl0ZW1zIGJldHdlZW4gSW5mZXJubyBsaWJzXG5cdE5PX09QOiBOT19PUCxcblx0RU1QVFlfT0JKOiBFTVBUWV9PQkosXG5cblx0Ly8gRE9NXG5cdHJlbmRlcjogcmVuZGVyLFxuXHRmaW5kRE9NTm9kZTogZmluZERPTU5vZGUsXG5cdGNyZWF0ZVJlbmRlcmVyOiBjcmVhdGVSZW5kZXJlcixcblx0b3B0aW9uczogb3B0aW9ucyxcblx0dmVyc2lvbjogdmVyc2lvblxufTtcblxuZXhwb3J0c1snZGVmYXVsdCddID0gaW5kZXg7XG5leHBvcnRzLmxpbmtFdmVudCA9IGxpbmtFdmVudDtcbmV4cG9ydHMuY3JlYXRlVk5vZGUgPSBjcmVhdGVWTm9kZTtcbmV4cG9ydHMuY2xvbmVWTm9kZSA9IGNsb25lVk5vZGU7XG5leHBvcnRzLk5PX09QID0gTk9fT1A7XG5leHBvcnRzLkVNUFRZX09CSiA9IEVNUFRZX09CSjtcbmV4cG9ydHMucmVuZGVyID0gcmVuZGVyO1xuZXhwb3J0cy5maW5kRE9NTm9kZSA9IGZpbmRET01Ob2RlO1xuZXhwb3J0cy5jcmVhdGVSZW5kZXJlciA9IGNyZWF0ZVJlbmRlcmVyO1xuZXhwb3J0cy5vcHRpb25zID0gb3B0aW9ucztcbmV4cG9ydHMudmVyc2lvbiA9IHZlcnNpb247XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG5cbn0pKSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vaW5mZXJuby9kaXN0L2luZmVybm8ubm9kZS5qc1xuLy8gbW9kdWxlIGlkID0gNjJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxMy0yMDE1LCBGYWNlYm9vaywgSW5jLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBCU0Qtc3R5bGUgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS4gQW4gYWRkaXRpb25hbCBncmFudFxuICogb2YgcGF0ZW50IHJpZ2h0cyBjYW4gYmUgZm91bmQgaW4gdGhlIFBBVEVOVFMgZmlsZSBpbiB0aGUgc2FtZSBkaXJlY3RvcnkuXG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIFVzZSBpbnZhcmlhbnQoKSB0byBhc3NlcnQgc3RhdGUgd2hpY2ggeW91ciBwcm9ncmFtIGFzc3VtZXMgdG8gYmUgdHJ1ZS5cbiAqXG4gKiBQcm92aWRlIHNwcmludGYtc3R5bGUgZm9ybWF0IChvbmx5ICVzIGlzIHN1cHBvcnRlZCkgYW5kIGFyZ3VtZW50c1xuICogdG8gcHJvdmlkZSBpbmZvcm1hdGlvbiBhYm91dCB3aGF0IGJyb2tlIGFuZCB3aGF0IHlvdSB3ZXJlXG4gKiBleHBlY3RpbmcuXG4gKlxuICogVGhlIGludmFyaWFudCBtZXNzYWdlIHdpbGwgYmUgc3RyaXBwZWQgaW4gcHJvZHVjdGlvbiwgYnV0IHRoZSBpbnZhcmlhbnRcbiAqIHdpbGwgcmVtYWluIHRvIGVuc3VyZSBsb2dpYyBkb2VzIG5vdCBkaWZmZXIgaW4gcHJvZHVjdGlvbi5cbiAqL1xuXG52YXIgaW52YXJpYW50ID0gZnVuY3Rpb24oY29uZGl0aW9uLCBmb3JtYXQsIGEsIGIsIGMsIGQsIGUsIGYpIHtcbiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICBpZiAoZm9ybWF0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignaW52YXJpYW50IHJlcXVpcmVzIGFuIGVycm9yIG1lc3NhZ2UgYXJndW1lbnQnKTtcbiAgICB9XG4gIH1cblxuICBpZiAoIWNvbmRpdGlvbikge1xuICAgIHZhciBlcnJvcjtcbiAgICBpZiAoZm9ybWF0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGVycm9yID0gbmV3IEVycm9yKFxuICAgICAgICAnTWluaWZpZWQgZXhjZXB0aW9uIG9jY3VycmVkOyB1c2UgdGhlIG5vbi1taW5pZmllZCBkZXYgZW52aXJvbm1lbnQgJyArXG4gICAgICAgICdmb3IgdGhlIGZ1bGwgZXJyb3IgbWVzc2FnZSBhbmQgYWRkaXRpb25hbCBoZWxwZnVsIHdhcm5pbmdzLidcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBhcmdzID0gW2EsIGIsIGMsIGQsIGUsIGZdO1xuICAgICAgdmFyIGFyZ0luZGV4ID0gMDtcbiAgICAgIGVycm9yID0gbmV3IEVycm9yKFxuICAgICAgICBmb3JtYXQucmVwbGFjZSgvJXMvZywgZnVuY3Rpb24oKSB7IHJldHVybiBhcmdzW2FyZ0luZGV4KytdOyB9KVxuICAgICAgKTtcbiAgICAgIGVycm9yLm5hbWUgPSAnSW52YXJpYW50IFZpb2xhdGlvbic7XG4gICAgfVxuXG4gICAgZXJyb3IuZnJhbWVzVG9Qb3AgPSAxOyAvLyB3ZSBkb24ndCBjYXJlIGFib3V0IGludmFyaWFudCdzIG93biBmcmFtZVxuICAgIHRocm93IGVycm9yO1xuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGludmFyaWFudDtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9pbnZhcmlhbnQvYnJvd3Nlci5qc1xuLy8gbW9kdWxlIGlkID0gNjNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIHRvU3RyaW5nID0ge30udG9TdHJpbmc7XG5cbm1vZHVsZS5leHBvcnRzID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiAoYXJyKSB7XG4gIHJldHVybiB0b1N0cmluZy5jYWxsKGFycikgPT0gJ1tvYmplY3QgQXJyYXldJztcbn07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vaXNhcnJheS9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gNjRcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSBcImltcG9ydCBjcmVhdGVFbGVtZW50IGZyb20gJ2luZmVybm8tY3JlYXRlLWVsZW1lbnQnO1xcbmltcG9ydCBDb21wb25lbnQgZnJvbSAnaW5mZXJuby1jb21wb25lbnQnO1xcbmltcG9ydCB7IEdyaWQsIHJlZHVjZXIsIHNlbGVjdEdyaWREYXRhLCB3aXRoU2Nyb2xsUHJvcHMgfSBmcm9tICcuLi8uLi9pbmRleC5qcyc7XFxuXFxuY29uc3QgVHJhY2tlZEdyaWQgPSB3aXRoU2Nyb2xsUHJvcHMoR3JpZCk7XFxuXFxuY29uc3QgZGF0YSA9IEFycmF5KDEwMDAwMCkuZmlsbCgwKS5tYXAoKGl0ZW0sIGkpID0+ICh7XFxuICAgIGNvbDExOiBgUGlubmVkIGxlZnQgJHtpfWAsXFxuICAgIGNvbDE6IGksXFxuICAgIGNvbDI6IGBUaXRsZSAke2l9YCxcXG4gICAgY29sMjE6IGBQaW5uZWQgcmlnaHQgJHtpfWAsXFxuICAgIGNvbDM6ICdMb3JlbSBJcHN1bSBpcyBzaW1wbHkgZHVtbXkgdGV4dCBvZiB0aGUgcHJpbnRpbmcgYW5kIHR5cGVzZXR0aW5nIGluZHVzdHJ5LidcXG59KSk7XFxuXFxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmlld3BvcnQgZXh0ZW5kcyBDb21wb25lbnQge1xcbiAgICBjb25zdHJ1Y3RvcigpIHtcXG4gICAgICAgIHN1cGVyKCk7XFxuXFxuICAgICAgICB0aGlzLnN0YXRlID0ge1xcbiAgICAgICAgICAgIGdyaWRTdGF0ZToge1xcbiAgICAgICAgICAgICAgICBjb2x1bW5zOiBbe1xcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2NvbDEnLFxcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlU29ydGluZzogdHJ1ZVxcbiAgICAgICAgICAgICAgICB9LCB7XFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnY29sMTEnLFxcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDEyMCxcXG4gICAgICAgICAgICAgICAgICAgIHBpbm5lZExlZnQ6IHRydWUsXFxuICAgICAgICAgICAgICAgICAgICBlbmFibGVSZXNpemluZzogdHJ1ZVxcbiAgICAgICAgICAgICAgICB9LCB7XFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnY29sMicsXFxuICAgICAgICAgICAgICAgICAgICBtaW5XaWR0aDogNjAsXFxuICAgICAgICAgICAgICAgICAgICBlbmFibGVNb3Zpbmc6IHRydWUsXFxuICAgICAgICAgICAgICAgICAgICBlbmFibGVGaWx0ZXJpbmc6IHRydWUsXFxuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcjogJ1NlYXJjaCcsXFxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogMTUwLFxcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlUmVzaXppbmc6IHRydWVcXG4gICAgICAgICAgICAgICAgfSwge1xcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2NvbDIxJyxcXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiAxMjAsXFxuICAgICAgICAgICAgICAgICAgICBwaW5uZWRSaWdodDogdHJ1ZSxcXG4gICAgICAgICAgICAgICAgICAgIGVuYWJsZVJlc2l6aW5nOiB0cnVlXFxuICAgICAgICAgICAgICAgIH0sIHtcXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdjb2wzJyxcXG4gICAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnQ29sdW1uIDMnLFxcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDIwMCxcXG4gICAgICAgICAgICAgICAgICAgIG1heFdpZHRoOiAzMDAsXFxuICAgICAgICAgICAgICAgICAgICBlbmFibGVNb3Zpbmc6IHRydWUsXFxuICAgICAgICAgICAgICAgICAgICBlbmFibGVSZXNpemluZzogdHJ1ZVxcbiAgICAgICAgICAgICAgICB9LCB7XFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnNCcsXFxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogJzUwJSdcXG4gICAgICAgICAgICAgICAgfV0sXFxuICAgICAgICAgICAgICAgIHJvd1N0YXRlOiB7XFxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEluZGV4OiAwXFxuICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICB9LFxcbiAgICAgICAgICAgIGRhdGEsXFxuICAgICAgICAgICAgb3JpZ2luYWxEYXRhOiBkYXRhXFxuICAgICAgICB9O1xcblxcbiAgICAgICAgdGhpcy5jYWxsYmFjayA9IHRoaXMuY2FsbGJhY2suYmluZCh0aGlzKTtcXG4gICAgfVxcblxcbiAgICBjYWxsYmFjayhhY3Rpb24pIHtcXG4gICAgICAgIGNvbnNvbGUubG9nKGFjdGlvbik7XFxuICAgICAgICBzd2l0Y2ggKGFjdGlvbi50eXBlKSB7XFxuICAgICAgICAgICAgY2FzZSAnRklMVEVSX0NPTFVNTic6XFxuICAgICAgICAgICAgY2FzZSAnU09SVF9DT0xVTU4nOlxcbiAgICAgICAgICAgICAgICB7XFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBncmlkU3RhdGUgPSByZWR1Y2VyKHRoaXMuc3RhdGUuZ3JpZFN0YXRlLCBhY3Rpb24pO1xcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XFxuICAgICAgICAgICAgICAgICAgICAgICAgZ3JpZFN0YXRlLFxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHNlbGVjdEdyaWREYXRhKGdyaWRTdGF0ZSwgdGhpcy5zdGF0ZS5vcmlnaW5hbERhdGEpXFxuICAgICAgICAgICAgICAgICAgICB9KTtcXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xcbiAgICAgICAgICAgICAgICB9XFxuXFxuICAgICAgICAgICAgZGVmYXVsdDpcXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XFxuICAgICAgICAgICAgICAgICAgICBncmlkU3RhdGU6IHJlZHVjZXIodGhpcy5zdGF0ZS5ncmlkU3RhdGUsIGFjdGlvbilcXG4gICAgICAgICAgICAgICAgfSk7XFxuICAgICAgICAgICAgICAgIGJyZWFrO1xcbiAgICAgICAgfVxcbiAgICB9XFxuXFxuICAgIHJlbmRlcih7fSwgeyBncmlkU3RhdGUsIGRhdGEgfSkge1xcbiAgICAgICAgcmV0dXJuIGNyZWF0ZUVsZW1lbnQoVHJhY2tlZEdyaWQsIHtcXG4gICAgICAgICAgICB2aWV3cG9ydFdpZHRoOiA2MDAsXFxuICAgICAgICAgICAgdmlld3BvcnRIZWlnaHQ6IDM2MCxcXG4gICAgICAgICAgICBoZWFkZXJIZWlnaHQ6IDYwLFxcbiAgICAgICAgICAgIGNvbHVtbkNvbXBvbmVudDogdW5kZWZpbmVkLFxcbiAgICAgICAgICAgIHJvd0NvbXBvbmVudDogdW5kZWZpbmVkLFxcbiAgICAgICAgICAgIHN0YXRlOiBncmlkU3RhdGUsXFxuICAgICAgICAgICAgZGF0YTogZGF0YSxcXG4gICAgICAgICAgICBjYWxsYmFjazogdGhpcy5jYWxsYmFja1xcbiAgICAgICAgfSk7XFxuICAgIH1cXG59XCJcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vcmF3LWxvYWRlciEuL3NyYy9leGFtcGxlcy9kZW1vcy9HcmlkRGVtby5qc1xuLy8gbW9kdWxlIGlkID0gNjVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSBcImltcG9ydCBjcmVhdGVFbGVtZW50IGZyb20gJ2luZmVybm8tY3JlYXRlLWVsZW1lbnQnO1xcbmltcG9ydCBDb21wb25lbnQgZnJvbSAnaW5mZXJuby1jb21wb25lbnQnO1xcbmltcG9ydCB7IHdpdGhTY3JvbGxQcm9wcywgR3JpZCB9IGZyb20gJy4uLy4uL2luZGV4LmpzJztcXG5cXG5jb25zdCBUcmFja2VkR3JpZCA9IHdpdGhTY3JvbGxQcm9wcyhHcmlkKTtcXG5cXG5jb25zdCBncmlkU3RhdGUgPSB7XFxuICAgIGNvbHVtbnM6IFt7XFxuICAgICAgICBuYW1lOiAnY29sMScsXFxuICAgICAgICB3aWR0aDogJzIwJSdcXG4gICAgfSwge1xcbiAgICAgICAgbmFtZTogJ2NvbDInLFxcbiAgICAgICAgd2lkdGg6ICczNSUnXFxuICAgIH0sIHtcXG4gICAgICAgIG5hbWU6ICdjb2wzJyxcXG4gICAgICAgIHdpZHRoOiAnNDUlJ1xcbiAgICB9XVxcbn07XFxuXFxuY29uc3QgZGF0YSA9IEFycmF5KDEwMDAwMCkuZmlsbCgwKS5tYXAoKGl0ZW0sIGkpID0+ICh7XFxuICAgIGNvbDE6IGksXFxuICAgIGNvbDI6IGBDb2wyICR7aX1gLFxcbiAgICBjb2wzOiAnTG9yZW0gSXBzdW0gaXMgc2ltcGx5IGR1bW15IHRleHQgb2YgdGhlIHByaW50aW5nIGFuZCB0eXBlc2V0dGluZyBpbmR1c3RyeS4nXFxufSkpO1xcblxcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1pbmltYWwgZXh0ZW5kcyBDb21wb25lbnQge1xcbiAgICByZW5kZXIoKSB7XFxuICAgICAgICByZXR1cm4gY3JlYXRlRWxlbWVudChUcmFja2VkR3JpZCwge1xcbiAgICAgICAgICAgIHZpZXdwb3J0V2lkdGg6IDcyMCxcXG4gICAgICAgICAgICB2aWV3cG9ydEhlaWdodDogNDgwLFxcbiAgICAgICAgICAgIHN0YXRlOiBncmlkU3RhdGUsXFxuICAgICAgICAgICAgZGF0YTogZGF0YSB9KTtcXG4gICAgfVxcbn1cIlxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9yYXctbG9hZGVyIS4vc3JjL2V4YW1wbGVzL2RlbW9zL01pbmltYWwuanNcbi8vIG1vZHVsZSBpZCA9IDY2XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gXCJpbXBvcnQgY3JlYXRlRWxlbWVudCBmcm9tICdpbmZlcm5vLWNyZWF0ZS1lbGVtZW50JztcXG5pbXBvcnQgeyB3aXRoU2Nyb2xsUHJvcHMsIEdyaWQgfSBmcm9tICcuLi8uLi9pbmRleC5qcyc7XFxuXFxuY29uc3QgVHJhY2tlZEdyaWQgPSB3aXRoU2Nyb2xsUHJvcHMoR3JpZCk7XFxuXFxuY29uc3QgZ3JpZFN0YXRlID0ge1xcbiAgICBjb2x1bW5zOiBbe1xcbiAgICAgICAgbmFtZTogJ2NvbDEnLFxcbiAgICAgICAgd2lkdGg6ICc1MCUnXFxuICAgIH0sIHtcXG4gICAgICAgIG5hbWU6ICdjb2wxMScsXFxuICAgICAgICB3aWR0aDogMTIwLFxcbiAgICAgICAgcGlubmVkTGVmdDogdHJ1ZVxcbiAgICB9LCB7XFxuICAgICAgICBuYW1lOiAnY29sMicsXFxuICAgICAgICB3aWR0aDogJzUwJSdcXG4gICAgfSwge1xcbiAgICAgICAgbmFtZTogJ2NvbDIxJyxcXG4gICAgICAgIHdpZHRoOiAxMjAsXFxuICAgICAgICBwaW5uZWRSaWdodDogdHJ1ZVxcbiAgICB9XVxcbn07XFxuXFxuY29uc3QgZGF0YSA9IEFycmF5KDEwMDAwMCkuZmlsbCgwKS5tYXAoKGl0ZW0sIGkpID0+ICh7XFxuICAgIGNvbDExOiBgUGlubmVkIGxlZnQgJHtpfWAsXFxuICAgIGNvbDE6IGksXFxuICAgIGNvbDI6IGBUaXRsZSAke2l9YCxcXG4gICAgY29sMjE6IGBQaW5uZWQgcmlnaHQgJHtpfWAsXFxuICAgIGNvbDM6ICdMb3JlbSBJcHN1bSBpcyBzaW1wbHkgZHVtbXkgdGV4dCBvZiB0aGUgcHJpbnRpbmcgYW5kIHR5cGVzZXR0aW5nIGluZHVzdHJ5LidcXG59KSk7XFxuXFxuZXhwb3J0IGRlZmF1bHQgKCgpID0+IGNyZWF0ZUVsZW1lbnQoVHJhY2tlZEdyaWQsIHtcXG4gICAgdmlld3BvcnRXaWR0aDogNjAwLFxcbiAgICB2aWV3cG9ydEhlaWdodDogMzYwLFxcbiAgICBzdGF0ZTogZ3JpZFN0YXRlLFxcbiAgICBkYXRhOiBkYXRhIH0pKTtcIlxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9yYXctbG9hZGVyIS4vc3JjL2V4YW1wbGVzL2RlbW9zL1Bpbm5lZENvbHVtbnMuanNcbi8vIG1vZHVsZSBpZCA9IDY3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIid1c2Ugc3RyaWN0JztcblxudmFyIGlzQWJzb2x1dGUgPSBmdW5jdGlvbiBpc0Fic29sdXRlKHBhdGhuYW1lKSB7XG4gIHJldHVybiBwYXRobmFtZS5jaGFyQXQoMCkgPT09ICcvJztcbn07XG5cbi8vIEFib3V0IDEuNXggZmFzdGVyIHRoYW4gdGhlIHR3by1hcmcgdmVyc2lvbiBvZiBBcnJheSNzcGxpY2UoKVxudmFyIHNwbGljZU9uZSA9IGZ1bmN0aW9uIHNwbGljZU9uZShsaXN0LCBpbmRleCkge1xuICBmb3IgKHZhciBpID0gaW5kZXgsIGsgPSBpICsgMSwgbiA9IGxpc3QubGVuZ3RoOyBrIDwgbjsgaSArPSAxLCBrICs9IDEpIHtcbiAgICBsaXN0W2ldID0gbGlzdFtrXTtcbiAgfWxpc3QucG9wKCk7XG59O1xuXG4vLyBUaGlzIGltcGxlbWVudGF0aW9uIGlzIGJhc2VkIGhlYXZpbHkgb24gbm9kZSdzIHVybC5wYXJzZVxudmFyIHJlc29sdmVQYXRobmFtZSA9IGZ1bmN0aW9uIHJlc29sdmVQYXRobmFtZSh0bykge1xuICB2YXIgZnJvbSA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMSB8fCBhcmd1bWVudHNbMV0gPT09IHVuZGVmaW5lZCA/ICcnIDogYXJndW1lbnRzWzFdO1xuXG4gIHZhciB0b1BhcnRzID0gdG8gJiYgdG8uc3BsaXQoJy8nKSB8fCBbXTtcbiAgdmFyIGZyb21QYXJ0cyA9IGZyb20gJiYgZnJvbS5zcGxpdCgnLycpIHx8IFtdO1xuXG4gIHZhciBpc1RvQWJzID0gdG8gJiYgaXNBYnNvbHV0ZSh0byk7XG4gIHZhciBpc0Zyb21BYnMgPSBmcm9tICYmIGlzQWJzb2x1dGUoZnJvbSk7XG4gIHZhciBtdXN0RW5kQWJzID0gaXNUb0FicyB8fCBpc0Zyb21BYnM7XG5cbiAgaWYgKHRvICYmIGlzQWJzb2x1dGUodG8pKSB7XG4gICAgLy8gdG8gaXMgYWJzb2x1dGVcbiAgICBmcm9tUGFydHMgPSB0b1BhcnRzO1xuICB9IGVsc2UgaWYgKHRvUGFydHMubGVuZ3RoKSB7XG4gICAgLy8gdG8gaXMgcmVsYXRpdmUsIGRyb3AgdGhlIGZpbGVuYW1lXG4gICAgZnJvbVBhcnRzLnBvcCgpO1xuICAgIGZyb21QYXJ0cyA9IGZyb21QYXJ0cy5jb25jYXQodG9QYXJ0cyk7XG4gIH1cblxuICBpZiAoIWZyb21QYXJ0cy5sZW5ndGgpIHJldHVybiAnLyc7XG5cbiAgdmFyIGhhc1RyYWlsaW5nU2xhc2ggPSB2b2lkIDA7XG4gIGlmIChmcm9tUGFydHMubGVuZ3RoKSB7XG4gICAgdmFyIGxhc3QgPSBmcm9tUGFydHNbZnJvbVBhcnRzLmxlbmd0aCAtIDFdO1xuICAgIGhhc1RyYWlsaW5nU2xhc2ggPSBsYXN0ID09PSAnLicgfHwgbGFzdCA9PT0gJy4uJyB8fCBsYXN0ID09PSAnJztcbiAgfSBlbHNlIHtcbiAgICBoYXNUcmFpbGluZ1NsYXNoID0gZmFsc2U7XG4gIH1cblxuICB2YXIgdXAgPSAwO1xuICBmb3IgKHZhciBpID0gZnJvbVBhcnRzLmxlbmd0aDsgaSA+PSAwOyBpLS0pIHtcbiAgICB2YXIgcGFydCA9IGZyb21QYXJ0c1tpXTtcblxuICAgIGlmIChwYXJ0ID09PSAnLicpIHtcbiAgICAgIHNwbGljZU9uZShmcm9tUGFydHMsIGkpO1xuICAgIH0gZWxzZSBpZiAocGFydCA9PT0gJy4uJykge1xuICAgICAgc3BsaWNlT25lKGZyb21QYXJ0cywgaSk7XG4gICAgICB1cCsrO1xuICAgIH0gZWxzZSBpZiAodXApIHtcbiAgICAgIHNwbGljZU9uZShmcm9tUGFydHMsIGkpO1xuICAgICAgdXAtLTtcbiAgICB9XG4gIH1cblxuICBpZiAoIW11c3RFbmRBYnMpIGZvciAoOyB1cC0tOyB1cCkge1xuICAgIGZyb21QYXJ0cy51bnNoaWZ0KCcuLicpO1xuICB9aWYgKG11c3RFbmRBYnMgJiYgZnJvbVBhcnRzWzBdICE9PSAnJyAmJiAoIWZyb21QYXJ0c1swXSB8fCAhaXNBYnNvbHV0ZShmcm9tUGFydHNbMF0pKSkgZnJvbVBhcnRzLnVuc2hpZnQoJycpO1xuXG4gIHZhciByZXN1bHQgPSBmcm9tUGFydHMuam9pbignLycpO1xuXG4gIGlmIChoYXNUcmFpbGluZ1NsYXNoICYmIHJlc3VsdC5zdWJzdHIoLTEpICE9PSAnLycpIHJlc3VsdCArPSAnLyc7XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gcmVzb2x2ZVBhdGhuYW1lO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9yZXNvbHZlLXBhdGhuYW1lL2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSA2OFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvLyBzdHlsZS1sb2FkZXI6IEFkZHMgc29tZSBjc3MgdG8gdGhlIERPTSBieSBhZGRpbmcgYSA8c3R5bGU+IHRhZ1xuXG4vLyBsb2FkIHRoZSBzdHlsZXNcbnZhciBjb250ZW50ID0gcmVxdWlyZShcIiEhLi4vLi4vY3NzLWxvYWRlci9pbmRleC5qcz8/cmVmLS0wLTEhLi9tb25va2FpLmNzc1wiKTtcbmlmKHR5cGVvZiBjb250ZW50ID09PSAnc3RyaW5nJykgY29udGVudCA9IFtbbW9kdWxlLmlkLCBjb250ZW50LCAnJ11dO1xuLy8gYWRkIHRoZSBzdHlsZXMgdG8gdGhlIERPTVxudmFyIHVwZGF0ZSA9IHJlcXVpcmUoXCIhLi4vLi4vc3R5bGUtbG9hZGVyL2FkZFN0eWxlcy5qc1wiKShjb250ZW50LCB7fSk7XG5pZihjb250ZW50LmxvY2FscykgbW9kdWxlLmV4cG9ydHMgPSBjb250ZW50LmxvY2Fscztcbi8vIEhvdCBNb2R1bGUgUmVwbGFjZW1lbnRcbmlmKG1vZHVsZS5ob3QpIHtcblx0Ly8gV2hlbiB0aGUgc3R5bGVzIGNoYW5nZSwgdXBkYXRlIHRoZSA8c3R5bGU+IHRhZ3Ncblx0aWYoIWNvbnRlbnQubG9jYWxzKSB7XG5cdFx0bW9kdWxlLmhvdC5hY2NlcHQoXCIhIS4uLy4uL2Nzcy1sb2FkZXIvaW5kZXguanM/P3JlZi0tMC0xIS4vbW9ub2thaS5jc3NcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgbmV3Q29udGVudCA9IHJlcXVpcmUoXCIhIS4uLy4uL2Nzcy1sb2FkZXIvaW5kZXguanM/P3JlZi0tMC0xIS4vbW9ub2thaS5jc3NcIik7XG5cdFx0XHRpZih0eXBlb2YgbmV3Q29udGVudCA9PT0gJ3N0cmluZycpIG5ld0NvbnRlbnQgPSBbW21vZHVsZS5pZCwgbmV3Q29udGVudCwgJyddXTtcblx0XHRcdHVwZGF0ZShuZXdDb250ZW50KTtcblx0XHR9KTtcblx0fVxuXHQvLyBXaGVuIHRoZSBtb2R1bGUgaXMgZGlzcG9zZWQsIHJlbW92ZSB0aGUgPHN0eWxlPiB0YWdzXG5cdG1vZHVsZS5ob3QuZGlzcG9zZShmdW5jdGlvbigpIHsgdXBkYXRlKCk7IH0pO1xufVxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9oaWdobGlnaHQuanMvc3R5bGVzL21vbm9rYWkuY3NzXG4vLyBtb2R1bGUgaWQgPSA2OVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvLyBzdHlsZS1sb2FkZXI6IEFkZHMgc29tZSBjc3MgdG8gdGhlIERPTSBieSBhZGRpbmcgYSA8c3R5bGU+IHRhZ1xuXG4vLyBsb2FkIHRoZSBzdHlsZXNcbnZhciBjb250ZW50ID0gcmVxdWlyZShcIiEhLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvaW5kZXguanM/P3JlZi0tMC0xIS4vQXBwLmNzc1wiKTtcbmlmKHR5cGVvZiBjb250ZW50ID09PSAnc3RyaW5nJykgY29udGVudCA9IFtbbW9kdWxlLmlkLCBjb250ZW50LCAnJ11dO1xuLy8gYWRkIHRoZSBzdHlsZXMgdG8gdGhlIERPTVxudmFyIHVwZGF0ZSA9IHJlcXVpcmUoXCIhLi4vLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9hZGRTdHlsZXMuanNcIikoY29udGVudCwge30pO1xuaWYoY29udGVudC5sb2NhbHMpIG1vZHVsZS5leHBvcnRzID0gY29udGVudC5sb2NhbHM7XG4vLyBIb3QgTW9kdWxlIFJlcGxhY2VtZW50XG5pZihtb2R1bGUuaG90KSB7XG5cdC8vIFdoZW4gdGhlIHN0eWxlcyBjaGFuZ2UsIHVwZGF0ZSB0aGUgPHN0eWxlPiB0YWdzXG5cdGlmKCFjb250ZW50LmxvY2Fscykge1xuXHRcdG1vZHVsZS5ob3QuYWNjZXB0KFwiISEuLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcz8/cmVmLS0wLTEhLi9BcHAuY3NzXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIG5ld0NvbnRlbnQgPSByZXF1aXJlKFwiISEuLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcz8/cmVmLS0wLTEhLi9BcHAuY3NzXCIpO1xuXHRcdFx0aWYodHlwZW9mIG5ld0NvbnRlbnQgPT09ICdzdHJpbmcnKSBuZXdDb250ZW50ID0gW1ttb2R1bGUuaWQsIG5ld0NvbnRlbnQsICcnXV07XG5cdFx0XHR1cGRhdGUobmV3Q29udGVudCk7XG5cdFx0fSk7XG5cdH1cblx0Ly8gV2hlbiB0aGUgbW9kdWxlIGlzIGRpc3Bvc2VkLCByZW1vdmUgdGhlIDxzdHlsZT4gdGFnc1xuXHRtb2R1bGUuaG90LmRpc3Bvc2UoZnVuY3Rpb24oKSB7IHVwZGF0ZSgpOyB9KTtcbn1cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9leGFtcGxlcy9BcHAuY3NzXG4vLyBtb2R1bGUgaWQgPSA3MFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvLyBzdHlsZS1sb2FkZXI6IEFkZHMgc29tZSBjc3MgdG8gdGhlIERPTSBieSBhZGRpbmcgYSA8c3R5bGU+IHRhZ1xuXG4vLyBsb2FkIHRoZSBzdHlsZXNcbnZhciBjb250ZW50ID0gcmVxdWlyZShcIiEhLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvaW5kZXguanM/P3JlZi0tMC0xIS4vUGFnZS5jc3NcIik7XG5pZih0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycpIGNvbnRlbnQgPSBbW21vZHVsZS5pZCwgY29udGVudCwgJyddXTtcbi8vIGFkZCB0aGUgc3R5bGVzIHRvIHRoZSBET01cbnZhciB1cGRhdGUgPSByZXF1aXJlKFwiIS4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvYWRkU3R5bGVzLmpzXCIpKGNvbnRlbnQsIHt9KTtcbmlmKGNvbnRlbnQubG9jYWxzKSBtb2R1bGUuZXhwb3J0cyA9IGNvbnRlbnQubG9jYWxzO1xuLy8gSG90IE1vZHVsZSBSZXBsYWNlbWVudFxuaWYobW9kdWxlLmhvdCkge1xuXHQvLyBXaGVuIHRoZSBzdHlsZXMgY2hhbmdlLCB1cGRhdGUgdGhlIDxzdHlsZT4gdGFnc1xuXHRpZighY29udGVudC5sb2NhbHMpIHtcblx0XHRtb2R1bGUuaG90LmFjY2VwdChcIiEhLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvaW5kZXguanM/P3JlZi0tMC0xIS4vUGFnZS5jc3NcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgbmV3Q29udGVudCA9IHJlcXVpcmUoXCIhIS4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzPz9yZWYtLTAtMSEuL1BhZ2UuY3NzXCIpO1xuXHRcdFx0aWYodHlwZW9mIG5ld0NvbnRlbnQgPT09ICdzdHJpbmcnKSBuZXdDb250ZW50ID0gW1ttb2R1bGUuaWQsIG5ld0NvbnRlbnQsICcnXV07XG5cdFx0XHR1cGRhdGUobmV3Q29udGVudCk7XG5cdFx0fSk7XG5cdH1cblx0Ly8gV2hlbiB0aGUgbW9kdWxlIGlzIGRpc3Bvc2VkLCByZW1vdmUgdGhlIDxzdHlsZT4gdGFnc1xuXHRtb2R1bGUuaG90LmRpc3Bvc2UoZnVuY3Rpb24oKSB7IHVwZGF0ZSgpOyB9KTtcbn1cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9leGFtcGxlcy9QYWdlLmNzc1xuLy8gbW9kdWxlIGlkID0gNzFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiJ3VzZSBzdHJpY3QnO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXG52YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07XG5cbnZhciB2YWx1ZUVxdWFsID0gZnVuY3Rpb24gdmFsdWVFcXVhbChhLCBiKSB7XG4gIGlmIChhID09PSBiKSByZXR1cm4gdHJ1ZTtcblxuICBpZiAoYSA9PSBudWxsIHx8IGIgPT0gbnVsbCkgcmV0dXJuIGZhbHNlO1xuXG4gIGlmIChBcnJheS5pc0FycmF5KGEpKSB7XG4gICAgaWYgKCFBcnJheS5pc0FycmF5KGIpIHx8IGEubGVuZ3RoICE9PSBiLmxlbmd0aCkgcmV0dXJuIGZhbHNlO1xuXG4gICAgcmV0dXJuIGEuZXZlcnkoZnVuY3Rpb24gKGl0ZW0sIGluZGV4KSB7XG4gICAgICByZXR1cm4gdmFsdWVFcXVhbChpdGVtLCBiW2luZGV4XSk7XG4gICAgfSk7XG4gIH1cblxuICB2YXIgYVR5cGUgPSB0eXBlb2YgYSA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YoYSk7XG4gIHZhciBiVHlwZSA9IHR5cGVvZiBiID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZihiKTtcblxuICBpZiAoYVR5cGUgIT09IGJUeXBlKSByZXR1cm4gZmFsc2U7XG5cbiAgaWYgKGFUeXBlID09PSAnb2JqZWN0Jykge1xuICAgIHZhciBhVmFsdWUgPSBhLnZhbHVlT2YoKTtcbiAgICB2YXIgYlZhbHVlID0gYi52YWx1ZU9mKCk7XG5cbiAgICBpZiAoYVZhbHVlICE9PSBhIHx8IGJWYWx1ZSAhPT0gYikgcmV0dXJuIHZhbHVlRXF1YWwoYVZhbHVlLCBiVmFsdWUpO1xuXG4gICAgdmFyIGFLZXlzID0gT2JqZWN0LmtleXMoYSk7XG4gICAgdmFyIGJLZXlzID0gT2JqZWN0LmtleXMoYik7XG5cbiAgICBpZiAoYUtleXMubGVuZ3RoICE9PSBiS2V5cy5sZW5ndGgpIHJldHVybiBmYWxzZTtcblxuICAgIHJldHVybiBhS2V5cy5ldmVyeShmdW5jdGlvbiAoa2V5KSB7XG4gICAgICByZXR1cm4gdmFsdWVFcXVhbChhW2tleV0sIGJba2V5XSk7XG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gZmFsc2U7XG59O1xuXG5leHBvcnRzLmRlZmF1bHQgPSB2YWx1ZUVxdWFsO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi92YWx1ZS1lcXVhbC9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gNzJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIGc7XHJcblxyXG4vLyBUaGlzIHdvcmtzIGluIG5vbi1zdHJpY3QgbW9kZVxyXG5nID0gKGZ1bmN0aW9uKCkge1xyXG5cdHJldHVybiB0aGlzO1xyXG59KSgpO1xyXG5cclxudHJ5IHtcclxuXHQvLyBUaGlzIHdvcmtzIGlmIGV2YWwgaXMgYWxsb3dlZCAoc2VlIENTUClcclxuXHRnID0gZyB8fCBGdW5jdGlvbihcInJldHVybiB0aGlzXCIpKCkgfHwgKDEsZXZhbCkoXCJ0aGlzXCIpO1xyXG59IGNhdGNoKGUpIHtcclxuXHQvLyBUaGlzIHdvcmtzIGlmIHRoZSB3aW5kb3cgcmVmZXJlbmNlIGlzIGF2YWlsYWJsZVxyXG5cdGlmKHR5cGVvZiB3aW5kb3cgPT09IFwib2JqZWN0XCIpXHJcblx0XHRnID0gd2luZG93O1xyXG59XHJcblxyXG4vLyBnIGNhbiBzdGlsbCBiZSB1bmRlZmluZWQsIGJ1dCBub3RoaW5nIHRvIGRvIGFib3V0IGl0Li4uXHJcbi8vIFdlIHJldHVybiB1bmRlZmluZWQsIGluc3RlYWQgb2Ygbm90aGluZyBoZXJlLCBzbyBpdCdzXHJcbi8vIGVhc2llciB0byBoYW5kbGUgdGhpcyBjYXNlLiBpZighZ2xvYmFsKSB7IC4uLn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gZztcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gKHdlYnBhY2spL2J1aWxkaW4vZ2xvYmFsLmpzXG4vLyBtb2R1bGUgaWQgPSA3M1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgSW5mZXJubyBmcm9tICdpbmZlcm5vJztcclxuaW1wb3J0IGNyZWF0ZUVsZW1lbnQgZnJvbSAnaW5mZXJuby1jcmVhdGUtZWxlbWVudCc7XHJcbmltcG9ydCB7IFJvdXRlciwgUm91dGUgfSBmcm9tICdpbmZlcm5vLXJvdXRlcic7XHJcbmltcG9ydCBjcmVhdGVIYXNoSGlzdG9yeSBmcm9tICdoaXN0b3J5L2NyZWF0ZUhhc2hIaXN0b3J5JztcclxuaW1wb3J0IEFwcCBmcm9tICcuL0FwcC5qcyc7XHJcbmltcG9ydCBQYWdlIGZyb20gJy4vUGFnZS5qcyc7XHJcbmltcG9ydCBuYXYgZnJvbSAnLi9uYXYuanMnO1xyXG5cclxuY29uc3QgbmF2TGlua2VkID0gbmF2Lm1hcChpdGVtID0+IE9iamVjdC5hc3NpZ24oe30sIGl0ZW0sIHtcclxuICAgIGNvbXBvbmVudDogKCkgPT4gPFBhZ2Ugey4uLml0ZW19IC8+XHJcbn0pKTtcclxuXHJcbkluZmVybm8ucmVuZGVyKFxyXG4gICAgPFJvdXRlciBoaXN0b3J5PXtjcmVhdGVIYXNoSGlzdG9yeSgpfT5cclxuICAgICAgICA8Um91dGUgY29tcG9uZW50PXtBcHB9PlxyXG4gICAgICAgICAgICB7bmF2TGlua2VkLm1hcChpdGVtID0+XHJcbiAgICAgICAgICAgICAgICA8Um91dGUga2V5PXtpdGVtLmhyZWZ9IHBhdGg9e2l0ZW0uaHJlZn0gY29tcG9uZW50PXtpdGVtLmNvbXBvbmVudH0gLz5cclxuICAgICAgICAgICAgKX1cclxuICAgICAgICA8L1JvdXRlPlxyXG4gICAgPC9Sb3V0ZXI+LFxyXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSlcclxuKTtcclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2V4YW1wbGVzL2luZGV4LmpzIl0sInNvdXJjZVJvb3QiOiIifQ==